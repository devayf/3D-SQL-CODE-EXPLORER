<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>TTX — SQL Neural Explorer</title>
  <style>
    :root{
      --bg:#0b0f14; --panel:#0e141c; --accent:#f2c200; --muted:#9aa4af; --border:#223; --text:#e6e6e6;
      --sidebar-w:560px;
         .rightAlign {
  margin-left: auto;
}
    }
    #search {
  width: 100%;
  box-sizing: border-box;
}
    html,body{
      margin:0; height:100%; background:var(--bg); color:var(--text);
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif; overflow:hidden;
    }

    /* top bar */
    #topbar{
      position:fixed; top:0; left:0; right:0; z-index:10;
      background:linear-gradient(90deg,#121821,#121821 70%,#1a2130);
      padding:10px; display:flex; gap:8px; align-items:center; border-bottom:1px solid var(--border);
    }
    .brand{ display:flex; align-items:center; gap:10px; padding-right:12px; border-right:1px solid var(--border) }
    .title{ font-weight:700; letter-spacing:.3px; font-size:1.6rem; }
    #topbar input,#topbar button,#topbar select{
      background:var(--bg); color:var(--text); border:1px solid var(--border); padding:6px 8px; border-radius:6px;
    }
    input[type="number"]::-webkit-outer-spin-button,
    input[type="number"]::-webkit-inner-spin-button{ -webkit-appearance:none; margin:0 }
    input[type="number"]{ -moz-appearance:textfield }

    /* search */
    .searchwrap{ position:relative; width:350px }
    #search{
      padding-right:28px;
      background-image:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" fill="%239aa4af" viewBox="0 0 24 24"><path d="M9.5 3a6.5 6.5 0 015.2 10.5l4.15 4.15-1.4 1.4-4.15-4.15A6.5 6.5 0 119.5 3zm0 2a4.5 4.5 0 100 9 4.5 4.5 0 000-9z"/></svg>');
      background-repeat:no-repeat; background-position:right 8px center;
    }
    .sugg{ position:absolute; left:0; right:0; top:calc(100% + 4px); background:var(--panel); border:1px solid var(--border);
           border-radius:8px; max-height:260px; overflow:auto; box-shadow:0 10px 30px rgba(0,0,0,.35); z-index:12 }
    .sugg.hidden{ display:none }
    .sugg .item{ padding:8px 10px; font-size:14px; cursor:pointer; display:flex; justify-content:space-between; gap:8px }
    .sugg .item:hover{ background:#0b0f14 }
    .sugg .type{ color:var(--muted); font-size:12px }

    /* canvas + collapsible sidebar */
    #canvas{ position:absolute; top:52px; bottom:0; left:0; right:var(--sidebar-w); transition:right .25s ease }
    #sidebar{ position:fixed; top:52px; right:0; bottom:0; width:var(--sidebar-w); background:var(--panel);
              border-left:1px solid var(--border); display:grid; grid-template-rows:1fr auto;
              transform:translateX(0); transition:transform .25s ease }
    body.sidebar-collapsed #sidebar{ transform:translateX(var(--sidebar-w)) }
    body.sidebar-collapsed #canvas{ right:0 }

    #toggleHandle{
  position:fixed; top:50%; right:var(--sidebar-w); transform:translateY(-50%);
  background:var(--panel); color:var(--text); border:1px solid var(--border); border-right:none;
  padding:16px 18px;      /* bigger padding for a larger clickable area */
  font-size:1.6em;        /* make icon/text bigger */
  border-radius:12px 0 0 12px; /* optionally round more */
  cursor:pointer; z-index:11; line-height:1;
}
body.sidebar-collapsed #toggleHandle{ 
  right:0; 
  border-right:1px solid var(--border); 
  border-left:none; 
  border-radius:0 12px 12px 0;  /* match new corner radius */
}

    #inspector{ padding:12px; border-bottom:1px solid var(--border); overflow:auto; min-height:0 }
    #details{ color:var(--muted); font-size:13px }
    #details pre{ overflow-wrap:anywhere; white-space:pre-wrap; background:#0b0f14; border:1px solid var(--border); border-radius:6px; padding:8px }

    #chat{ display:grid; grid-template-rows:1fr auto; height:100% }
    #chatlog{ padding:12px; overflow:auto }
    .chat-msg{ margin-bottom:10px }
    .chat-role{ font-size:12px; color:var(--muted) }
    .chat-bubble{ background:#0b0f14; border:1px solid var(--border); padding:8px; border-radius:8px; margin-top:4px; white-space:pre-wrap }
    #chatctl{ padding:10px; border-top:1px solid var(--border); display:grid; grid-template-columns:1fr auto; gap:8px }
    #prompt{ background:#0b0f14; color:var(--text); border:1px solid var(--border); border-radius:8px; padding:8px; min-height:56px }
    #send{ background:var(--accent); color:#111; border:0; padding:10px 14px; border-radius:8px; font-weight:700 }

    .muted{ color:var(--muted) }
    .pill{ display:inline-block; padding:2px 6px; border-radius:999px; border:1px solid var(--border); font-size:12px; margin-right:6px }
    .legend .pill{ margin-top:4px }

    /* reset button */
    #btnReset{
      position:fixed; left:12px; bottom:12px; z-index:12;
      background:var(--panel); color:var(--text); border:1px solid var(--border);
      padding:8px 10px; border-radius:8px;
    }
    #btnReset:hover{ filter:brightness(1.1); cursor:pointer }
#btnLabels{
  position:fixed; left:75px; bottom:12px; z-index:12;
  background:var(--panel); color:var(--text); border:1px solid var(--border);
  padding:8px 10px; border-radius:8px;
}
#btnLabels:hover{ filter:brightness(1.1); cursor:pointer }
/* Modern scrollbar for sidebar and chat */
#sidebar, #chatlog, #inspector {
  scrollbar-width: thin;           /* For Firefox */
  scrollbar-color: var(--accent) var(--panel); /* For Firefox */
}

/* For Chrome/Safari/Edge */
#sidebar::-webkit-scrollbar,
#chatlog::-webkit-scrollbar,
#inspector::-webkit-scrollbar {
  width: 8px;
  background: var(--panel);
}
#sidebar::-webkit-scrollbar-thumb,
#chatlog::-webkit-scrollbar-thumb,
#inspector::-webkit-scrollbar-thumb {
  background: var(--accent);
  border-radius: 5px;
  border: 2px solid var(--panel);
}
#sidebar::-webkit-scrollbar-track,
#chatlog::-webkit-scrollbar-track,
#inspector::-webkit-scrollbar-track {
  background: var(--panel);
  border-radius: 5px;
}
input[type="file"]:hover,
#btnDemo:hover {
  cursor: pointer;
}
input[type="file"]:hover,
#btnDemo:hover,
#send:hover {
  cursor: pointer;
}
  </style>
</head>
<body>
  <div id="topbar">
    <div class="brand">
      <img src="TTX_Company-Logo.wine.png" alt="TTX Logo" style="height:75px;width:auto;object-fit:contain;vertical-align:middle;">
      <span class="title">SQL Neural Explorer</span>
    </div>
    <div class="searchwrap">
      <input id="search" type="text" placeholder="Search node by name..." autocomplete="on" />
      <div id="sugg" class="sugg hidden"></div>
    </div>
    <label>Radius <input id="radius" type="number" min="0" max="25" value="4" style="width:64px"></label>
    <input id="file" type="file" accept=".json,application/json" class="rightAlign" />
    <button id="btnDemo">Load Demo</button>
    <span class="muted">DDSMRT</span>
  </div>

  <div id="canvas"></div>

  <div id="sidebar">
    <div id="inspector">
      <div class="legend">
        <span class="pill">Size = degree</span>
        <span class="pill">Color = type</span>
        <span class="pill">Links = deps</span>
      </div>
      <h3 id="title" style="margin:10px 0 6px 0;">Details</h3>
      <div id="details" class="muted">Load a JSON model or the demo. Select a node to view SQL.</div>
    </div>

    <div id="chat">
      <div id="chatlog"></div>
      <div id="chatctl">
        <textarea id="prompt" placeholder='Commands: help | focus <id> | neighbors <id> [r] | shortest <src> <dst> | search <text>'></textarea>
        <button id="send">Ask</button>
      </div>
    </div>
  </div>

  <button id="toggleHandle" aria-label="Toggle sidebar">◂</button>
  <button id="btnReset" aria-label="Reset view">Reset</button>
  <button id="btnLabels" aria-label="Toggle labels">Show Object Names</button>

  <!-- libs -->
  <script src="https://unpkg.com/three@0.157.0/build/three.min.js"></script>
  <script src="https://unpkg.com/3d-force-graph@1.73.3/dist/3d-force-graph.min.js"></script>

  <!-- inline demo JSON -->
  <script type="application/json" id="ttx-demo">
{
  "nodes": [
    {
      "id": "VMRT_Car_Dimension_Correct",
      "name": "VMRT_Car_Dimension_Correct",
      "type": "VIEW",
      "sql": "CREATE VIEW [dbo].[VMRT_Car_Dimension_Correct]  WITH schemabinding  AS       SELECT car.[car_nr],              car.[car_init],             car.[car_status_ufd],              car.[ttx_eff_dt],              car.[car_ownrshp_ind],              car.[pool_cd],              car.[ttx_mngd_car_ind],              car.car_eff_from,              car.car_eff_to,              car.[car_dimn_id],              car.[car_ver],              car.car_src_sys_nm,              car.[ownr_mrk],              car.[eq_hierchy_id],              car.[eq_hierchy_ver],              car.[fleet_hierchy_ver],              car.[entr_hierchy_ver],              car.[fleet_hierchy_id],              car.[entr_hierchy_id],        --7/16/2020 - Eshift data       car.Eshift_Hierchy_Id,       car.Eshift_Hierchy_Ver,             car.[car_cls],              car.[railcar],              car.[car_lineage_grp_id],              car.[assetnum],              car.[fin_car_id],              car.[car_status_maximo],              [umler_blt_dt],              [eq_bldr],              [bldr_lot_cd],              [blt_from_use_ast],              [brk_cd],              [car_cost_est_act],              [lese_cd],              [ldgr_val],              [lst_shp_dt],              [milg_upd_dt],              [orig_car_ownr],              [orig_cost],              [reblt_dt],              [scnd_hand_dt],              [scnd_lese],              [seller_orig_cost],              [setl_val],              [split_or_cmbnd_invl_ind],              [wghg_pty],              [milg_sinc_lst_cls_a_rpr_dt],              [milg_sinc_lst_cls_b_rpr_dt],              [milg_sinc_lst_cls_i_rpr_dt],              [lst_cls_a_rpr_dt],              [lst_cls_b_rpr_dt],              [lst_cls_i_rpr_dt],              [num_dy_car_can],              [num_dy_car_mex],              [can_mex_dy_lst_updt_dt],              [blng_extd_srvc_ind],              [rub_rail_upd],              [cert_dt],              [cert_cd],              [car_grd],              [car_grd_dt],              [osid_usa_ind],              [insd_len],              [osid_len],              car.car_char_eff_from,              car.car_char_eff_to              --    ,ISNULL(ISNULL(car.[Pltfm_Fctr], 2*Ut_Cnt),1.0) as [Pltfm_Fctr]              ,              Isnull(car.[pltfm_fctr], 1.0) AS [Pltfm_Fctr],              car.[trk_axl_cnt],              car.[axl_cnt],              Isnull(car.[tpe_fctr], 1)     AS [TPE_Fctr],              car.[ut_cnt],              [eq_typ_cd],              [intmdit_connt_styl],              [s_str_bldr_cd],              [s_str_modl],              [s_str_blt_dt],              [rt_ind],              [s_str_addn_betr_val],              [orig_rk_cost],              [act_rk_dim_ind],              [s_str_deck_bc_setg],              [s_str_deck_ab_setg],              [s_str_chock_typ],              [s_str_end_door_m941_90_qlfy],              [s_str_dooredg_prot_cd],              [enclsd_s_str_top_deck_setg],              [s_str_lese],              [auto_rk_ctgy],              [s_str_ownr],              [s_str_crnt_cost],              [s_str_enclsr_cd],              [s_str_end_door_dsgn],              [s_str_deck_lvl_cd],              [s_str_tare_wgt],              [is_s_str_intg_wth_car],              [car_char_dimn_id],              [car_char_ver],              [elem_desc],              [elem_id],              [elem_lbl],              [elem_shrt_desc],              car.[ttx_blt_dt],              hier1.ttx_eq_cd,              hier1.[eq_char],              hier1.ttx_eq_cd_desc              ---- container car logic              ,              CASE                WHEN ( CASE                         WHEN hier3.stat_cd IN ( 998, 999 ) THEN                         hier3.[bus_ln_shrt_desc]                         ELSE Isnull(hier3.[bus_ln_shrt_desc],                              Hier2.business_line_description)                       END ) = 'Intermodal'                     AND [ttx_mngd_car_ind] = 0 THEN                  CASE                    WHEN Substring([eq_typ_cd], 1, 1) IN ( 'P', 'Q' ) THEN                    'Conventional'                    WHEN Substring([eq_typ_cd], 1, 2) IN                         ( 'S1', 'S2', 'S3', 'S4', 'S5' ) THEN                    'DTTX 40-48ft'                    WHEN Substring([eq_typ_cd], 1, 2) IN ( 'S6', 'S7' ) THEN                    'DTTX 53-56ft'                    ELSE hier2.[fleet_segment_description]                  END                WHEN ( CASE                         WHEN hier3.stat_cd IN ( 998, 999 ) THEN                         hier3.[bus_ln_shrt_desc]                         ELSE Isnull(hier3.[bus_ln_shrt_desc],                              Hier2.business_line_description)                       END ) = 'Intermodal'                     AND ( COALESCE(car.[car_status_maximo], car.[car_status_ufd]) =                           'PRE-REGISTERED'                            OR COALESCE(car.[car_status_maximo],                               car.[car_status_ufd])                               IS NULL                         ) THEN NULL                ELSE hier2.[fleet_segment_description]              END                           AS [Fleet_Segment_Description],              Isnull(CASE                       WHEN ( CASE                                WHEN hier3.stat_cd IN ( 998, 999 ) THEN                                hier3.[bus_ln_shrt_desc]                                ELSE Isnull(hier3.[bus_ln_shrt_desc],                                     Hier2.business_line_description)                              END ) = 'Intermodal'                            AND [ttx_mngd_car_ind] = 0 THEN                         CASE                           WHEN Substring([eq_typ_cd], 1, 1) IN ( 'P', 'Q' ) THEN                           'Conventional'                           WHEN Substring([eq_typ_cd], 1, 2) IN (                                'S1', 'S2', 'S3', 'S4',                                'S5', 'S6', 'S7' ) THEN                           'Doublestack'                         END                       ELSE ( CASE                                WHEN hier3.stat_cd IN ( 998, 999 ) THEN                                hier3.[eq_typ_shrt_desc]                                ELSE Isnull(hier3.[eq_typ_shrt_desc],                                     hier2.equipment_type_description)                              END )                     END, 'Unknown')        AS Equipment_Type_Description,              hier3.[stat_cd]               AS Stat_Code,              Isnull(CASE                       WHEN ( CASE                                WHEN hier3.stat_cd IN ( 998, 999 ) THEN                                hier3.[bus_ln_shrt_desc]                                ELSE Isnull(hier3.[bus_ln_shrt_desc],                                     Hier2.business_line_description)                              END ) = 'Intermodal'                            AND [ttx_mngd_car_ind] = 0 THEN                         CASE                           WHEN Substring([eq_typ_cd], 1, 2) IN                                ( 'S1', 'S2', 'S3', 'S4', 'S5' ) THEN                           '40 ft Wells'                           WHEN Substring([eq_typ_cd], 1, 2) IN ( 'S6', 'S7' ) THEN                           '53 ft Wells'                           ELSE hier3.[eq_featr_shrt_desc]                         END                       ELSE hier3.[eq_featr_shrt_desc]                     END, 'Unknown')        AS [Equipment_Feature],              hier3.[car_hrly_rt]           AS Car_Hourly_Rate,              hier3.[est_car_hrly_rate]     AS Estimated_Car_Hourly_Rate,              hier3.[daily_miles]           AS Daily_Miles,              hier3.[milg_rt]               AS Milg_Rate,              hier3.[fleet_type],              hier3.[rack_type],              Isnull(CASE                       WHEN ( CASE                                WHEN hier3.stat_cd IN ( 998, 999 ) THEN                                hier3.[bus_ln_shrt_desc]                                ELSE Isnull(hier3.[bus_ln_shrt_desc],                                     Hier2.business_line_description)                              END ) = 'Intermodal'                            AND [ttx_mngd_car_ind] = 0 THEN                         CASE                           WHEN Substring([eq_typ_cd], 1, 1) IN ( 'P', 'Q' ) THEN                           'Conventional'                           WHEN Substring([eq_typ_cd], 1, 2) IN (                                'S1', 'S2', 'S3', 'S4',                                'S5', 'S6', 'S7' ) THEN                           'Doublestack'                         END                       ELSE ( CASE                                WHEN hier3.stat_cd IN ( 998, 999 ) THEN                                hier3.[eq_typ_shrt_desc]                                ELSE Isnull(hier3.[eq_typ_shrt_desc],                                     hier2.equipment_type_description)                              END )                     END, 'Unknown')        AS Equipment_Type,              Isnull(CASE                       WHEN hier3.stat_cd IN ( 998, 999 ) THEN                       hier3.[bus_ln_shrt_desc]                       ELSE Isnull(hier3.[bus_ln_shrt_desc],                            Hier2.business_line_description)                     END, 'Unknown')        AS Business_Line,         Car_Health_Rating,      [Lessor],      [Lease_number],      [Maintenance_Terms],      [Lease_Termination_Date],     hier4.bus_Ln_Shrt_Desc Eshift_Business_Line,       hier4.Eq_Featr_Shrt_Desc Eshift_Equipment_Feature,       hier4.Eq_Typ_Shrt_Desc Eshift_Equipment_Type,       hier4.Stat_Cd Eshift_Stat_Code,       hier4.Total_Line_Of_Business AS Eshift_Total_Line_Of_Business,     hier4.Oracle_Lob AS Eshift_Oracle_Lob    -- Car_Health_Score       FROM   (SELECT [car_nr],                      [car_init],                      [car_status_ufd],                      [ttx_eff_dt],                      [car_ownrshp_ind],                      [pool_cd],                      [ttx_mngd_car_ind],                      car_eff_from,                      car_eff_to,                      [car_dimn_id],                      [car_ver],                      car_src_sys_nm,                      [ownr_mrk],                      [eq_hierchy_id],                      [eq_hierchy_ver],                      [fleet_hierchy_ver],                      [entr_hierchy_ver],                      [fleet_hierchy_id],                      [entr_hierchy_id],          Eshift_Hierchy_Id,         Eshift_Hierchy_Ver,                     [car_cls],                      [railcar],                      [car_lineage_grp_id],                      [assetnum],                      [fin_car_id],                      [car_status_maximo],                      [umler_blt_dt],                      [eq_bldr],                      [bldr_lot_cd],                      [blt_from_use_ast],                      [brk_cd],                      [car_cost_est_act],                      [lese_cd],                      [ldgr_val],                      [lst_shp_dt],                      [milg_upd_dt],                      [orig_car_ownr],                      [orig_cost],                      [reblt_dt],                      [scnd_hand_dt],                      [scnd_lese],                      [seller_orig_cost],                      [setl_val],                      [split_or_cmbnd_invl_ind],                      [wghg_pty],                      [milg_sinc_lst_cls_a_rpr_dt],                      [milg_sinc_lst_cls_b_rpr_dt],                      [milg_sinc_lst_cls_i_rpr_dt],                      [lst_cls_a_rpr_dt],                      [lst_cls_b_rpr_dt],                      [lst_cls_i_rpr_dt],                      [num_dy_car_can],                      [num_dy_car_mex],                      [can_mex_dy_lst_updt_dt],                      [blng_extd_srvc_ind],                      [rub_rail_upd],                      [cert_dt],                      [cert_cd],                      [car_grd],                      [car_grd_dt],                      [osid_usa_ind],                      [insd_len],                      [osid_len],                      car_char_eff_from,                      car_char_eff_to,                      [pltfm_fctr],                      [trk_axl_cnt],                      [axl_cnt],                      [tpe_fctr],                      [ut_cnt],                      [eq_typ_cd],                      [intmdit_connt_styl],                      [s_str_bldr_cd],                      [s_str_modl],                      [s_str_blt_dt],                      [rt_ind],                      [s_str_addn_betr_val],                      [orig_rk_cost],                      [act_rk_dim_ind],                      [s_str_deck_bc_setg],                      [s_str_deck_ab_setg],                      [s_str_chock_typ],                      [s_str_end_door_m941_90_qlfy],                      [s_str_dooredg_prot_cd],                      [enclsd_s_str_top_deck_setg],                      [s_str_lese],                      [auto_rk_ctgy],                      [s_str_ownr],                      [s_str_crnt_cost],                      [s_str_enclsr_cd],                      [s_str_end_door_dsgn],                      [s_str_deck_lvl_cd],                      [s_str_tare_wgt],                      [is_s_str_intg_wth_car],                      [car_char_dimn_id],                      [car_char_ver],                      [elem_desc],                      [elem_id],                      [elem_lbl],                      [elem_shrt_desc],                      [ttx_blt_dt],      [Lessor],      [Lease_number],      [Maintenance_Terms],      [Lease_Termination_Date],       Car_Health_Rating         --Car_Health_Score              FROM   (SELECT car1.[car_nr],                              car1.[car_init],                              car1.[car_status_ufd],                              car1.[ttx_eff_dt],                              car1.[car_ownrshp_ind],                              car1.[pool_cd],                              car1.[ttx_mngd_car_ind],                              car1.[eff_from]   AS Car_Eff_From,                              car1.[eff_to]     AS Car_Eff_To,                              car1.[car_dimn_id],                              car1.[car_ver],                              car1.[src_sys_nm] AS Car_Src_Sys_Nm,                              car1.[ownr_mrk],                              car1.[eq_hierchy_id],                              car1.[eq_hierchy_ver],                              car1.[fleet_hierchy_ver],                              car1.[entr_hierchy_ver],                              car1.[fleet_hierchy_id],                              car1.[entr_hierchy_id],            car1.Eshift_Hierchy_Id,           car1.Eshift_Hierchy_Ver,                             car1.[car_cls],                              car1.[railcar],                              car1.[car_lineage_grp_id],                              car1.[assetnum],                              car1.[fin_car_id],                              car1.[car_status_maximo],                              cchar.[umler_blt_dt],                              cchar.[eq_bldr],                              cchar.[bldr_lot_cd],                              cchar.[blt_from_use_ast],                              cchar.[brk_cd],                              cchar.[car_cost_est_act],                              cchar.[lese_cd],                              cchar.[ldgr_val],                              cchar.[lst_shp_dt],                              cchar.[milg_upd_dt],                              cchar.[orig_car_ownr],                              cchar.[orig_cost],                              cchar.[reblt_dt],                              cchar.[scnd_hand_dt],                              cchar.[scnd_lese],                              cchar.[seller_orig_cost],                              cchar.[setl_val],                              cchar.[split_or_cmbnd_invl_ind],                              cchar.[wghg_pty],                              cchar.[milg_sinc_lst_cls_a_rpr_dt],                              cchar.[milg_sinc_lst_cls_b_rpr_dt],                              cchar.[milg_sinc_lst_cls_i_rpr_dt],                              cchar.[lst_cls_a_rpr_dt],                              cchar.[lst_cls_b_rpr_dt],                              cchar.[lst_cls_i_rpr_dt],                              cchar.[num_dy_car_can],                              cchar.[num_dy_car_mex],                              cchar.[can_mex_dy_lst_updt_dt],                              cchar.[blng_extd_srvc_ind],                              cchar.[rub_rail_upd],                              cchar.[cert_dt],                              cchar.[cert_cd],                              cchar.[car_grd],                              cchar.[car_grd_dt],                              cchar.[osid_usa_ind],                              cchar.[insd_len],                              cchar.[osid_len],                             cchar.[eff_from]  AS Car_Char_Eff_From,                              cchar.[eff_to]    AS Car_Char_Eff_To,                              cchar.[pltfm_fctr],                              cchar.[trk_axl_cnt],                              cchar.[axl_cnt],                              cchar.[tpe_fctr],                              cchar.[ut_cnt],                              cchar.[eq_typ_cd],                              cchar.[intmdit_connt_styl],                              cchar.[s_str_bldr_cd],                              cchar.[s_str_modl],                              cchar.[s_str_blt_dt],                              cchar.[rt_ind],                              cchar.[s_str_addn_betr_val],                              cchar.[orig_rk_cost],                              cchar.[act_rk_dim_ind],                              cchar.[s_str_deck_bc_setg],                              cchar.[s_str_deck_ab_setg],                              cchar.[s_str_chock_typ],                              cchar.[s_str_end_door_m941_90_qlfy],                              cchar.[s_str_dooredg_prot_cd],                              cchar.[enclsd_s_str_top_deck_setg],                              cchar.[s_str_lese],                              cchar.[auto_rk_ctgy],                              cchar.[s_str_ownr],                              cchar.[s_str_crnt_cost],                              cchar.[s_str_enclsr_cd],                              cchar.[s_str_end_door_dsgn],                              cchar.[s_str_deck_lvl_cd],                              cchar.[s_str_tare_wgt],                              cchar.[is_s_str_intg_wth_car],                              cchar.[car_char_dimn_id],                              cchar.[car_char_ver],                              cchar.[elem_desc],                              cchar.[elem_id],                              cchar.[elem_lbl],                              cchar.[elem_shrt_desc],                             cchar.[ttx_blt_dt],           cchar.[Lessor],         cchar.[Lease_number],         cchar.[Maintenance_Terms],         cchar.[Lease_Termination_Date],         car1.Car_Health_Rating                             --car1.Car_health_score                      FROM   dbo.Car_Dim_Correct (nolock) car1                              LEFT JOIN (SELECT car_dimn_id,                                                car_ver,                                                [umler_blt_dt],                                                [eq_bldr],                                                [bldr_lot_cd],                                                [blt_from_use_ast],                                                [brk_cd],                                                [car_cost_est_act],                                                [lese_cd],                                                [ldgr_val],                                                [lst_shp_dt],                                                [milg_upd_dt],                                                [orig_car_ownr],                                                [orig_cost],                                                [reblt_dt],                                                [scnd_hand_dt],                                                [scnd_lese],                                                [seller_orig_cost],                                                [setl_val],                                                [split_or_cmbnd_invl_ind],                                                [wghg_pty],                                                [milg_sinc_lst_cls_a_rpr_dt],                                                [milg_sinc_lst_cls_b_rpr_dt],                                                [milg_sinc_lst_cls_i_rpr_dt],                                                [lst_cls_a_rpr_dt],                                                [lst_cls_b_rpr_dt],                                                [lst_cls_i_rpr_dt],                                                [num_dy_car_can],                                                [num_dy_car_mex],                                                [can_mex_dy_lst_updt_dt],                  [blng_extd_srvc_ind],                                                [rub_rail_upd],                                                [cert_dt],                                                [cert_cd],                                                [car_grd],                                                [car_grd_dt],                                                [osid_usa_ind],                                                [insd_len],                                                [osid_len],                                                [eff_from],                                                [eff_to],                                                [pltfm_fctr],                                                [trk_axl_cnt],                                                [axl_cnt],                                                [tpe_fctr],                                                [ut_cnt],                                                [eq_typ_cd],                                                [intmdit_connt_styl],                                                [s_str_bldr_cd],                                                [s_str_modl],                                                [s_str_blt_dt],                                                [rt_ind],                                                [s_str_addn_betr_val],                                                [orig_rk_cost],                                                [act_rk_dim_ind],                                                [s_str_deck_bc_setg],                                                [s_str_deck_ab_setg],                                                [s_str_chock_typ],                                                [s_str_end_door_m941_90_qlfy],                                                [s_str_dooredg_prot_cd],                                                [enclsd_s_str_top_deck_setg],                                                [s_str_lese],                                                [auto_rk_ctgy],                                                [s_str_ownr],                                                [s_str_crnt_cost],                                                [s_str_enclsr_cd],                                                [s_str_end_door_dsgn],                                                [s_str_deck_lvl_cd],                                                [s_str_tare_wgt],                                                [is_s_str_intg_wth_car],                                                [car_char_dimn_id],                                                [car_char_ver],                                                [elem_desc],                                                [elem_id],                                                [elem_lbl],                                                [elem_shrt_desc],                                                [ttx_blt_dt] ,               [Lessor],               [Lease_Number],               [Maintenance_Terms],               [Lease_Termination_Date]                                      FROM   dbo.car_characteristic_dim (nolock)                                         WHERE  eff_to IS NULL) cchar                                     ON ( car1.car_dimn_id = cchar.car_dimn_id )) ta)              car              LEFT JOIN [dbo].[vmrt_car_hierarchy_equipment] hier1  WITH(NOLOCK)                     ON ( car.eq_hierchy_id = hier1.hierchy_id                          AND car.eq_hierchy_ver = hier1.hierchy_ver )              LEFT JOIN [dbo].[vmrt_car_hierarchy_fleet] hier2  WITH(NOLOCK)                     ON ( car.fleet_hierchy_id = hier2.hierchy_id                          AND car.fleet_hierchy_ver = hier2.hierchy_ver )              LEFT JOIN [dbo].[vmrt_car_hierarchy_enterprise] hier3  WITH(NOLOCK)                    ON ( car.entr_hierchy_id = hier3.hierchy_id                          AND car.entr_hierchy_ver = hier3.hierchy_ver )      LEFT JOIN [dbo].[VMRT_Car_Hierarchy_Eshift] hier4 WITH(NOLOCK)                      ON ( car.Eshift_Hierchy_Id = hier4.hierchy_id                          AND car.Eshift_Hierchy_Ver = hier4.hierchy_ver )"
    },
    {
      "id": "Vfin_Supplement_Car_Hire_Penalty_Fact",
      "name": "Vfin_Supplement_Car_Hire_Penalty_Fact",
      "type": "VIEW",
      "sql": "CREATE VIEW [DDSV].[Vfin_Supplement_Car_Hire_Penalty_Fact]  AS  WITH CTE1 AS  (  SELECT DISTINCT  fact.carDimnId ,fact.carVer,  liableRoadOrgDimnId,liableRoadOrgVer,carHireRate,  CAST(CEILING(CAST(startDate as float)*(24))/(24) as SMALLDATETIME) as startDate,  ISNULL(CAST(CEILING(CAST(endDate as float)*(24))/(24) as SMALLDATETIME),GETDATE()) AS endDate  FROM DDSMRT.DBO.supplementCarHirePenaltyFact fact (nolock)   INNER JOIN DDSMRT.DBO.VMRT_Organization_Dimension org with(nolock)   on fact.liableRoadOrgDimnId = org.Org_Dimn_Id and fact.liableRoadOrgVer = org.Org_Ver    and org.eff_to is null  INNER JOIN  (    SELECT carDimnId, max(carVer) as carVer    FROM DDSMRT.DBO.supplementCarHirePenaltyFact fact (nolock)    WHERE deletedFlag=0    GROUP BY carDimnId  )fact2     on fact.carDimnId = fact2.carDimnId and fact.carVer =fact2.carVer  WHERE fact.deletedFlag=0 and  DATEDIFF_BIG(SECOND, startDate, ISNULL(endDate, GETDATE())) >= 3599  AND org.Org_Abrv IN ('BNSF','CN','CPRS','CSXT','FXE','KCS','KCSM','NS','PAS','ST','UP')      ),  Numbers AS (    SELECT TOP(1000) ROW_NUMBER() OVER (ORDER BY (SELECT NULL)) AS Num    FROM sys.all_columns  ),  CTE AS (    SELECT      s.carDimnId,      s.carVer,      s.liableRoadOrgDimnId,      s.liableRoadOrgVer,      s.carHireRate,      s.StartDate,      s.EndDate,       cast(DATEADD(DAY, Num - 1, s.StartDate) as date) AS reportDate    FROM      CTE1 AS s      INNER JOIN Numbers AS n ON Num <= DATEDIFF(DAY, s.StartDate, s.EndDate) + 1  ),  CTE2 AS (  SELECT    stat_Dt_1.Dt_Dimn_Id as reportDtDimnId,reportDate,carDimnId ,carVer,  liableRoadOrgDimnId,liableRoadOrgVer,carHireRate,   CASE WHEN cast(startDate as date) =cast(endDate as date) then datediff(MINUTE,startDate,endDate)/60.0    WHEN reportDate =cast(endDate as date) then datediff(MINUTE,reportDate,endDate)/60.0     WHEN reportDate =cast(startDate as date) then datediff(MINUTE,startDate,DATEADD(day,1,reportDate))/60.0    else 24   end as hrs  FROM cte   INNER JOIN   (   SELECT    Dt_Dimn_Id   ,Dt  FROM    DDSMRT.dbo.Date_Dim WITH ( NOLOCK )  WHERE   Dt IS NOT NULL  ) stat_Dt_1   ON reportDate = stat_Dt_1.Dt  where reportDate<=endDate AND reportDate>=CAST(startDate AS DATE) and startDate<>endDate  )    SELECT reportDtDimnId,reportDate,carDimnId,carVer,liableRoadOrgDimnId,liableRoadOrgVer,carHireRate,hrs   FROM CTE2 WHERE HRS>0"
    },
    {
      "id": "Vfin_Supplement_Loaded_Penalty_Fact",
      "name": "Vfin_Supplement_Loaded_Penalty_Fact",
      "type": "VIEW",
      "sql": "---------------  CREATE VIEW [DDSV].[Vfin_Supplement_Loaded_Penalty_Fact]    AS    SELECT DISTINCT     loadedPenaltyDtDimnID    ,fact.carDimnId    ,fact.carVer    ,loadedRoadOrgDimnId    ,loadedRoadOrgVer    ,originatingCarrierDimnId    ,originatingCarrierVer    ,loadedTripStartDate    ,supplement246Penalty    ,supplement247Penalty  FROM  DDSMRT.DBO.supplementLoadedPenaltyFact fact WITH(NOLOCK)  INNER JOIN DDSMRT.DBO.VMRT_Organization_Dimension org with(nolock)        on fact.originatingCarrierDimnId = org.Org_Dimn_Id and fact.originatingCarrierVer = org.Org_Ver     and org.eff_to is null  INNER JOIN DDSMRT.DBO.VMRT_Organization_Dimension loadedOrg with(nolock)        on fact.originatingCarrierDimnId = loadedOrg.Org_Dimn_Id and fact.originatingCarrierVer = loadedOrg.Org_Ver     and loadedOrg.eff_to is null  INNER JOIN  (    SELECT carDimnId, max(carVer) as carVer    FROM DDSMRT.DBO.supplementLoadedPenaltyFact fact (nolock)    GROUP BY carDimnId  )fact2     on fact.carDimnId = fact2.carDimnId and fact.carVer =fact2.carVer  INNER JOIN   (   SELECT MAX(Car_Dimn_Id) Car_Dimn_Id    FROM DDSMRT.DBO.supplementLoadedPenaltyFact fact with(nolock)    INNER JOIN DDSMRT.DBO.Car_Dim_Correct cor with(nolock)      on fact.carDimnId = cor.Car_Dimn_Id   and fact.carVer = cor.Car_Ver    WHERE  Railcar is not null    GROUP BY RAILCAR,Car_Init  )reinit     on fact.carDimnId = reinit.Car_Dimn_Id  WHERE org.Org_Abrv IN ('BNSF','CN','CPRS','CSXT','FXE','KCS','KCSM','NS','PAS','ST','UP')"
    },
    {
      "id": "vw_Car_Health_Snapshot",
      "name": "vw_Car_Health_Snapshot",
      "type": "VIEW",
      "sql": "CREATE VIEW [dbo].[vw_Car_Health_Snapshot]  AS  SELECT b.DT AS Snapshot_Date,         a.car_init,         a.car_nr,         a.assetnum,         a.Car_List_Num,         a.Car_Health_Rating,         a.Car_Health_Score,         CCD.milg_sinc_lst_cls_i_rpr_dt AS ClassI_Miles,         b.Dt_Dimn_Id,         a.Car_Dimn_Id,         a.Car_Ver  FROM  (      SELECT CONCAT(ISNULL(cf.Car_Dimn_Id, -1), '|', ISNULL(cf.Car_Ver, -1)) Car_Id,             cf.Car_Health_Score,             cf.Eff_From_Dt_Dimn_Id AS Car_Health_From_dt_Dimn_Id,             ISNULL(                       LEAD(cf.Eff_From_Dt_Dimn_Id) OVER (PARTITION BY ISNULL(cf.Car_Dimn_Id, -1)                                                       ORDER BY cf.Car_Health_Dt,                                                                cf.Car_Ver ASC                                                      ),                       CAST(FORMAT(GETDATE() + 1, 'yyyyMMdd') AS BIGINT)                   ) Car_Health_To_dt_Dimn_Id,             cf1.Car_List_Dimn_Id,             cf.Car_Dimn_Id,             cf.Car_Ver,             CLD.Car_List_Num,             cc.Car_Health_Rating,             cc.car_init,             cc.car_nr,             cc.assetnum,             cc.milg_sinc_lst_cls_i_rpr_dt      FROM [DDSMRT].[dbo].Car_Health_Fact cf WITH(NOLOCK)          INNER JOIN [DDSMRT].[dbo].[VMRT_Car_Dimension_Correct] cc WITH(NOLOCK)              ON cf.Car_Dimn_Id = cc.car_dimn_id                 AND cc.car_ver = cf.Car_Ver          LEFT OUTER JOIN          (              SELECT cl_1.Car_Dimn_Id,                     cl_2.Car_List_Dimn_Id              FROM              (                  SELECT cl.[Car_Dimn_Id],                         MAX(cl.Dt_Add_Dimn_Id) AS Dt_Add_Dimn_Id                  FROM DDSMRT.dbo.Car_List_Fact cl WITH(NOLOCK)                  GROUP BY cl.[Car_Dimn_Id]              ) cl_1                  INNER JOIN DDSMRT.dbo.Car_List_Fact cl_2 WITH(NOLOCK)                      ON cl_1.Dt_Add_Dimn_Id = cl_2.Dt_Add_Dimn_Id                         AND cl_1.[Car_Dimn_Id] = cl_2.[Car_Dimn_Id]          ) cf1              ON cf1.Car_Dimn_Id = cf.Car_Dimn_Id          LEFT JOIN DDSMRT.dbo.Car_List_Dim CLD WITH(NOLOCK)              ON CLD.Car_List_Dimn_Id = cf1.Car_List_Dimn_Id  ) a      JOIN [SV].[Time] b WITH(NOLOCK)          ON b.Dt_Dimn_Id >= a.Car_Health_From_dt_Dimn_Id             AND b.Dt_Dimn_Id < a.Car_Health_To_dt_Dimn_Id      LEFT JOIN      (          SELECT Car_Dimn_Id,                 CASE                     WHEN Car_Char_Ver = 1 THEN                         '1900-01-01'                     ELSE                         CONVERT(DATE, Eff_From)                 END Eff_From,                 ISNULL(CONVERT(DATE, Eff_To), '9999-12-31') Eff_To,                 MAX(Milg_Sinc_Lst_Cls_I_Rpr_Dt) milg_sinc_lst_cls_i_rpr_dt          FROM DDSMRT.dbo.Car_Characteristic_Dim WITH(NOLOCK)          GROUP BY Car_Dimn_Id,                   CASE                       WHEN Car_Char_Ver = 1 THEN                           '1900-01-01'                       ELSE                           CONVERT(DATE, Eff_From)                   END,                   ISNULL(CONVERT(DATE, Eff_To), '9999-12-31')      ) CCD          ON CCD.Car_Dimn_Id = a.Car_Dimn_Id             AND CONVERT(VARCHAR(8), CCD.Eff_From, 112) <= b.Dt_Dimn_Id             AND CONVERT(VARCHAR(8), CCD.Eff_To, 112) > b.Dt_Dimn_Id   INNER JOIN      (       SELECT Car_Dimn_Id, CAR_INIT,CAR_NR, CAST(Min(isnull(Eff_From,'9999-12-31')) AS DATE) AS Eff_From,    CAST(MAX(isnull(Eff_To,'9999-12-31')) AS DATE) AS Eff_To     from ddsmrt.dbo.car_dim_correct WITH(NOLOCK)    GROUP BY Car_Dimn_Id, CAR_INIT,CAR_NR   )CH     ON a.car_nr=ch.Car_Nr and a.Car_Dimn_Id = ch.Car_Dimn_Id     and a.car_init = ch.Car_Init AND b.DT BETWEEN CH.Eff_From AND CH.Eff_To  WHERE 1 = 1        AND a.Car_Health_Rating != ''        AND a.Car_Health_Rating IS NOT NULL;"
    },
    {
      "id": "vw_Cycle_Fact",
      "name": "vw_Cycle_Fact",
      "type": "VIEW",
      "sql": "CREATE VIEW [dbo].[vw_Cycle_Fact]  AS    SELECT [Cycle_Fact_Id]        ,[Cycle_Shpr_Org_Dimn_Id]        ,[Cycle_Shpr_Org_Ver]        ,[Car_Dimn_Id]        ,[Car_Ver]        ,[Origin_Empt_Org_Dimn_Id]        ,[Origin_Empt_Org_Ver]        ,[Dest_Empt_Org_Dimn_Id]        ,[Dest_Empt_Org_Ver]        ,[Origin_Ld_Org_Dimn_Id]        ,[Origin_Ld_Org_Ver]        ,[Dest_Ld_Org_Dimn_Id]        ,[Dest_Ld_Org_Ver]        ,[Cycle_Begin_Dt_Dimn_Id]        ,[Cycle_End_Dt_Dimn_Id]        ,[Cycle]        ,[Railcar]        ,[Cycle_Typ]        ,[Cycle_Rules_Not_Satisfied]        ,[Has_Missing_Segs]        ,[Cycle_Shpr]        ,[Cycle_Begin_Dt]        ,[Cycle_End_Dt]        ,[Begin_Dt_Ld]        ,[Orig_Loc_Empt]        ,[Orig_Enty_Empt]        ,[Dest_Loc_Empt]        ,[Dest_Enty_Empt]        ,[Orig_Loc_Ld]        ,[Orig_Enty_Ld]        ,[Dest_Loc_Ld]        ,[Dest_Enty_Ld]        ,[Invalid_Rsn]        ,[Totl_Seg_Cnt]        ,[Cycle_Calc_Milg_Empt]        ,[Cycle_Calc_Milg_Ld]        ,[Cycle_Calc_Dura_Empt]        ,[Cycle_Calc_Dura_Ld]        ,[Crtd_Id]        ,[Crtd_Dt]        ,[Lst_Upd_Id]        ,[Lst_Upd_Dt]        ,[Src_Sys_Nm]        ,[Dq_Flg]        ,[Dlet_Flg]    FROM [dbo].[Cycle_Fact]"
    },
    {
      "id": "vw_Cycle_Fact_History",
      "name": "vw_Cycle_Fact_History",
      "type": "VIEW",
      "sql": "CREATE VIEW [dbo].[vw_Cycle_Fact_History]  AS  SELECT [Cycle_Fact_Id]        ,[Cycle_Shpr_Org_Dimn_Id]        ,[Cycle_Shpr_Org_Ver]        ,[Car_Dimn_Id]        ,[Car_Ver]        ,[Origin_Empt_Org_Dimn_Id]        ,[Origin_Empt_Org_Ver]        ,[Dest_Empt_Org_Dimn_Id]        ,[Dest_Empt_Org_Ver]        ,[Origin_Ld_Org_Dimn_Id]        ,[Origin_Ld_Org_Ver]        ,[Dest_Ld_Org_Dimn_Id]        ,[Dest_Ld_Org_Ver]        ,[Cycle_Begin_Dt_Dimn_Id]        ,[Cycle_End_Dt_Dimn_Id]        ,[Cycle]        ,[Railcar]        ,[Cycle_Typ]        ,[Cycle_Rules_Not_Satisfied]        ,[Has_Missing_Segs]        ,[Cycle_Shpr]        ,[Cycle_Begin_Dt]        ,[Cycle_End_Dt]        ,[Begin_Dt_Ld]        ,[Orig_Loc_Empt]        ,[Orig_Enty_Empt]        ,[Dest_Loc_Empt]        ,[Dest_Enty_Empt]        ,[Orig_Loc_Ld]        ,[Orig_Enty_Ld]        ,[Dest_Loc_Ld]        ,[Dest_Enty_Ld]        ,[Invalid_Rsn]        ,[Totl_Seg_Cnt]        ,[Cycle_Calc_Milg_Empt]        ,[Cycle_Calc_Milg_Ld]        ,[Cycle_Calc_Dura_Empt]        ,[Cycle_Calc_Dura_Ld]        ,[Crtd_Id]        ,[Crtd_Dt]        ,[Lst_Upd_Id]        ,[Lst_Upd_Dt]        ,[Src_Sys_Nm]        ,[Dq_Flg]        ,[Dlet_Flg]    FROM [dbo].[Cycle_Fact_History]"
    },
    {
      "id": "sysextendedarticlesview",
      "name": "sysextendedarticlesview",
      "type": "VIEW",
      "sql": "create view dbo.sysextendedarticlesview                     as                      select artid, creation_script, del_cmd, description,                                  dest_table, filter, filter_clause, ins_cmd, name, objid, pubid,                                  pre_creation_cmd, status, sync_objid, type, upd_cmd,                                  schema_option, dest_owner, ins_scripting_proc, del_scripting_proc,                                  upd_scripting_proc, custom_script, fire_triggers_on_snapshot                               from sysarticles                        union all                        select artid, creation_script, NULL, description,                              dest_object, NULL, NULL, NULL, name, objid, pubid,                               pre_creation_cmd, status, NULL, type, NULL,                               schema_option, dest_owner, NULL, NULL, NULL, NULL, 0                          from sysschemaarticles"
    },
    {
      "id": "VFIN_PERF_PLN_FCST",
      "name": "VFIN_PERF_PLN_FCST",
      "type": "VIEW",
      "sql": "CREATE VIEW [dbo].[VFIN_PERF_PLN_FCST]  AS  SELECT        Tast_Stat_Cd_Dimn.Stat_Cd,  Tast_Stat_Cd_Dimn.Stat_Cd_Dimn_Id,Tfin_Flet_Perf_Fcst_Pln_Fact.Dt_Dimn_Id,                           Tfin_Flet_Perf_Fcst_Pln_Fact.Fcst_Bad_Ordr_Cnt, Tfin_Flet_Perf_Fcst_Pln_Fact.Fcst_Bad_Ordr_Shop_Cnt, Tfin_Flet_Perf_Fcst_Pln_Fact.Fcst_Car_Cnt,                            Tfin_Flet_Perf_Fcst_Pln_Fact.Fcst_Car_Hire_Rev, Tfin_Flet_Perf_Fcst_Pln_Fact.Fcst_Enrt_To_Shop_Cnt, Tfin_Flet_Perf_Fcst_Pln_Fact.Fcst_Inct_Pct,                            Tfin_Flet_Perf_Fcst_Pln_Fact.Fcst_Milg_Per_Day, Tfin_Flet_Perf_Fcst_Pln_Fact.Fcst_Milg_Rev, Tfin_Flet_Perf_Fcst_Pln_Fact.Fcst_Milg_Rt,                            Tfin_Flet_Perf_Fcst_Pln_Fact.Fcst_Milg_Schg, Tfin_Flet_Perf_Fcst_Pln_Fact.Fcst_On_Hand_Cnt, Tfin_Flet_Perf_Fcst_Pln_Fact.Fcst_Selct_Stor_Cnt,                            Tfin_Flet_Perf_Fcst_Pln_Fact.Fcst_Srvc_Stor_Cnt, Tfin_Flet_Perf_Fcst_Pln_Fact.Fcst_Totl_Rev, Tfin_Flet_Perf_Fcst_Pln_Fact.Pln_Bad_Ordr_Cnt,                            Tfin_Flet_Perf_Fcst_Pln_Fact.Pln_Bad_Ordr_Shop_Cnt, Tfin_Flet_Perf_Fcst_Pln_Fact.Pln_Car_Cnt, Tfin_Flet_Perf_Fcst_Pln_Fact.Pln_Enrt_To_Shop_Cnt,                            Tfin_Flet_Perf_Fcst_Pln_Fact.Plan_Inct_Pct, Tfin_Flet_Perf_Fcst_Pln_Fact.Pln_On_Hand_Cnt, Tfin_Flet_Perf_Fcst_Pln_Fact.Pln_Selct_Stor_Cnt,                            Tfin_Flet_Perf_Fcst_Pln_Fact.Pln_Srvc_Stor_Cnt, Tfin_Flet_Perf_Fcst_Pln_Fact.Pln_Car_Hire_Rev, Tfin_Flet_Perf_Fcst_Pln_Fact.Pln_Milg_Per_Day,                            Tfin_Flet_Perf_Fcst_Pln_Fact.Pln_Milg_Rev, Tfin_Flet_Perf_Fcst_Pln_Fact.Pln_Milg_Rt, Tfin_Flet_Perf_Fcst_Pln_Fact.Pln_Milg_Schg,                            Tfin_Flet_Perf_Fcst_Pln_Fact.Pln_Totl_Rev     FROM                                            Tfin_Flet_Perf_Fcst_Pln_Fact         INNER JOIN                           Tast_Stat_Cd_Dimn          ON Tfin_Flet_Perf_Fcst_Pln_Fact.Stat_Cd_Dimn_Id = Tast_Stat_Cd_Dimn.Stat_Cd_Dimn_Id         AND Tfin_Flet_Perf_Fcst_Pln_Fact.Dt_Dimn_Id >= CONVERT(CHAR(8),[Stat_Cd_Eff_Strt_Dt],112)         AND Tfin_Flet_Perf_Fcst_Pln_Fact.Dt_Dimn_Id < isnull(CONVERT(CHAR(8),[Stat_Cd_Eff_End_Dt],112),'99991231')"
    },
    {
      "id": "vw_Cycle_Fact_All",
      "name": "vw_Cycle_Fact_All",
      "type": "VIEW",
      "sql": "CREATE VIEW [dbo].[vw_Cycle_Fact_All]  AS    SELECT [Cycle_Fact_Id]        ,[Cycle_Shpr_Org_Dimn_Id]        ,[Cycle_Shpr_Org_Ver]        ,[Car_Dimn_Id]        ,[Car_Ver]        ,[Origin_Empt_Org_Dimn_Id]        ,[Origin_Empt_Org_Ver]        ,[Dest_Empt_Org_Dimn_Id]        ,[Dest_Empt_Org_Ver]        ,[Origin_Ld_Org_Dimn_Id]        ,[Origin_Ld_Org_Ver]        ,[Dest_Ld_Org_Dimn_Id]        ,[Dest_Ld_Org_Ver]        ,[Cycle_Begin_Dt_Dimn_Id]        ,[Cycle_End_Dt_Dimn_Id]        ,[Cycle]        ,[Railcar]        ,[Cycle_Typ]        ,[Cycle_Rules_Not_Satisfied]        ,[Has_Missing_Segs]        ,[Cycle_Shpr]        ,[Cycle_Begin_Dt]        ,[Cycle_End_Dt]        ,[Begin_Dt_Ld]        ,[Orig_Loc_Empt]        ,[Orig_Enty_Empt]        ,[Dest_Loc_Empt]        ,[Dest_Enty_Empt]        ,[Orig_Loc_Ld]        ,[Orig_Enty_Ld]        ,[Dest_Loc_Ld]        ,[Dest_Enty_Ld]        ,[Invalid_Rsn]        ,[Totl_Seg_Cnt]        ,[Cycle_Calc_Milg_Empt]        ,[Cycle_Calc_Milg_Ld]        ,[Cycle_Calc_Dura_Empt]        ,[Cycle_Calc_Dura_Ld]        ,[Crtd_Id]        ,[Crtd_Dt]        ,[Lst_Upd_Id]        ,[Lst_Upd_Dt]        ,[Src_Sys_Nm]        ,[Dq_Flg]        ,[Dlet_Flg]    FROM [dbo].[Cycle_Fact]      UNION ALL      SELECT [Cycle_Fact_Id]        ,[Cycle_Shpr_Org_Dimn_Id]        ,[Cycle_Shpr_Org_Ver]        ,[Car_Dimn_Id]        ,[Car_Ver]        ,[Origin_Empt_Org_Dimn_Id]        ,[Origin_Empt_Org_Ver]        ,[Dest_Empt_Org_Dimn_Id]        ,[Dest_Empt_Org_Ver]        ,[Origin_Ld_Org_Dimn_Id]        ,[Origin_Ld_Org_Ver]        ,[Dest_Ld_Org_Dimn_Id]        ,[Dest_Ld_Org_Ver]        ,[Cycle_Begin_Dt_Dimn_Id]        ,[Cycle_End_Dt_Dimn_Id]        ,[Cycle]        ,[Railcar]        ,[Cycle_Typ]        ,[Cycle_Rules_Not_Satisfied]        ,[Has_Missing_Segs]        ,[Cycle_Shpr]        ,[Cycle_Begin_Dt]        ,[Cycle_End_Dt]        ,[Begin_Dt_Ld]        ,[Orig_Loc_Empt]        ,[Orig_Enty_Empt]        ,[Dest_Loc_Empt]        ,[Dest_Enty_Empt]        ,[Orig_Loc_Ld]        ,[Orig_Enty_Ld]        ,[Dest_Loc_Ld]        ,[Dest_Enty_Ld]        ,[Invalid_Rsn]        ,[Totl_Seg_Cnt]        ,[Cycle_Calc_Milg_Empt]        ,[Cycle_Calc_Milg_Ld]        ,[Cycle_Calc_Dura_Empt]        ,[Cycle_Calc_Dura_Ld]        ,[Crtd_Id]        ,[Crtd_Dt]        ,[Lst_Upd_Id]        ,[Lst_Upd_Dt]        ,[Src_Sys_Nm]        ,[Dq_Flg]        ,[Dlet_Flg]    FROM [dbo].[Cycle_Fact_History]"
    },
    {
      "id": "VAST_STAT_LOOKUP_FOR_SSIS",
      "name": "VAST_STAT_LOOKUP_FOR_SSIS",
      "type": "VIEW",
      "sql": "create view [dbo].[VAST_STAT_LOOKUP_FOR_SSIS]  AS  SELECT [Stat_Cd_Dimn_Id]        ,[Stat_Cd]        ,[Stat_Cd_Eff_Strt_Dt]        ,[Stat_Cd_Eff_End_Dt]         FROM [DDSMRT].[dbo].[Tast_Stat_Cd_Dimn]"
    },
    {
      "id": "Ramp_Services_Cost",
      "name": "Ramp_Services_Cost",
      "type": "VIEW",
      "sql": "CREATE VIEW sv.Ramp_Services_Cost    AS    select      dt_dimn_id    ,ISNULL((CAST([Car_Dimn_Id] AS VARCHAR) + '|' + CAST([Car_Ver] AS VARCHAR)),'-1|-1')  car_id    ,ISNULL((CAST([Repr_Enty_Dimn_Id] AS VARCHAR) + '|' + CAST([Repr_Enty_Ver] AS VARCHAR)),'-1|-1') AS [Repr_Enty_Id]    ,Actl_Inspctn_Car_Cnt    ,Actl_Inspctn_Ut_Cnt    ,Ramp_Services_cost   ,ISNULL(TotalInspectionStandard,-1) [Total Inspection Standard]  FROM ramp_services_cost_fact"
    },
    {
      "id": "vw_Cycle_Seg_Fact",
      "name": "vw_Cycle_Seg_Fact",
      "type": "VIEW",
      "sql": "CREATE VIEW [dbo].[vw_Cycle_Seg_Fact]  AS  SELECT [Cycle_Seg_Fact_Id]        ,[Cycle_Fact_Id]        ,[Car_Dimn_Id]        ,[Car_Ver]        ,[Cycle_Seg_Orig_Org_Dimn_Id]        ,[Cycle_Seg_Orig_Org_Ver]        ,[Cycle_Seg_Dest_Org_Dimn_Id]        ,[Cycle_Seg_Dest_Org_Ver]        ,[Cycle_Segment]        ,[Cycle]        ,[Cycle_Seg_Order]        ,[Cycle_Seg_Typ]        ,[Empt_Ld_Ind]        ,[Cycle_Seg_Begin_Dt]        ,[Cycle_Seg_Begin_Dt_Dimn_Id]        ,[Cycle_Seg_End_Dt]        ,[Cycle_Seg_End_Dt_Dimn_Id]        ,[Cycle_Seg_Calc_Milg]        ,[Cycle_Seg_Calc_Dura]        ,[Orig_Loc]        ,[Orig_Enty]        ,[Dest_Loc]        ,[Dest_Enty]        ,[Cycle_Seg_Scnd_Status]        ,[Crtd_Id]        ,[Crtd_Dt]        ,[Lst_Upd_Id]        ,[Lst_Upd_Dt]        ,[Src_Sys_Nm]        ,[Dq_Flg]    FROM [dbo].[Cycle_Seg_Fact]"
    },
    {
      "id": "vw_Cycle_Seg_Fact_History",
      "name": "vw_Cycle_Seg_Fact_History",
      "type": "VIEW",
      "sql": "CREATE VIEW [dbo].[vw_Cycle_Seg_Fact_History]  AS  SELECT [Cycle_Seg_Fact_Id]        ,[Cycle_Fact_Id]        ,[Car_Dimn_Id]        ,[Car_Ver]        ,[Cycle_Seg_Orig_Org_Dimn_Id]        ,[Cycle_Seg_Orig_Org_Ver]        ,[Cycle_Seg_Dest_Org_Dimn_Id]        ,[Cycle_Seg_Dest_Org_Ver]        ,[Cycle_Segment]        ,[Cycle]        ,[Cycle_Seg_Order]        ,[Cycle_Seg_Typ]        ,[Empt_Ld_Ind]        ,[Cycle_Seg_Begin_Dt]        ,[Cycle_Seg_Begin_Dt_Dimn_Id]        ,[Cycle_Seg_End_Dt]        ,[Cycle_Seg_End_Dt_Dimn_Id]        ,[Cycle_Seg_Calc_Milg]        ,[Cycle_Seg_Calc_Dura]        ,[Orig_Loc]        ,[Orig_Enty]        ,[Dest_Loc]        ,[Dest_Enty]        ,[Cycle_Seg_Scnd_Status]        ,[Crtd_Id]        ,[Crtd_Dt]        ,[Lst_Upd_Id]        ,[Lst_Upd_Dt]        ,[Src_Sys_Nm]        ,[Dq_Flg]    FROM [dbo].[Cycle_Seg_Fact_History]"
    },
    {
      "id": "vw_Cycle_Seg_Fact_All",
      "name": "vw_Cycle_Seg_Fact_All",
      "type": "VIEW",
      "sql": "CREATE VIEW [dbo].[vw_Cycle_Seg_Fact_All]  AS  SELECT [Cycle_Seg_Fact_Id]        ,[Cycle_Fact_Id]        ,[Car_Dimn_Id]        ,[Car_Ver]        ,[Cycle_Seg_Orig_Org_Dimn_Id]        ,[Cycle_Seg_Orig_Org_Ver]        ,[Cycle_Seg_Dest_Org_Dimn_Id]        ,[Cycle_Seg_Dest_Org_Ver]        ,[Cycle_Segment]        ,[Cycle]        ,[Cycle_Seg_Order]        ,[Cycle_Seg_Typ]        ,[Empt_Ld_Ind]        ,[Cycle_Seg_Begin_Dt]        ,[Cycle_Seg_Begin_Dt_Dimn_Id]        ,[Cycle_Seg_End_Dt]        ,[Cycle_Seg_End_Dt_Dimn_Id]        ,[Cycle_Seg_Calc_Milg]        ,[Cycle_Seg_Calc_Dura]        ,[Orig_Loc]        ,[Orig_Enty]        ,[Dest_Loc]        ,[Dest_Enty]        ,[Cycle_Seg_Scnd_Status]        ,[Crtd_Id]        ,[Crtd_Dt]        ,[Lst_Upd_Id]        ,[Lst_Upd_Dt]        ,[Src_Sys_Nm]        ,[Dq_Flg]    FROM [dbo].[Cycle_Seg_Fact]      UNION ALL      SELECT [Cycle_Seg_Fact_Id]        ,[Cycle_Fact_Id]        ,[Car_Dimn_Id]        ,[Car_Ver]        ,[Cycle_Seg_Orig_Org_Dimn_Id]        ,[Cycle_Seg_Orig_Org_Ver]        ,[Cycle_Seg_Dest_Org_Dimn_Id]        ,[Cycle_Seg_Dest_Org_Ver]        ,[Cycle_Segment]        ,[Cycle]        ,[Cycle_Seg_Order]        ,[Cycle_Seg_Typ]        ,[Empt_Ld_Ind]        ,[Cycle_Seg_Begin_Dt]        ,[Cycle_Seg_Begin_Dt_Dimn_Id]        ,[Cycle_Seg_End_Dt]        ,[Cycle_Seg_End_Dt_Dimn_Id]        ,[Cycle_Seg_Calc_Milg]        ,[Cycle_Seg_Calc_Dura]        ,[Orig_Loc]        ,[Orig_Enty]        ,[Dest_Loc]        ,[Dest_Enty]        ,[Cycle_Seg_Scnd_Status]        ,[Crtd_Id]        ,[Crtd_Dt]        ,[Lst_Upd_Id]        ,[Lst_Upd_Dt]        ,[Src_Sys_Nm]        ,[Dq_Flg]    FROM [dbo].[Cycle_Seg_Fact_History]"
    },
    {
      "id": "vw_Cycle_Seg_Road_Seg_Fact",
      "name": "vw_Cycle_Seg_Road_Seg_Fact",
      "type": "VIEW",
      "sql": "CREATE VIEW [dbo].[vw_Cycle_Seg_Road_Seg_Fact]  AS  SELECT [Cycle_Seg_Road_Seg_Fact_Id]        ,[Cycle_Seg_Fact_Id]        ,[Car_Dimn_Id]        ,[Car_Ver]        ,[Cycle_Seg_Road_Seg_Poss_Road_Org_Dimn_Id]        ,[Cycle_Seg_Road_Seg_Poss_Road_Org_Ver]        ,[Cycle_Seg_Road_Seg_Resp_Road_Org_Dimn_Id]        ,[Cycle_Seg_Road_Seg_Resp_Road_Org_Ver]        ,[Cycle_Seg_Road_Seg_Lst_Parti_Road_Org_Dimn_Id]        ,[Cycle_Seg_Road_Seg_Lst_Parti_Road_Org_Ver]        ,[Cycle_Seg_Road_Seg_Begin_Loc_SPLC_Dimn_Id]        ,[Cycle_Seg_Road_Seg_End_Loc_SPLC_Dimn_Id]        ,[Cycle_Segment_Railroad_Segment]        ,[Cycle_Segment]        ,[Cycle_Seg_Road_Seg_Order]        ,[Cycle_Seg_Road_Seg_Begin_Loc]        ,[Cycle_Seg_Road_Seg_End_Loc]        ,[Cycle_Seg_Road_Seg_Begin_Dt]        ,[Cycle_Seg_Road_Seg_End_Dt]        ,[Cycle_Seg_Road_Seg_Calc_Milg]        ,[Cycle_Seg_Road_Seg_BadOrder_Milg]        ,[Cycle_Seg_Road_Seg_Calc_Dura]        ,[Cycle_Seg_Road_Seg_BadOrder_Dura]        ,[Cycle_Seg_Road_Seg_Poss_Road]        ,[Cycle_Seg_Road_Seg_Resp_Road]        ,[Cycle_Seg_Road_Seg_Lst_Parti_Enty]        ,[Cycle_Seg_Road_Seg_Scnd_Status]        ,[Crtd_Id]        ,[Crtd_Dt]        ,[Lst_Upd_Id]        ,[Lst_Upd_Dt]        ,[Src_Sys_Nm]        ,[Dq_Flg]    FROM [dbo].[Cycle_Seg_Road_Seg_Fact]"
    },
    {
      "id": "vw_Cycle_Seg_Road_Seg_Fact_History",
      "name": "vw_Cycle_Seg_Road_Seg_Fact_History",
      "type": "VIEW",
      "sql": "CREATE VIEW [dbo].[vw_Cycle_Seg_Road_Seg_Fact_History]  AS  SELECT [Cycle_Seg_Road_Seg_Fact_Id]        ,[Cycle_Seg_Fact_Id]        ,[Car_Dimn_Id]        ,[Car_Ver]        ,[Cycle_Seg_Road_Seg_Poss_Road_Org_Dimn_Id]        ,[Cycle_Seg_Road_Seg_Poss_Road_Org_Ver]        ,[Cycle_Seg_Road_Seg_Resp_Road_Org_Dimn_Id]        ,[Cycle_Seg_Road_Seg_Resp_Road_Org_Ver]        ,[Cycle_Seg_Road_Seg_Lst_Parti_Road_Org_Dimn_Id]        ,[Cycle_Seg_Road_Seg_Lst_Parti_Road_Org_Ver]        ,[Cycle_Seg_Road_Seg_Begin_Loc_SPLC_Dimn_Id]        ,[Cycle_Seg_Road_Seg_End_Loc_SPLC_Dimn_Id]        ,[Cycle_Segment_Railroad_Segment]        ,[Cycle_Segment]        ,[Cycle_Seg_Road_Seg_Order]        ,[Cycle_Seg_Road_Seg_Begin_Loc]        ,[Cycle_Seg_Road_Seg_End_Loc]        ,[Cycle_Seg_Road_Seg_Begin_Dt]        ,[Cycle_Seg_Road_Seg_End_Dt]        ,[Cycle_Seg_Road_Seg_Calc_Milg]        ,[Cycle_Seg_Road_Seg_BadOrder_Milg]        ,[Cycle_Seg_Road_Seg_Calc_Dura]        ,[Cycle_Seg_Road_Seg_BadOrder_Dura]        ,[Cycle_Seg_Road_Seg_Poss_Road]        ,[Cycle_Seg_Road_Seg_Resp_Road]        ,[Cycle_Seg_Road_Seg_Lst_Parti_Enty]        ,[Cycle_Seg_Road_Seg_Scnd_Status]        ,[Crtd_Id]        ,[Crtd_Dt]        ,[Lst_Upd_Id]        ,[Lst_Upd_Dt]        ,[Src_Sys_Nm]        ,[Dq_Flg]    FROM [dbo].[Cycle_Seg_Road_Seg_Fact_History]"
    },
    {
      "id": "vw_Repair_Entity",
      "name": "vw_Repair_Entity",
      "type": "VIEW",
      "sql": "CREATE VIEW [DBO].[vw_Repair_Entity]     AS   SELECT VMRT_Repair_Entity_Dimension.Repr_Enty_Dimn_Id as Repr_Enty_Dimn_Id,   VMRT_Repair_Entity_Dimension.Repr_Enty_Ver as Repr_Enty_Ver,   VMRT_Repair_Entity_Dimension.St_Prov as State,   VMRT_Repair_Entity_Dimension.City as City,   VMRT_Repair_Entity_Dimension.FMO_Zone as FMO_Zone,   VMRT_Repair_Entity_Dimension.Repr_Enty_Org_Abrv  as Repair_Entity_ID,    VMRT_Repair_Entity_Dimension.Repr_Enty_Org_Nm  as Repair_Entity_Name,    VMRT_Repair_Entity_Dimension.Ownr_Org_Abrv   as Repair_Entity_Owner_ID,    VMRT_Repair_Entity_Dimension.Ownr_Org_Nm   as Repair_Entity_Owner_Name,    isnull(VMRT_Repair_Entity_Dimension.Repr_Enty_Typ, 'Unknown') as Repair_Entity_Type_Level_1,   isnull(VMRT_Repair_Entity_Dimension.Ownr_Typ_Desc, 'Unknown') as Repair_Entity_Type_Level_2,   VMRT_Repair_Entity_Dimension.Repr_Shp_Typ as Repair_Shop_Type,   VMRT_Repair_Entity_Dimension.SPLC_Nr as SPLC_Number,   VMRT_Repair_Entity_Dimension.SPLC_Dimn_Id as SPLC_Dimn_Id,   VMRT_Repair_Entity_Dimension.Repr_Enty_Org_Dimn_Id as Repr_Enty_Org_Dimn_Id,   VMRT_Repair_Entity_Dimension.Repr_Enty_Org_Ver as Repr_Enty_Org_Ver    FROM (       SELECT    Repair_Entity_Dim.Repr_Enty_Dimn_Id,   Repair_Entity_Dim.Repr_Enty_Ver,   Repair_Entity_Dim.Repr_Enty_Org_Dimn_Id,   Repair_Entity_Dim.Repr_Enty_Org_Ver,   Case when ISNULL(Odim1.Prnt_Org_Dimn_Id,-1) = -1 then Repair_Entity_Dim.Repr_Enty_Org_Dimn_Id else Odim1.Prnt_Org_Dimn_Id end  as Prnt_Org_Dimn_Id,   Case when ISNULL(Odim1.Prnt_Org_Ver,-1) = -1 then Repair_Entity_Dim.Repr_Enty_Org_Ver else Odim1.Prnt_Org_Ver end as Prnt_Org_Ver,   Repair_Entity_Dim.SPLC_Dimn_Id,   Repair_Entity_Dim.Repr_Enty_org_Abrv,   Repair_Entity_Dim.SPLC_nr,   SPLC_Dm.SPLC_Nm,   Odim1.Org_Nm as Repr_Enty_org_Nm,   odim1.Pty_Id,   ISNULL(Odim2.Org_Abrv,Repair_Entity_Dim.Repr_Enty_org_Abrv) as Ownr_Org_Abrv,   ISNULL(Odim2.Org_Nm,Odim1.Org_Nm ) AS Ownr_Org_Nm,   Repair_Entity_Dim.Repr_Enty_Typ,   Repair_Entity_Dim.Repr_Shp_Typ,   Repair_Entity_Dim.Ownr_Typ_Desc,   Repair_Entity_Dim.FMO_Zone,   Geo_DM.St_Prov,   Repair_Entity_Dim.City,   --Repr_Fac_Grp.Group_Name as Repr_Fac_Grp,   Repair_Entity_Dim.Shop_Cap,   Repair_Entity_Dim.Serv_Yard_Cap,   Repair_Entity_Dim.Eff_From,   Repair_Entity_Dim.Eff_To,   Repair_Entity_Dim.Crtd_Dt,   Repair_Entity_Dim.Crtd_Id,   Repair_Entity_Dim.Lst_Upd_Dt,   Repair_Entity_Dim.Lst_Upd_Id,   Repair_Entity_Dim.Src_Sys_Nm     FROM ddsmrt.dbo.Repair_Entity_Dim Repair_Entity_Dim     LEFT JOIN Organization_Dim AS Odim1 ON Repair_Entity_Dim.Repr_Enty_Org_Dimn_Id  = Odim1.Org_Dimn_Id AND     Repair_Entity_Dim.Repr_Enty_Org_Ver  = Odim1.Org_Ver     LEFT JOIN Organization_Dim AS Odim2 ON Odim2.Org_Dimn_Id = Odim1.Prnt_Org_Dimn_Id AND  Odim2.Org_Ver= Odim1.Prnt_Org_Ver     LEFT JOIN SPLC_Dim AS SPLC_DM ON Repair_Entity_Dim.SPLC_Dimn_ID =    SPLC_DM.SPLC_Dimn_ID      LEFT JOIN Geography_Dim As Geo_DM  ON SPLC_DM.Geo_Dimn_ID =   Geo_DM.Geo_Dimn_ID    --Left Join  ( Select Railroad,Group_Name from   --  (   --  SELECT *, ROW_NUMBER() OVER (PARTITION BY Railroad ORDER BY Group_Name ) RN   --         FROM   ddsstg.dbo.AAR_Grouping_Facility        --   ) dups   --   where dups.Rn=1) As Repr_Fac_Grp   --on  Repair_Entity_Dim.Repr_Enty_org_Abrv=Repr_Fac_Grp.Railroad   )    VMRT_Repair_Entity_Dimension"
    },
    {
      "id": "vw_Cycle_Seg_Road_Seg_Fact_All",
      "name": "vw_Cycle_Seg_Road_Seg_Fact_All",
      "type": "VIEW",
      "sql": "CREATE VIEW [dbo].[vw_Cycle_Seg_Road_Seg_Fact_All]  AS  SELECT [Cycle_Seg_Road_Seg_Fact_Id]        ,[Cycle_Seg_Fact_Id]        ,[Car_Dimn_Id]        ,[Car_Ver]        ,[Cycle_Seg_Road_Seg_Poss_Road_Org_Dimn_Id]        ,[Cycle_Seg_Road_Seg_Poss_Road_Org_Ver]        ,[Cycle_Seg_Road_Seg_Resp_Road_Org_Dimn_Id]        ,[Cycle_Seg_Road_Seg_Resp_Road_Org_Ver]        ,[Cycle_Seg_Road_Seg_Lst_Parti_Road_Org_Dimn_Id]        ,[Cycle_Seg_Road_Seg_Lst_Parti_Road_Org_Ver]        ,[Cycle_Seg_Road_Seg_Begin_Loc_SPLC_Dimn_Id]        ,[Cycle_Seg_Road_Seg_End_Loc_SPLC_Dimn_Id]        ,[Cycle_Segment_Railroad_Segment]        ,[Cycle_Segment]        ,[Cycle_Seg_Road_Seg_Order]        ,[Cycle_Seg_Road_Seg_Begin_Loc]        ,[Cycle_Seg_Road_Seg_End_Loc]        ,[Cycle_Seg_Road_Seg_Begin_Dt]        ,[Cycle_Seg_Road_Seg_End_Dt]        ,[Cycle_Seg_Road_Seg_Calc_Milg]        ,[Cycle_Seg_Road_Seg_BadOrder_Milg]        ,[Cycle_Seg_Road_Seg_Calc_Dura]        ,[Cycle_Seg_Road_Seg_BadOrder_Dura]        ,[Cycle_Seg_Road_Seg_Poss_Road]        ,[Cycle_Seg_Road_Seg_Resp_Road]        ,[Cycle_Seg_Road_Seg_Lst_Parti_Enty]        ,[Cycle_Seg_Road_Seg_Scnd_Status]        ,[Crtd_Id]        ,[Crtd_Dt]        ,[Lst_Upd_Id]        ,[Lst_Upd_Dt]        ,[Src_Sys_Nm]        ,[Dq_Flg]    FROM [dbo].[Cycle_Seg_Road_Seg_Fact]      UNION ALL      SELECT [Cycle_Seg_Road_Seg_Fact_Id]        ,[Cycle_Seg_Fact_Id]        ,[Car_Dimn_Id]        ,[Car_Ver]        ,[Cycle_Seg_Road_Seg_Poss_Road_Org_Dimn_Id]        ,[Cycle_Seg_Road_Seg_Poss_Road_Org_Ver]        ,[Cycle_Seg_Road_Seg_Resp_Road_Org_Dimn_Id]        ,[Cycle_Seg_Road_Seg_Resp_Road_Org_Ver]        ,[Cycle_Seg_Road_Seg_Lst_Parti_Road_Org_Dimn_Id]        ,[Cycle_Seg_Road_Seg_Lst_Parti_Road_Org_Ver]        ,[Cycle_Seg_Road_Seg_Begin_Loc_SPLC_Dimn_Id]        ,[Cycle_Seg_Road_Seg_End_Loc_SPLC_Dimn_Id]        ,[Cycle_Segment_Railroad_Segment]        ,[Cycle_Segment]        ,[Cycle_Seg_Road_Seg_Order]        ,[Cycle_Seg_Road_Seg_Begin_Loc]        ,[Cycle_Seg_Road_Seg_End_Loc]        ,[Cycle_Seg_Road_Seg_Begin_Dt]        ,[Cycle_Seg_Road_Seg_End_Dt]        ,[Cycle_Seg_Road_Seg_Calc_Milg]        ,[Cycle_Seg_Road_Seg_BadOrder_Milg]        ,[Cycle_Seg_Road_Seg_Calc_Dura]        ,[Cycle_Seg_Road_Seg_BadOrder_Dura]        ,[Cycle_Seg_Road_Seg_Poss_Road]        ,[Cycle_Seg_Road_Seg_Resp_Road]        ,[Cycle_Seg_Road_Seg_Lst_Parti_Enty]        ,[Cycle_Seg_Road_Seg_Scnd_Status]        ,[Crtd_Id]        ,[Crtd_Dt]        ,[Lst_Upd_Id]        ,[Lst_Upd_Dt]        ,[Src_Sys_Nm]        ,[Dq_Flg]    FROM [dbo].[Cycle_Seg_Road_Seg_Fact_History]"
    },
    {
      "id": "Car_Mileage_Fact",
      "name": "Car_Mileage_Fact",
      "type": "VIEW",
      "sql": "CREATE View [SV].[Car_Mileage_Fact]  As    SELECT   CMF.Car_Dimn_ID,  CMF.Car_Ver,  CAST(CMF.Car_Dimn_ID as VARCHAR(20)) + '|' + CAST(CMF.Car_Ver as VARCHAR(20)) Car_ID,  CMF.Dt_Dimn_Id,  CMF.Empty_Loaded,  CMF.RailCar,  CMF.Lst_Part_org_dimn_id as Last_Participating_Road_Org_Dimn_Id   ,CMF.Lst_Part_org_ver as Last_Participating_Road_Org_Ver   ,CMF.Rpt_org_dimn_id as Reporting_Road_Org_Dimn_Id  ,CMF.Rpt_org_ver as Reporting_Road_Org_Ver  ,CMF.Car_Mileage UFD_Mileage_in_Cars  ,ISNULL(CMF.Car_Mileage,0) * CASE WHEN ISNULL(CC.Unit_Count, 0) = 0 THEN 1                     ELSE CC.Unit_Count END UFD_Mileage_in_Units  FROM DDSMRT.DBO.Car_Mileage_Fact CMF  JOIN DDSMRT.SV.Car_Correct CC ON CMF.Car_Dimn_Id = CC.car_dimn_id AND CMF.Car_Ver = CC.car_ver"
    },
    {
      "id": "VMRT_Cycle_Fact_History",
      "name": "VMRT_Cycle_Fact_History",
      "type": "VIEW",
      "sql": "CREATE VIEW [dbo].[VMRT_Cycle_Fact_History] as     SELECT   CYCLE.[Cycle_Fact_Id]  ,CYCLE.[Cycle_Shpr_Org_Dimn_Id]  ,CYCLE.[Cycle_Shpr_Org_Ver]  ,CYCLE.[Car_Dimn_Id]  ,CYCLE.[Car_Ver]  ,CYCLE.[Origin_Empt_Org_Dimn_Id]  ,CYCLE.[Origin_Empt_Org_Ver]  ,CYCLE.[Dest_Empt_Org_Dimn_Id]  ,CYCLE.[Dest_Empt_Org_Ver]  ,CYCLE.[Origin_Ld_Org_Dimn_Id]  ,CYCLE.[Origin_Ld_Org_Ver]  ,CYCLE.[Dest_Ld_Org_Dimn_Id]  ,CYCLE.[Dest_Ld_Org_Ver]  ,isnull(SPLC1.SPLC_Dimn_Id, -1) as  Dest_Ld_SPLC_Dimn_Id  ,isnull(SPLC2.SPLC_Dimn_Id, -1) as  Origin_Ld_SPLC_Dimn_Id  ,isnull(SPLC3.SPLC_Dimn_Id, -1) as  Dest_Empt_SPLC_Dimn_Id  ,isnull(SPLC4.SPLC_Dimn_Id, -1) as  Origin_Empt_SPLC_Dimn_Id  ,CYCLE.[Cycle_Begin_Dt_Dimn_Id]  ,CYCLE.[Cycle_End_Dt_Dimn_Id]  ,CYCLE.[Cycle]  ,CYCLE.[Railcar]  ,CYCLE.[Cycle_Typ]  ,CYCLE.[Cycle_Rules_Not_Satisfied]  ,CYCLE.[Has_Missing_Segs]  ,CYCLE.[Cycle_Shpr]  ,CYCLE.[Cycle_Begin_Dt]  ,CYCLE.[Cycle_End_Dt]  ,CYCLE.[Begin_Dt_Ld]  ,CYCLE.[Orig_Loc_Empt]  ,CYCLE.[Orig_Enty_Empt]  ,CYCLE.[Dest_Loc_Empt]  ,CYCLE.[Dest_Enty_Empt]  ,CYCLE.[Orig_Loc_Ld]  ,CYCLE.[Orig_Enty_Ld]  ,CYCLE.[Dest_Loc_Ld]  ,CYCLE.[Dest_Enty_Ld]  ,CYCLE.[Invalid_Rsn]  ,CYCLE.[Totl_Seg_Cnt]  ,CYCLE.[Cycle_Calc_Milg_Empt]  ,CYCLE.[Cycle_Calc_Milg_Ld]  ,CYCLE.[Cycle_Calc_Dura_Empt]  ,CYCLE.[Cycle_Calc_Dura_Ld]  ,CYCLE.[Crtd_Id]  ,CYCLE.[Crtd_Dt]  ,CYCLE.[Lst_Upd_Id]  ,CYCLE.[Lst_Upd_Dt]  ,CYCLE.[Src_Sys_Nm]  ,CYCLE.[Dq_Flg]  ,CYCLE.[Dlet_Flg]  FROM [DDSMRT].[dbo].[vw_Cycle_Fact_History] (NOLOCK) CYCLE  LEFT JOIN DDSMRT.dbo.SPLC_Dim (NOLOCK) SPLC1 on (CYCLE.Dest_Loc_Ld = SPLC1.Location)  LEFT JOIN DDSMRT.dbo.SPLC_Dim (NOLOCK) SPLC2 on (CYCLE.Orig_Loc_Ld = SPLC2.Location)  LEFT JOIN DDSMRT.dbo.SPLC_Dim (NOLOCK) SPLC3 on (CYCLE.Dest_Loc_Empt = SPLC3.Location)  LEFT JOIN DDSMRT.dbo.SPLC_Dim (NOLOCK) SPLC4 on (CYCLE.Orig_Loc_Empt = SPLC4.Location)"
    },
    {
      "id": "Badorder_Snapshot",
      "name": "Badorder_Snapshot",
      "type": "VIEW",
      "sql": "CREATE VIEW [SV].[Badorder_Snapshot]    AS  SELECT [Dt_Dimn_Id],         (CAST(bos.Car_Dimn_Id AS VARCHAR) + '|' + CAST(bos.Car_Ver AS VARCHAR)) AS [Car_Id],         [fact_Bad_Orders_key],         bos.Car_Initial,         bos.Car_Number,         Transaction_Type,         Reporting_Railroad,         Actual_Reason_Code,         Bad_Order_Start_Date,         End_Date AS Bad_Order_End_Date,         Is_Closed,         RailCar,         Bad_Order_Hours_Open,      car.Unit_Count ,      ROW_NUMBER() OVER (Partition BY Dt_Dimn_ID,bos.Car_Initial,bos.Car_Number,CAST(End_Date AS DATE) ORDER by Bad_Order_Start_Date) AS Badorder_Event  FROM [DDSMRT].[dbo].[BadOrder_Snapshot] bos INNER JOIN [DDSMRT].SV.Car_Correct car  on bos.Car_Dimn_Id=car.car_dimn_id and bos.Car_Ver=car.car_ver;"
    },
    {
      "id": "VMRT_TTX_Velocity_History",
      "name": "VMRT_TTX_Velocity_History",
      "type": "VIEW",
      "sql": "CREATE VIEW [dbo].[VMRT_TTX_Velocity_History] as   select   c.[Cycle_Fact_Id]  ,cs.[Cycle_Seg_Fact_Id]  ,cs.cycle_seg_order  ,csrs.[Cycle_Seg_Road_Seg_Fact_Id]  ,csrs.Cycle_Seg_Road_Seg_Order  ,c.[Car_Dimn_Id]  ,c.[Car_Ver]  ,csrs.[Cycle_Seg_Road_Seg_Poss_Road_Org_Dimn_Id]  ,csrs.[Cycle_Seg_Road_Seg_Poss_Road_Org_Ver]  ,csrs.[Cycle_Seg_Road_Seg_Resp_Road_Org_Dimn_Id]  ,csrs.[Cycle_Seg_Road_Seg_Resp_Road_Org_Ver]  ,csrs.[Cycle_Seg_Road_Seg_Lst_Parti_Road_Org_Dimn_Id]  ,csrs.[Cycle_Seg_Road_Seg_Lst_Parti_Road_Org_Ver]  ,csrs.[Cycle_Seg_Road_Seg_Begin_Loc_SPLC_Dimn_Id]  ,csrs.[Cycle_Seg_Road_Seg_End_Loc_SPLC_Dimn_Id]  ,csrs.[Crtd_Dt]  ,csrs.[Lst_Upd_Dt]  ,cs.[Empt_Ld_Ind]  ,cs.[Cycle_Seg_Typ]  ,ISNULL(csrs.[Cycle_Seg_Road_Seg_Calc_Dura], 0) as Calc_Dura  ,ISNULL(csrs.[Cycle_Seg_Road_Seg_Calc_Milg],0) as Calc_Milg  ,c.[Cycle_Shpr_Org_Dimn_Id]  ,c.[Cycle_Shpr_Org_Ver]  ,c.[Origin_Ld_Org_Dimn_Id]  ,c.[Origin_Ld_Org_Ver]  ,c.[Dest_Ld_Org_Dimn_Id]  ,c.[Dest_Ld_Org_Ver]  ,c.[Origin_Empt_Org_Dimn_Id]  ,c.[Origin_Empt_Org_Ver]  ,c.[Dest_Empt_Org_Dimn_Id]  ,c.[Dest_Empt_Org_Ver]  ,c.Origin_Empt_SPLC_Dimn_Id  ,c.Dest_Empt_SPLC_Dimn_Id  ,c.Origin_Ld_SPLC_Dimn_Id  ,c.Dest_Ld_SPLC_Dimn_Id  ,c.[Cycle_Begin_Dt_Dimn_Id]  ,c.[Cycle_End_Dt_Dimn_Id]  ,c.[Cycle_Typ]  ,c.[Invalid_Rsn]  , case when cs.cycle_seg_order =1 and csrs.Cycle_Seg_Road_Seg_Order =1 then csrs.[Cycle_Seg_Road_Seg_Lst_Parti_Road_Org_Dimn_Id] end as Orig_Lst_Parti_road_Org_Dimn_Id  , case when cs.cycle_seg_order =1 and csrs.Cycle_Seg_Road_Seg_Order =1 then csrs.[Cycle_Seg_Road_Seg_Lst_Parti_Road_Org_Ver]  end as Orig_Lst_Parti_road_Org_Ver  , case when cs.cycle_seg_order =1 and csrs.Cycle_Seg_Road_Seg_Order =1 then csrs.[Cycle_Seg_Road_Seg_Resp_Road_Org_Dimn_Id]   end as Orig_Resp_road_Org_Dimn_Id  , case when cs.cycle_seg_order =1 and csrs.Cycle_Seg_Road_Seg_Order =1 then csrs.[Cycle_Seg_Road_Seg_Resp_Road_Org_Ver]    end as Orig_Resp_road_Org_Ver  , case when cs.cycle_seg_order =1 and csrs.Cycle_Seg_Road_Seg_Order =1 then csrs.[Cycle_Seg_Road_Seg_Poss_Road_Org_Dimn_Id]   end as Orig_Poss_road_Org_Dimn_Id  , case when cs.cycle_seg_order =1 and csrs.Cycle_Seg_Road_Seg_Order =1 then csrs.[Cycle_Seg_Road_Seg_Poss_Road_Org_Ver]    end as Orig_Poss_road_Org_Ver    from [dbo].[VMRT_Cycle_Fact_History] (NOLOCK) c   INNER join [dbo].[VMRT_Cycle_Seg_Fact] (NOLOCK) cs on cs.cycle_fact_id = c.cycle_fact_id  INNER JOIN [dbo].[VMRT_Cycle_Seg_Road_Seg_Fact] (NOLOCK) csrs  on csrs.cycle_seg_fact_id = cs.cycle_seg_fact_id  where c.Dlet_Flg = 0"
    },
    {
      "id": "TTX_Velocity_History",
      "name": "TTX_Velocity_History",
      "type": "VIEW",
      "sql": "CREATE VIEW [SV].[TTX_Velocity_History]  AS  SELECT   VMRT_TTX_Velocity.Cycle_Fact_Id,  VMRT_TTX_Velocity.Cycle_Seg_Fact_Id,  VMRT_TTX_Velocity.Cycle_Seg_Road_Seg_Fact_Id,  VMRT_TTX_Velocity.Car_Dimn_Id,  VMRT_TTX_Velocity.Car_Ver,  VMRT_TTX_Velocity.Cycle_Seg_Road_Seg_Poss_Road_Org_Dimn_Id AS Cycle_Seg_Poss_Road_Org_Dimn_Id,  VMRT_TTX_Velocity.Cycle_Seg_Road_Seg_Poss_Road_Org_Ver AS Cycle_Seg_Poss_Road_Org_Ver,  VMRT_TTX_Velocity.Cycle_Seg_Road_Seg_Resp_Road_Org_Dimn_Id AS Cycle_Seg_Resp_Road_Org_Dimn_Id,  VMRT_TTX_Velocity.Cycle_Seg_Road_Seg_Resp_Road_Org_Ver AS Cycle_Seg_Resp_Road_Org_Ver,  VMRT_TTX_Velocity.Cycle_Seg_Road_Seg_Lst_Parti_Road_Org_Dimn_Id AS Cycle_Seg_Lst_Parti_Road_Org_Dimn_Id,  VMRT_TTX_Velocity.Cycle_Seg_Road_Seg_Lst_Parti_Road_Org_Ver AS Cycle_Seg_Lst_Parti_Road_Org_Ver,  VMRT_TTX_Velocity.Cycle_Seg_Road_Seg_Begin_Loc_SPLC_Dimn_Id AS Cycle_Seg_Road_Seg_Beg_Loc_SPLC_Dimn_Id,  VMRT_TTX_Velocity.Cycle_Seg_Road_Seg_End_Loc_SPLC_Dimn_Id AS Cycle_Seg_Road_Seg_End_Loc_SPLC_Dimn_Id,  VMRT_TTX_Velocity.Orig_Lst_Parti_road_Org_Dimn_Id,  VMRT_TTX_Velocity.Orig_Lst_Parti_road_Org_Ver,  VMRT_TTX_Velocity.Orig_Resp_road_Org_Dimn_Id,  VMRT_TTX_Velocity.Orig_Resp_road_Org_Ver,  VMRT_TTX_Velocity.Orig_Poss_road_Org_Dimn_Id,  VMRT_TTX_Velocity.Orig_Poss_road_Org_Ver,  VMRT_TTX_Velocity.Origin_Empt_SPLC_Dimn_Id,  VMRT_TTX_Velocity.Dest_Empt_SPLC_Dimn_Id,  VMRT_TTX_Velocity.Origin_Ld_SPLC_Dimn_Id,  VMRT_TTX_Velocity.Dest_Ld_SPLC_Dimn_Id,  VMRT_TTX_Velocity.Empt_Ld_Ind,  VMRT_TTX_Velocity.Cycle_Seg_Typ,  VMRT_TTX_Velocity.Calc_Milg,  VMRT_TTX_Velocity.Calc_Dura,  VMRT_TTX_Velocity.Cycle_Shpr_Org_Dimn_Id,  VMRT_TTX_Velocity.Cycle_Shpr_Org_Ver,  VMRT_TTX_Velocity.Cycle_Begin_Dt_Dimn_Id,  VMRT_TTX_Velocity.Origin_Ld_Org_Dimn_Id,  VMRT_TTX_Velocity.Origin_Ld_Org_Ver,  VMRT_TTX_Velocity.Dest_Ld_Org_Dimn_Id,  VMRT_TTX_Velocity.Dest_Ld_Org_Ver,  VMRT_TTX_Velocity.Origin_Empt_Org_Dimn_Id,  VMRT_TTX_Velocity.Origin_Empt_Org_Ver,  VMRT_TTX_Velocity.Dest_Empt_Org_Dimn_Id,  VMRT_TTX_Velocity.Dest_Empt_Org_Ver,  VMRT_TTX_Velocity.Cycle_End_Dt_Dimn_Id,  VMRT_TTX_Velocity.Cycle_Typ,  VMRT_TTX_Velocity.Invalid_Rsn,  VMRT_TTX_Velocity.Crtd_Dt,  VMRT_TTX_Velocity.Lst_Upd_Dt  FROM dbo.VMRT_TTX_Velocity_History VMRT_TTX_Velocity  where Cycle_Typ = 'SH'"
    },
    {
      "id": "VMRT_Car_Hierarchy_Eshift",
      "name": "VMRT_Car_Hierarchy_Eshift",
      "type": "VIEW",
      "sql": "CREATE VIEW [dbo].[VMRT_Car_Hierarchy_Eshift]    WITH SCHEMABINDING    as    SELECT      HD.[Hierchy_Id]     ,HD.[Hierchy_Ver]    ,convert(varchar(100),HD.[Lvl1_Desc]) as bus_Ln_Shrt_Desc    ,cast(HD.Lvl1_Nm as int) as Bus_Ln_Id    ,convert(varchar(100),HD.[Lvl2_Desc]) as [Eq_Typ_Shrt_Desc]    ,cast(HD.Lvl2_Nm as int) as Eq_Typ_Id    ,convert(varchar(100),HD.[Lvl3_Desc]) as [Eq_Featr_Shrt_Desc]    ,cast(HD.Lvl3_Nm as int) as Eq_Featr_Id    ,cast(HD.[Lvl4_Nm] as int) as [Stat_Cd]    ,convert(datetime, HD.[Attr5_Val_Char] ) as [Stat_Cd_Eff_Strt_Dt]    ,convert(datetime, HD.[Attr6_Val_Char] ) as [Stat_Cd_Eff_End_Dt]    ,convert(varchar(100),HD.[Lvl5_Desc]) as Total_Line_Of_Business  ,convert(varchar(100),HD.[Attr1_Val_Char]) as Oracle_Lob  ,HD.eff_from    ,HD.eff_to    ,HD.crtd_id    ,HD.crtd_dt    ,HD.lst_upd_id    ,HD.lst_upd_dt     FROM dbo.[Hierarchy_Dim] (NOLOCK) HD     JOIN DBO.Type_Lookup TL ON TL.Typ_Id = HD.[Hierchy_Typ_Id]     WHERE TL.Typ_Desc = 'Eshift Hierarchy' AND TL.Typ_Grp = 'Car Hierarchy' ;"
    },
    {
      "id": "VCycles_Fact_History",
      "name": "VCycles_Fact_History",
      "type": "VIEW",
      "sql": "CREATE VIEW [DDSV].[VCycles_Fact_History] AS  SELECT     cast(A.Cycle_Begin_Dt_Dimn_Id as INT) as Cyc_Beg_Dt_Dimn_Id ,  cast(A.Cycle_End_Dt_Dimn_Id as INT) as Cyc_End_Dt_Dimn_Id ,  cast(F.SPLC_Dimn_Id as INT) as Orig_Geo_Dimn_Id ,  cast(G.SPLC_Dimn_Id as INT) as Dest_Geo_Dimn_Id ,  concat(convert(varchar(10),A.Car_Dimn_Id),'_',convert(varchar(5), A.Car_Ver)) as Car_Dimn_Id,  concat(convert(varchar(10),A.Cycle_Shpr_Org_Dimn_Id),'_',convert(varchar(5), A.Cycle_Shpr_Org_Ver)) as Ship_Enty_Dimn_Id ,  concat(convert(varchar(10),B.Cycle_Seg_Road_Seg_Lst_Parti_Road_Org_Dimn_Id),'_',convert(varchar(5), B.Cycle_Seg_Road_Seg_Lst_Parti_Road_Org_Ver)) as Lst_Part_Rd_Dimn_Id ,  A.Cycle as Cycle ,  A.Railcar as Railcar ,  cast(E.Car_Nr as [decimal](11, 0)) as Car_Nr ,  E.Car_Init ,  A.Cycle_End_Dt as End_Dt ,  A.Cycle_Shpr as Shipper ,  A.Orig_Loc_Ld as Orig_Loc_Load ,  A.Dest_Loc_Ld as Dest_Loc_Load ,  cast(H.org_abrv as char(4)) as Lst_Part_RR_Entity ,  cast(A.Cycle_Calc_Milg_Empt as decimal(15,2)) as Calc_Emp_Mil ,  cast(A.Cycle_Calc_Milg_Ld as decimal(15,2)) as Calc_Ld_Mil ,  A.Cycle_Calc_Dura_Empt as Calc_Emp_Dur ,  A.Cycle_Calc_Dura_Ld as Calc_Ld_Dur ,  A.Invalid_Rsn  as Inv_Rsn ,  Is_Valid_Ind,  RecMod_Dt_Id,  A.Crtd_Id as Crtd_Id ,  A.Crtd_Dt as Crtd_Dt ,  A.Lst_Upd_Id as Lst_Upd_Id ,  A.Lst_Upd_Dt  Lst_Upd_Dt   from  (SELECT  Cycle_Fact_Id,  Cycle_Begin_Dt_Dimn_Id,  Cycle_End_Dt_Dimn_Id,  Car_Dimn_Id, Car_Ver,  Cycle_Shpr_Org_Dimn_Id, Cycle_Shpr_Org_Ver,  Cycle ,  Railcar ,  Cycle_End_Dt,  Cycle_Shpr,  Orig_Loc_Ld,  Dest_Loc_Ld,  Cycle_Calc_Milg_Empt,  Cycle_Calc_Milg_Ld,  Cycle_Calc_Dura_Empt,  Cycle_Calc_Dura_Ld,  cycle_typ,  Invalid_Rsn,  cast((case when Invalid_Rsn is NULL then 'Y' else 'N' end) as char(1)) as Is_Valid_Ind,  cast(NULL as int) as RecMod_Dt_Id,  Crtd_Id ,  Crtd_Dt ,  Lst_Upd_Id ,  Lst_Upd_Dt from  ddsmrt.dbo.vw_Cycle_Fact_History (NOLOCK)  where cycle_typ = 'SH' and Dlet_Flg = 0 and Cycle_End_Dt_Dimn_Id >= 20100101 ) A  left join ( select Cycle_Fact_Id       , Cycle_Seg_Fact_Id       , row_number() OVER ( partition by Cycle_Fact_Id  ORDER BY [Cycle_Seg_Order] desc) AS Row_ID     from  ddsmrt.dbo.vw_Cycle_Seg_Fact_All (NOLOCK) ) C  on A.Cycle_Fact_Id = C.Cycle_Fact_Id  left join ( select Cycle_Seg_Fact_Id       , Cycle_Seg_Road_Seg_Lst_Parti_Road_Org_Dimn_Id       , Cycle_Seg_Road_Seg_Lst_Parti_Road_Org_Ver       , row_number() OVER ( partition by Cycle_Seg_Fact_Id  ORDER BY [Cycle_Seg_Road_Seg_Order] desc) AS Row_ID     from ddsmrt.dbo.vw_cycle_seg_road_seg_fact_All (NOLOCK)) B on C.Cycle_Seg_Fact_Id = B.Cycle_Seg_Fact_Id  /** IR527842 Fix **/  left join ddsmrt.dbo.Car_Dim_Correct  (NOLOCK) E on A.Car_Dimn_Id = E.Car_Dimn_Id and A.Car_Ver = E.Car_Ver  left join ddsmrt.dbo.SPLC_Dim (NOLOCK) F on A.Orig_Loc_Ld = F.location   left join ddsmrt.dbo.SPLC_Dim (NOLOCK) G on A.Dest_Loc_Ld = G.Location  left join (select * from ddsmrt.dbo.VMRT_Organization_Dimension where eff_to is null) H on B.Cycle_Seg_Road_Seg_Lst_Parti_Road_Org_Dimn_Id = H.Org_Dimn_Id    where  (c.row_id = 1 or c.Row_ID is null) and (b.row_id = 1 or b.Row_ID is null)"
    },
    {
      "id": "usp_D_House_Keeping_Cycle_Fact",
      "name": "usp_D_House_Keeping_Cycle_Fact",
      "type": "SQL_STORED_PROCEDURE",
      "sql": "-- *************************************************************************************************    -- -------------------------------------------------------------------------------------------------    --  Revisions:    --  Date  Author Description    --  08/29/23 DEVJ2D Added comment as part of Database Deployment Automation (10206) project  -- -------------------------------------------------------------------------------------------------   -- *************************************************************************************************   CREATE   PROC [dbo].[usp_D_House_Keeping_Cycle_Fact] (@month INT = 6)  AS  BEGIN         IF(MONTH(GETDATE()) IN (3,6,9,12))         BEGIN                DECLARE @date INT = CONVERT(VARCHAR(10), DATEADD(MONTH,- @month,GETDATE()), 112)                DECLARE @PARTITION INT                  SELECT @PARTITION = $PARTITION.pf_Cycle_Fact_Function(@date)                         ALTER TABLE [dbo].[Cycle_Fact] SWITCH PARTITION (@PARTITION) TO [dbo].[Cycle_Fact_History] PARTITION (@PARTITION)         END                                                           END"
    },
    {
      "id": "VFIN_PERF_CNT_SNPSHT",
      "name": "VFIN_PERF_CNT_SNPSHT",
      "type": "VIEW",
      "sql": "CREATE VIEW [dbo].[VFIN_PERF_CNT_SNPSHT]  AS  SELECT        Tast_Stat_Cd_Dimn.Stat_Cd, Tfin_Flet_Perf_Car_Milg_Car_Cnt_Snpsht_Fact.Dt_Dimn_Id, Tfin_Flet_Perf_Car_Milg_Car_Cnt_Snpsht_Fact.Stat_Cd_Dimn_Id,                            Tfin_Flet_Perf_Car_Milg_Car_Cnt_Snpsht_Fact.Emp_Cnt, Tfin_Flet_Perf_Car_Milg_Car_Cnt_Snpsht_Fact.Load_Cnt,                            Tfin_Flet_Perf_Car_Milg_Car_Cnt_Snpsht_Fact.LE_Unknown_Cnt, Tfin_Flet_Perf_Car_Milg_Car_Cnt_Snpsht_Fact.LE_Totl_Cnt,                            Tfin_Flet_Perf_Car_Milg_Car_Cnt_Snpsht_Fact.Pltfm_Per_Car_Cnt, Tfin_Flet_Perf_Car_Milg_Car_Cnt_Snpsht_Fact.TPE_Per_Car_Cnt,                            Tfin_Flet_Perf_Car_Milg_Car_Cnt_Snpsht_Fact.TPE_Fctr, Tfin_Flet_Perf_Car_Milg_Car_Cnt_Snpsht_Fact.Car_Pltfm_Cnt_Fctr,                            Tfin_Flet_Perf_Car_Milg_Car_Cnt_Snpsht_Fact.Cars_Onln_Cnt, Tfin_Flet_Perf_Car_Milg_Car_Cnt_Snpsht_Fact.Cars_Stor_Cnt,                            Tfin_Flet_Perf_Car_Milg_Car_Cnt_Snpsht_Fact.Cars_Pd_Stor_Cnt, Tfin_Flet_Perf_Car_Milg_Car_Cnt_Snpsht_Fact.Cars_In_Shop_Cnt,                            Tfin_Flet_Perf_Car_Milg_Car_Cnt_Snpsht_Fact.Cars_Enrt_Cnt, Tfin_Flet_Perf_Car_Milg_Car_Cnt_Snpsht_Fact.Car_Hire_Rev                               FROM                 Tfin_Flet_Perf_Car_Milg_Car_Cnt_Snpsht_Fact INNER JOIN                           Tast_Stat_Cd_Dimn          ON Tfin_Flet_Perf_Car_Milg_Car_Cnt_Snpsht_Fact.Stat_Cd_Dimn_Id = Tast_Stat_Cd_Dimn.Stat_Cd_Dimn_Id         AND Tfin_Flet_Perf_Car_Milg_Car_Cnt_Snpsht_Fact.Dt_Dimn_Id >= CONVERT(CHAR(8),[Stat_Cd_Eff_Strt_Dt],112)         AND Tfin_Flet_Perf_Car_Milg_Car_Cnt_Snpsht_Fact.Dt_Dimn_Id < isnull(CONVERT(CHAR(8),[Stat_Cd_Eff_End_Dt],112),'99991231')"
    },
    {
      "id": "VMRT_Car_Hierarchy_Equipment",
      "name": "VMRT_Car_Hierarchy_Equipment",
      "type": "VIEW",
      "sql": "CREATE VIEW [dbo].[VMRT_Car_Hierarchy_Equipment]   With schemabinding  as  SELECT [Hierchy_Id]  ,[Hierchy_Ver]  ,cast(REPLACE(REPLACE(REPLACE([Lvl1_Desc], CHAR(13), ''), CHAR(10), ''), CHAR(9), '')     as varchar(50)) as Bus_Ln_Desc  ,cast(REPLACE(REPLACE(REPLACE([Lvl2_Desc], CHAR(13), ''), CHAR(10), ''), CHAR(9), '')     as varchar(50)) as Eq_Typ_Desc  ,cast(REPLACE(REPLACE(REPLACE([Lvl3_Desc], CHAR(13), ''), CHAR(10), ''), CHAR(9), '')     as varchar(50)) as Eq_Char  ,cast(REPLACE(REPLACE(REPLACE([Lvl4_Desc], CHAR(13), ''), CHAR(10), ''), CHAR(9), '')     as varchar(50)) as TTX_Eq_Cd_Desc  ,cast(REPLACE(REPLACE(REPLACE(convert(varchar(5), lvl4_Nm), CHAR(13), ''), CHAR(10), ''), CHAR(9), '') as varchar(50)) as TTX_Eq_Cd   ,eff_from, eff_to   ,Crtd_Dt,Crtd_Id   ,Lst_Upd_Dt,Lst_Upd_Id   FROM dbo.[Hierarchy_Dim] (NOLOCK)    WHERE [Hierchy_Typ_Id]=102"
    },
    {
      "id": "Material",
      "name": "Material",
      "type": "VIEW",
      "sql": "CREATE VIEW [SV].[Material]  (  Matl_Dimn_id,  Reference_Number,  Reference_Number_Description,  Trackable_Material_Flag,  Category_Code,  Category_Code_Description,  Universal_Item_Number,  Universal_Item_Number_Description)  AS  SELECT  Material_Dim.Matl_Dimn_id,   Material_Dim.Ref_Nr,   Material_Dim.Ref_Nr_Desc,   Material_Dim.Tksl_Matl_Flg,   Material_Dim.Catg_Cd,   Material_Dim.Catg_Cd_Desc,   Matl_Prnt_Ref_Nbr,   Matl_Prnt_Desc  FROM Material_Dim (NOLOCK)"
    },
    {
      "id": "VMRT_Revenue_Accounting_Accrual_Car_Hire_Revenue",
      "name": "VMRT_Revenue_Accounting_Accrual_Car_Hire_Revenue",
      "type": "VIEW",
      "sql": "CREATE view [dbo].[VMRT_Revenue_Accounting_Accrual_Car_Hire_Revenue] as  select  od.org_abrv as Liable_Abrv,   llo_d.org_abrv as Last_Liable_Member_Abrv,   dt.dt as Date,   rev_h.Revenue_Service_Code ,  rev_h.Revenue_Service_Code_Short_Desc as Revenue_Service_Code_Short_Description,   rev_h.Car_Hire_Subgroup as Car_Hire_Subgroup ,   rev_h.Car_Hire_Group as Car_Hire_Grouping,  rev_h.Is_In_Service as Is_In_Service,   ent.Stat_Cd as Stat_Code,   ent.Eq_Typ_Shrt_Desc as Equipment_Type_Short_Desc,   ent.bus_Ln_Shrt_Desc as Business_Line_Shrt_Desc,  ent.TPE_Fctr as TPE_Factor,   ent.Ut_Cnt as Unit_Count,  rev.Ernd_Hrs_Cnt as Earned_Hours,  rev.Car_Hire_Rev_Amt as Car_Hire_Revenue,   rev.Tot_Milg as Total_Mileage,  rev.Milg_Rev_Amt as Mileage_Revenue,   rev.Whl_Schg_Rev_Amt as Wheel_Surcharge_Revenue,  rev.Ernd_Hrs_Cnt / (dt.Num_Day_Mth * 24.0) as Average_Cars_Count,  rev.Ernd_Hrs_Cnt * ent.TPE_Fctr / (dt.Num_Day_Mth * 24.0) as Average_TPE_Count,  rev.Ernd_Hrs_Cnt * ent.Ut_Cnt / (dt.Num_Day_Mth * 24.0) as Average_Ut_Count,  ent.Milg_Rt as Mileage_Rate,   ent.Milg_Rt_Whl_Schg as Wheel_Surchage_Rate,  ent.car_hrly_Rt as Car_Hourly_Rate,  inct.Description as Incentive_Program,   inct.inctv_typ as Incentive_Type,  Incentive_Deduction as Incentive_Deduction,  rev.Org_Mbrshp_Dimn_Id as Liable_Road_Org_Mbrshp_Dimn_Id,   rev.Org_Mbrshp_Ver as Liable_Road_Org_Mbrshp_Ver,   od.Org_Dimn_Id as Last_Liable_Org_Id,  od.Org_Ver as Last_Liable_Org_Ver,  llo_d.Org_Dimn_Id as Last_Liable_Mem_Id,  rev.Mth_Beg_Dt_Dimn_Id as Date_Dimn_Id,  rev.Rev_Hierchy_Id as Revenue_Hierchy_Id,   rev.Rev_Hierchy_Ver as Revenue_Hierchy_Ver,    rev.Entr_Hierchy_Id as Enterprise_Hierchy_Id,  rev.Entr_Hierchy_Ver as Enterprise_Hierchy_Ver,  rev.Inctv_Dimn_Id as Incentive_Dim_Id   from   ddsmrt.dbo.Car_Hire_Revenue_Fact (NOLOCK) rev  left join ddsmrt.dbo.Organization_Membership_dim (NOLOCK) mem1 on (rev.Org_Mbrshp_Dimn_Id = mem1.[Org_Mbrshp_Dimn_Id] and rev.Org_Mbrshp_Ver = mem1.[Org_Mbrshp_Ver])  left join ddsmrt.dbo.Vmrt_Organization_Dimension (NOLOCK) od on od.org_dimn_id = mem1.Org_Dimn_Id and od.Org_Ver = mem1.org_ver  left join ddsmrt.dbo.Vmrt_Organization_Dimension (NOLOCK) llo_d on llo_d.org_dimn_id = rev.lst_lbl_ownr and llo_d.eff_to is null  left join ddsmrt.dbo.Vmrt_Revenue_Hierarchy rev_h (NOLOCK) on rev.rev_hierchy_id = rev_h.hierchy_id and rev.rev_hierchy_ver = rev_h.hierchy_ver  left join ddsmrt.dbo.vmrt_car_hierarchy_enterprise ent on ent.hierchy_id = rev.entr_hierchy_id and ent.hierchy_ver = rev.entr_hierchy_ver  inner join ddsmrt.dbo.date_dim dt on rev.Mth_Beg_Dt_Dimn_Id = dt.dt_dimn_id   left join incentive_dim inct on inct.inctv_dimn_id = rev.inctv_dimn_id  WHERE rev.typ_id = 157  --this set it to Accrual"
    },
    {
      "id": "VMRT_Car_Hierarchy_Fleet",
      "name": "VMRT_Car_Hierarchy_Fleet",
      "type": "VIEW",
      "sql": "CREATE VIEW [dbo].[VMRT_Car_Hierarchy_Fleet]   WITH SCHEMABINDING  AS  SELECT [Hierarchy_Dim].[Hierchy_Id] as [Hierchy_Id]  ,[Hierchy_Ver] as [Hierchy_Ver]  ,cast(Lvl3_Nm as int) as [Fleet_Segment]  ,[Lvl3_Desc] as [Fleet_Segment_Description]  ,cast(Lvl2_Nm as int) as Equipment_Group  ,[Lvl2_Desc] as Equipment_Type_Description  , cast(Lvl1_Nm as int) as Bus_Ln  ,[Lvl1_Desc] as Business_Line_Description  , eff_from  , eff_to  ,Crtd_Dt  ,Crtd_Id  ,Lst_Upd_Dt  ,Lst_Upd_Id   FROM dbo.[Hierarchy_Dim] (NOLOCK)    WHERE [Hierchy_Typ_Id]=103"
    },
    {
      "id": "VMRT_Revenue_Accounting_Accrual_Car_Hire_Revenue_Pivot",
      "name": "VMRT_Revenue_Accounting_Accrual_Car_Hire_Revenue_Pivot",
      "type": "VIEW",
      "sql": "-- get the entries which are online and join them with the entries of not online (pivot those entries)  CREATE view [dbo].[VMRT_Revenue_Accounting_Accrual_Car_Hire_Revenue_Pivot] as  select      od.org_abrv as Liable_Abrv     , llo_d.org_abrv as Last_Liable_Owner_Abrv     , dt.dt as Date     , ent.Stat_Cd as Stat_Code     , ent.Eq_Typ_Shrt_Desc as Equipment_Type_Short_Desc     , ent.bus_Ln_Shrt_Desc as Business_Line_Shrt_Desc     , ent.TPE_Fctr as TPE_Factor     , ent.Ut_Cnt as Unit_Count     , rev.Car_Hire_Rev_Amt as Car_Hire_Revenue     , rev.Tot_Milg as Total_Mileage     , rev.Milg_Rev_Amt as Mileage_Revenue     , rev.Whl_Schg_Rev_Amt as Wheel_Surcharge_Revenue     , ent.Milg_Rt as Mileage_Rate     , ent.Milg_Rt_Whl_Schg as Wheel_Surchage_Rate     , ent.car_hrly_Rt as Car_Hourly_Rate     , inct.Description as Incentive_Program     , inct.inctv_typ as Incentive_Type     , Incentive_Deduction as Incentive_Deduction     , rev.Ernd_Hrs_Cnt as Online_Hours     , rev.Ernd_Hrs_Cnt / (dt.Num_Day_Mth * 24.0) as Online_Cars_Count     , rev.Ernd_Hrs_Cnt * ent.TPE_Fctr / (dt.Num_Day_Mth * 24.0) as Online_TPE_Count     , rev.Ernd_Hrs_Cnt * ent.Ut_Cnt / (dt.Num_Day_Mth * 24.0) as Online_Ut_Count     , [ENRT] as ENRT_Hours     , [ENRT] / (dt.Num_Day_Mth * 24.0) as ENRT_Cars_Count     , [ENRT] * ent.TPE_Fctr / (dt.Num_Day_Mth * 24.0) as ENRT_TPE_Count     , [ENRT] * ent.Ut_Cnt / (dt.Num_Day_Mth * 24.0) as ENRT_Ut_Count     , [FMO] as FMO_Hours     , [FMO] / (dt.Num_Day_Mth * 24.0) as FMO_Cars_Count     , [FMO] * ent.TPE_Fctr / (dt.Num_Day_Mth * 24.0) as FMO_TPE_Count     , [FMO] * ent.Ut_Cnt / (dt.Num_Day_Mth * 24.0) as FMO_Ut_Count     , [RELF] as RELF_Hours     , [RELF] / (dt.Num_Day_Mth * 24.0) as RELF_Cars_Count     , [RELF] * ent.TPE_Fctr / (dt.Num_Day_Mth * 24.0) as RELF_TPE_Count     , [RELF] * ent.Ut_Cnt / (dt.Num_Day_Mth * 24.0) as RELF_Ut_Count     , [REOL] as REOL_Hours     , [REOL] / (dt.Num_Day_Mth * 24.0) as REOL_Cars_Count     , [REOL] * ent.TPE_Fctr / (dt.Num_Day_Mth * 24.0) as REOL_TPE_Count     , [REOL] * ent.Ut_Cnt / (dt.Num_Day_Mth * 24.0) as REOL_Ut_Count     , [SHOP] as SHOP_Hours     , [SHOP] / (dt.Num_Day_Mth * 24.0) as SHOP_Cars_Count     , [SHOP] * ent.TPE_Fctr / (dt.Num_Day_Mth * 24.0) as SHOP_TPE_Count     , [SHOP] * ent.Ut_Cnt / (dt.Num_Day_Mth * 24.0) as SHOP_Ut_Count     , [STBO] as STBO_Hours     , [STBO] / (dt.Num_Day_Mth * 24.0) as STBO_Cars_Count     , [STBO] * ent.TPE_Fctr / (dt.Num_Day_Mth * 24.0) as STBO_TPE_Count     , [STBO] * ent.Ut_Cnt / (dt.Num_Day_Mth * 24.0) as STBO_Ut_Count     , [STOR] as STOR_Hours     , [STOR] / (dt.Num_Day_Mth * 24.0) as STOR_Cars_Count     , [STOR] * ent.TPE_Fctr / (dt.Num_Day_Mth * 24.0) as STOR_TPE_Count     , [STOR] * ent.Ut_Cnt / (dt.Num_Day_Mth * 24.0) as STOR_Ut_Count     , [ZERO] as ZERO_Hours     , [ZERO] / (dt.Num_Day_Mth * 24.0) as ZERO_Cars_Count     , [ZERO] * ent.TPE_Fctr / (dt.Num_Day_Mth * 24.0) as ZERO_TPE_Count     , [ZERO] * ent.Ut_Cnt / (dt.Num_Day_Mth * 24.0) as ZERO_Ut_Count  from      ddsmrt.dbo.car_hire_revenue_fact (NOLOCK) rev   left join ddsmrt.dbo.Vmrt_Revenue_Hierarchy (NOLOCK) rev_h       on  rev.rev_hierchy_id = rev_h.hierchy_id           and rev.rev_hierchy_ver = rev_h.hierchy_ver  full outer join      ( select           Org_Mbrshp_Dimn_Id         , Org_Mbrshp_Ver         , Entr_Hierchy_Id         , Entr_Hierchy_Ver         , Mth_Beg_Dt_Dimn_Id         , lst_lbl_ownr         , typ_id         , [ENRT]         , [FMO]         , [RELF]         , [REOL]         , [SHOP]         , [STBO]         , [STOR]         , [ZERO]      from           ( select               Org_Mbrshp_Dimn_Id             , Org_Mbrshp_Ver             , Entr_Hierchy_Id             , Entr_Hierchy_Ver             , Mth_Beg_Dt_Dimn_Id             , lst_lbl_ownr             , ernd_hrs_cnt             , revenue_service_code             , typ_id          from               ddsmrt.dbo.car_hire_revenue_fact (NOLOCK) rev_oos          left join ddsmrt.dbo.Vmrt_Revenue_Hierarchy (NOLOCK) rev_h_oos              on  rev_oos.rev_hierchy_id = rev_h_oos.hierchy_id                   and rev_oos.rev_hierchy_ver = rev_h_oos.hierchy_ver          where               revenue_service_code <> 'ONLN'           ) as SourceTable PIVOT (SUM(ernd_hrs_cnt) FOR revenue_service_code in ([ENRT], [FMO], [RELF], [REOL]                                                                                , [SHOP], [STBO], [STOR], [ZERO]) ) as PivotTable       ) as OOSCars       on  OOSCars.Org_Mbrshp_Dimn_Id = rev.Org_Mbrshp_Dimn_Id           and OOSCars.Org_Mbrshp_Ver = rev.Org_Mbrshp_Ver          AND OOSCars.Entr_Hierchy_Id = rev.Entr_Hierchy_Id           and OOSCars.Entr_Hierchy_Ver = rev.Entr_Hierchy_Ver          AND OOSCars.Mth_Beg_Dt_Dimn_Id = Rev.Mth_Beg_Dt_Dimn_Id          AND OOSCars.lst_lbl_ownr= rev.lst_lbl_ownr          AND OOSCars.typ_id = rev.typ_id    and rev_h.revenue_service_code = 'ONLN'  left join ddsmrt.dbo.Organization_Membership_dim (NOLOCK) mem1       on  coalesce(rev.Org_Mbrshp_Dimn_Id, OOSCars.Org_Mbrshp_Dimn_Id ) = mem1.Org_Mbrshp_Dimn_Id          and coalesce(rev.Org_Mbrshp_Ver,OOSCars.Org_Mbrshp_Ver) = mem1.Org_Mbrshp_Ver  left join ddsmrt.dbo.vmrt_organization_dimension (NOLOCK) od       on  od.org_dimn_id = mem1.Org_Dimn_Id           and od.Org_Ver = mem1.org_ver  left join ddsmrt.dbo.vmrt_organization_dimension (NOLOCK) llo_d       on  llo_d.org_dimn_id = coalesce(rev.lst_lbl_ownr,OOSCars.lst_lbl_ownr)           and llo_d.eff_to is null  left join ddsmrt.dbo.vmrt_car_hierarchy_enterprise (NOLOCK) ent       on  ent.hierchy_id = coalesce(rev.entr_hierchy_id, OOSCars.entr_hierchy_id)           and ent.hierchy_ver = coalesce(rev.entr_hierchy_ver, OOSCars.entr_hierchy_ver)  left join ddsmrt.dbo.incentive_dim inct       on  inct.inctv_dimn_id = rev.inctv_dimn_id  inner join ddsmrt.dbo.date_dim dt       on  coalesce(rev.Mth_Beg_Dt_Dimn_Id, OOSCars.Mth_Beg_Dt_Dimn_Id) = dt.dt_dimn_id  WHERE       coalesce(rev.typ_id, OOSCars.typ_id) = 157 --this set it to Accrual      and coalesce (rev_h.revenue_service_code, 'ONLN') = 'ONLN'"
    },
    {
      "id": "Car_Correct",
      "name": "Car_Correct",
      "type": "VIEW",
      "sql": "CREATE VIEW [SV].[Car_Correct]      AS      SELECT c1.car_dimn_id,             c1.car_ver,             c1.car_nr AS Car_Number,             c1.car_init AS Car_Initial,             c1.car_status_ufd,             c1.car_status_maximo,             c1.car_cls AS Car_Class,             c1.ttx_eff_dt AS TTX_Effective_Date,             c1.car_ownrshp_ind AS Car_Ownership_Ind,             c1.pool_cd AS Pool_Code,             c1.ttx_mngd_car_ind AS TTX_Managed_Car_Ind,             c1.umler_blt_dt AS Umler_Built_Date,             c1.eq_bldr AS Eq_Builder_Name,             c1.bldr_lot_cd AS Builder_Lot_Code,             c1.eq_hierchy_id,             c1.eq_hierchy_ver,             CONCAT(c1.ttx_eq_cd, ' ', c1.ttx_eq_cd_desc) AS TTX_Eq_Cd,             c1.eq_char AS Equipment_Characteristics,             c1.fleet_hierchy_id,             c1.fleet_hierchy_ver,             c1.Fleet_Segment_Description,             c1.entr_hierchy_id,             c1.entr_hierchy_ver,             c1.Stat_Code,             c1.Equipment_Feature,             c1.Equipment_Type,             c1.Business_Line,             c1.ownr_mrk AS Owner_Mark,             c1.Pltfm_Fctr AS Platform_Factor,             c1.axl_cnt AS Axle_Count,             c1.TPE_Fctr AS TPE_Factor,             c1.ut_cnt AS Unit_Count,             c1.trk_axl_cnt AS Truck_Count,             c1.eq_typ_cd AS Equipment_Type_Code,             c1.intmdit_connt_styl AS Intermediate_Conn_Style,             c1.ttx_eq_cd_desc AS TTX_Equipment_Description,             c1.[insd_len] AS Insd_Pltfm_Len,             c1.insd_len / 12 AS Insd_Len,             c1.osid_len / 12 AS Osid_Len,         c1.Eshift_Business_Line,        c1.Eshift_Equipment_Feature,        c1.Eshift_Equipment_Type,        c1.Eshift_Stat_Code,        c1.Eshift_Total_Line_Of_Business,    c1.Eshift_Oracle_Lob,      c1.Eshift_Hierchy_Id,        c1.Eshift_Hierchy_Ver,           c1.car_eff_from,             c1.car_eff_to,             c1.s_str_ownr AS Rack_Owner, -- Added as part of ticket IR520420             c1.Car_Health_Rating,             car2.Current_Car_Health_Rating,        c1.assetnum AS Assetnum ,        -- Added as part of IR742864  ,        c1.car_grd,        c1.car_grd_dt ,   c1.Lessor,   c1.Lease_number,   c1.Maintenance_Terms,   c1.Lease_Termination_Date,   c1.Lese_Cd        -- Added as part of ticket RITM0018706    FROM [dbo].[VMRT_Car_Dimension_Correct] c1          INNER JOIN          (              SELECT dset.car_dimn_id,                     dset.Car_Health_Rating AS 'Current_Car_Health_Rating'              FROM              (                  SELECT car_dimn_id,                         car_ver,                         Car_Health_Rating,                         ROW_NUMBER() OVER (PARTITION BY car_dimn_id ORDER BY car_dimn_id, car_ver DESC) AS 'RowNum'                  FROM [dbo].[VMRT_Car_Dimension_Correct]              ) dset              WHERE dset.RowNum = 1          ) car2              ON car2.car_dimn_id = c1.car_dimn_id;"
    },
    {
      "id": "VMRT_Revenue_Accounting_Actual_Car_Hire_Revenue",
      "name": "VMRT_Revenue_Accounting_Actual_Car_Hire_Revenue",
      "type": "VIEW",
      "sql": "CREATE view [dbo].[VMRT_Revenue_Accounting_Actual_Car_Hire_Revenue] as    select  od.org_abrv as Liable_Abrv,   llo_d.org_abrv as Last_Liable_Member_Abrv,   dt.dt as Date,   rev_h.Revenue_Service_Code ,  rev_h.Revenue_Service_Code_Short_Desc as Revenue_Service_Code_Short_Description,   rev_h.Car_Hire_Subgroup as Car_Hire_Subgroup ,   rev_h.Car_Hire_Group as Car_Hire_Grouping,  rev_h.Is_In_Service as Is_In_Service,   ent.Stat_Cd as Stat_Code,   ent.Eq_Typ_Shrt_Desc as Equipment_Type_Short_Desc,   ent.bus_Ln_Shrt_Desc as Business_Line_Shrt_Desc,  ent.TPE_Fctr as TPE_Factor,   ent.Ut_Cnt as Unit_Count,  rev.Ernd_Hrs_Cnt as Earned_Hours,  rev.Car_Hire_Rev_Amt as Car_Hire_Revenue,   rev.Tot_Milg as Total_Mileage,  rev.Milg_Rev_Amt as Mileage_Revenue,   rev.Whl_Schg_Rev_Amt as Wheel_Surcharge_Revenue,  rev.Ernd_Hrs_Cnt / (dt.Num_Day_Mth * 24.0) as Average_Cars_Count,  rev.Ernd_Hrs_Cnt * ent.TPE_Fctr / (dt.Num_Day_Mth * 24.0) as Average_TPE_Count,  rev.Ernd_Hrs_Cnt * ent.Ut_Cnt / (dt.Num_Day_Mth * 24.0) as Average_Ut_Count,  ent.Milg_Rt as Mileage_Rate,   ent.Milg_Rt_Whl_Schg as Wheel_Surchage_Rate,  ent.car_hrly_Rt as Car_Hourly_Rate,  inct.Description as Incentive_Program,   inct.inctv_typ as Incentive_Type,  Incentive_Deduction as Incentive_Deduction,  rev.Org_Mbrshp_Dimn_Id as Liable_Road_Org_Mbrshp_Dimn_Id,   rev.Org_Mbrshp_Ver as Liable_Road_Org_Mbrshp_Ver,   od.Org_Dimn_Id as Last_Liable_Org_Id,  od.Org_Ver as Last_Liable_Org_Ver,  llo_d.Org_Dimn_Id as Last_Liable_Mem_Id,  rev.Mth_Beg_Dt_Dimn_Id as Date_Dimn_Id,  rev.Rev_Hierchy_Id as Revenue_Hierchy_Id,   rev.Rev_Hierchy_Ver as Revenue_Hierchy_Ver,    rev.Entr_Hierchy_Id as Enterprise_Hierchy_Id,  rev.Entr_Hierchy_Ver as Enterprise_Hierchy_Ver,  rev.Inctv_Dimn_Id as Incentive_Dim_Id   from   ddsmrt.dbo.Car_Hire_Revenue_Fact (NOLOCK) rev  left join ddsmrt.dbo.Organization_Membership_dim (NOLOCK) mem1 on (rev.Org_Mbrshp_Dimn_Id = mem1.[Org_Mbrshp_Dimn_Id] and rev.Org_Mbrshp_Ver = mem1.[Org_Mbrshp_Ver])  left join ddsmrt.dbo.Vmrt_Organization_Dimension (NOLOCK) od on od.org_dimn_id = mem1.Org_Dimn_Id and od.Org_Ver = mem1.org_ver  left join ddsmrt.dbo.Vmrt_Organization_Dimension (NOLOCK) llo_d on llo_d.org_dimn_id = rev.lst_lbl_ownr and llo_d.eff_to is null  left join ddsmrt.dbo.Vmrt_Revenue_Hierarchy rev_h (NOLOCK) on rev.rev_hierchy_id = rev_h.hierchy_id and rev.rev_hierchy_ver = rev_h.hierchy_ver  left join ddsmrt.dbo.vmrt_car_hierarchy_enterprise ent on ent.hierchy_id = rev.entr_hierchy_id and ent.hierchy_ver = rev.entr_hierchy_ver  inner join ddsmrt.dbo.date_dim dt on rev.Mth_Beg_Dt_Dimn_Id = dt.dt_dimn_id   left join incentive_dim inct on inct.inctv_dimn_id = rev.inctv_dimn_id  WHERE rev.typ_id = 158  --this set it to Actual"
    },
    {
      "id": "VMRT_Revenue_Accounting_Actual_Car_Hire_Revenue_Pivot",
      "name": "VMRT_Revenue_Accounting_Actual_Car_Hire_Revenue_Pivot",
      "type": "VIEW",
      "sql": "-- get the entries which are online and join them with the entries of not online (pivot those entries)  CREATE view [dbo].[VMRT_Revenue_Accounting_Actual_Car_Hire_Revenue_Pivot] as  select      od.org_abrv as Liable_Abrv     , llo_d.org_abrv as Last_Liable_Owner_Abrv     , dt.dt as Date     , ent.Stat_Cd as Stat_Code     , ent.Eq_Typ_Shrt_Desc as Equipment_Type_Short_Desc     , ent.bus_Ln_Shrt_Desc as Business_Line_Shrt_Desc     , ent.TPE_Fctr as TPE_Factor     , ent.Ut_Cnt as Unit_Count     , rev.Car_Hire_Rev_Amt as Car_Hire_Revenue     , rev.Tot_Milg as Total_Mileage     , rev.Milg_Rev_Amt as Mileage_Revenue     , rev.Whl_Schg_Rev_Amt as Wheel_Surcharge_Revenue     , ent.Milg_Rt as Mileage_Rate     , ent.Milg_Rt_Whl_Schg as Wheel_Surchage_Rate     , ent.car_hrly_Rt as Car_Hourly_Rate     , inct.Description as Incentive_Program     , inct.inctv_typ as Incentive_Type     , Incentive_Deduction as Incentive_Deduction     , rev.Ernd_Hrs_Cnt as Online_Hours     , rev.Ernd_Hrs_Cnt / (dt.Num_Day_Mth * 24.0) as Online_Cars_Count     , rev.Ernd_Hrs_Cnt * ent.TPE_Fctr / (dt.Num_Day_Mth * 24.0) as Online_TPE_Count     , rev.Ernd_Hrs_Cnt * ent.Ut_Cnt / (dt.Num_Day_Mth * 24.0) as Online_Ut_Count     , [ENRT] as ENRT_Hours     , [ENRT] / (dt.Num_Day_Mth * 24.0) as ENRT_Cars_Count     , [ENRT] * ent.TPE_Fctr / (dt.Num_Day_Mth * 24.0) as ENRT_TPE_Count     , [ENRT] * ent.Ut_Cnt / (dt.Num_Day_Mth * 24.0) as ENRT_Ut_Count     , [FMO] as FMO_Hours     , [FMO] / (dt.Num_Day_Mth * 24.0) as FMO_Cars_Count     , [FMO] * ent.TPE_Fctr / (dt.Num_Day_Mth * 24.0) as FMO_TPE_Count     , [FMO] * ent.Ut_Cnt / (dt.Num_Day_Mth * 24.0) as FMO_Ut_Count     , [RELF] as RELF_Hours     , [RELF] / (dt.Num_Day_Mth * 24.0) as RELF_Cars_Count     , [RELF] * ent.TPE_Fctr / (dt.Num_Day_Mth * 24.0) as RELF_TPE_Count     , [RELF] * ent.Ut_Cnt / (dt.Num_Day_Mth * 24.0) as RELF_Ut_Count     , [REOL] as REOL_Hours     , [REOL] / (dt.Num_Day_Mth * 24.0) as REOL_Cars_Count     , [REOL] * ent.TPE_Fctr / (dt.Num_Day_Mth * 24.0) as REOL_TPE_Count     , [REOL] * ent.Ut_Cnt / (dt.Num_Day_Mth * 24.0) as REOL_Ut_Count     , [SHOP] as SHOP_Hours     , [SHOP] / (dt.Num_Day_Mth * 24.0) as SHOP_Cars_Count     , [SHOP] * ent.TPE_Fctr / (dt.Num_Day_Mth * 24.0) as SHOP_TPE_Count     , [SHOP] * ent.Ut_Cnt / (dt.Num_Day_Mth * 24.0) as SHOP_Ut_Count     , [STBO] as STBO_Hours     , [STBO] / (dt.Num_Day_Mth * 24.0) as STBO_Cars_Count     , [STBO] * ent.TPE_Fctr / (dt.Num_Day_Mth * 24.0) as STBO_TPE_Count     , [STBO] * ent.Ut_Cnt / (dt.Num_Day_Mth * 24.0) as STBO_Ut_Count     , [STOR] as STOR_Hours     , [STOR] / (dt.Num_Day_Mth * 24.0) as STOR_Cars_Count     , [STOR] * ent.TPE_Fctr / (dt.Num_Day_Mth * 24.0) as STOR_TPE_Count     , [STOR] * ent.Ut_Cnt / (dt.Num_Day_Mth * 24.0) as STOR_Ut_Count     , [ZERO] as ZERO_Hours     , [ZERO] / (dt.Num_Day_Mth * 24.0) as ZERO_Cars_Count     , [ZERO] * ent.TPE_Fctr / (dt.Num_Day_Mth * 24.0) as ZERO_TPE_Count     , [ZERO] * ent.Ut_Cnt / (dt.Num_Day_Mth * 24.0) as ZERO_Ut_Count  from      ddsmrt.dbo.car_hire_revenue_fact (NOLOCK) rev   left join ddsmrt.dbo.Vmrt_Revenue_Hierarchy (NOLOCK) rev_h       on  rev.rev_hierchy_id = rev_h.hierchy_id           and rev.rev_hierchy_ver = rev_h.hierchy_ver  full outer join      ( select           Org_Mbrshp_Dimn_Id         , Org_Mbrshp_Ver         , Entr_Hierchy_Id         , Entr_Hierchy_Ver         , Mth_Beg_Dt_Dimn_Id         , lst_lbl_ownr         , typ_id         , [ENRT]         , [FMO]         , [RELF]         , [REOL]         , [SHOP]         , [STBO]         , [STOR]         , [ZERO]      from           ( select               Org_Mbrshp_Dimn_Id             , Org_Mbrshp_Ver             , Entr_Hierchy_Id             , Entr_Hierchy_Ver             , Mth_Beg_Dt_Dimn_Id             , lst_lbl_ownr             , ernd_hrs_cnt             , revenue_service_code             , typ_id          from               ddsmrt.dbo.car_hire_revenue_fact (NOLOCK) rev_oos          left join ddsmrt.dbo.Vmrt_Revenue_Hierarchy (NOLOCK) rev_h_oos              on  rev_oos.rev_hierchy_id = rev_h_oos.hierchy_id                   and rev_oos.rev_hierchy_ver = rev_h_oos.hierchy_ver          where               revenue_service_code <> 'ONLN'           ) as SourceTable PIVOT (SUM(ernd_hrs_cnt) FOR revenue_service_code in ([ENRT], [FMO], [RELF], [REOL]                                                                                , [SHOP], [STBO], [STOR], [ZERO]) ) as PivotTable       ) as OOSCars       on  OOSCars.Org_Mbrshp_Dimn_Id = rev.Org_Mbrshp_Dimn_Id           and OOSCars.Org_Mbrshp_Ver = rev.Org_Mbrshp_Ver          AND OOSCars.Entr_Hierchy_Id = rev.Entr_Hierchy_Id           and OOSCars.Entr_Hierchy_Ver = rev.Entr_Hierchy_Ver          AND OOSCars.Mth_Beg_Dt_Dimn_Id = Rev.Mth_Beg_Dt_Dimn_Id          AND OOSCars.lst_lbl_ownr= rev.lst_lbl_ownr          AND OOSCars.typ_id = rev.typ_id    and rev_h.revenue_service_code = 'ONLN'  left join ddsmrt.dbo.Organization_Membership_dim (NOLOCK) mem1       on  coalesce(rev.Org_Mbrshp_Dimn_Id, OOSCars.Org_Mbrshp_Dimn_Id ) = mem1.Org_Mbrshp_Dimn_Id          and coalesce(rev.Org_Mbrshp_Ver,OOSCars.Org_Mbrshp_Ver) = mem1.Org_Mbrshp_Ver  left join ddsmrt.dbo.vmrt_organization_dimension (NOLOCK) od       on  od.org_dimn_id = mem1.Org_Dimn_Id           and od.Org_Ver = mem1.org_ver  left join ddsmrt.dbo.vmrt_organization_dimension (NOLOCK) llo_d       on  llo_d.org_dimn_id = coalesce(rev.lst_lbl_ownr,OOSCars.lst_lbl_ownr)           and llo_d.eff_to is null  left join ddsmrt.dbo.vmrt_car_hierarchy_enterprise (NOLOCK) ent       on  ent.hierchy_id = coalesce(rev.entr_hierchy_id, OOSCars.entr_hierchy_id)           and ent.hierchy_ver = coalesce(rev.entr_hierchy_ver, OOSCars.entr_hierchy_ver)  left join ddsmrt.dbo.incentive_dim inct       on  inct.inctv_dimn_id = rev.inctv_dimn_id  inner join ddsmrt.dbo.date_dim dt       on  coalesce(rev.Mth_Beg_Dt_Dimn_Id, OOSCars.Mth_Beg_Dt_Dimn_Id) = dt.dt_dimn_id  WHERE       coalesce(rev.typ_id, OOSCars.typ_id) = 158 --this set it to Accrual      and coalesce (rev_h.revenue_service_code, 'ONLN') = 'ONLN'"
    },
    {
      "id": "Work_Type_Dim",
      "name": "Work_Type_Dim",
      "type": "VIEW",
      "sql": "CREATE VIEW [sv].[Work_Type_Dim]  AS  SELECT Wrk_Typ_Dimn_Id,  Wrk_Typ_Lvl_1_Desc,  Wrk_Typ_Lvl_2_Desc,  Cond_Based_Mnt_Flg  FROM dbo.Work_Type_Dim (NOLOCK)"
    },
    {
      "id": "VMRT_Organization_Dimension",
      "name": "VMRT_Organization_Dimension",
      "type": "VIEW",
      "sql": "CREATE VIEW [dbo].[VMRT_Organization_Dimension]  AS  SELECT Organization_Dim.Org_Dimn_Id     ,Organization_Dim.Org_Ver     ,Organization_Dim.Org_Abrv as Org_Abrv     ,Organization_Dim.Org_Nm as Org_Nm     ,Organization_Dim.Pty_Id     ,Organization_Dim.eff_From     ,Organization_Dim.eff_to     FROM ddsmrt.dbo.Organization_Dim (NOLOCK)       where Organization_Dim.Row_Typ_Id=501   or org_abrv = 'UNKN'"
    },
    {
      "id": "VMRT_Revenue_Accounting_Estimated_Car_Hire_Revenue",
      "name": "VMRT_Revenue_Accounting_Estimated_Car_Hire_Revenue",
      "type": "VIEW",
      "sql": "CREATE view [dbo].[VMRT_Revenue_Accounting_Estimated_Car_Hire_Revenue] as    select  od.org_abrv as Liable_Abrv,   llo_d.org_abrv as Last_Liable_Member_Abrv,   dt.dt as Date,   rev_h.Revenue_Service_Code ,  rev_h.Revenue_Service_Code_Short_Desc as Revenue_Service_Code_Short_Description,   rev_h.Car_Hire_Subgroup as Car_Hire_Subgroup ,   rev_h.Car_Hire_Group as Car_Hire_Grouping,  rev_h.Is_In_Service as Is_In_Service,   ent.Stat_Cd as Stat_Code,   ent.Eq_Typ_Shrt_Desc as Equipment_Type_Short_Desc,   ent.bus_Ln_Shrt_Desc as Business_Line_Shrt_Desc,  ent.TPE_Fctr as TPE_Factor,   ent.Ut_Cnt as Unit_Count,  rev.Ernd_Hrs_Cnt as Earned_Hours,  rev.Car_Hire_Rev_Amt as Car_Hire_Revenue,   rev.Tot_Milg as Total_Mileage,  rev.Milg_Rev_Amt as Mileage_Revenue,   rev.Whl_Schg_Rev_Amt as Wheel_Surcharge_Revenue,  rev.Ernd_Hrs_Cnt / (dt.Num_Day_Mth * 24.0) as Average_Cars_Count,  rev.Ernd_Hrs_Cnt * ent.TPE_Fctr / (dt.Num_Day_Mth * 24.0) as Average_TPE_Count,  rev.Ernd_Hrs_Cnt * ent.Ut_Cnt / (dt.Num_Day_Mth * 24.0) as Average_Ut_Count,  ent.Milg_Rt as Mileage_Rate,   ent.Milg_Rt_Whl_Schg as Wheel_Surchage_Rate,  ent.car_hrly_Rt as Car_Hourly_Rate,  inct.Description as Incentive_Program,   inct.inctv_typ as Incentive_Type,  Incentive_Deduction as Incentive_Deduction,  rev.Org_Mbrshp_Dimn_Id as Liable_Road_Org_Mbrshp_Dimn_Id,   rev.Org_Mbrshp_Ver as Liable_Road_Org_Mbrshp_Ver,   od.Org_Dimn_Id as Last_Liable_Org_Id,  od.Org_Ver as Last_Liable_Org_Ver,  llo_d.Org_Dimn_Id as Last_Liable_Mem_Id,  rev.Mth_Beg_Dt_Dimn_Id as Date_Dimn_Id,  rev.Rev_Hierchy_Id as Revenue_Hierchy_Id,   rev.Rev_Hierchy_Ver as Revenue_Hierchy_Ver,    rev.Entr_Hierchy_Id as Enterprise_Hierchy_Id,  rev.Entr_Hierchy_Ver as Enterprise_Hierchy_Ver,  rev.Inctv_Dimn_Id as Incentive_Dim_Id   from   ddsmrt.dbo.Car_Hire_Revenue_Fact (NOLOCK) rev  left join ddsmrt.dbo.Organization_Membership_dim (NOLOCK) mem1 on (rev.Org_Mbrshp_Dimn_Id = mem1.[Org_Mbrshp_Dimn_Id] and rev.Org_Mbrshp_Ver = mem1.[Org_Mbrshp_Ver])  left join ddsmrt.dbo.Vmrt_Organization_Dimension (NOLOCK) od on od.org_dimn_id = mem1.Org_Dimn_Id and od.Org_Ver = mem1.org_ver  left join ddsmrt.dbo.Vmrt_Organization_Dimension (NOLOCK) llo_d on llo_d.org_dimn_id = rev.lst_lbl_ownr and llo_d.eff_to is null  left join ddsmrt.dbo.Vmrt_Revenue_Hierarchy rev_h (NOLOCK) on rev.rev_hierchy_id = rev_h.hierchy_id and rev.rev_hierchy_ver = rev_h.hierchy_ver  left join ddsmrt.dbo.vmrt_car_hierarchy_enterprise ent on ent.hierchy_id = rev.entr_hierchy_id and ent.hierchy_ver = rev.entr_hierchy_ver  inner join ddsmrt.dbo.date_dim dt on rev.Mth_Beg_Dt_Dimn_Id = dt.dt_dimn_id   left join incentive_dim inct on inct.inctv_dimn_id = rev.inctv_dimn_id  WHERE rev.typ_id = 156  --this set it to Estimated Values"
    },
    {
      "id": "VMRT_Loading_TTXContainer",
      "name": "VMRT_Loading_TTXContainer",
      "type": "VIEW",
      "sql": "CREATE view [dbo].[VMRT_Loading_TTXContainer] as   SELECT    MAX(CF.Container_Fact_ID) AS 'Container_Fact_ID' ,                      CF.Dt_Dimn_Id ,                      CF.Rpt_Rd_Dimn_Id ,       CF.Rpt_Rd_Ver ,       CF.Car_Dimn_Id ,                      CF.Car_Ver ,                      CF.Stcc_Dimn_Id ,                      CF.Geo_Dimn_Id ,       CF.Rpt_Rd ,                      CASE WHEN Rpt_Rd = 'CSXI' THEN 'TTXX'                           ELSE CF.[Car_Init]                      END AS Car_Init ,                      CF.Car_Nr ,       CF.Orig_Evnt_Dt ,       CF.Cntr_Trl_Nr ,                      CF.Cntr_Trl_Pfx ,                      CF.Cntr_Trl_Wgt ,                      CF.Cntr_Trl_Wgt_Qlfy ,                      CF.Cntr_Trl_Eq_Typ ,                      CF.Cntr_Trl_Len ,                      CF.Cntr_Trl_Hgt ,                      CF.Cntr_Trl_Wdt ,                      CF.Cntr_Pos ,                      CF.Evnt_Typ ,                      CF.Inside_Pltfm_Len,       CF.Evnt_Loc_SPLC            FROM      DDSMRT.dbo.Container_Fact AS CF      /** IR527842 Fix **/                      LEFT JOIN DDSMRT.dbo.VMRT_Car_Dimension_Correct Car ON Car.Car_Dimn_Id = CF.Car_Dimn_Id                                                                AND Car.Car_Ver = CF.Car_Ver            WHERE     ( CF.Evnt_Typ IN ( 'AL', 'RM' ) )                      AND ( CF.Cntr_Trl_Eq_Typ NOT IN ( 'CH' ) OR (CF.Cntr_Trl_Eq_Typ IS NULL))                      AND car.Business_Line = 'Intermodal'                      AND (CF.Orig_Evnt_Dt >= '2010-01-01 00:00:00.000'                      OR CF.Recv_Dt >= '2010-01-01 00:00:00.000')            GROUP BY  CF.Dt_Dimn_Id ,                      CF.Rpt_Rd_Dimn_Id ,       CF.Rpt_Rd_Ver ,                      CF.Car_Dimn_Id ,                      CF.Car_Ver ,                      CF.Stcc_Dimn_Id ,                      CF.Geo_Dimn_Id ,                      CF.Rpt_Rd ,                      CF.Car_Init ,                      CF.Car_Nr ,       CF.Orig_Evnt_Dt ,       CF.Cntr_Trl_Nr ,                      CF.Cntr_Trl_Pfx ,                      CF.Cntr_Trl_Wgt ,                      CF.Cntr_Trl_Wgt_Qlfy ,                      CF.Cntr_Trl_Eq_Typ ,                      CF.Cntr_Trl_Len ,                      CF.Cntr_Trl_Hgt ,                      CF.Cntr_Trl_Wdt ,                      CF.Cntr_Pos ,                      CF.Evnt_Typ ,                      CF.Inside_Pltfm_Len,       CF.Evnt_Loc_SPLC"
    },
    {
      "id": "VMRT_Revenue_Accounting_Estimated_Car_Hire_Revenue_Pivot",
      "name": "VMRT_Revenue_Accounting_Estimated_Car_Hire_Revenue_Pivot",
      "type": "VIEW",
      "sql": "-- get the entries which are online and join them with the entries of not online (pivot those entries)  CREATE view [dbo].[VMRT_Revenue_Accounting_Estimated_Car_Hire_Revenue_Pivot] as  select      od.org_abrv as Liable_Abrv     , llo_d.org_abrv as Last_Liable_Owner_Abrv     , dt.dt as Date     , ent.Stat_Cd as Stat_Code     , ent.Eq_Typ_Shrt_Desc as Equipment_Type_Short_Desc     , ent.bus_Ln_Shrt_Desc as Business_Line_Shrt_Desc     , ent.TPE_Fctr as TPE_Factor     , ent.Ut_Cnt as Unit_Count     , rev.Car_Hire_Rev_Amt as Car_Hire_Revenue     , rev.Tot_Milg as Total_Mileage     , rev.Milg_Rev_Amt as Mileage_Revenue     , rev.Whl_Schg_Rev_Amt as Wheel_Surcharge_Revenue     , ent.Milg_Rt as Mileage_Rate     , ent.Milg_Rt_Whl_Schg as Wheel_Surchage_Rate     , ent.car_hrly_Rt as Car_Hourly_Rate     , inct.Description as Incentive_Program     , inct.inctv_typ as Incentive_Type     , Incentive_Deduction as Incentive_Deduction     , rev.Ernd_Hrs_Cnt as Online_Hours     , rev.Ernd_Hrs_Cnt / (dt.Num_Day_Mth * 24.0) as Online_Cars_Count     , rev.Ernd_Hrs_Cnt * ent.TPE_Fctr / (dt.Num_Day_Mth * 24.0) as Online_TPE_Count     , rev.Ernd_Hrs_Cnt * ent.Ut_Cnt / (dt.Num_Day_Mth * 24.0) as Online_Ut_Count     , [ENRT] as ENRT_Hours     , [ENRT] / (dt.Num_Day_Mth * 24.0) as ENRT_Cars_Count     , [ENRT] * ent.TPE_Fctr / (dt.Num_Day_Mth * 24.0) as ENRT_TPE_Count     , [ENRT] * ent.Ut_Cnt / (dt.Num_Day_Mth * 24.0) as ENRT_Ut_Count     , [FMO] as FMO_Hours     , [FMO] / (dt.Num_Day_Mth * 24.0) as FMO_Cars_Count     , [FMO] * ent.TPE_Fctr / (dt.Num_Day_Mth * 24.0) as FMO_TPE_Count     , [FMO] * ent.Ut_Cnt / (dt.Num_Day_Mth * 24.0) as FMO_Ut_Count     , [RELF] as RELF_Hours     , [RELF] / (dt.Num_Day_Mth * 24.0) as RELF_Cars_Count     , [RELF] * ent.TPE_Fctr / (dt.Num_Day_Mth * 24.0) as RELF_TPE_Count     , [RELF] * ent.Ut_Cnt / (dt.Num_Day_Mth * 24.0) as RELF_Ut_Count     , [REOL] as REOL_Hours     , [REOL] / (dt.Num_Day_Mth * 24.0) as REOL_Cars_Count     , [REOL] * ent.TPE_Fctr / (dt.Num_Day_Mth * 24.0) as REOL_TPE_Count     , [REOL] * ent.Ut_Cnt / (dt.Num_Day_Mth * 24.0) as REOL_Ut_Count     , [SHOP] as SHOP_Hours     , [SHOP] / (dt.Num_Day_Mth * 24.0) as SHOP_Cars_Count     , [SHOP] * ent.TPE_Fctr / (dt.Num_Day_Mth * 24.0) as SHOP_TPE_Count     , [SHOP] * ent.Ut_Cnt / (dt.Num_Day_Mth * 24.0) as SHOP_Ut_Count     , [STBO] as STBO_Hours     , [STBO] / (dt.Num_Day_Mth * 24.0) as STBO_Cars_Count     , [STBO] * ent.TPE_Fctr / (dt.Num_Day_Mth * 24.0) as STBO_TPE_Count     , [STBO] * ent.Ut_Cnt / (dt.Num_Day_Mth * 24.0) as STBO_Ut_Count     , [STOR] as STOR_Hours     , [STOR] / (dt.Num_Day_Mth * 24.0) as STOR_Cars_Count     , [STOR] * ent.TPE_Fctr / (dt.Num_Day_Mth * 24.0) as STOR_TPE_Count     , [STOR] * ent.Ut_Cnt / (dt.Num_Day_Mth * 24.0) as STOR_Ut_Count     , [ZERO] as ZERO_Hours     , [ZERO] / (dt.Num_Day_Mth * 24.0) as ZERO_Cars_Count     , [ZERO] * ent.TPE_Fctr / (dt.Num_Day_Mth * 24.0) as ZERO_TPE_Count     , [ZERO] * ent.Ut_Cnt / (dt.Num_Day_Mth * 24.0) as ZERO_Ut_Count  from      ddsmrt.dbo.car_hire_revenue_fact (NOLOCK) rev   left join ddsmrt.dbo.Vmrt_Revenue_Hierarchy (NOLOCK) rev_h       on  rev.rev_hierchy_id = rev_h.hierchy_id           and rev.rev_hierchy_ver = rev_h.hierchy_ver  full outer join      ( select           Org_Mbrshp_Dimn_Id         , Org_Mbrshp_Ver         , Entr_Hierchy_Id         , Entr_Hierchy_Ver         , Mth_Beg_Dt_Dimn_Id         , lst_lbl_ownr         , typ_id         , [ENRT]         , [FMO]         , [RELF]         , [REOL]         , [SHOP]         , [STBO]         , [STOR]         , [ZERO]      from           ( select               Org_Mbrshp_Dimn_Id             , Org_Mbrshp_Ver             , Entr_Hierchy_Id             , Entr_Hierchy_Ver             , Mth_Beg_Dt_Dimn_Id             , lst_lbl_ownr             , ernd_hrs_cnt             , revenue_service_code             , typ_id          from               ddsmrt.dbo.car_hire_revenue_fact (NOLOCK) rev_oos          left join ddsmrt.dbo.Vmrt_Revenue_Hierarchy (NOLOCK) rev_h_oos              on  rev_oos.rev_hierchy_id = rev_h_oos.hierchy_id                   and rev_oos.rev_hierchy_ver = rev_h_oos.hierchy_ver          where               revenue_service_code <> 'ONLN'           ) as SourceTable PIVOT (SUM(ernd_hrs_cnt) FOR revenue_service_code in ([ENRT], [FMO], [RELF], [REOL]                                                                                , [SHOP], [STBO], [STOR], [ZERO]) ) as PivotTable       ) as OOSCars       on  OOSCars.Org_Mbrshp_Dimn_Id = rev.Org_Mbrshp_Dimn_Id           and OOSCars.Org_Mbrshp_Ver = rev.Org_Mbrshp_Ver          AND OOSCars.Entr_Hierchy_Id = rev.Entr_Hierchy_Id           and OOSCars.Entr_Hierchy_Ver = rev.Entr_Hierchy_Ver          AND OOSCars.Mth_Beg_Dt_Dimn_Id = Rev.Mth_Beg_Dt_Dimn_Id          AND OOSCars.lst_lbl_ownr= rev.lst_lbl_ownr          AND OOSCars.typ_id = rev.typ_id    and rev_h.revenue_service_code = 'ONLN'  left join ddsmrt.dbo.Organization_Membership_dim (NOLOCK) mem1       on  coalesce(rev.Org_Mbrshp_Dimn_Id, OOSCars.Org_Mbrshp_Dimn_Id ) = mem1.Org_Mbrshp_Dimn_Id          and coalesce(rev.Org_Mbrshp_Ver,OOSCars.Org_Mbrshp_Ver) = mem1.Org_Mbrshp_Ver  left join ddsmrt.dbo.vmrt_organization_dimension (NOLOCK) od       on  od.org_dimn_id = mem1.Org_Dimn_Id           and od.Org_Ver = mem1.org_ver  left join ddsmrt.dbo.vmrt_organization_dimension (NOLOCK) llo_d       on  llo_d.org_dimn_id = coalesce(rev.lst_lbl_ownr,OOSCars.lst_lbl_ownr)           and llo_d.eff_to is null  left join ddsmrt.dbo.vmrt_car_hierarchy_enterprise (NOLOCK) ent       on  ent.hierchy_id = coalesce(rev.entr_hierchy_id, OOSCars.entr_hierchy_id)           and ent.hierchy_ver = coalesce(rev.entr_hierchy_ver, OOSCars.entr_hierchy_ver)  left join ddsmrt.dbo.incentive_dim inct       on  inct.inctv_dimn_id = rev.inctv_dimn_id  inner join ddsmrt.dbo.date_dim dt       on  coalesce(rev.Mth_Beg_Dt_Dimn_Id, OOSCars.Mth_Beg_Dt_Dimn_Id) = dt.dt_dimn_id  WHERE       coalesce(rev.typ_id, OOSCars.typ_id) = 158 --this set it to Accrual      and coalesce (rev_h.revenue_service_code, 'ONLN') = 'ONLN'"
    },
    {
      "id": "VMRT_Cycle_Fact",
      "name": "VMRT_Cycle_Fact",
      "type": "VIEW",
      "sql": "CREATE VIEW [dbo].[VMRT_Cycle_Fact] as     SELECT   CYCLE.[Cycle_Fact_Id]  ,CYCLE.[Cycle_Shpr_Org_Dimn_Id]  ,CYCLE.[Cycle_Shpr_Org_Ver]  ,CYCLE.[Car_Dimn_Id]  ,CYCLE.[Car_Ver]  ,CYCLE.[Origin_Empt_Org_Dimn_Id]  ,CYCLE.[Origin_Empt_Org_Ver]  ,CYCLE.[Dest_Empt_Org_Dimn_Id]  ,CYCLE.[Dest_Empt_Org_Ver]  ,CYCLE.[Origin_Ld_Org_Dimn_Id]  ,CYCLE.[Origin_Ld_Org_Ver]  ,CYCLE.[Dest_Ld_Org_Dimn_Id]  ,CYCLE.[Dest_Ld_Org_Ver]  ,isnull(SPLC1.SPLC_Dimn_Id, -1) as  Dest_Ld_SPLC_Dimn_Id  ,isnull(SPLC2.SPLC_Dimn_Id, -1) as  Origin_Ld_SPLC_Dimn_Id  ,isnull(SPLC3.SPLC_Dimn_Id, -1) as  Dest_Empt_SPLC_Dimn_Id  ,isnull(SPLC4.SPLC_Dimn_Id, -1) as  Origin_Empt_SPLC_Dimn_Id  ,CYCLE.[Cycle_Begin_Dt_Dimn_Id]  ,CYCLE.[Cycle_End_Dt_Dimn_Id]  ,CYCLE.[Cycle]  ,CYCLE.[Railcar]  ,CYCLE.[Cycle_Typ]  ,CYCLE.[Cycle_Rules_Not_Satisfied]  ,CYCLE.[Has_Missing_Segs]  ,CYCLE.[Cycle_Shpr]  ,CYCLE.[Cycle_Begin_Dt]  ,CYCLE.[Cycle_End_Dt]  ,CYCLE.[Begin_Dt_Ld]  ,CYCLE.[Orig_Loc_Empt]  ,CYCLE.[Orig_Enty_Empt]  ,CYCLE.[Dest_Loc_Empt]  ,CYCLE.[Dest_Enty_Empt]  ,CYCLE.[Orig_Loc_Ld]  ,CYCLE.[Orig_Enty_Ld]  ,CYCLE.[Dest_Loc_Ld]  ,CYCLE.[Dest_Enty_Ld]  ,CYCLE.[Invalid_Rsn]  ,CYCLE.[Totl_Seg_Cnt]  ,CYCLE.[Cycle_Calc_Milg_Empt]  ,CYCLE.[Cycle_Calc_Milg_Ld]  ,CYCLE.[Cycle_Calc_Dura_Empt]  ,CYCLE.[Cycle_Calc_Dura_Ld]  ,CYCLE.[Crtd_Id]  ,CYCLE.[Crtd_Dt]  ,CYCLE.[Lst_Upd_Id]  ,CYCLE.[Lst_Upd_Dt]  ,CYCLE.[Src_Sys_Nm]  ,CYCLE.[Dq_Flg]  ,CYCLE.[Dlet_Flg]  FROM [DDSMRT].[dbo].[vw_Cycle_Fact] (NOLOCK) CYCLE  LEFT JOIN DDSMRT.dbo.SPLC_Dim (NOLOCK) SPLC1 on (CYCLE.Dest_Loc_Ld = SPLC1.Location)  LEFT JOIN DDSMRT.dbo.SPLC_Dim (NOLOCK) SPLC2 on (CYCLE.Orig_Loc_Ld = SPLC2.Location)  LEFT JOIN DDSMRT.dbo.SPLC_Dim (NOLOCK) SPLC3 on (CYCLE.Dest_Loc_Empt = SPLC3.Location)  LEFT JOIN DDSMRT.dbo.SPLC_Dim (NOLOCK) SPLC4 on (CYCLE.Orig_Loc_Empt = SPLC4.Location)"
    },
    {
      "id": "VMRT_Cycle_Seg_Fact",
      "name": "VMRT_Cycle_Seg_Fact",
      "type": "VIEW",
      "sql": "CREATE VIEW [dbo].[VMRT_Cycle_Seg_Fact] as   SELECT    cs.[Cycle_Seg_Fact_Id]  ,cs.[Cycle_Fact_Id]  ,cs.[Car_Dimn_Id]  ,cs.[Car_Ver]  ,cs.[Cycle_Seg_Orig_Org_Dimn_Id]  ,cs.[Cycle_Seg_Orig_Org_Ver]  ,cs.[Cycle_Seg_Dest_Org_Dimn_Id]  ,cs.[Cycle_Seg_Dest_Org_Ver]  ,isnull(splc1.SPLC_Dimn_Id, -1) as Cycle_Seg_Orig_SPLC_Dimn_Id  ,isnull(splc2.SPLC_Dimn_Id, -1) as Cycle_Seg_Dest_SPLC_Dimn_Id  ,cs.[Cycle_Segment]  ,cs.[Cycle]  ,cs.[Cycle_Seg_Order]  ,cs.[Cycle_Seg_Typ]  ,cs.[Empt_Ld_Ind]  ,cs.[Cycle_Seg_Begin_Dt]  ,cs.[Cycle_Seg_Begin_Dt_Dimn_Id]  ,cs.[Cycle_Seg_End_Dt]  ,cs.[Cycle_Seg_End_Dt_Dimn_Id]  ,cs.[Cycle_Seg_Calc_Milg]  ,cs.[Cycle_Seg_Calc_Dura]  ,cs.[Orig_Loc]  ,cs.[Orig_Enty]  ,cs.[Dest_Loc]  ,cs.[Dest_Enty]  ,cs.[Cycle_Seg_Scnd_Status]  ,cs.[Crtd_Id]  ,cs.[Crtd_Dt]  ,cs.[Lst_Upd_Id]  ,cs.[Lst_Upd_Dt]  ,cs.[Src_Sys_Nm]  ,cs.[Dq_Flg]  FROM [DDSMRT].[dbo].[vw_Cycle_Seg_Fact_All] (NOLOCK) cs  LEFT JOIN DDSMRT.dbo.SPLC_Dim (NOLOCK) SPLC1 on (cs.[Orig_Loc] = SPLC1.Location)  LEFT JOIN DDSMRT.dbo.SPLC_Dim (NOLOCK) SPLC2 on (cs.[Dest_Loc] = SPLC2.Location)"
    },
    {
      "id": "VMRT_Cycle_Seg_Road_Seg_Fact",
      "name": "VMRT_Cycle_Seg_Road_Seg_Fact",
      "type": "VIEW",
      "sql": "CREATE VIEW [dbo].[VMRT_Cycle_Seg_Road_Seg_Fact] as   SELECT [Cycle_Seg_Road_Seg_Fact_Id]        ,[Cycle_Seg_Fact_Id]        ,[Car_Dimn_Id]        ,[Car_Ver]        ,[Cycle_Seg_Road_Seg_Poss_Road_Org_Dimn_Id]        ,[Cycle_Seg_Road_Seg_Poss_Road_Org_Ver]        ,[Cycle_Seg_Road_Seg_Resp_Road_Org_Dimn_Id]        ,[Cycle_Seg_Road_Seg_Resp_Road_Org_Ver]        ,[Cycle_Seg_Road_Seg_Lst_Parti_Road_Org_Dimn_Id]        ,[Cycle_Seg_Road_Seg_Lst_Parti_Road_Org_Ver]        ,[Cycle_Seg_Road_Seg_Begin_Loc_SPLC_Dimn_Id]        ,[Cycle_Seg_Road_Seg_End_Loc_SPLC_Dimn_Id]        ,[Cycle_Segment_Railroad_Segment]        ,[Cycle_Segment]        ,[Cycle_Seg_Road_Seg_Order]        ,[Cycle_Seg_Road_Seg_Begin_Loc]        ,[Cycle_Seg_Road_Seg_End_Loc]        ,[Cycle_Seg_Road_Seg_Begin_Dt]        ,[Cycle_Seg_Road_Seg_End_Dt]        ,[Cycle_Seg_Road_Seg_Calc_Milg]        ,[Cycle_Seg_Road_Seg_BadOrder_Milg]        ,[Cycle_Seg_Road_Seg_Calc_Dura]        ,[Cycle_Seg_Road_Seg_BadOrder_Dura]        ,[Cycle_Seg_Road_Seg_Poss_Road]        ,[Cycle_Seg_Road_Seg_Resp_Road]        ,[Cycle_Seg_Road_Seg_Lst_Parti_Enty]        ,[Cycle_Seg_Road_Seg_Scnd_Status]        ,[Crtd_Id]        ,[Crtd_Dt]        ,[Lst_Upd_Id]        ,[Lst_Upd_Dt]        ,[Src_Sys_Nm]        ,[Dq_Flg]  FROM [DDSMRT].[dbo].[vw_Cycle_Seg_Road_Seg_Fact_All] (NOLOCK)"
    },
    {
      "id": "VMRT_TTX_Velocity",
      "name": "VMRT_TTX_Velocity",
      "type": "VIEW",
      "sql": "CREATE VIEW [dbo].[VMRT_TTX_Velocity] as   select   c.[Cycle_Fact_Id]  ,cs.[Cycle_Seg_Fact_Id]  ,cs.cycle_seg_order  ,csrs.[Cycle_Seg_Road_Seg_Fact_Id]  ,csrs.Cycle_Seg_Road_Seg_Order  ,c.[Car_Dimn_Id]  ,c.[Car_Ver]  ,csrs.[Cycle_Seg_Road_Seg_Poss_Road_Org_Dimn_Id]  ,csrs.[Cycle_Seg_Road_Seg_Poss_Road_Org_Ver]  ,csrs.[Cycle_Seg_Road_Seg_Resp_Road_Org_Dimn_Id]  ,csrs.[Cycle_Seg_Road_Seg_Resp_Road_Org_Ver]  ,csrs.[Cycle_Seg_Road_Seg_Lst_Parti_Road_Org_Dimn_Id]  ,csrs.[Cycle_Seg_Road_Seg_Lst_Parti_Road_Org_Ver]  ,csrs.[Cycle_Seg_Road_Seg_Begin_Loc_SPLC_Dimn_Id]  ,csrs.[Cycle_Seg_Road_Seg_End_Loc_SPLC_Dimn_Id]  ,csrs.[Crtd_Dt]  ,csrs.[Lst_Upd_Dt]  ,cs.[Empt_Ld_Ind]  ,cs.[Cycle_Seg_Typ]  ,ISNULL(csrs.[Cycle_Seg_Road_Seg_Calc_Dura], 0) as Calc_Dura  ,ISNULL(csrs.[Cycle_Seg_Road_Seg_Calc_Milg],0) as Calc_Milg  ,c.[Cycle_Shpr_Org_Dimn_Id]  ,c.[Cycle_Shpr_Org_Ver]  ,c.[Origin_Ld_Org_Dimn_Id]  ,c.[Origin_Ld_Org_Ver]  ,c.[Dest_Ld_Org_Dimn_Id]  ,c.[Dest_Ld_Org_Ver]  ,c.[Origin_Empt_Org_Dimn_Id]  ,c.[Origin_Empt_Org_Ver]  ,c.[Dest_Empt_Org_Dimn_Id]  ,c.[Dest_Empt_Org_Ver]  ,c.Origin_Empt_SPLC_Dimn_Id  ,c.Dest_Empt_SPLC_Dimn_Id  ,c.Origin_Ld_SPLC_Dimn_Id  ,c.Dest_Ld_SPLC_Dimn_Id  ,c.[Cycle_Begin_Dt_Dimn_Id]  ,c.[Cycle_End_Dt_Dimn_Id]  ,c.[Cycle_Typ]  ,c.[Invalid_Rsn]  , case when cs.cycle_seg_order =1 and csrs.Cycle_Seg_Road_Seg_Order =1 then csrs.[Cycle_Seg_Road_Seg_Lst_Parti_Road_Org_Dimn_Id] end as Orig_Lst_Parti_road_Org_Dimn_Id  , case when cs.cycle_seg_order =1 and csrs.Cycle_Seg_Road_Seg_Order =1 then csrs.[Cycle_Seg_Road_Seg_Lst_Parti_Road_Org_Ver]  end as Orig_Lst_Parti_road_Org_Ver  , case when cs.cycle_seg_order =1 and csrs.Cycle_Seg_Road_Seg_Order =1 then csrs.[Cycle_Seg_Road_Seg_Resp_Road_Org_Dimn_Id]   end as Orig_Resp_road_Org_Dimn_Id  , case when cs.cycle_seg_order =1 and csrs.Cycle_Seg_Road_Seg_Order =1 then csrs.[Cycle_Seg_Road_Seg_Resp_Road_Org_Ver]    end as Orig_Resp_road_Org_Ver  , case when cs.cycle_seg_order =1 and csrs.Cycle_Seg_Road_Seg_Order =1 then csrs.[Cycle_Seg_Road_Seg_Poss_Road_Org_Dimn_Id]   end as Orig_Poss_road_Org_Dimn_Id  , case when cs.cycle_seg_order =1 and csrs.Cycle_Seg_Road_Seg_Order =1 then csrs.[Cycle_Seg_Road_Seg_Poss_Road_Org_Ver]    end as Orig_Poss_road_Org_Ver    from [dbo].[VMRT_Cycle_Fact] (NOLOCK) c   INNER join [dbo].[VMRT_Cycle_Seg_Fact] (NOLOCK) cs on cs.cycle_fact_id = c.cycle_fact_id  INNER JOIN [dbo].[VMRT_Cycle_Seg_Road_Seg_Fact] (NOLOCK) csrs  on csrs.cycle_seg_fact_id = cs.cycle_seg_fact_id  where c.Dlet_Flg = 0"
    },
    {
      "id": "VMRT_Condition_Code_Dimension",
      "name": "VMRT_Condition_Code_Dimension",
      "type": "VIEW",
      "sql": "CREATE VIEW [dbo].[VMRT_Condition_Code_Dimension](Cond_Cd_Dimn_Id,Cnd_Cd,Cnd_Cd_Desc,Crtd_Dt,Crtd_Id,Lst_Upd_Dt,Lst_Upd_Id,Src_Sys_Nm)  AS  (    SELECT Code_Lookup.Cd_Lkp_Dimn_Id  ,Code_Lookup.Cd  ,Code_Lookup.Cd_Desc  ,Code_Lookup.Crtd_Dt  ,Code_Lookup.Crtd_Id  ,Code_Lookup.Lst_Upd_Dt  ,Code_Lookup.Lst_Upd_Id  ,Code_Lookup.Src_Sys_Nm   FROM DDSMRT.dbo.Code_Lookup (NOLOCK)    WHERE Cd_Identifier = 'CONDITION_CODE' or Cd_Lkp_Dimn_Id= -1       )   ;"
    },
    {
      "id": "Vfin_Supplement_Cher_Penalty",
      "name": "Vfin_Supplement_Cher_Penalty",
      "type": "VIEW",
      "sql": "CREATE VIEW [DDSV].[Vfin_Supplement_Cher_Penalty]    AS    SELECT      processCycleDtDimnId    ,carDimnId    ,carVer    ,penaltyLiableRoadOrgDimnId    ,penaltyLiableRoadOrgVer    ,participatingRailroad    ,possessorRailroad    ,lastMovementDate    ,penaltyStartDate    ,penaltyEndDate    ,carHireStatus    ,carHireRate    ,noOfPlatforms    ,DATEDIFF(HOUR,penaltyStartDate,ISNULL(penaltyEndDate,GETDATE()))*carHireRate  as totalEstimatedPenaltyAmount  FROM DDSMRT.DBO.supplementCherFact fact WITH(NOLOCK)  INNER JOIN DDSMRT.DBO.Car_Dim_Correct cc with(nolock)      on fact.carDimnId =cc.Car_Dimn_Id and fact.carVer = cc.car_ver  WHERE createdDate= (SELECT MAX(createdDate) from DDSMRT.DBO.supplementCherFact fact2 WITH(NOLOCK)                       INNER JOIN DDSMRT.DBO.Car_Dim_Correct cc2 with(nolock)                          on fact2.carDimnId =cc2.Car_Dimn_Id and fact2.carVer = cc2.car_ver                       where fact.processCycleDtDimnId = fact2.processCycleDtDimnId and cc.Railcar=cc2.Railcar)"
    },
    {
      "id": "VMRT_Distribution_Entity_Dimension",
      "name": "VMRT_Distribution_Entity_Dimension",
      "type": "VIEW",
      "sql": "CREATE VIEW [dbo].[VMRT_Distribution_Entity_Dimension]  AS  SELECT      org.Org_Abrv as Org_Abrv     ,org.Org_Nm as Org_Nm       ,dist.[Dist_Enty_Dimn_Id]        ,dist.[Dist_Enty_Ver]        ,dist.[Org_Dimn_Id]        ,dist.[Org_Ver]        ,dist.[Dist_Enty]        ,dist.[Apl_To_Trip_Ind]        ,dist.[SCT_Ent_Ind]        ,dist.[TTX_Aprv_Ind]        ,dist.[Ld_Typ]        ,dist.[Act_Sts_Ind]        ,dist.[Eff_From]        ,dist.[Eff_To]        ,dist.[Crtd_Id]        ,dist.[Crtd_Dt]        ,dist.[Lst_Upd_Id]        ,dist.[Lst_Upd_Dt]        ,dist.[Src_Sys_Nm]        ,dist.[Dq_Flg]       ,dist.[Type]       FROM ddsmrt.dbo.Distribution_Entity_Dim (NOLOCK) dist   left join ddsmrt.dbo.Organization_Dim  (NOLOCK) org on (dist.Org_Dimn_Id = org.Org_Dimn_Id and dist.Org_Ver = org.Org_Ver)"
    },
    {
      "id": "Vfin_Supplement_Eio_Penalty",
      "name": "Vfin_Supplement_Eio_Penalty",
      "type": "VIEW",
      "sql": "CREATE VIEW [DDSV].[Vfin_Supplement_Eio_Penalty]    AS    SELECT      processCycleDtDimnId    ,fleetHierchyId    ,participatingRoadOrgDimnId    ,participatingRoadOrgVer    ,entitlementOpenDate    ,entitlementCloseDate    ,transactionPeriodOpenDate    ,transactionPeriodProjectedCloseDate    ,eioStartDate    ,eioEndDate    ,projectedEioEndDate    ,requestedRailcars    ,fulfilledRailcars    ,noOfPlatforms    ,eioEligibility    ,cherEligibility    ,eligibiltyFailureReason    ,requestStatus    ,requestStatusEndDate  FROM DDSMRT.DBO.supplementEioFact fact WITH(NOLOCK)  where createdDate = (select max(createdDate) from DDSMRT.DBO.supplementEioFact fact1 WITH(NOLOCK)                        where fact.processCycleDtDimnId = fact1.processCycleDtDimnId and fact.fleetHierchyId =fact1.fleetHierchyId         and fact.participatingRoadOrgDimnId =fact1.participatingRoadOrgDimnId)"
    },
    {
      "id": "VMRT_Invoicing_Entity_Dimension",
      "name": "VMRT_Invoicing_Entity_Dimension",
      "type": "VIEW",
      "sql": "CREATE VIEW [dbo].[VMRT_Invoicing_Entity_Dimension]  AS  SELECT   org.[Org_Dimn_Id] as Invc_Enty_Org_Dimn_Id  ,org.[Org_Ver] as Invc_Enty_Org_Ver  ,org.org_abrv as [Invc_Enty_Org_Abrv]  ,org.Pty_Id  ,org.org_nm as [Invc_Enty_Org_Nm]  , org.Crtd_Id  , org.Crtd_Dt  , org.Lst_Upd_Id  , org.Lst_Upd_Dt  , org.Eff_From  , org.Eff_To  , org.Dq_Flg  , org.Src_Sys_Nm  FROM [Organization_Dim]  (NOLOCK) org  Inner join [organization_Type_Lookup]  (NOLOCK) org_typ  on (org.org_dimn_id = org_typ.org_dimn_id and org.org_ver = org_typ.org_ver)  inner join  [DDSMRT].[dbo].[Type_Lookup]  (NOLOCK) typ_lkp     on  org_typ.Org_Typ_Id=typ_lkp.Typ_id  where typ_lkp.typ_Grp= 'Organization' and typ_lkp.Typ_Desc= 'INVOICING ENTITY'  and org.Row_Typ_Id= 501  and org.Org_Abrv is not null  OR org.Org_Dimn_Id = -1"
    },
    {
      "id": "VMember_Mileage_Audit_Fact",
      "name": "VMember_Mileage_Audit_Fact",
      "type": "VIEW",
      "sql": "CREATE VIEW DDSV.VMember_Mileage_Audit_Fact  AS      SELECT  CAST([Dt_Dimn_Id] / 100 AS INT) AS [Mth_Dimn_Id] ,              CONCAT(CONVERT(VARCHAR(10), Org_Mbrshp_Dimn_Id), '_',                     CONVERT(VARCHAR(5), Org_Mbrshp_Ver)) AS [Rd_Mbrshp_Dimn_Id] ,              CONCAT(CONVERT(VARCHAR(10), [Car_Dimn_Id]), '_',                     CONVERT(VARCHAR(5), [Car_Ver])) AS [Car_Dimn_Id] ,              [Service_Month] ,              [Car_Nr] ,              [Car_Init] ,              [Rpt_Mil_Cnt] ,              [Adj_Mil_Cnt] ,              [Net_Mil_Cnt] ,              [Milg_Rt_Rpt] ,              [Milg_Amt] ,              [Ernd_Hrs] ,              [Milg_Rt] ,              [Seq_Nr] ,              [Totl_Pop_Cnt] ,              [Is_Sampled] ,              [Crtd_Dt] ,              [Crtd_Id] ,              [Lst_Upd_Dt] ,              [Lst_Upd_Id]      FROM    [dbo].[Member_Mileage_Audit_Fact]"
    },
    {
      "id": "VMRT_Car_Dimension",
      "name": "VMRT_Car_Dimension",
      "type": "VIEW",
      "sql": "CREATE view [dbo].[VMRT_Car_Dimension]   WITH SCHEMABINDING  as  select       car.[Car_Nr]        ,car.[Car_Init]        ,car.[Car_Status_UFD]        ,car.[TTX_Eff_Dt]        ,car.[Car_Ownrshp_Ind]        ,car.[Pool_Cd]        ,car.[TTX_Mngd_Car_Ind]        ,car.Car_Eff_From        ,car.Car_Eff_To        ,car.[Car_Dimn_Id]        ,car.[Car_Ver]        ,car.Car_Src_Sys_Nm        ,car.[Ownr_Mrk]        ,car.[Eq_Hierchy_Id]        ,car.[Eq_Hierchy_Ver]        ,car.[Fleet_Hierchy_Ver]        ,car.[Entr_Hierchy_Ver]        ,car.[Fleet_Hierchy_Id]        ,car.[Entr_Hierchy_Id]        ,car.[Car_Cls]        ,car.[Railcar]        ,car.[Car_Lineage_Grp_Id]        ,car.[Assetnum]        ,car.[Fin_Car_Id]        ,car.[Car_Status_Maximo]     ,[Umler_Blt_Dt]        ,[Eq_Bldr]        ,[Bldr_Lot_Cd]        ,[Blt_From_Use_Ast]        ,[Brk_Cd]        ,[Car_Cost_Est_Act]     ,[Lese_Cd]        ,[Ldgr_Val]        ,[Lst_Shp_Dt]        ,[Milg_Upd_Dt]        ,[Orig_Car_Ownr]        ,[Orig_Cost]        ,[Reblt_Dt]        ,[Scnd_Hand_Dt]        ,[Scnd_Lese]        ,[Seller_Orig_Cost]        ,[Setl_Val]        ,[Split_Or_Cmbnd_Invl_Ind]        ,[Wghg_Pty]        ,[Milg_Sinc_Lst_Cls_A_Rpr_Dt]        ,[Milg_Sinc_Lst_Cls_B_Rpr_Dt]        ,[Milg_Sinc_Lst_Cls_I_Rpr_Dt]        ,[Lst_Cls_A_Rpr_Dt]        ,[Lst_Cls_B_Rpr_Dt]        ,[Lst_Cls_I_Rpr_Dt]        ,[Num_Dy_Car_Can]        ,[Num_Dy_Car_Mex]        ,[Can_Mex_Dy_Lst_Updt_Dt]        ,[Blng_Extd_Srvc_Ind]        ,[Rub_Rail_Upd]        ,[Cert_Dt]        ,[Cert_Cd]        ,[Car_Grd]        ,[Car_Grd_Dt]        ,[Osid_Usa_Ind]        ,[Insd_Len]        ,[Osid_Len]        ,car.Car_Char_Eff_From        ,car.Car_Char_Eff_To    --    ,ISNULL(ISNULL(car.[Pltfm_Fctr], 2*Ut_Cnt),1.0) as [Pltfm_Fctr]    ,ISNULL(car.[Pltfm_Fctr],1.0) as [Pltfm_Fctr]        ,car.[Trk_Axl_Cnt]        ,car.[Axl_Cnt]        ,ISNULL(car.[TPE_Fctr], 1) as [TPE_Fctr]        ,car.[Ut_Cnt]        ,[Eq_Typ_Cd]        ,[Intmdit_Connt_Styl]        ,[S_Str_Bldr_Cd]        ,[S_Str_Modl]        ,[S_Str_Blt_Dt]        ,[Rt_Ind]        ,[S_Str_Addn_Betr_Val]        ,[Orig_Rk_Cost]        ,[Act_Rk_Dim_Ind]        ,[S_Str_Deck_BC_Setg]        ,[S_Str_Deck_AB_Setg]        ,[S_Str_Chock_Typ]        ,[S_Str_End_Door_M941_90_Qlfy]        ,[S_Str_Dooredg_Prot_Cd]        ,[Enclsd_S_Str_Top_Deck_Setg]        ,[S_Str_Lese]        ,[Auto_Rk_Ctgy]        ,[S_Str_Ownr]        ,[S_Str_Crnt_Cost]        ,[S_Str_Enclsr_Cd]        ,[S_Str_End_Door_Dsgn]        ,[S_Str_Deck_Lvl_Cd]        ,[S_Str_Tare_Wgt]        ,[Is_S_Str_Intg_Wth_Car]        ,[Car_Char_Dimn_Id]        ,[Car_Char_Ver]        ,[Elem_Desc]        ,[Elem_Id]        ,[Elem_Lbl]        ,[Elem_Shrt_Desc]        ,car.[TTX_Blt_Dt]     ,hier1.TTX_Eq_Cd        ,hier1.[Eq_Char]        ,hier1.TTX_Eq_Cd_Desc     ---- container car logic       ,        CASE WHEN ( case when hier3.stat_cd in (998, 999) then hier3.[Bus_Ln_Shrt_Desc]        else isnull(hier3.[Bus_Ln_Shrt_Desc] , Hier2.Business_line_description) end) = 'Intermodal' AND [TTX_Mngd_Car_Ind] = 0      THEN         CASE WHEN SUBSTRING([Eq_Typ_Cd], 1, 1) IN ('P', 'Q') THEN 'Conventional'         WHEN SUBSTRING([Eq_Typ_Cd], 1, 2) IN ('S1', 'S2', 'S3', 'S4', 'S5') THEN 'DTTX 40-48ft'          WHEN SUBSTRING([Eq_Typ_Cd], 1, 2) IN ('S6', 'S7') THEN 'DTTX 53-56ft'                ELSE hier2.[Fleet_Segment_Description] END         WHEN ( case when hier3.stat_cd in (998, 999) then hier3.[Bus_Ln_Shrt_Desc]        else isnull(hier3.[Bus_Ln_Shrt_Desc] , Hier2.Business_line_description) end) = 'Intermodal'        AND (coalesce(car.[Car_Status_Maximo], car.[Car_Status_UFD]) = 'PRE-REGISTERED' or coalesce(car.[Car_Status_Maximo], car.[Car_Status_UFD]) IS NULL)     THEN NULL     ELSE hier2.[Fleet_Segment_Description] END  as [Fleet_Segment_Description]       ,isnull(            CASE WHEN ( case when hier3.stat_cd in (998, 999) then hier3.[Bus_Ln_Shrt_Desc]           else isnull(hier3.[Bus_Ln_Shrt_Desc] , Hier2.Business_line_description) end) = 'Intermodal' AND [TTX_Mngd_Car_Ind] = 0        THEN                   CASE WHEN SUBSTRING([Eq_Typ_Cd], 1, 1) IN ('P', 'Q') THEN 'Conventional'            WHEN SUBSTRING([Eq_Typ_Cd], 1, 2) IN ('S1', 'S2', 'S3', 'S4', 'S5', 'S6', 'S7') THEN 'Doublestack' END            ELSE (case when hier3.stat_cd in (998, 999) then hier3.[Eq_Typ_Shrt_Desc] else isnull(hier3.[Eq_Typ_Shrt_Desc], hier2.Equipment_Type_Description) end) END      ,'Unknown') AS Equipment_Type_Description          ,hier3.[Stat_Cd] AS Stat_Code        ,     isnull(      CASE WHEN ( case when hier3.stat_cd in (998, 999) then hier3.[Bus_Ln_Shrt_Desc]        else isnull(hier3.[Bus_Ln_Shrt_Desc] , Hier2.Business_line_description) end) = 'Intermodal' AND [TTX_Mngd_Car_Ind] = 0       THEN                 CASE WHEN SUBSTRING([Eq_Typ_Cd], 1, 2) IN ('S1', 'S2', 'S3', 'S4', 'S5') THEN '40 ft Wells'         WHEN SUBSTRING([Eq_Typ_Cd], 1, 2) IN ('S6', 'S7') THEN '53 ft Wells'          ELSE hier3.[Eq_Featr_Shrt_Desc] END      ELSE hier3.[Eq_Featr_Shrt_Desc] END           , 'Unknown') AS [Equipment_Feature]           ,hier3.[Car_Hrly_Rt] AS Car_Hourly_Rate        ,hier3.[Est_Car_Hrly_Rate] AS Estimated_Car_Hourly_Rate        ,hier3.[Daily_Miles] AS Daily_Miles        ,hier3.[Milg_Rt] AS Milg_Rate        ,hier3.[Fleet_Type]        ,hier3.[Rack_Type]     ,isnull(            CASE WHEN ( case when hier3.stat_cd in (998, 999) then hier3.[Bus_Ln_Shrt_Desc]           else isnull(hier3.[Bus_Ln_Shrt_Desc] , Hier2.Business_line_description) end) = 'Intermodal' AND [TTX_Mngd_Car_Ind] = 0        THEN                   CASE WHEN SUBSTRING([Eq_Typ_Cd], 1, 1) IN ('P', 'Q') THEN 'Conventional'            WHEN SUBSTRING([Eq_Typ_Cd], 1, 2) IN ('S1', 'S2', 'S3', 'S4', 'S5', 'S6', 'S7') THEN 'Doublestack' END            ELSE (case when hier3.stat_cd in (998, 999) then hier3.[Eq_Typ_Shrt_Desc] else isnull(hier3.[Eq_Typ_Shrt_Desc], hier2.Equipment_Type_Description) end) END      ,'Unknown') AS  Equipment_Type            ,isnull(case when hier3.stat_cd in (998, 999) then hier3.[Bus_Ln_Shrt_Desc]    else isnull(hier3.[Bus_Ln_Shrt_Desc] , Hier2.Business_line_description) end ,'Unknown') AS Business_Line      from  (     select    [Car_Nr]   ,[Car_Init]   ,[Car_Status_UFD]   ,[TTX_Eff_Dt]   ,[Car_Ownrshp_Ind]   ,[Pool_Cd]   ,[TTX_Mngd_Car_Ind]   ,Car_Eff_From   ,Car_Eff_To   ,[Car_Dimn_Id]   ,[Car_Ver]   ,Car_Src_Sys_Nm   ,[Ownr_Mrk]   ,[Eq_Hierchy_Id]   ,[Eq_Hierchy_Ver]   ,[Fleet_Hierchy_Ver]   ,[Entr_Hierchy_Ver]   ,[Fleet_Hierchy_Id]   ,[Entr_Hierchy_Id]   ,[Car_Cls]   ,[Railcar]   ,[Car_Lineage_Grp_Id]   ,[Assetnum]   ,[Fin_Car_Id]   ,[Car_Status_Maximo]   ,[Umler_Blt_Dt]   ,[Eq_Bldr]   ,[Bldr_Lot_Cd]   ,[Blt_From_Use_Ast]   ,[Brk_Cd]   ,[Car_Cost_Est_Act]      ,[Lese_Cd]     ,[Ldgr_Val]   ,[Lst_Shp_Dt]   ,[Milg_Upd_Dt]   ,[Orig_Car_Ownr]   ,[Orig_Cost]   ,[Reblt_Dt]   ,[Scnd_Hand_Dt]   ,[Scnd_Lese]   ,[Seller_Orig_Cost]   ,[Setl_Val]   ,[Split_Or_Cmbnd_Invl_Ind]   ,[Wghg_Pty]   ,[Milg_Sinc_Lst_Cls_A_Rpr_Dt]   ,[Milg_Sinc_Lst_Cls_B_Rpr_Dt]   ,[Milg_Sinc_Lst_Cls_I_Rpr_Dt]   ,[Lst_Cls_A_Rpr_Dt]   ,[Lst_Cls_B_Rpr_Dt]   ,[Lst_Cls_I_Rpr_Dt]   ,[Num_Dy_Car_Can]   ,[Num_Dy_Car_Mex]   ,[Can_Mex_Dy_Lst_Updt_Dt]   ,[Blng_Extd_Srvc_Ind]   ,[Rub_Rail_Upd]   ,[Cert_Dt]   ,[Cert_Cd]   ,[Car_Grd]   ,[Car_Grd_Dt]   ,[Osid_Usa_Ind]   ,[Insd_Len]   ,[Osid_Len]   ,Car_Char_Eff_From   ,Car_Char_Eff_To   ,[Pltfm_Fctr]   ,[Trk_Axl_Cnt]   ,[Axl_Cnt]   ,[TPE_Fctr]   ,[Ut_Cnt]   ,[Eq_Typ_Cd]   ,[Intmdit_Connt_Styl]   ,[S_Str_Bldr_Cd]   ,[S_Str_Modl]   ,[S_Str_Blt_Dt]   ,[Rt_Ind]   ,[S_Str_Addn_Betr_Val]   ,[Orig_Rk_Cost]   ,[Act_Rk_Dim_Ind]   ,[S_Str_Deck_BC_Setg]   ,[S_Str_Deck_AB_Setg]   ,[S_Str_Chock_Typ]   ,[S_Str_End_Door_M941_90_Qlfy]   ,[S_Str_Dooredg_Prot_Cd]   ,[Enclsd_S_Str_Top_Deck_Setg]   ,[S_Str_Lese]   ,[Auto_Rk_Ctgy]   ,[S_Str_Ownr]   ,[S_Str_Crnt_Cost]   ,[S_Str_Enclsr_Cd]   ,[S_Str_End_Door_Dsgn]   ,[S_Str_Deck_Lvl_Cd]   ,[S_Str_Tare_Wgt]   ,[Is_S_Str_Intg_Wth_Car]   ,[Car_Char_Dimn_Id]   ,[Car_Char_Ver]   ,[Elem_Desc]   ,[Elem_Id]   ,[Elem_Lbl]   ,[Elem_Shrt_Desc]   ,[TTX_Blt_Dt]           from (    select           car1.[Car_Nr]        ,car1.[Car_Init]        ,car1.[Car_Status_UFD]        ,car1.[TTX_Eff_Dt]        ,car1.[Car_Ownrshp_Ind]        ,car1.[Pool_Cd]        ,car1.[TTX_Mngd_Car_Ind]        ,car1.[Eff_From] as Car_Eff_From        ,car1.[Eff_To] as Car_Eff_To        ,car1.[Car_Dimn_Id]        ,car1.[Car_Ver]        ,car1.[Src_Sys_Nm] as Car_Src_Sys_Nm        ,car1.[Ownr_Mrk]        ,car1.[Eq_Hierchy_Id]        ,car1.[Eq_Hierchy_Ver]        ,car1.[Fleet_Hierchy_Ver]        ,car1.[Entr_Hierchy_Ver]        ,car1.[Fleet_Hierchy_Id]        ,car1.[Entr_Hierchy_Id]        ,car1.[Car_Cls]        ,car1.[Railcar]        ,car1.[Car_Lineage_Grp_Id]        ,car1.[Assetnum]        ,car1.[Fin_Car_Id]        ,car1.[Car_Status_Maximo]     ,cchar.[Umler_Blt_Dt]        ,cchar.[Eq_Bldr]        ,cchar.[Bldr_Lot_Cd]        ,cchar.[Blt_From_Use_Ast]        ,cchar.[Brk_Cd]        ,cchar.[Car_Cost_Est_Act]     ,cchar.[Lese_Cd]        ,cchar.[Ldgr_Val]        ,cchar.[Lst_Shp_Dt]        ,cchar.[Milg_Upd_Dt]        ,cchar.[Orig_Car_Ownr]        ,cchar.[Orig_Cost]        ,cchar.[Reblt_Dt]        ,cchar.[Scnd_Hand_Dt]        ,cchar.[Scnd_Lese]        ,cchar.[Seller_Orig_Cost]        ,cchar.[Setl_Val]        ,cchar.[Split_Or_Cmbnd_Invl_Ind]        ,cchar.[Wghg_Pty]        ,cchar.[Milg_Sinc_Lst_Cls_A_Rpr_Dt]        ,cchar.[Milg_Sinc_Lst_Cls_B_Rpr_Dt]        ,cchar.[Milg_Sinc_Lst_Cls_I_Rpr_Dt]        ,cchar.[Lst_Cls_A_Rpr_Dt]        ,cchar.[Lst_Cls_B_Rpr_Dt]        ,cchar.[Lst_Cls_I_Rpr_Dt]        ,cchar.[Num_Dy_Car_Can]        ,cchar.[Num_Dy_Car_Mex]        ,cchar.[Can_Mex_Dy_Lst_Updt_Dt]        ,cchar.[Blng_Extd_Srvc_Ind]        ,cchar.[Rub_Rail_Upd]        ,cchar.[Cert_Dt]        ,cchar.[Cert_Cd]        ,cchar.[Car_Grd]        ,cchar.[Car_Grd_Dt]        ,cchar.[Osid_Usa_Ind]        ,cchar.[Insd_Len]        ,cchar.[Osid_Len]        ,cchar.[Eff_From] as Car_Char_Eff_From        ,cchar.[Eff_To] as Car_Char_Eff_To        ,cchar.[Pltfm_Fctr]        ,cchar.[Trk_Axl_Cnt]        ,cchar.[Axl_Cnt]        ,cchar.[TPE_Fctr]        ,cchar.[Ut_Cnt]        ,cchar.[Eq_Typ_Cd]        ,cchar.[Intmdit_Connt_Styl]        ,cchar.[S_Str_Bldr_Cd]        ,cchar.[S_Str_Modl]        ,cchar.[S_Str_Blt_Dt]        ,cchar.[Rt_Ind]        ,cchar.[S_Str_Addn_Betr_Val]        ,cchar.[Orig_Rk_Cost]        ,cchar.[Act_Rk_Dim_Ind]        ,cchar.[S_Str_Deck_BC_Setg]        ,cchar.[S_Str_Deck_AB_Setg]        ,cchar.[S_Str_Chock_Typ]        ,cchar.[S_Str_End_Door_M941_90_Qlfy]        ,cchar.[S_Str_Dooredg_Prot_Cd]        ,cchar.[Enclsd_S_Str_Top_Deck_Setg]        ,cchar.[S_Str_Lese]        ,cchar.[Auto_Rk_Ctgy]        ,cchar.[S_Str_Ownr]        ,cchar.[S_Str_Crnt_Cost]        ,cchar.[S_Str_Enclsr_Cd]        ,cchar.[S_Str_End_Door_Dsgn]        ,cchar.[S_Str_Deck_Lvl_Cd]        ,cchar.[S_Str_Tare_Wgt]        ,cchar.[Is_S_Str_Intg_Wth_Car]        ,cchar.[Car_Char_Dimn_Id]        ,cchar.[Car_Char_Ver]        ,cchar.[Elem_Desc]        ,cchar.[Elem_Id]        ,cchar.[Elem_Lbl]        ,cchar.[Elem_Shrt_Desc]        ,cchar.[TTX_Blt_Dt]    from   dbo.[2022_09_Car_Dim] car1 (NOLOCK)     left join (select    Car_Dimn_Id   ,Car_Ver   ,[Umler_Blt_Dt]   ,[Eq_Bldr]   ,[Bldr_Lot_Cd]   ,[Blt_From_Use_Ast]   ,[Brk_Cd]   ,[Car_Cost_Est_Act]      ,[Lese_Cd]   ,[Ldgr_Val]   ,[Lst_Shp_Dt]   ,[Milg_Upd_Dt]   ,[Orig_Car_Ownr]   ,[Orig_Cost]   ,[Reblt_Dt]   ,[Scnd_Hand_Dt]   ,[Scnd_Lese]   ,[Seller_Orig_Cost]   ,[Setl_Val]   ,[Split_Or_Cmbnd_Invl_Ind]   ,[Wghg_Pty]   ,[Milg_Sinc_Lst_Cls_A_Rpr_Dt]   ,[Milg_Sinc_Lst_Cls_B_Rpr_Dt]   ,[Milg_Sinc_Lst_Cls_I_Rpr_Dt]   ,[Lst_Cls_A_Rpr_Dt]   ,[Lst_Cls_B_Rpr_Dt]   ,[Lst_Cls_I_Rpr_Dt]   ,[Num_Dy_Car_Can]   ,[Num_Dy_Car_Mex]   ,[Can_Mex_Dy_Lst_Updt_Dt]   ,[Blng_Extd_Srvc_Ind]   ,[Rub_Rail_Upd]   ,[Cert_Dt]   ,[Cert_Cd]   ,[Car_Grd]   ,[Car_Grd_Dt]   ,[Osid_Usa_Ind]   ,[Insd_Len]   ,[Osid_Len]   ,[Eff_From]    ,[Eff_To]    ,[Pltfm_Fctr]   ,[Trk_Axl_Cnt]   ,[Axl_Cnt]   ,[TPE_Fctr]   ,[Ut_Cnt]   ,[Eq_Typ_Cd]   ,[Intmdit_Connt_Styl]   ,[S_Str_Bldr_Cd]   ,[S_Str_Modl]   ,[S_Str_Blt_Dt]   ,[Rt_Ind]   ,[S_Str_Addn_Betr_Val]   ,[Orig_Rk_Cost]   ,[Act_Rk_Dim_Ind]   ,[S_Str_Deck_BC_Setg]   ,[S_Str_Deck_AB_Setg]   ,[S_Str_Chock_Typ]   ,[S_Str_End_Door_M941_90_Qlfy]   ,[S_Str_Dooredg_Prot_Cd]   ,[Enclsd_S_Str_Top_Deck_Setg]   ,[S_Str_Lese]   ,[Auto_Rk_Ctgy]   ,[S_Str_Ownr]   ,[S_Str_Crnt_Cost]   ,[S_Str_Enclsr_Cd]   ,[S_Str_End_Door_Dsgn]   ,[S_Str_Deck_Lvl_Cd]   ,[S_Str_Tare_Wgt]   ,[Is_S_Str_Intg_Wth_Car]   ,[Car_Char_Dimn_Id]   ,[Car_Char_Ver]   ,[Elem_Desc]   ,[Elem_Id]   ,[Elem_Lbl]   ,[Elem_Shrt_Desc]   ,[TTX_Blt_Dt]       from dbo.Car_Characteristic_Dim (NOLOCK) where eff_to is null) cchar    on (car1.Car_Dimn_Id = cchar.Car_Dimn_Id )    ) ta      ) car  left join [dbo].[VMRT_Car_Hierarchy_Equipment] hier1  on (car.eq_Hierchy_Id = hier1.Hierchy_Id and car.eq_Hierchy_ver = hier1.hierchy_ver)  left join [dbo].[VMRT_Car_Hierarchy_Fleet] hier2  on (car.Fleet_Hierchy_Id = hier2.Hierchy_Id and car.fleet_Hierchy_ver = hier2.hierchy_ver)  left join [dbo].[VMRT_Car_Hierarchy_Enterprise] hier3  on (car.Entr_Hierchy_Id = hier3.Hierchy_Id and car.Entr_Hierchy_ver = hier3.hierchy_ver)"
    },
    {
      "id": "syncobj_0x4341383632324633",
      "name": "syncobj_0x4341383632324633",
      "type": "VIEW",
      "sql": "create view [dbo].[syncobj_0x4341383632324633]as select  [Area_Of_Car_Dimn_Id],[Area_Of_Car_Ver],[Apl_Job_Cd],[Apl_Qlfr_Cd],[Apl_Job_Cd_Desc],[Apl_Qlfr_Cd_Desc],[Area_Of_Car_Lvl_1],[Area_Of_Car_Lvl_2],[Area_Of_Car_Lvl_3],[Area_Of_Car_Lvl_4],[Job_Cd_Act_Ind],[Whl_Sz],[Whl_Cls],[Whl_Cond],[Cond_Based_Mnt_Typ],[Cond_Based_Mnt_Flg],[Eff_From],[Eff_To],[Crtd_Dt],[Crtd_Id],[Lst_Upd_Dt],[Lst_Upd_Id],[Src_Sys_Nm],[Dq_Flg],[Ref_Nr],[Miscellaneous_Flag],[Miscellaneous_Type]  from  [dbo].[Area_Of_Car_Dim]  where HAS_PERMS_BY_NAME('[dbo].[Area_Of_Car_Dim]', 'OBJECT', 'SELECT')= 1  and ((1=0))"
    },
    {
      "id": "VMRT_Loading_AAR",
      "name": "VMRT_Loading_AAR",
      "type": "VIEW",
      "sql": "CREATE VIEW [dbo].[VMRT_Loading_AAR]  AS  SELECT Dt_Dimn_Id                         as Week_Start_Date_Dimn_Id        ,STCC_Dimn_Id                              ,Road_Org_Dimn_Id        ,Road_Org_Ver        ,Ld_Trip_Strts_Cnt       as Loaded_Trip_Starts_Cnt        ,Ld_Ich_Cnt_Parti        as Loads_Interchanged_Cnt        ,Totl_Vol_Handled_Parti      as Total_Volume_Handled        ,Trip_Orig_Regn_Geo_Dimn_Id     as Trip_Origin_Region_Geo_Dimn_Id        ,Lst_Upd_Dt         as Last_Updated_Date        ,Crtd_Dt          as Created_Date   FROM DDSMRT.dbo.[AAR_Loading_Fact]  (NOLOCK)    WHERE Row_Typ_Id=505 AND ISNULL(Dlet_flg,0) <> 1"
    },
    {
      "id": "VCar_Lineage_Dim",
      "name": "VCar_Lineage_Dim",
      "type": "VIEW",
      "sql": "CREATE VIEW DDSV.VCar_Lineage_Dim  AS      SELECT  [Car_Lineage_Leas_Dimn_Id] ,              CONCAT(CONVERT(VARCHAR(10), [Car_Dimn_Id]), '_',                     CONVERT(VARCHAR(5), [Car_Ver])) AS [Car_Dimn_Id] ,              [TTX_Car_Id] ,              [TTX_Car_Init] ,              [TTX_Car_Nr] ,              [Loc_On_From_Car] ,              [From_Car_Id] ,              [From_Car_Init] ,              [From_Car_Nr] ,              [From_Car_Cls] ,              [From_Cls_Str_Id] ,              [From_Car_Tmplt] ,              [From_Car_Unit_Cnt] ,              [From_Car_Insd] ,              [From_Car_Stat] ,              [From_Car_Blt_Dt] ,              [To_Car_Cntr] ,              [To_Car_Id] ,              [To_Car_Init] ,              [To_Car_Nr] ,              [To_Car_Cls] ,              [To_Car_Str_Id] ,              [To_Car_Tmplt] ,              [To_Car_Unit_Cnt] ,              [To_Car_Insd] ,              [Loc_On_To_Car] ,              [To_Car_Stat] ,              [To_Car_Blt_Dt] ,              [Crtd_Dt] ,              [Crtd_Id] ,              [Lst_Upd_Dt] ,              [Lst_Upd_Id]      FROM    [DDSMRT].[dbo].[Car_Lineage_Dim]"
    },
    {
      "id": "VMRT_Car_Dimension_Hist",
      "name": "VMRT_Car_Dimension_Hist",
      "type": "VIEW",
      "sql": "CREATE view [dbo].[VMRT_Car_Dimension_Hist]     WITH SCHEMABINDING    as    select         car.[Car_Nr]          ,car.[Car_Init]          ,car.[Car_Status_UFD]          ,car.[TTX_Eff_Dt]          ,car.[Car_Ownrshp_Ind]          ,car.[Pool_Cd]          ,car.[TTX_Mngd_Car_Ind]          ,car.Car_Eff_From          ,car.Car_Eff_To          ,car.[Car_Dimn_Id]          ,car.[Car_Ver]          ,car.Car_Src_Sys_Nm          ,car.[Ownr_Mrk]          ,car.[Eq_Hierchy_Id]          ,car.[Eq_Hierchy_Ver]          ,car.[Fleet_Hierchy_Ver]          ,car.[Entr_Hierchy_Ver]          ,car.[Fleet_Hierchy_Id]          ,car.[Entr_Hierchy_Id]          ,car.[Car_Cls]          ,car.[Railcar]          ,car.[Car_Lineage_Grp_Id]          ,car.[Assetnum]          ,car.[Fin_Car_Id]          ,car.[Car_Status_Maximo]       ,[Umler_Blt_Dt]          ,[Eq_Bldr]          ,[Bldr_Lot_Cd]          ,[Blt_From_Use_Ast]          ,[Brk_Cd]          ,[Car_Cost_Est_Act]       ,[Lese_Cd]          ,[Ldgr_Val]          ,[Lst_Shp_Dt]          ,[Milg_Upd_Dt]          ,[Orig_Car_Ownr]          ,[Orig_Cost]          ,[Reblt_Dt]          ,[Scnd_Hand_Dt]          ,[Scnd_Lese]          ,[Seller_Orig_Cost]          ,[Setl_Val]          ,[Split_Or_Cmbnd_Invl_Ind]          ,[Wghg_Pty]          ,[Milg_Sinc_Lst_Cls_A_Rpr_Dt]          ,[Milg_Sinc_Lst_Cls_B_Rpr_Dt]          ,[Milg_Sinc_Lst_Cls_I_Rpr_Dt]          ,[Lst_Cls_A_Rpr_Dt]          ,[Lst_Cls_B_Rpr_Dt]          ,[Lst_Cls_I_Rpr_Dt]          ,[Num_Dy_Car_Can]          ,[Num_Dy_Car_Mex]          ,[Can_Mex_Dy_Lst_Updt_Dt]          ,[Blng_Extd_Srvc_Ind]          ,[Rub_Rail_Upd]          ,[Cert_Dt]          ,[Cert_Cd]          ,[Car_Grd]          ,[Car_Grd_Dt]          ,[Osid_Usa_Ind]          ,[Insd_Len]          ,[Osid_Len]          ,car.Car_Char_Eff_From          ,car.Car_Char_Eff_To      --    ,ISNULL(ISNULL(car.[Pltfm_Fctr], 2*Ut_Cnt),1.0) as [Pltfm_Fctr]      ,ISNULL(car.[Pltfm_Fctr],1.0) as [Pltfm_Fctr]          ,car.[Trk_Axl_Cnt]          ,car.[Axl_Cnt]          ,ISNULL(car.[TPE_Fctr], 1) as [TPE_Fctr]          ,car.[Ut_Cnt]          ,[Eq_Typ_Cd]          ,[Intmdit_Connt_Styl]          ,[S_Str_Bldr_Cd]          ,[S_Str_Modl]          ,[S_Str_Blt_Dt]          ,[Rt_Ind]          ,[S_Str_Addn_Betr_Val]          ,[Orig_Rk_Cost]          ,[Act_Rk_Dim_Ind]          ,[S_Str_Deck_BC_Setg]          ,[S_Str_Deck_AB_Setg]          ,[S_Str_Chock_Typ]          ,[S_Str_End_Door_M941_90_Qlfy]          ,[S_Str_Dooredg_Prot_Cd]          ,[Enclsd_S_Str_Top_Deck_Setg]          ,[S_Str_Lese]          ,[Auto_Rk_Ctgy]          ,[S_Str_Ownr]          ,[S_Str_Crnt_Cost]          ,[S_Str_Enclsr_Cd]          ,[S_Str_End_Door_Dsgn]          ,[S_Str_Deck_Lvl_Cd]          ,[S_Str_Tare_Wgt]          ,[Is_S_Str_Intg_Wth_Car]          ,[Car_Char_Dimn_Id]          ,[Car_Char_Ver]          ,[Elem_Desc]          ,[Elem_Id]          ,[Elem_Lbl]          ,[Elem_Shrt_Desc]          ,car.[TTX_Blt_Dt]       ,hier1.TTX_Eq_Cd          ,hier1.[Eq_Char]          ,hier1.TTX_Eq_Cd_Desc       ---- container car logic           ,            CASE WHEN ( case when hier3.stat_cd in (998, 999) then hier3.[Bus_Ln_Shrt_Desc]          else isnull(hier3.[Bus_Ln_Shrt_Desc] , Hier2.Business_line_description) end) = 'Intermodal' AND [TTX_Mngd_Car_Ind] = 0        THEN           CASE WHEN SUBSTRING([Eq_Typ_Cd], 1, 1) IN ('P', 'Q') THEN 'Conventional'           WHEN SUBSTRING([Eq_Typ_Cd], 1, 2) IN ('S1', 'S2', 'S3', 'S4', 'S5') THEN 'DTTX 40-48ft'            WHEN SUBSTRING([Eq_Typ_Cd], 1, 2) IN ('S6', 'S7') THEN 'DTTX 53-56ft'                    ELSE hier2.[Fleet_Segment_Description] END             WHEN ( case when hier3.stat_cd in (998, 999) then hier3.[Bus_Ln_Shrt_Desc]          else isnull(hier3.[Bus_Ln_Shrt_Desc] , Hier2.Business_line_description) end) = 'Intermodal'          AND (coalesce(car.[Car_Status_Maximo], car.[Car_Status_UFD]) = 'PRE-REGISTERED' or coalesce(car.[Car_Status_Maximo], car.[Car_Status_UFD]) IS NULL)       THEN NULL       ELSE hier2.[Fleet_Segment_Description] END  as [Fleet_Segment_Description]           ,isnull(                CASE WHEN ( case when hier3.stat_cd in (998, 999) then hier3.[Bus_Ln_Shrt_Desc]             else isnull(hier3.[Bus_Ln_Shrt_Desc] , Hier2.Business_line_description) end) = 'Intermodal' AND [TTX_Mngd_Car_Ind] = 0          THEN                       CASE WHEN SUBSTRING([Eq_Typ_Cd], 1, 1) IN ('P', 'Q') THEN 'Conventional'              WHEN SUBSTRING([Eq_Typ_Cd], 1, 2) IN ('S1', 'S2', 'S3', 'S4', 'S5', 'S6', 'S7') THEN 'Doublestack' END                ELSE (case when hier3.stat_cd in (998, 999) then hier3.[Eq_Typ_Shrt_Desc] else isnull(hier3.[Eq_Typ_Shrt_Desc], hier2.Equipment_Type_Description) end) END        ,'Unknown') AS Equipment_Type_Description                  ,hier3.[Stat_Cd] AS Stat_Code          ,       isnull(        CASE WHEN ( case when hier3.stat_cd in (998, 999) then hier3.[Bus_Ln_Shrt_Desc]          else isnull(hier3.[Bus_Ln_Shrt_Desc] , Hier2.Business_line_description) end) = 'Intermodal' AND [TTX_Mngd_Car_Ind] = 0         THEN                     CASE WHEN SUBSTRING([Eq_Typ_Cd], 1, 2) IN ('S1', 'S2', 'S3', 'S4', 'S5') THEN '40 ft Wells'           WHEN SUBSTRING([Eq_Typ_Cd], 1, 2) IN ('S6', 'S7') THEN '53 ft Wells'            ELSE hier3.[Eq_Featr_Shrt_Desc] END        ELSE hier3.[Eq_Featr_Shrt_Desc] END               , 'Unknown') AS [Equipment_Feature]               ,hier3.[Car_Hrly_Rt] AS Car_Hourly_Rate          ,hier3.[Est_Car_Hrly_Rate] AS Estimated_Car_Hourly_Rate          ,hier3.[Daily_Miles] AS Daily_Miles          ,hier3.[Milg_Rt] AS Milg_Rate          ,hier3.[Fleet_Type]          ,hier3.[Rack_Type]       ,isnull(                CASE WHEN ( case when hier3.stat_cd in (998, 999) then hier3.[Bus_Ln_Shrt_Desc]             else isnull(hier3.[Bus_Ln_Shrt_Desc] , Hier2.Business_line_description) end) = 'Intermodal' AND [TTX_Mngd_Car_Ind] = 0          THEN                       CASE WHEN SUBSTRING([Eq_Typ_Cd], 1, 1) IN ('P', 'Q') THEN 'Conventional'              WHEN SUBSTRING([Eq_Typ_Cd], 1, 2) IN ('S1', 'S2', 'S3', 'S4', 'S5', 'S6', 'S7') THEN 'Doublestack' END                ELSE (case when hier3.stat_cd in (998, 999) then hier3.[Eq_Typ_Shrt_Desc] else isnull(hier3.[Eq_Typ_Shrt_Desc], hier2.Equipment_Type_Description) end) END        ,'Unknown') AS  Equipment_Type                  ,isnull(case when hier3.stat_cd in (998, 999) then hier3.[Bus_Ln_Shrt_Desc]      else isnull(hier3.[Bus_Ln_Shrt_Desc] , Hier2.Business_line_description) end ,'Unknown') AS Business_Line            from  (         select      [Car_Nr]     ,[Car_Init]     ,[Car_Status_UFD]     ,[TTX_Eff_Dt]     ,[Car_Ownrshp_Ind]     ,[Pool_Cd]     ,[TTX_Mngd_Car_Ind]     ,Car_Eff_From     ,Car_Eff_To     ,[Car_Dimn_Id]     ,[Car_Ver]     ,Car_Src_Sys_Nm     ,[Ownr_Mrk]     ,[Eq_Hierchy_Id]     ,[Eq_Hierchy_Ver]     ,[Fleet_Hierchy_Ver]     ,[Entr_Hierchy_Ver]     ,[Fleet_Hierchy_Id]     ,[Entr_Hierchy_Id]     ,[Car_Cls]     ,[Railcar]     ,[Car_Lineage_Grp_Id]     ,[Assetnum]     ,[Fin_Car_Id]     ,[Car_Status_Maximo]     ,[Umler_Blt_Dt]     ,[Eq_Bldr]     ,[Bldr_Lot_Cd]     ,[Blt_From_Use_Ast]     ,[Brk_Cd]     ,[Car_Cost_Est_Act]        ,[Lese_Cd]         ,[Ldgr_Val]     ,[Lst_Shp_Dt]     ,[Milg_Upd_Dt]     ,[Orig_Car_Ownr]     ,[Orig_Cost]     ,[Reblt_Dt]     ,[Scnd_Hand_Dt]     ,[Scnd_Lese]     ,[Seller_Orig_Cost]     ,[Setl_Val]     ,[Split_Or_Cmbnd_Invl_Ind]     ,[Wghg_Pty]     ,[Milg_Sinc_Lst_Cls_A_Rpr_Dt]     ,[Milg_Sinc_Lst_Cls_B_Rpr_Dt]     ,[Milg_Sinc_Lst_Cls_I_Rpr_Dt]     ,[Lst_Cls_A_Rpr_Dt]     ,[Lst_Cls_B_Rpr_Dt]     ,[Lst_Cls_I_Rpr_Dt]     ,[Num_Dy_Car_Can]     ,[Num_Dy_Car_Mex]     ,[Can_Mex_Dy_Lst_Updt_Dt]     ,[Blng_Extd_Srvc_Ind]     ,[Rub_Rail_Upd]     ,[Cert_Dt]     ,[Cert_Cd]     ,[Car_Grd]     ,[Car_Grd_Dt]     ,[Osid_Usa_Ind]     ,[Insd_Len]     ,[Osid_Len]     ,Car_Char_Eff_From     ,Car_Char_Eff_To     ,[Pltfm_Fctr]     ,[Trk_Axl_Cnt]     ,[Axl_Cnt]     ,[TPE_Fctr]     ,[Ut_Cnt]     ,[Eq_Typ_Cd]     ,[Intmdit_Connt_Styl]     ,[S_Str_Bldr_Cd]     ,[S_Str_Modl]     ,[S_Str_Blt_Dt]     ,[Rt_Ind]     ,[S_Str_Addn_Betr_Val]     ,[Orig_Rk_Cost]     ,[Act_Rk_Dim_Ind]     ,[S_Str_Deck_BC_Setg]     ,[S_Str_Deck_AB_Setg]     ,[S_Str_Chock_Typ]     ,[S_Str_End_Door_M941_90_Qlfy]     ,[S_Str_Dooredg_Prot_Cd]     ,[Enclsd_S_Str_Top_Deck_Setg]     ,[S_Str_Lese]     ,[Auto_Rk_Ctgy]     ,[S_Str_Ownr]     ,[S_Str_Crnt_Cost]     ,[S_Str_Enclsr_Cd]     ,[S_Str_End_Door_Dsgn]     ,[S_Str_Deck_Lvl_Cd]     ,[S_Str_Tare_Wgt]     ,[Is_S_Str_Intg_Wth_Car]     ,[Car_Char_Dimn_Id]     ,[Car_Char_Ver]     ,[Elem_Desc]     ,[Elem_Id]     ,[Elem_Lbl]     ,[Elem_Shrt_Desc]     ,[TTX_Blt_Dt]                 from (      select             car1.[Car_Nr]          ,car1.[Car_Init]          ,car1.[Car_Status_UFD]          ,car1.[TTX_Eff_Dt]          ,car1.[Car_Ownrshp_Ind]          ,car1.[Pool_Cd]          ,car1.[TTX_Mngd_Car_Ind]          ,car1.[Eff_From] as Car_Eff_From          ,car1.[Eff_To] as Car_Eff_To          ,car1.[Car_Dimn_Id]          ,car1.[Car_Ver]          ,car1.[Src_Sys_Nm] as Car_Src_Sys_Nm          ,car1.[Ownr_Mrk]          ,car1.[Eq_Hierchy_Id]          ,car1.[Eq_Hierchy_Ver]          ,car1.[Fleet_Hierchy_Ver]          ,car1.[Entr_Hierchy_Ver]          ,car1.[Fleet_Hierchy_Id]          ,car1.[Entr_Hierchy_Id]          ,car1.[Car_Cls]          ,car1.[Railcar]          ,car1.[Car_Lineage_Grp_Id]          ,car1.[Assetnum]          ,car1.[Fin_Car_Id]          ,car1.[Car_Status_Maximo]       ,cchar.[Umler_Blt_Dt]          ,cchar.[Eq_Bldr]          ,cchar.[Bldr_Lot_Cd]          ,cchar.[Blt_From_Use_Ast]          ,cchar.[Brk_Cd]          ,cchar.[Car_Cost_Est_Act]       ,cchar.[Lese_Cd]          ,cchar.[Ldgr_Val]          ,cchar.[Lst_Shp_Dt]          ,cchar.[Milg_Upd_Dt]          ,cchar.[Orig_Car_Ownr]          ,cchar.[Orig_Cost]          ,cchar.[Reblt_Dt]          ,cchar.[Scnd_Hand_Dt]          ,cchar.[Scnd_Lese]          ,cchar.[Seller_Orig_Cost]          ,cchar.[Setl_Val]          ,cchar.[Split_Or_Cmbnd_Invl_Ind]          ,cchar.[Wghg_Pty]          ,cchar.[Milg_Sinc_Lst_Cls_A_Rpr_Dt]          ,cchar.[Milg_Sinc_Lst_Cls_B_Rpr_Dt]          ,cchar.[Milg_Sinc_Lst_Cls_I_Rpr_Dt]          ,cchar.[Lst_Cls_A_Rpr_Dt]          ,cchar.[Lst_Cls_B_Rpr_Dt]          ,cchar.[Lst_Cls_I_Rpr_Dt]          ,cchar.[Num_Dy_Car_Can]          ,cchar.[Num_Dy_Car_Mex]          ,cchar.[Can_Mex_Dy_Lst_Updt_Dt]          ,cchar.[Blng_Extd_Srvc_Ind]          ,cchar.[Rub_Rail_Upd]          ,cchar.[Cert_Dt]          ,cchar.[Cert_Cd]          ,cchar.[Car_Grd]          ,cchar.[Car_Grd_Dt]          ,cchar.[Osid_Usa_Ind]          ,cchar.[Insd_Len]          ,cchar.[Osid_Len]          ,cchar.[Eff_From] as Car_Char_Eff_From          ,cchar.[Eff_To] as Car_Char_Eff_To          ,cchar.[Pltfm_Fctr]          ,cchar.[Trk_Axl_Cnt]          ,cchar.[Axl_Cnt]          ,cchar.[TPE_Fctr]          ,cchar.[Ut_Cnt]          ,cchar.[Eq_Typ_Cd]          ,cchar.[Intmdit_Connt_Styl]          ,cchar.[S_Str_Bldr_Cd]          ,cchar.[S_Str_Modl]          ,cchar.[S_Str_Blt_Dt]          ,cchar.[Rt_Ind]          ,cchar.[S_Str_Addn_Betr_Val]          ,cchar.[Orig_Rk_Cost]          ,cchar.[Act_Rk_Dim_Ind]          ,cchar.[S_Str_Deck_BC_Setg]          ,cchar.[S_Str_Deck_AB_Setg]          ,cchar.[S_Str_Chock_Typ]          ,cchar.[S_Str_End_Door_M941_90_Qlfy]          ,cchar.[S_Str_Dooredg_Prot_Cd]          ,cchar.[Enclsd_S_Str_Top_Deck_Setg]          ,cchar.[S_Str_Lese]          ,cchar.[Auto_Rk_Ctgy]          ,cchar.[S_Str_Ownr]          ,cchar.[S_Str_Crnt_Cost]          ,cchar.[S_Str_Enclsr_Cd]          ,cchar.[S_Str_End_Door_Dsgn]          ,cchar.[S_Str_Deck_Lvl_Cd]          ,cchar.[S_Str_Tare_Wgt]          ,cchar.[Is_S_Str_Intg_Wth_Car]          ,cchar.[Car_Char_Dimn_Id]          ,cchar.[Car_Char_Ver]          ,cchar.[Elem_Desc]          ,cchar.[Elem_Id]          ,cchar.[Elem_Lbl]          ,cchar.[Elem_Shrt_Desc]          ,cchar.[TTX_Blt_Dt]      from     dbo.[2022_09_Car_Dim] (NOLOCK) car1      left join (select      Car_Dimn_Id     ,Car_Ver     ,[Umler_Blt_Dt]     ,[Eq_Bldr]     ,[Bldr_Lot_Cd]     ,[Blt_From_Use_Ast]     ,[Brk_Cd]     ,[Car_Cost_Est_Act]        ,[Lese_Cd]     ,[Ldgr_Val]     ,[Lst_Shp_Dt]     ,[Milg_Upd_Dt]     ,[Orig_Car_Ownr]     ,[Orig_Cost]     ,[Reblt_Dt]     ,[Scnd_Hand_Dt]     ,[Scnd_Lese]     ,[Seller_Orig_Cost]     ,[Setl_Val]     ,[Split_Or_Cmbnd_Invl_Ind]     ,[Wghg_Pty]     ,[Milg_Sinc_Lst_Cls_A_Rpr_Dt]     ,[Milg_Sinc_Lst_Cls_B_Rpr_Dt]     ,[Milg_Sinc_Lst_Cls_I_Rpr_Dt]     ,[Lst_Cls_A_Rpr_Dt]     ,[Lst_Cls_B_Rpr_Dt]     ,[Lst_Cls_I_Rpr_Dt]     ,[Num_Dy_Car_Can]     ,[Num_Dy_Car_Mex]     ,[Can_Mex_Dy_Lst_Updt_Dt]     ,[Blng_Extd_Srvc_Ind]     ,[Rub_Rail_Upd]     ,[Cert_Dt]     ,[Cert_Cd]     ,[Car_Grd]     ,[Car_Grd_Dt]     ,[Osid_Usa_Ind]     ,[Insd_Len]     ,[Osid_Len]     ,[Eff_From]      ,[Eff_To]      ,[Pltfm_Fctr]     ,[Trk_Axl_Cnt]     ,[Axl_Cnt]     ,[TPE_Fctr]     ,[Ut_Cnt]     ,[Eq_Typ_Cd]   ,[Intmdit_Connt_Styl]     ,[S_Str_Bldr_Cd]     ,[S_Str_Modl]     ,[S_Str_Blt_Dt]     ,[Rt_Ind]     ,[S_Str_Addn_Betr_Val]     ,[Orig_Rk_Cost]     ,[Act_Rk_Dim_Ind]     ,[S_Str_Deck_BC_Setg]     ,[S_Str_Deck_AB_Setg]     ,[S_Str_Chock_Typ]     ,[S_Str_End_Door_M941_90_Qlfy]     ,[S_Str_Dooredg_Prot_Cd]     ,[Enclsd_S_Str_Top_Deck_Setg]     ,[S_Str_Lese]     ,[Auto_Rk_Ctgy]     ,[S_Str_Ownr]     ,[S_Str_Crnt_Cost]     ,[S_Str_Enclsr_Cd]     ,[S_Str_End_Door_Dsgn]     ,[S_Str_Deck_Lvl_Cd]     ,[S_Str_Tare_Wgt]     ,[Is_S_Str_Intg_Wth_Car]     ,[Car_Char_Dimn_Id]     ,[Car_Char_Ver]     ,[Elem_Desc]     ,[Elem_Id]     ,[Elem_Lbl]     ,[Elem_Shrt_Desc]     ,[TTX_Blt_Dt]        --Retrieve data from Car_Characterstic_Dim for all dates    from dbo.Car_Characteristic_Dim (NOLOCK) ) cchar      on (car1.Car_Dimn_Id = cchar.Car_Dimn_Id and    car1.Car_Ver = cchar.Car_Ver   )      ) ta      ) car    left join [dbo].[VMRT_Car_Hierarchy_Equipment] hier1    on (car.eq_Hierchy_Id = hier1.Hierchy_Id and car.eq_Hierchy_ver = hier1.hierchy_ver)    left join [dbo].[VMRT_Car_Hierarchy_Fleet] hier2    on (car.Fleet_Hierchy_Id = hier2.Hierchy_Id and car.fleet_Hierchy_ver = hier2.hierchy_ver)    left join [dbo].[VMRT_Car_Hierarchy_Enterprise] hier3    on (car.Entr_Hierchy_Id = hier3.Hierchy_Id and car.Entr_Hierchy_ver = hier3.hierchy_ver)"
    },
    {
      "id": "AR_FILTER_00005_1195151303",
      "name": "AR_FILTER_00005_1195151303",
      "type": "REPLICATION_FILTER_PROCEDURE",
      "sql": "create procedure [dbo].[AR_FILTER_00005_1195151303] for replication as if exists (select * from [dbo].[Area_Of_Car_Dim] where (1=0)) return 1 else return 0"
    },
    {
      "id": "syncobj_0x4646453836463236",
      "name": "syncobj_0x4646453836463236",
      "type": "VIEW",
      "sql": "create view [dbo].[syncobj_0x4646453836463236]as select  [Car_Loc_Dimn_Id],[Area_Of_Car_Lvl_1],[Ut_Cnt],[Intmdit_Connt_Styl],[On_Car_Loc_Cd],[Axl_Loc_Cd],[Trk_Loc_Cd],[Crtd_Dt],[Crtd_Id],[Lst_Upd_Dt],[Lst_Upd_Id],[Src_Sys_Nm],[Dq_Flg]  from  [dbo].[Car_Location_Dim]  where HAS_PERMS_BY_NAME('[dbo].[Car_Location_Dim]', 'OBJECT', 'SELECT')= 1  and ((1=0))"
    },
    {
      "id": "VMRT_Maximo_Car_Count",
      "name": "VMRT_Maximo_Car_Count",
      "type": "VIEW",
      "sql": "CREATE view [dbo].[VMRT_Maximo_Car_Count]   as      select      max_car_cnt.car_dimn_id      ,max_car_cnt.car_ver      ,max_car_cnt.Dt_Dimn_Id as Snapshot_Dt_Dimn_Id      ,max_car_cnt as Maximo_Fleet_Size_Car_Cnt      ,max_tpe_cnt as Maximo_Fleet_Size_TPE_Cnt      ,max_ut_cnt as Maximo_Fleet_Size_Unit_Cnt      ,max_pltfm_cnt as Maximo_Fleet_Size_Platform_Cnt    from  ddsmrt.dbo.vw_car_count_fact max_car_cnt (NOLOCK)    INNER JOIN   (   SELECT car_dimn_id,car_ver,Dt_Dimn_Id, sum(car_cnt) AS max_car_cnt, sum(tpe_cnt) AS max_tpe_cnt , sum(Ut_cnt) as max_ut_cnt, sum(Pltfm_cnt) as max_pltfm_cnt   from  ddsmrt.dbo.vw_car_count_fact fact (NOLOCK)    where row_typ_id=519 and Car_cnt_Catg_Typ_id =138   group by car_dimn_id,car_ver,Dt_Dimn_Id  )a    on max_car_cnt.car_dimn_id = a.car_dimn_id and max_car_cnt.car_ver = a.car_ver    and max_car_cnt.Dt_Dimn_Id = a.Dt_Dimn_Id  where row_typ_id=519"
    },
    {
      "id": "AR_FILTER_00005_864722133",
      "name": "AR_FILTER_00005_864722133",
      "type": "REPLICATION_FILTER_PROCEDURE",
      "sql": "create procedure [dbo].[AR_FILTER_00005_864722133] for replication as if exists (select * from [dbo].[Car_Location_Dim] where (1=0)) return 1 else return 0"
    },
    {
      "id": "vw_Repair_Event_Cost_Fact",
      "name": "vw_Repair_Event_Cost_Fact",
      "type": "VIEW",
      "sql": "CREATE VIEW [dbo].[vw_Repair_Event_Cost_Fact]  AS  SELECT [Rpr_Evnt_Cst_Fct_Id]        ,[Car_Dimn_Id]        ,[Car_Ver]        ,[Repr_Enty_Dimn_Id]        ,[Repr_Enty_Ver]        ,[Mnt_Typ_Dimn_Id]        ,[Mnt_Typ_Ver]        ,[Area_Of_Car_Dimn_Id]        ,[Area_Of_Car_Ver]        ,[Rpr_Dt_Dimn_Id]        ,[SPLC_Dimn_Id]        ,[TTX_Acct_Dt_Dimn_Id]        ,[Cond_Cd_Dimn_Id]        ,[Repr_Evnt_Typ_Cd_Dimn_Id]        ,[Resp_Cd_Dimn_Id]        ,[Why_Md_Cd_Dimn_Id]        ,[Car_Loc_Dimn_Id]        ,[Matl_Dimn_Id]        ,[Spon_Road_Org_Dimn_Id]        ,[Spon_Road_Org_Ver]        ,[Invc_Enty_Org_Dimn_Id]        ,[Invc_Enty_Org_Ver]        ,[Vndr_Dimn_Id]        ,[Vndr_Ver]        ,[Uniq_Rec_Id]        ,[Inv_Ln_Nr]        ,[Inv_Nr]        ,[Repr_Dt]        ,[TTX_Acct_Dt]        ,[Car_Nr]        ,[Car_Init]        ,[Repr_Enty_Org_Abrv]        ,[SPLC_Nr]        ,[Apl_Job_Cd]        ,[Apl_Qlfr_Cd]        ,[Loc_On_Car_Cd]        ,[Repr_Cd]        ,[Repr_Cls_Cd]        ,[Resp_Cd]        ,[Why_Md_Cd]        ,[Repr_Evnt_Typ_Cd]        ,[Car_Cls]        ,[Invc_Typ]        ,[Invc_Enty_Id]        ,[Acct_Typ]        ,[Cnd_Cd]        ,[Orig_Party]        ,[Vndr_Mfg_Cd]        ,[Ref_Nr]        ,[Repr_Desc]        ,[Frgn_Repr_Typ]        ,[Bil_Card_Stts]        ,[Labr_Rt]        ,[Labr_Hrs]        ,[Labr_Cost]        ,[Matl_Cost]        ,[Cmpnt_Qty]        ,[Repr_Cnv_Flg]        ,[Car_Age_Bukt]        ,[Crtd_Dt]        ,[Crtd_Id]        ,[Lst_Upd_Id]        ,[Lst_Upd_Dt]        ,[Src_Sys_Nm]        ,[Dq_Flg]        ,[Work_Type_Dimn_Id]        ,[Wrk_Ord_Nr]     ,[Invoice_Type_ID]     ,[Photo_Indicator_Flag]    FROM [dbo].[Repair_Event_Cost_Fact]"
    },
    {
      "id": "syncobj_0x3341423131324138",
      "name": "syncobj_0x3341423131324138",
      "type": "VIEW",
      "sql": "create view [dbo].[syncobj_0x3341423131324138]as select  [Cd_Lkp_Dimn_Id],[Cd_Identifier],[Cd],[Cd_Desc],[Attr1_Val_Num],[Attr1_Val_Char],[Attr2_Val_Num],[Attr2_Val_Char],[Attr3_Val_Num],[Attr3_Val_Char],[Attr4_Val_Num],[Attr4_Val_Char],[Crtd_Dt],[Crtd_Id],[Lst_Upd_Dt],[Lst_Upd_Id],[Src_Sys_Nm],[Dq_Flg]  from  [dbo].[Code_Lookup]  where HAS_PERMS_BY_NAME('[dbo].[Code_Lookup]', 'OBJECT', 'SELECT')= 1  and ((1=0))"
    },
    {
      "id": "VMRT_Organization_Membership_Dimension",
      "name": "VMRT_Organization_Membership_Dimension",
      "type": "VIEW",
      "sql": "CREATE VIEW [dbo].[VMRT_Organization_Membership_Dimension]   WITH SCHEMABINDING  AS  SELECT Organization_Dim.Org_Dimn_Id     ,Organization_Dim.Org_Ver     ,Organization_Dim.Org_Abrv as Org_Abrv     ,Organization_Dim.Org_Nm as Org_Nm     ,Organization_Dim.Pty_Id    ,Org_Mbrshp_Dimn_Id  ,Org_Mbrshp_Ver     ,Organization_Membership_Dim.TTX_Road_Mbrshp_Stat_Typ_Id as TTX_Road_Mbrshp_Stat_Typ_Id     ,Organization_Membership_Dim.Road_Hun_Pct_Stmt_Part_Ind as Road_Hun_Pct_Stmt_Part_Ind     ,Organization_Membership_Dim.Road_Ownrshp_Ind as Road_Ownrshp_Ind     ,Organization_Membership_Dim.Signatory_Road_Ind as Signatory_Road_Ind     ,Organization_Membership_Dim.TTX_Mbrshp_Strt_Dt as TTX_Mbrshp_Strt_Dt     ,Organization_Membership_Dim.TTX_Mbrshp_End_Dt as TTX_Mbrshp_End_Dt     ,Organization_Dim.Eff_From as Org_Eff_From     ,Organization_Dim.Eff_To as Org_Eff_To     ,Organization_Membership_Dim.Eff_From as OrgMemb_Eff_From     ,Organization_Membership_Dim.Eff_To as OrgMemb_Eff_To   FROM dbo.Organization_Dim (NOLOCK)     left join    dbo.Organization_Membership_Dim (NOLOCK) on (Organization_Membership_Dim.org_dimn_id = Organization_Dim.org_dimn_id and Organization_Membership_Dim.org_ver = Organization_Dim.org_ver)   where Organization_Dim.Row_Typ_Id=501"
    },
    {
      "id": "vw_Repair_Event_Cost_Fact_History",
      "name": "vw_Repair_Event_Cost_Fact_History",
      "type": "VIEW",
      "sql": "CREATE VIEW [dbo].[vw_Repair_Event_Cost_Fact_History]  AS  SELECT [Rpr_Evnt_Cst_Fct_Id]        ,[Car_Dimn_Id]        ,[Car_Ver]        ,[Repr_Enty_Dimn_Id]        ,[Repr_Enty_Ver]        ,[Mnt_Typ_Dimn_Id]        ,[Mnt_Typ_Ver]        ,[Area_Of_Car_Dimn_Id]        ,[Area_Of_Car_Ver]        ,[Rpr_Dt_Dimn_Id]        ,[SPLC_Dimn_Id]        ,[TTX_Acct_Dt_Dimn_Id]        ,[Cond_Cd_Dimn_Id]        ,[Repr_Evnt_Typ_Cd_Dimn_Id]        ,[Resp_Cd_Dimn_Id]        ,[Why_Md_Cd_Dimn_Id]        ,[Car_Loc_Dimn_Id]        ,[Matl_Dimn_Id]        ,[Spon_Road_Org_Dimn_Id]        ,[Spon_Road_Org_Ver]        ,[Invc_Enty_Org_Dimn_Id]        ,[Invc_Enty_Org_Ver]        ,[Vndr_Dimn_Id]        ,[Vndr_Ver]        ,[Uniq_Rec_Id]        ,[Inv_Ln_Nr]        ,[Inv_Nr]        ,[Repr_Dt]        ,[TTX_Acct_Dt]        ,[Car_Nr]        ,[Car_Init]        ,[Repr_Enty_Org_Abrv]        ,[SPLC_Nr]        ,[Apl_Job_Cd]        ,[Apl_Qlfr_Cd]        ,[Loc_On_Car_Cd]        ,[Repr_Cd]        ,[Repr_Cls_Cd]        ,[Resp_Cd]        ,[Why_Md_Cd]        ,[Repr_Evnt_Typ_Cd]        ,[Car_Cls]        ,[Invc_Typ]        ,[Invc_Enty_Id]        ,[Acct_Typ]        ,[Cnd_Cd]        ,[Orig_Party]        ,[Vndr_Mfg_Cd]        ,[Ref_Nr]        ,[Repr_Desc]        ,[Frgn_Repr_Typ]        ,[Bil_Card_Stts]        ,[Labr_Rt]        ,[Labr_Hrs]        ,[Labr_Cost]        ,[Matl_Cost]        ,[Cmpnt_Qty]        ,[Repr_Cnv_Flg]        ,[Car_Age_Bukt]        ,[Crtd_Dt]        ,[Crtd_Id]        ,[Lst_Upd_Id]        ,[Lst_Upd_Dt]        ,[Src_Sys_Nm]        ,[Dq_Flg]        ,[Work_Type_Dimn_Id]        ,[Wrk_Ord_Nr]     ,[Invoice_Type_ID]     ,[Photo_Indicator_Flag]    FROM [dbo].[Repair_Event_Cost_Fact_History]"
    },
    {
      "id": "AR_FILTER_00005_1355151873",
      "name": "AR_FILTER_00005_1355151873",
      "type": "REPLICATION_FILTER_PROCEDURE",
      "sql": "create procedure [dbo].[AR_FILTER_00005_1355151873] for replication as if exists (select * from [dbo].[Code_Lookup] where (1=0)) return 1 else return 0"
    },
    {
      "id": "VMRT_Railroad_Dimension",
      "name": "VMRT_Railroad_Dimension",
      "type": "VIEW",
      "sql": "CREATE VIEW [dbo].[VMRT_Railroad_Dimension]  AS  SELECT Organization_Dim.Org_Dimn_Id     ,Organization_Dim.Org_Ver     ,isnull(Organization_Dim.Org_Abrv,'Unknown') as Railroad_Abbreviation     ,isnull(Organization_Dim.Org_Nm,'Unknown') as Railroad_Name     ,Organization_Dim.Pty_Id     ,Organization_Membership_Dim.Org_Mbrshp_Dimn_Id     ,Organization_Membership_Dim.Org_Mbrshp_Ver     ,Organization_Membership_Dim.TTX_Road_Mbrshp_Stat_Typ_Id as TTX_Railroad_Membership_Status_Typ_Id     ,Organization_Membership_Dim.Road_Hun_Pct_Stmt_Part_Ind as Railroad_Hundred_Percent_Statement_Participating_Indicator     ,Organization_Membership_Dim.Road_Ownrshp_Ind as Railroad_Ownership_Ind     ,Organization_Membership_Dim.Signatory_Road_Ind as Signatory_Road_Ind     ,Organization_Membership_Dim.TTX_Mbrshp_Strt_Dt as TTX_Mbrshp_Strt_Dt     ,Organization_Membership_Dim.TTX_Mbrshp_End_Dt as TTX_Mbrshp_End_Dt     ,Organization_Dim.Eff_From as Org_Eff_From     ,Organization_Dim.Eff_To as Org_Eff_To     ,Organization_Membership_Dim.Eff_From as OrgMemb_Eff_From     ,Organization_Membership_Dim.Eff_To as OrgMemb_Eff_To      FROM Organization_Membership_Dim (NOLOCK)       ,Organization_Dim (NOLOCK)    ,[organization_Type_Lookup] (NOLOCK) org_typ  where (Organization_Dim.org_dimn_id = org_typ.org_dimn_id and Organization_Dim.org_ver = org_typ.org_ver  and   Organization_Dim.org_dimn_id = Organization_Membership_Dim.org_dimn_id and Organization_Dim.org_ver = Organization_Membership_Dim.org_ver)      and ( (org_Typ_id=105 and Row_Typ_Id=501)     or ( Organization_Dim.org_dimn_id =-1    and Organization_Membership_Dim.Org_Mbrshp_Dimn_Id =-1    and org_typ.org_dimn_id = -1   ))"
    },
    {
      "id": "vw_Repair_Event_Cost_Fact_All",
      "name": "vw_Repair_Event_Cost_Fact_All",
      "type": "VIEW",
      "sql": "CREATE VIEW [dbo].[vw_Repair_Event_Cost_Fact_All]  AS    SELECT [Rpr_Evnt_Cst_Fct_Id]        ,[Car_Dimn_Id]        ,[Car_Ver]        ,[Repr_Enty_Dimn_Id]        ,[Repr_Enty_Ver]        ,[Mnt_Typ_Dimn_Id]        ,[Mnt_Typ_Ver]        ,[Area_Of_Car_Dimn_Id]        ,[Area_Of_Car_Ver]        ,[Rpr_Dt_Dimn_Id]        ,[SPLC_Dimn_Id]        ,[TTX_Acct_Dt_Dimn_Id]        ,[Cond_Cd_Dimn_Id]        ,[Repr_Evnt_Typ_Cd_Dimn_Id]        ,[Resp_Cd_Dimn_Id]        ,[Why_Md_Cd_Dimn_Id]        ,[Car_Loc_Dimn_Id]        ,[Matl_Dimn_Id]        ,[Spon_Road_Org_Dimn_Id]        ,[Spon_Road_Org_Ver]        ,[Invc_Enty_Org_Dimn_Id]        ,[Invc_Enty_Org_Ver]        ,[Vndr_Dimn_Id]        ,[Vndr_Ver]        ,[Uniq_Rec_Id]        ,[Inv_Ln_Nr]        ,[Inv_Nr]        ,[Repr_Dt]        ,[TTX_Acct_Dt]        ,[Car_Nr]        ,[Car_Init]        ,[Repr_Enty_Org_Abrv]        ,[SPLC_Nr]        ,[Apl_Job_Cd]        ,[Apl_Qlfr_Cd]        ,[Loc_On_Car_Cd]        ,[Repr_Cd]        ,[Repr_Cls_Cd]        ,[Resp_Cd]        ,[Why_Md_Cd]        ,[Repr_Evnt_Typ_Cd]        ,[Car_Cls]        ,[Invc_Typ]        ,[Invc_Enty_Id]        ,[Acct_Typ]        ,[Cnd_Cd]        ,[Orig_Party]        ,[Vndr_Mfg_Cd]        ,[Ref_Nr]        ,[Repr_Desc]        ,[Frgn_Repr_Typ]        ,[Bil_Card_Stts]        ,[Labr_Rt]        ,[Labr_Hrs]        ,[Labr_Cost]        ,[Matl_Cost]        ,[Cmpnt_Qty]        ,[Repr_Cnv_Flg]        ,[Car_Age_Bukt]        ,[Crtd_Dt]        ,[Crtd_Id]        ,[Lst_Upd_Id]        ,[Lst_Upd_Dt]        ,[Src_Sys_Nm]        ,[Dq_Flg]        ,[Work_Type_Dimn_Id]        ,[Wrk_Ord_Nr]     ,[Invoice_Type_ID]     ,[Photo_Indicator_Flag]    FROM [dbo].[Repair_Event_Cost_Fact]        UNION ALL    SELECT [Rpr_Evnt_Cst_Fct_Id]        ,[Car_Dimn_Id]        ,[Car_Ver]        ,[Repr_Enty_Dimn_Id]        ,[Repr_Enty_Ver]        ,[Mnt_Typ_Dimn_Id]        ,[Mnt_Typ_Ver]        ,[Area_Of_Car_Dimn_Id]        ,[Area_Of_Car_Ver]        ,[Rpr_Dt_Dimn_Id]        ,[SPLC_Dimn_Id]        ,[TTX_Acct_Dt_Dimn_Id]        ,[Cond_Cd_Dimn_Id]        ,[Repr_Evnt_Typ_Cd_Dimn_Id]        ,[Resp_Cd_Dimn_Id]        ,[Why_Md_Cd_Dimn_Id]        ,[Car_Loc_Dimn_Id]        ,[Matl_Dimn_Id]        ,[Spon_Road_Org_Dimn_Id]        ,[Spon_Road_Org_Ver]        ,[Invc_Enty_Org_Dimn_Id]        ,[Invc_Enty_Org_Ver]        ,[Vndr_Dimn_Id]        ,[Vndr_Ver]        ,[Uniq_Rec_Id]        ,[Inv_Ln_Nr]        ,[Inv_Nr]        ,[Repr_Dt]        ,[TTX_Acct_Dt]        ,[Car_Nr]        ,[Car_Init]        ,[Repr_Enty_Org_Abrv]        ,[SPLC_Nr]        ,[Apl_Job_Cd]        ,[Apl_Qlfr_Cd]        ,[Loc_On_Car_Cd]        ,[Repr_Cd]        ,[Repr_Cls_Cd]        ,[Resp_Cd]        ,[Why_Md_Cd]        ,[Repr_Evnt_Typ_Cd]        ,[Car_Cls]        ,[Invc_Typ]        ,[Invc_Enty_Id]        ,[Acct_Typ]        ,[Cnd_Cd]        ,[Orig_Party]        ,[Vndr_Mfg_Cd]        ,[Ref_Nr]        ,[Repr_Desc]        ,[Frgn_Repr_Typ]        ,[Bil_Card_Stts]        ,[Labr_Rt]        ,[Labr_Hrs]        ,[Labr_Cost]        ,[Matl_Cost]        ,[Cmpnt_Qty]        ,[Repr_Cnv_Flg]        ,[Car_Age_Bukt]        ,[Crtd_Dt]        ,[Crtd_Id]        ,[Lst_Upd_Id]        ,[Lst_Upd_Dt]        ,[Src_Sys_Nm]        ,[Dq_Flg]        ,[Work_Type_Dimn_Id]        ,[Wrk_Ord_Nr]     ,[Invoice_Type_ID]    ,[Photo_Indicator_Flag]    FROM [dbo].[Repair_Event_Cost_Fact_History]"
    },
    {
      "id": "syncobj_0x4243314436443534",
      "name": "syncobj_0x4243314436443534",
      "type": "VIEW",
      "sql": "create view [dbo].[syncobj_0x4243314436443534]as select  [Geo_Dimn_Id],[Row_Typ_Id],[Cntry],[Metro_Area],[Regn],[Regn_Ext],[St_Prov],[County],[City],[Geo_Long],[Geo_Lat],[Crtd_Id],[Crtd_Dt],[Lst_Upd_Id],[Lst_Upd_Dt],[Src_Sys_Nm],[Dq_Flg],[Cntry_Desc],[Regn_Desc],[Regn_Ext_Desc],[St_Prov_Desc]  from  [dbo].[Geography_Dim]  where HAS_PERMS_BY_NAME('[dbo].[Geography_Dim]', 'OBJECT', 'SELECT')= 1  and ((1=0))"
    },
    {
      "id": "VMRT_Repair_Entity_Dimension",
      "name": "VMRT_Repair_Entity_Dimension",
      "type": "VIEW",
      "sql": "CREATE VIEW [dbo].[VMRT_Repair_Entity_Dimension]  (      Repr_Enty_Dimn_Id,      Repr_Enty_Ver,      Repr_Enty_Org_Dimn_Id,      Repr_Enty_Org_Ver,      Prnt_Org_Dimn_Id,      Prnt_Org_Ver,      SPLC_Dimn_Id,      Repr_Enty_org_Abrv,      SPLC_nr,      SPLC_Nm,      Repr_Enty_org_Nm,      Pty_Id,      Ownr_Org_Abrv,      Ownr_Org_Nm,      Repr_Enty_Typ,      Repr_Shp_Typ,      Ownr_Typ_Desc,      FMO_Zone,      St_Prov,      City,      Repr_Fac_Grp,      Shop_Cap,      Serv_Yard_Cap,      Eff_From,      Eff_To,      Crtd_Dt,      Crtd_Id,      Lst_Upd_Dt,      Lst_Upd_Id,      Src_Sys_Nm  )  AS(  SELECT Repair_Entity_Dim.Repr_Enty_Dimn_Id,         Repair_Entity_Dim.Repr_Enty_Ver,         Repair_Entity_Dim.Repr_Enty_Org_Dimn_Id,         Repair_Entity_Dim.Repr_Enty_Org_Ver,         --Odim1.Org_Ver AS Repr_Enty_Org_Ver_1,         CASE             WHEN ISNULL(Odim1.Prnt_Org_Dimn_Id, -1) = -1 THEN                 Repair_Entity_Dim.Repr_Enty_Org_Dimn_Id             ELSE                 Odim1.Prnt_Org_Dimn_Id         END AS Prnt_Org_Dimn_Id,         CASE             WHEN ISNULL(Odim1.Prnt_Org_Ver, -1) = -1 THEN                 Repair_Entity_Dim.Repr_Enty_Org_Ver             ELSE                 Odim1.Prnt_Org_Ver         END AS Prnt_Org_Ver,         Repair_Entity_Dim.SPLC_Dimn_Id,         Repair_Entity_Dim.Repr_Enty_Org_Abrv,         Repair_Entity_Dim.SPLC_Nr,         SPLC_DM.SPLC_Nm,         Odim1.Org_Nm AS Repr_Enty_org_Nm,         Odim1.Pty_Id,         ISNULL(Odim2.Org_Abrv, Repair_Entity_Dim.Repr_Enty_Org_Abrv) AS Ownr_Org_Abrv,         ISNULL(Odim2.Org_Nm, Odim1.Org_Nm) AS Ownr_Org_Nm,         Repair_Entity_Dim.Repr_Enty_Typ,         Repair_Entity_Dim.Repr_Shp_Typ,         Repair_Entity_Dim.Ownr_Typ_Desc,         Repair_Entity_Dim.FMO_Zone,         Geo_DM.St_Prov,         Repair_Entity_Dim.City,         Repr_Fac_Grp.Group_Name AS Repr_Fac_Grp,         Repair_Entity_Dim.Shop_Cap,         Repair_Entity_Dim.Serv_Yard_Cap,         Repair_Entity_Dim.Eff_From,         Repair_Entity_Dim.Eff_To,         Repair_Entity_Dim.Crtd_Dt,         Repair_Entity_Dim.Crtd_Id,         Repair_Entity_Dim.Lst_Upd_Dt,         Repair_Entity_Dim.Lst_Upd_Id,         Repair_Entity_Dim.Src_Sys_Nm  FROM DDSMRT.dbo.Repair_Entity_Dim Repair_Entity_Dim      LEFT OUTER JOIN      (          SELECT a.Org_Dimn_Id,                 a.Org_Ver,                 a.Prnt_Org_Dimn_Id,                 a.Prnt_Org_Ver,                 a.Org_Nm,                 a.Pty_Id          FROM dbo.Organization_Dim a          WHERE Org_Ver =          (              SELECT MAX(Org_Ver)              FROM dbo.Organization_Dim b              WHERE b.Org_Dimn_Id = a.Org_Dimn_Id          )      ) Odim1          ON Repair_Entity_Dim.Repr_Enty_Org_Dimn_Id = Odim1.Org_Dimn_Id      -- AND Repair_Entity_Dim.Repr_Enty_Org_Ver = Odim1.Org_Ver            --LEFT JOIN Organization_Dim AS Odim1      --       ON Repair_Entity_Dim.Repr_Enty_Org_Dimn_Id = Odim1.Org_Dimn_Id      --          AND Repair_Entity_Dim.Repr_Enty_Org_Ver      = Odim1.Org_Ver        LEFT JOIN Organization_Dim AS Odim2          ON Odim2.Org_Dimn_Id = Odim1.Prnt_Org_Dimn_Id             AND Odim2.Org_Ver = Odim1.Prnt_Org_Ver      LEFT JOIN SPLC_Dim AS SPLC_DM          ON Repair_Entity_Dim.SPLC_Dimn_Id = SPLC_DM.SPLC_Dimn_Id      LEFT JOIN Geography_Dim AS Geo_DM          ON SPLC_DM.Geo_Dimn_Id = Geo_DM.Geo_Dimn_Id      LEFT JOIN      (          SELECT Railroad,                 Group_Name          FROM          (              SELECT *,                     ROW_NUMBER() OVER (PARTITION BY Railroad ORDER BY Group_Name) RN              FROM DDSSTG.dbo.AAR_Grouping_Facility          ) dups          WHERE dups.RN = 1      ) AS Repr_Fac_Grp          ON Repair_Entity_Dim.Repr_Enty_Org_Abrv = Repr_Fac_Grp.Railroad);"
    },
    {
      "id": "VMRT_DQ_Repair_Event_Cost_Fact_History",
      "name": "VMRT_DQ_Repair_Event_Cost_Fact_History",
      "type": "VIEW",
      "sql": "CREATE VIEW [dbo].[VMRT_DQ_Repair_Event_Cost_Fact_History]  AS  SELECT        Repair_Event_Cost_Fact.Car_Init, Repair_Event_Cost_Fact.Car_Nr, Repair_Event_Cost_Fact.Repr_Enty_Org_Abrv,                            Repair_Event_Cost_Fact.SPLC_Nr, Repair_Event_Cost_Fact.Loc_On_Car_Cd, Repair_Event_Cost_Fact.Why_Md_Cd,                            Repair_Event_Cost_Fact.Cnd_Cd, Repair_Event_Cost_Fact.Repr_Cd, Repair_Event_Cost_Fact.Repr_Cls_Cd, Repair_Event_Cost_Fact.Apl_Job_Cd,                            Repair_Event_Cost_Fact.Apl_Qlfr_Cd, Repair_Event_Cost_Fact.Invc_Enty_Id, dbo.ETL_Error_Check_Lookup.Err_Desc, dbo.ETL_Run.Run_Dt,                            Repair_Event_Cost_Fact.Dq_Flg, dbo.ETL_Error_Check_Lookup.Tbl_Nm  FROM            dbo.ETL_Error_Check_Lookup INNER JOIN                           dbo.ETL_Error_Detail ON dbo.ETL_Error_Check_Lookup.Err_Chk_Id = dbo.ETL_Error_Detail.Err_Chk_Id INNER JOIN                           dbo.ETL_Run ON dbo.ETL_Error_Detail.Run_Id = dbo.ETL_Run.Run_Id INNER JOIN                           dbo.vw_Repair_Event_Cost_Fact_History Repair_Event_Cost_Fact ON dbo.ETL_Error_Detail.DDS_Ver = Repair_Event_Cost_Fact.Car_Ver AND                            dbo.ETL_Error_Detail.DDS_PK = Repair_Event_Cost_Fact.Car_Dimn_Id  WHERE        (Repair_Event_Cost_Fact.Dq_Flg = 1) AND (dbo.ETL_Error_Check_Lookup.Tbl_Nm = 'Repair_Entity_Dim') OR                           (dbo.ETL_Error_Check_Lookup.Tbl_Nm = 'Organization_Dim')"
    },
    {
      "id": "Why_Made",
      "name": "Why_Made",
      "type": "VIEW",
      "sql": "CREATE VIEW [sv].[Why_Made](Why_Md_Cd_Dimn_Id,Why_Made_Code,Why_Made_Code_Desc)  AS  SELECT VMRT_Why_Made_Code_Dimension.Why_Md_Cd_Dimn_Id,VMRT_Why_Made_Code_Dimension.Repr_Rsn_Cd,VMRT_Why_Made_Code_Dimension.Repr_Rsn_Cd_Desc   FROM DDSMRT.dbo.VMRT_Why_Made_Code_Dimension"
    },
    {
      "id": "AR_FILTER_00005_1691153070",
      "name": "AR_FILTER_00005_1691153070",
      "type": "REPLICATION_FILTER_PROCEDURE",
      "sql": "create procedure [dbo].[AR_FILTER_00005_1691153070] for replication as if exists (select * from [dbo].[Geography_Dim] where (1=0)) return 1 else return 0"
    },
    {
      "id": "VMRT_Repair_Event_Type_Dimension",
      "name": "VMRT_Repair_Event_Type_Dimension",
      "type": "VIEW",
      "sql": "CREATE VIEW [dbo].[VMRT_Repair_Event_Type_Dimension] (Repr_Evnt_Typ_Cd_Dimn_Id,Repr_Evnt_Typ_Cd,Repr_Evnt_Typ_Cd_Desc,Crtd_Dt,Crtd_Id,Lst_Upd_Dt,Lst_Upd_Id,Src_Sys_Nm)  AS  (    SELECT Code_Lookup.Cd_Lkp_Dimn_Id,Code_Lookup.Cd,Code_Lookup.Cd_Desc,Code_Lookup.Crtd_Dt,Code_Lookup.Crtd_Id,Code_Lookup.Lst_Upd_Dt,Code_Lookup.Lst_Upd_Id,Code_Lookup.Src_Sys_Nm   FROM DDSMRT.dbo.Code_Lookup (NOLOCK)    WHERE Cd_Identifier = 'REPAIR_EVENT_TYPE' or Cd_Lkp_Dimn_Id= -1       )   ;"
    },
    {
      "id": "VRepair_Event_Cost_Fact_History",
      "name": "VRepair_Event_Cost_Fact_History",
      "type": "VIEW",
      "sql": "CREATE VIEW [DDSV].[VRepair_Event_Cost_Fact_History] AS   SELECT CAST([Rpr_Evnt_Cst_Fct_Id] AS int) AS [Repr_Evnt_Cst_Fct_Id]        ,concat(convert(varchar(10),Car_Dimn_Id),'_',convert(varchar(5), Car_Ver)) as [Car_Dimn_Id]     ,concat(convert(varchar(10),Car_Dimn_Id),'_',convert(varchar(5), Car_Ver)) as TTX_Equipment_Dimn_Id        ,concat(convert(varchar(10),Mnt_Typ_Dimn_Id),'_',convert(varchar(5),Mnt_Typ_Ver)) as [Repr_Cd_Dimn_Id]     ,CAST(Rpr_Dt_Dimn_Id AS int) AS [Repr_Dt_Dimn_Id]        ,CAST(TTX_Acct_Dt_Dimn_Id AS int) AS [Acct_Dt_Dimn_Id]        ,CAST([Cond_Cd_Dimn_Id] as int) as Cnd_Cd_Dimn_Id        ,CAST([Repr_Evnt_Typ_Cd_Dimn_Id] as int) as [Repr_Typ_Dimn_Id]     ,concat(convert(varchar(10),[Area_Of_Car_Dimn_Id]),'_',convert(varchar(5),[Area_Of_Car_Ver])) as [Area_Of_Car_Dimn_Id]        ,concat(convert(varchar(10),Rpr.Repr_Enty_Org_Dimn_Id),'_',convert(varchar(5), Rpr.Repr_Enty_Org_Ver)) as [Org_Enty_Dimn_Id]        ,concat(convert(varchar(10),[Invc_Enty_Org_Dimn_Id]),'_',convert(varchar(5), [Invc_Enty_Org_Ver])) as [Inv_Enty_Dimn_Id]        ,concat(convert(varchar(10),Rf.[Repr_Enty_Dimn_Id]),'_',convert(varchar(5), Rf.[Repr_Enty_Ver])) as [Repr_Enty_Dimn_Id]        ,cast (Resp_Cd_Dimn_Id as int) as [Repr_Resp_Dimn_Id]        ,cast (Why_Md_Cd_Dimn_Id as int) as [Repr_Rsn_Dimn_Id]        ,cast ([Car_Loc_Dimn_Id] as int) as [Car_Loc_Dimn_Id]        ,cast ([Car_Nr] as decimal(11,0)) as Car_Nr        ,[Car_Init]        ,[Repr_Cd]        ,[Repr_Dt]        ,TTX_Acct_Dt as [Acct_Dt]        ,cast ([Cnd_Cd] as varchar(2)) as Cond_Cd        ,cast (Repr_Evnt_Typ_Cd as varchar(20)) as [Repr_Fac_Typ]        ,Apl_Job_Cd as [Job_Cd]        ,Apl_Qlfr_Cd as [Qlfr_Cd]        ,cast (Invc_Enty_Id as char(4)) as [Invc_Abrv]        ,cast (Rf.Repr_Enty_Org_Abrv as char(4)) as [Repr_Abrv]        ,[Resp_Cd]        ,[Why_Md_Cd]        ,cast (Loc_On_Car_Cd as varchar(10)) as [Loc_On_Car]        ,cast (Car_Cls as varchar(6)) as [Car_Cls_Cd]        ,[Repr_Cls_Cd]        ,[Labr_Cost]        ,[Labr_Hrs]        ,[Matl_Cost]        ,[Cmpnt_Qty]        ,Acct_Typ as [Mnt_Or_Cap_Ind]        ,[Labr_Rt]        ,[Inv_Nr]        ,[Inv_Ln_Nr]        ,[Ref_Nr]        ,Repr_Cnv_Flg as [Repr_Cnv_Fl]        ,cast (Rf.Src_Sys_Nm as varchar(50)) as [Src_Sys_Nm]        ,[Invc_Typ]        ,[Repr_Desc]     ,[Wrk_Ord_Nr]     ,[Work_Type_Dimn_Id]        ,cast (Rf.[Crtd_Id] as char(8)) as Crtd_Id        ,Rf.[Crtd_Dt]        ,Rf.[Lst_Upd_Dt]        ,cast (Rf.[Lst_Upd_Id] as char(8)) as Lst_Upd_Id    FROM ddsmrt.[dbo].[vw_Repair_Event_Cost_Fact_History]  (NOLOCK)  rf    LEFT JOIN DDSMRT.DBO.Repair_Entity_Dim  (NOLOCK)  as Rpr    on Rf.Repr_Enty_Dimn_Id = Rpr.Repr_Enty_Dimn_Id     and Rf.Repr_Enty_Ver = Rpr.Repr_Enty_Ver"
    },
    {
      "id": "VMRT_Operational_Car_Count",
      "name": "VMRT_Operational_Car_Count",
      "type": "VIEW",
      "sql": "CREATE view [dbo].[VMRT_Operational_Car_Count]    WITH SCHEMABINDING     as        select        op_car_cnt.car_dimn_id      ,op_car_cnt.car_ver      ,op_car_cnt.Dt_Dimn_Id as Snapshot_Dt_Dimn_Id      ,op_car_cnt.Attr_Id_1 as Last_Participating_Road_Org_Dimn_Id       ,op_car_cnt.Attr_Ver_1 as Last_Participating_Road_Org_Ver       ,op_car_cnt.Attr_Id_2 as Current_Participating_Road_Org_Dimn_Id       ,op_car_cnt.Attr_Ver_2 as Current_Participating_Road_Org_Ver       ,op_car_cnt.Attr_Id_3 as Reporting_Road_Org_Dimn_Id      ,op_car_cnt.Attr_Ver_3 as Reporting_Road_Org_Ver      ,Liability_Event_Dt      ,Crtd_Dt     --,cast(op_car_cnt.Attr_Val_Num_3 as int) as railcar      ,convert(char(1),op_car_cnt.Attr_Val_Char_4) as Ld_Empt_Ind         --car cnt      , sum(isnull(op_car_cnt.[Car_Cnt128],0) ) As Enroute_Car_Cnt       , sum(isnull(op_car_cnt.[Car_Cnt131],0) ) as In_Paid_Storage_Car_Cnt      , sum(isnull(op_car_cnt.[Car_Cnt132],0) ) as In_Repair_Entity_Car_Cnt      , sum(isnull(op_car_cnt.[Car_Cnt136],0) ) as On_Railroad_Relief_Car_Cnt            , case when ISNULL(Ownr_Mrk,'') <> 'TTX' OR upper(ISNULL(car_status_UFD,'')) <> ('ACTIVE') then NULL--sum(op_car_cnt.[Car_Cnt138]) is null OR        else sum((isnull(op_car_cnt.[Car_Cnt138],0) - isnull(op_car_cnt.[Car_Cnt128],0)                  - isnull(op_car_cnt.[Car_Cnt131],0)                  - isnull(op_car_cnt.[Car_Cnt132],0)                 - isnull(op_car_cnt.[Car_Cnt136],0))) end as Fleet_In_Service_Car_Cnt          , sum(isnull(op_car_cnt.[Car_Cnt138],0) ) as Physical_Fleet_Size_Car_Cnt      , sum(op_car_cnt.[Car_Cnt139]   ) as Pooled_Fleet_Size_Car_Cnt      , sum(op_car_cnt.[Car_Cnt140]   ) as Distributable_Fleet_Size_Car_Cnt         /* added for ticket 735845*/            , sum(op_car_cnt.[Car_Cnt159] ) as Offered_for_Relief_Fleet_Size_Car_cnt         --tpe cnt      , sum(isnull(op_car_cnt.[TPE_Cnt128],0) )           As Enroute_TPE_Cnt       , sum(isnull(op_car_cnt.[TPE_Cnt131],0) )           as In_Paid_Storage_TPE_Cnt      , sum(isnull(op_car_cnt.[TPE_Cnt132],0) )              as In_Repair_Entity_TPE_Cnt      , sum(isnull(op_car_cnt.[TPE_Cnt136],0) )              as On_Railroad_Relief_TPE_Cnt      , case when ISNULL(Ownr_Mrk,'') <> 'TTX' OR upper(ISNULL(car_status_UFD,'')) <> ('ACTIVE') then NULL--sum(op_car_cnt.[TPE_Cnt138]) is null OR        else sum((isnull(op_car_cnt.[TPE_Cnt138],0) - isnull(op_car_cnt.[TPE_Cnt128],0)                 - isnull(op_car_cnt.[TPE_Cnt131],0)                 - isnull(op_car_cnt.[TPE_Cnt132],0)                - isnull(op_car_cnt.[TPE_Cnt136],0)))  end as Fleet_In_Service_TPE_Cnt          , sum(isnull(op_car_cnt.[TPE_Cnt138],0) )           as Physical_Fleet_Size_TPE_Cnt      , sum(op_car_cnt.[TPE_Cnt139]   )           as Pooled_Fleet_Size_TPE_Cnt      , sum(op_car_cnt.[TPE_Cnt140]   )           as Distributable_Fleet_Size_TPE_Cnt               ,sum(isnull(op_car_cnt.[Car_Cnt138],0)-isnull(op_car_cnt.[Car_Cnt136],0)-isnull(op_car_cnt.[Car_Cnt131],0)-isnull(op_car_cnt.[Car_Cnt132],0)-      isnull([Owned Idle Empty Car Count 15 days138],0)) as Active_Circulation_Car_Cnt           , sum(((isnull(op_car_cnt.[Car_Cnt138],0)-isnull(op_car_cnt.[Car_Cnt136],0)-isnull(op_car_cnt.[Car_Cnt131],0)-isnull(op_car_cnt.[Car_Cnt132],0))-      isnull([Owned Idle Empty Car Count 15 days138],0))  * isnull(trk_axl_cnt, 2.0) ) as Active_Circulation_Truck_Cnt            , sum(((isnull(op_car_cnt.[Car_Cnt138],0)-isnull(op_car_cnt.[Car_Cnt136],0)-isnull(op_car_cnt.[Car_Cnt131],0)-isnull(op_car_cnt.[Car_Cnt132],0))-      isnull([Owned Idle Empty Car Count 15 days138],0))  * car_ut_cnt) as Active_Circulation_Unit_Cnt               /* added for ticket 735845*/          , sum(op_car_cnt.[TPE_Cnt159] ) as Offered_for_Relief_Fleet_Size_TPE_cnt         --Ut cnt      , sum(isnull(op_car_cnt.[Ut_Cnt128],0) )           As Enroute_Unit_Cnt       , sum(isnull(op_car_cnt.[Ut_Cnt131],0) )           as In_Paid_Storage_Unit_Cnt      , sum(isnull(op_car_cnt.[Ut_Cnt132],0) )              as In_Repair_Entity_Unit_Cnt      , sum(isnull(op_car_cnt.[Ut_Cnt136],0) )              as On_Railroad_Relief_Unit_Cnt          , case when ISNULL(Ownr_Mrk,'') <> 'TTX' OR upper(ISNULL(car_status_UFD,'')) <> ('ACTIVE') then NULL--sum(op_car_cnt.[Ut_Cnt138]) is null OR        else sum((isnull(op_car_cnt.[Ut_Cnt138],0)  - isnull(op_car_cnt.[Ut_Cnt128],0)                 - isnull(op_car_cnt.[Ut_Cnt131],0)                 - isnull(op_car_cnt.[Ut_Cnt132],0)                - isnull(op_car_cnt.[Ut_Cnt136],0)))    end as Fleet_In_Service_Unit_Cnt      , sum(isnull(op_car_cnt.[Ut_Cnt138],0) )           as Physical_Fleet_Size_Unit_Cnt      , sum(op_car_cnt.[Ut_Cnt139]   )           as Pooled_Fleet_Size_Unit_Cnt      , sum(op_car_cnt.[Ut_Cnt140]   )           as Distributable_Fleet_Size_Unit_Cnt           /* added for ticket 735845*/                , sum(op_car_cnt.[UT_Cnt159] ) as Offered_for_Relief_Fleet_Size_Unit_cnt               --Platform cnt      , sum(isnull(op_car_cnt.[Pltfm_Cnt128],0))            As Enroute_Platform_Cnt       , sum(isnull(op_car_cnt.[Pltfm_Cnt131],0))            as In_Paid_Storage_Platform_Cnt      , sum(isnull(op_car_cnt.[Pltfm_Cnt132],0))               as In_Repair_Entity_Platform_Cnt      , sum(isnull(op_car_cnt.[Pltfm_Cnt136],0))               as On_Railroad_Relief_Platform_Cnt      , case when ISNULL(Ownr_Mrk,'') <> 'TTX' OR upper(ISNULL(car_status_UFD,'')) <> ('ACTIVE')              then NULL -- sum(op_car_cnt.[Pltfm_Cnt138]) is null OR           else sum((isnull(op_car_cnt.[Pltfm_Cnt138],0) - isnull(op_car_cnt.[Pltfm_Cnt128],0)                                                         - isnull(op_car_cnt.[Pltfm_Cnt131],0)                     - isnull(op_car_cnt.[Pltfm_Cnt132],0)                                         - isnull(op_car_cnt.[Pltfm_Cnt136],0)))  end as Fleet_In_Service_Platform_Cnt          , sum(isnull(op_car_cnt.[Pltfm_Cnt138],0)) as Physical_Fleet_Size_Platform_Cnt      , sum(op_car_cnt.[Pltfm_Cnt139] ) as Pooled_Fleet_Size_Platform_Cnt      , sum(op_car_cnt.[Pltfm_Cnt140] ) as Distributable_Fleet_Size_Platform_Cnt              /* added for ticket 735845*/          , sum(op_car_cnt.[Pltfm_Cnt159] ) as Offered_for_Relief_Fleet_Size_Pltfm_cnt          ,sum(isnull([Owned Idle Empty Car Count 15 days128],0)) as Enroute_Owned_Idle_Empty_Car_Cnt_15_Days,      sum(isnull([Owned Idle Empty Car Count 15 days138] ,0)) as Physical_Fleet_Size_Owned_Idle_Empty_Car_Cnt_15_Days,      sum(isnull([Owned Idle Empty Car Count 15 days139] ,0)) as Pooled_Fleet_Size_Owned_Idle_Empty_Car_Cnt_15_Days,      sum(isnull([Owned Idle Empty Car Count 15 days140] ,0))  as Distributable_Fleet_Size_Owned_Idle_Empty_Car_Cnt_15_Days,      sum(isnull([Owned Idle Empty Car Count 15 days128] * Pltfm_Fctr,0)) as Enroute_Owned_Idle_Empty_Platform_Cnt_15_Days,      sum(isnull([Owned Idle Empty Car Count 15 days138] * Pltfm_Fctr,0)) as Physical_Fleet_Size_Owned_Idle_Empty_Platform_Cnt_15_Days,      sum(isnull([Owned Idle Empty Car Count 15 days139] * Pltfm_Fctr,0)) as Pooled_Fleet_Size_Owned_Idle_Empty_Platform_Cnt_15_Days,      sum(isnull([Owned Idle Empty Car Count 15 days140] * Pltfm_Fctr,0))  as Distributable_Fleet_Size_Owned_Idle_Empty_Platform_Cnt_15_Days       --RITM0027009     , sum(isnull([Owned Idle Empty Car Count No Movement 15 days138] ,0)) as Physical_Fleet_Size_Owned_Idle_Empty_No_Movement_Car_Cnt_15_Days,         sum(isnull([Owned Idle Empty Car Count No Movement 15 days138] * Pltfm_Fctr,0)) as Physical_Fleet_Size_Owned_Idle_Empty_No_Movement_Platform_Cnt_15_Days    from (    SELECT          car_dimn_id    ,car_ver    ,Dt_Dimn_Id     ,Attr_Id_1     ,Attr_Ver_1     ,Attr_Id_2     ,Attr_Ver_2     ,Attr_Id_3    ,Attr_Ver_3    ,Attr_Val_Num_3    ,Attr_Val_Char_4    ,Ownr_Mrk    ,car_status_UFD    ,concat(CntName, Car_Cnt_Catg_Typ_Id) as PCol    ,CntValue    ,Pltfm_Fctr    ,Liability_Event_Dt    ,Crtd_Dt    ,trk_axl_cnt    ,Car_Ut_Cnt                FROM           (select car_cnt.car_dimn_id,car_cnt.car_ver,car_cnt.Dt_Dimn_Id,car_cnt.Attr_Id_1,car_cnt.Attr_Ver_1,     car_cnt.Attr_Id_2,car_cnt.Attr_Ver_2     ,car_cnt.Attr_Id_3,car_cnt.Attr_Ver_3,car_cnt.Attr_Val_Char_4,car_cnt.Attr_Val_Num_3     ,car_cnt.Car_cnt_Catg_Typ_id, car_cnt.Car_Cnt     ,TPE_Cnt, car_cnt.Ut_Cnt, Pltfm_Cnt,car_dim.Ownr_Mrk,car_dim.car_status_UFD     ,Liability_Event_Dt , car_cnt.Crtd_Dt        ,isnull((CASE WHEN (Car_Idle_Cnt / 24) >= 15 AND [Owned_Idle_Empty_Car_Cnt] = 1                    THEN cast('1' as decimal(38,10))            ELSE cast('0' as decimal(38,10)) END),cast('0' as decimal(38,10))) AS [Owned Idle Empty Car Count 15 days],       isnull((CASE WHEN (Car_Idle_No_Movement_CNT / 24) >= 15 AND [Owned_Idle_Empty_Car_Count_No_Movement] = 1                    THEN cast('1' as decimal(38,10))            ELSE cast('0' as decimal(38,10)) END),cast('0' as decimal(38,10))) AS [Owned Idle Empty Car Count No Movement 15 days],         Pltfm_Fctr,trk_axl_cnt  ,car_dim.Ut_Cnt as Car_Ut_Cnt      from  dbo.vw_car_count_fact car_cnt(NOLOCK)      LEFT JOIN (SELECT car_dimn_id,car_ver,Ownr_Mrk,car_status_UFD,Pltfm_Fctr ,trk_axl_cnt ,Ut_Cnt      FROM dbo.vmrt_car_dimension_correct (NOLOCK)) car_dim       ON car_cnt.car_dimn_id = car_dim.car_dimn_id AND car_cnt.car_ver = car_dim.car_ver      where row_typ_id=518 and  Car_Cnt_Catg_Typ_Id <> 149 ) ta --Operational        UNPIVOT         (CntValue FOR CntName IN (Car_Cnt, TPE_Cnt, Ut_Cnt, Pltfm_Cnt,[Owned Idle Empty Car Count 15 days],[Owned Idle Empty Car Count No Movement 15 days])) AS pvt     ) Tunpivot        PIVOT         (              sum(CntValue)         FOR Pcol IN ( [Car_Cnt128], [Car_Cnt131],[Car_Cnt132],[Car_Cnt136],[Car_Cnt138],[Car_Cnt139],[Car_Cnt140], [Car_Cnt159]          , [TPE_Cnt128], [TPE_Cnt131],[TPE_Cnt132],[TPE_Cnt136],[TPE_Cnt138],[TPE_Cnt139],[TPE_Cnt140] , [TPE_Cnt159]          , [Ut_Cnt128], [Ut_Cnt131],[Ut_Cnt132],[Ut_Cnt136],[Ut_Cnt138],[Ut_Cnt139],[Ut_Cnt140] , [Ut_Cnt159]          , [Pltfm_Cnt128], [Pltfm_Cnt131],[Pltfm_Cnt132],[Pltfm_Cnt136],[Pltfm_Cnt138],[Pltfm_Cnt139],[Pltfm_Cnt140], [Pltfm_Cnt159],          [Owned Idle Empty Car Count 15 days128],          [Owned Idle Empty Car Count 15 days138],          [Owned Idle Empty Car Count 15 days139],          [Owned Idle Empty Car Count 15 days140],     [Owned Idle Empty Car Count No Movement 15 days138]     )  )   AS op_car_cnt        group by        op_car_cnt.car_dimn_id      ,op_car_cnt.car_ver      ,op_car_cnt.Dt_Dimn_Id       ,op_car_cnt.Attr_Id_1        ,op_car_cnt.Attr_Ver_1       ,op_car_cnt.Attr_Id_2        ,op_car_cnt.Attr_Ver_2       ,op_car_cnt.Attr_Id_3        ,op_car_cnt.Attr_Ver_3      ,op_car_cnt.Ownr_Mrk      ,op_car_cnt.car_status_UFD      ,Liability_Event_Dt      ,Crtd_Dt     --,cast(op_car_cnt.Attr_Val_Num_3 as int)      ,convert(char(1),op_car_cnt.Attr_Val_Char_4)"
    },
    {
      "id": "syncobj_0x4236324632464537",
      "name": "syncobj_0x4236324632464537",
      "type": "VIEW",
      "sql": "create view [dbo].[syncobj_0x4236324632464537]as select  [Mnt_Typ_Dimn_Id],[Mnt_Typ_Ver],[Repr_Cd_Full],[Repr_Cd],[Repr_Cls_Cd],[Repr_Cd_Full_Desc],[Repr_Cls_Desc],[Mnt_Typ_Lvl_1],[Mnt_Typ_Lvl_2],[Mnt_Typ_Lvl_3],[Pgm_Desc],[Repr_Cls_Grp],[Repr_Cd_Actv_Ind],[Repr_Cd_Non_Bill_Ind],[Repr_Cnv_flg],[Eff_From],[Eff_To],[Crtd_Dt],[Crtd_Id],[Lst_Upd_Dt],[Lst_Upd_Id],[Src_Sys_Nm],[Dq_Flg]  from  [dbo].[Maintenance_Type_Dim]  where HAS_PERMS_BY_NAME('[dbo].[Maintenance_Type_Dim]', 'OBJECT', 'SELECT')= 1  and ((1=0))"
    },
    {
      "id": "VMRT_Responsibility_Code_Dimension",
      "name": "VMRT_Responsibility_Code_Dimension",
      "type": "VIEW",
      "sql": "CREATE VIEW [dbo].[VMRT_Responsibility_Code_Dimension] (Resp_Cd_Dimn_Id,Resp_Cd,Resp_Cd_Desc,Crtd_Dt,Crtd_Id,Lst_Upd_Dt,Lst_Upd_Id,Src_Sys_Nm)  AS  (    SELECT Code_Lookup.Cd_Lkp_Dimn_Id,Code_Lookup.Cd,Code_Lookup.Cd_Desc,Code_Lookup.Crtd_Dt,Code_Lookup.Crtd_Id,Code_Lookup.Lst_Upd_Dt,Code_Lookup.Lst_Upd_Id,Code_Lookup.Src_Sys_Nm   FROM DDSMRT.dbo.Code_Lookup (NOLOCK)    WHERE Cd_Identifier = 'RESPONSIBILITY_CODE' or Cd_Lkp_Dimn_Id= -1       )   ;"
    },
    {
      "id": "Repair_Event_Cost_History",
      "name": "Repair_Event_Cost_History",
      "type": "VIEW",
      "sql": "CREATE VIEW [SV].[Repair_Event_Cost_History]  AS  SELECT   Repair_Event_Cost_Fact.Rpr_Evnt_Cst_Fct_Id as Repair_Event_Cost_Fact_Id,  Repair_Event_Cost_Fact.Car_Dimn_Id,  Repair_Event_Cost_Fact.Car_Ver,  Repair_Event_Cost_Fact.Repr_Enty_Dimn_Id,  Repair_Event_Cost_Fact.Repr_Enty_Ver,  Repair_Event_Cost_Fact.Rpr_Dt_Dimn_Id,  Repair_Event_Cost_Fact.Area_Of_Car_Dimn_Id,  Repair_Event_Cost_Fact.Area_Of_Car_Ver,  Repair_Event_Cost_Fact.Mnt_Typ_Dimn_Id,  Repair_Event_Cost_Fact.Mnt_Typ_Ver,  Repair_Event_Cost_Fact.Car_Loc_Dimn_Id,  case when Src_Sys_Nm = 'Open AAR' then (select cast(convert(varchar(8),dateadd( mm,1, max(TTX_Acct_Dt)),112) as int) from ddsmrt.dbo.Repair_Event_Cost_Fact where src_sys_nm = 'Closed AAR')  else Repair_Event_Cost_Fact.TTX_Acct_Dt_Dimn_Id end as TTX_Acct_Dt_Dimn_Id,  Repair_Event_Cost_Fact.Resp_Cd_Dimn_Id,  Repair_Event_Cost_Fact.Cond_Cd_Dimn_Id,  Repair_Event_Cost_Fact.Repr_Evnt_Typ_Cd_Dimn_Id,  Repair_Event_Cost_Fact.Why_Md_Cd_Dimn_Id,  Repair_Event_Cost_Fact.Matl_Dimn_Id,  Repair_Event_Cost_Fact.Spon_Road_Org_Ver as Spons_Road_Org_Ver,  Repair_Event_Cost_Fact.Spon_road_Org_Dimn_Id as Spons_Road_Org_Dim_Id ,  Repair_Event_Cost_Fact.Invc_Enty_Org_Dimn_Id,  Repair_Event_Cost_Fact.Invc_Enty_Org_Ver,  Repair_Event_Cost_Fact.[Vndr_Dimn_Id] as [Vndr_Dimn_Id],  Repair_Event_Cost_Fact.[Vndr_Ver] as [Vndr_Ver],  Repair_Event_Cost_Fact.Splc_Dimn_Id,  Repair_Event_Cost_Fact.Inv_Nr as Invoice_Number,  Repair_Event_Cost_Fact.Inv_Ln_Nr as Invoice_Line_Number,  Repair_Event_Cost_Fact.Repr_Dt as Repair_Date,  case when Src_Sys_Nm = 'Open AAR' then (select dateadd( mm,1, max(TTX_Acct_Dt)) from ddsmrt.dbo.Repair_Event_Cost_Fact where src_sys_nm = 'Closed AAR')  else Repair_Event_Cost_Fact.TTX_Acct_Dt end as TTX_Account_Date,  Repair_Event_Cost_Fact.Car_Nr as Car_Number,  Repair_Event_Cost_Fact.Car_Init as Car_Initial,  Repair_Event_Cost_Fact.Repr_Enty_Org_Abrv as Repair_Entity_ID,  Repair_Event_Cost_Fact.Apl_Job_Cd as Applied_Job_Code,  Repair_Event_Cost_Fact.Apl_Qlfr_Cd as Qualifier_Code,  Repair_Event_Cost_Fact.Loc_On_Car_Cd as Location_on_Car,  Repair_Event_Cost_Fact.Repr_Cd as Repair_Code,  Repair_Event_Cost_Fact.Repr_Cls_Cd as Repair_Class,  Repair_Event_Cost_Fact.Resp_Cd as Responsibility_Code,  Repair_Event_Cost_Fact.Why_Md_Cd as Why_Made_Code,  Repair_Event_Cost_Fact.Repr_Evnt_Typ_Cd as Repair_Event_Type_ID,  Repair_Event_Cost_Fact.Car_Cls as Car_Class_Code,  Repair_Event_Cost_Fact.Invc_Typ as Invoice_Type,  Repair_Event_Cost_Fact.Invc_Enty_Id as Invoicing_Entity_Id,  case when Repair_Event_Cost_Fact.Acct_Typ = 'M' then 'Maintenance' when Repair_Event_Cost_Fact.Acct_Typ = 'C' then 'Capital' else NULL  end as Accounting_Type,  Repair_Event_Cost_Fact.Cnd_Cd as Condition_Code,  Repair_Event_Cost_Fact.Orig_Party as Orig_Party,  Repair_Event_Cost_Fact.Ref_Nr as Reference_Number,  Repair_Event_Cost_Fact.Car_Age_Bukt as Car_Age_Bucket,  Repair_Event_Cost_Fact.Repr_Desc as Repair_Description,  Repair_Event_Cost_Fact.Labr_Rt as Labor_Rate,  Repair_Event_Cost_Fact.Labr_Hrs as Labor_Hours,  Repair_Event_Cost_Fact.Labr_Cost as Labor_Cost,  Repair_Event_Cost_Fact.Matl_Cost as Material_Cost,  Repair_Event_Cost_Fact.Cmpnt_Qty as Component_Quantity,  case when Src_Sys_Nm in ('Open AAR', 'Closed AAR') then 'AAR'     when Src_Sys_Nm = 'Foreign' then 'Foreign Repair Billing'    else   Repair_Event_Cost_Fact.Src_Sys_Nm end as Source,  Src_Sys_Nm as Open_Close_Flag,  Bil_Card_Stts as Bill_Card_Status,  frgn_Repr_Typ as Foreign_Repair_Type,  Repair_Event_Cost_Fact.SPLC_Nr,  Repair_Event_Cost_Fact.Wrk_Ord_Nr,  Repair_Event_Cost_Fact.Work_Type_Dimn_Id,  CASE WHEN Repair_Event_Cost_Fact.Invoice_Type_Id = 10 THEN 'Y'  ELSE 'N'  END Full_Service_Lease,  Repair_Event_Cost_Fact.Photo_Indicator_Flag  FROM ddsmrt.dbo.vw_Repair_Event_Cost_Fact_History (NOLOCK) Repair_Event_Cost_Fact"
    },
    {
      "id": "VMRT_Operational_Car_Count_Hist",
      "name": "VMRT_Operational_Car_Count_Hist",
      "type": "VIEW",
      "sql": "CREATE view [dbo].[VMRT_Operational_Car_Count_Hist]    WITH SCHEMABINDING     as      select        op_car_cnt.car_dimn_id      ,op_car_cnt.car_ver      ,op_car_cnt.Dt_Dimn_Id as Snapshot_Dt_Dimn_Id      ,op_car_cnt.Attr_Id_1 as Last_Participating_Road_Org_Dimn_Id       ,op_car_cnt.Attr_Ver_1 as Last_Participating_Road_Org_Ver       ,op_car_cnt.Attr_Id_2 as Current_Participating_Road_Org_Dimn_Id       ,op_car_cnt.Attr_Ver_2 as Current_Participating_Road_Org_Ver       ,op_car_cnt.Attr_Id_3 as Reporting_Road_Org_Dimn_Id      ,op_car_cnt.Attr_Ver_3 as Reporting_Road_Org_Ver      ,Liability_Event_Dt      ,Crtd_Dt     --,cast(op_car_cnt.Attr_Val_Num_3 as int) as railcar      ,convert(char(1),op_car_cnt.Attr_Val_Char_4) as Ld_Empt_Ind         --car cnt      , sum(isnull(op_car_cnt.[Car_Cnt128],0) )           As Enroute_Car_Cnt       , sum(isnull(op_car_cnt.[Car_Cnt131],0) )           as In_Paid_Storage_Car_Cnt      , sum(isnull(op_car_cnt.[Car_Cnt132],0) )              as In_Repair_Entity_Car_Cnt      , sum(isnull(op_car_cnt.[Car_Cnt136],0) )              as On_Railroad_Relief_Car_Cnt            , case when ISNULL(Ownr_Mrk,'') <> 'TTX' OR upper(ISNULL(car_status_UFD,'')) <> ('ACTIVE') then NULL--sum(op_car_cnt.[Car_Cnt138]) is null OR        else sum((isnull(op_car_cnt.[Car_Cnt138],0) - isnull(op_car_cnt.[Car_Cnt128],0)                  - isnull(op_car_cnt.[Car_Cnt131],0)                  - isnull(op_car_cnt.[Car_Cnt132],0)                 - isnull(op_car_cnt.[Car_Cnt136],0))) end as Fleet_In_Service_Car_Cnt          , sum(isnull(op_car_cnt.[Car_Cnt138],0) )           as Physical_Fleet_Size_Car_Cnt      , sum(op_car_cnt.[Car_Cnt139]   )           as Pooled_Fleet_Size_Car_Cnt      , sum(op_car_cnt.[Car_Cnt140]   )           as Distributable_Fleet_Size_Car_Cnt               ,sum(isnull(op_car_cnt.[Car_Cnt138],0)-isnull(op_car_cnt.[Car_Cnt136],0)-isnull(op_car_cnt.[Car_Cnt131],0)-isnull(op_car_cnt.[Car_Cnt132],0)-      isnull([Owned Idle Empty Car Count 15 days138],0)) as Active_Circulation_Car_Cnt           , sum(((isnull(op_car_cnt.[Car_Cnt138],0)-isnull(op_car_cnt.[Car_Cnt136],0)-isnull(op_car_cnt.[Car_Cnt131],0)-isnull(op_car_cnt.[Car_Cnt132],0))-      isnull([Owned Idle Empty Car Count 15 days138],0))  * isnull(trk_axl_cnt, 2.0) ) as Active_Circulation_Truck_Cnt           , sum(((isnull(op_car_cnt.[Car_Cnt138],0)-isnull(op_car_cnt.[Car_Cnt136],0)-isnull(op_car_cnt.[Car_Cnt131],0)-isnull(op_car_cnt.[Car_Cnt132],0))-      isnull([Owned Idle Empty Car Count 15 days138],0))  * car_ut_cnt ) as Active_Circulation_Unit_Cnt                 /* added for ticket 735845*/                           , sum(op_car_cnt.[Car_Cnt159] ) as Offered_for_Relief_Fleet_Size_Car_cnt         --tpe cnt      , sum(isnull(op_car_cnt.[TPE_Cnt128],0) )           As Enroute_TPE_Cnt       , sum(isnull(op_car_cnt.[TPE_Cnt131],0) )           as In_Paid_Storage_TPE_Cnt      , sum(isnull(op_car_cnt.[TPE_Cnt132],0) )              as In_Repair_Entity_TPE_Cnt      , sum(isnull(op_car_cnt.[TPE_Cnt136],0) )              as On_Railroad_Relief_TPE_Cnt      , case when ISNULL(Ownr_Mrk,'') <> 'TTX' OR upper(ISNULL(car_status_UFD,'')) <> ('ACTIVE') then NULL--sum(op_car_cnt.[TPE_Cnt138]) is null OR        else sum((isnull(op_car_cnt.[TPE_Cnt138],0) - isnull(op_car_cnt.[TPE_Cnt128],0)                 - isnull(op_car_cnt.[TPE_Cnt131],0)                 - isnull(op_car_cnt.[TPE_Cnt132],0)                - isnull(op_car_cnt.[TPE_Cnt136],0)))  end as Fleet_In_Service_TPE_Cnt          , sum(isnull(op_car_cnt.[TPE_Cnt138],0) )           as Physical_Fleet_Size_TPE_Cnt      , sum(op_car_cnt.[TPE_Cnt139]   )           as Pooled_Fleet_Size_TPE_Cnt      , sum(op_car_cnt.[TPE_Cnt140]   )           as Distributable_Fleet_Size_TPE_Cnt             /* added for ticket 735845*/            , sum(op_car_cnt.[TPE_Cnt159] ) as Offered_for_Relief_Fleet_Size_TPE_cnt         --Ut cnt      , sum(isnull(op_car_cnt.[Ut_Cnt128],0) )           As Enroute_Unit_Cnt       , sum(isnull(op_car_cnt.[Ut_Cnt131],0) )           as In_Paid_Storage_Unit_Cnt      , sum(isnull(op_car_cnt.[Ut_Cnt132],0) )              as In_Repair_Entity_Unit_Cnt      , sum(isnull(op_car_cnt.[Ut_Cnt136],0) )              as On_Railroad_Relief_Unit_Cnt          , case when ISNULL(Ownr_Mrk,'') <> 'TTX' OR upper(ISNULL(car_status_UFD,'')) <> ('ACTIVE') then NULL--sum(op_car_cnt.[Ut_Cnt138]) is null OR        else sum((isnull(op_car_cnt.[Ut_Cnt138],0)  - isnull(op_car_cnt.[Ut_Cnt128],0)                 - isnull(op_car_cnt.[Ut_Cnt131],0)                 - isnull(op_car_cnt.[Ut_Cnt132],0)                - isnull(op_car_cnt.[Ut_Cnt136],0)))    end as Fleet_In_Service_Unit_Cnt      , sum(isnull(op_car_cnt.[Ut_Cnt138],0) )           as Physical_Fleet_Size_Unit_Cnt      , sum(op_car_cnt.[Ut_Cnt139]   )           as Pooled_Fleet_Size_Unit_Cnt      , sum(op_car_cnt.[Ut_Cnt140]   )           as Distributable_Fleet_Size_Unit_Cnt           /* added for ticket 735845*/            ,sum(op_car_cnt.[Ut_Cnt159] ) as Offered_for_Relief_Fleet_Size_Unit_cnt               --Platform cnt      , sum(isnull(op_car_cnt.[Pltfm_Cnt128],0))            As Enroute_Platform_Cnt       , sum(isnull(op_car_cnt.[Pltfm_Cnt131],0))            as In_Paid_Storage_Platform_Cnt      , sum(isnull(op_car_cnt.[Pltfm_Cnt132],0))               as In_Repair_Entity_Platform_Cnt      , sum(isnull(op_car_cnt.[Pltfm_Cnt136],0))               as On_Railroad_Relief_Platform_Cnt      , case when ISNULL(Ownr_Mrk,'') <> 'TTX' OR upper(ISNULL(car_status_UFD,'')) <> ('ACTIVE') then NULL -- sum(op_car_cnt.[Pltfm_Cnt138]) is null OR        else sum((isnull(op_car_cnt.[Pltfm_Cnt138],0) - isnull(op_car_cnt.[Pltfm_Cnt128],0)                 - isnull(op_car_cnt.[Pltfm_Cnt131],0)                 - isnull(op_car_cnt.[Pltfm_Cnt132],0)                - isnull(op_car_cnt.[Pltfm_Cnt136],0)))  end as Fleet_In_Service_Platform_Cnt          , sum(isnull(op_car_cnt.[Pltfm_Cnt138],0) )           as Physical_Fleet_Size_Platform_Cnt      , sum(op_car_cnt.[Pltfm_Cnt139]    )           as Pooled_Fleet_Size_Platform_Cnt      , sum(op_car_cnt.[Pltfm_Cnt140]    )           as Distributable_Fleet_Size_Platform_Cnt            /* added for ticket 735845*/            ,sum(op_car_cnt.[Pltfm_Cnt159] ) as Offered_for_Relief_Fleet_Size_Pltfm_cnt          ,sum(isnull([Owned Idle Empty Car Count 15 days128],0)) as Enroute_Owned_Idle_Empty_Car_Cnt_15_Days,          sum(isnull([Owned Idle Empty Car Count 15 days138] ,0)) as Physical_Fleet_Size_Owned_Idle_Empty_Car_Cnt_15_Days,          sum(isnull([Owned Idle Empty Car Count 15 days139] ,0)) as Pooled_Fleet_Size_Owned_Idle_Empty_Car_Cnt_15_Days,          sum(isnull([Owned Idle Empty Car Count 15 days140] ,0))  as Distributable_Fleet_Size_Owned_Idle_Empty_Car_Cnt_15_Days,          sum(isnull([Owned Idle Empty Car Count 15 days128] * Pltfm_Fctr,0)) as Enroute_Owned_Idle_Empty_Platform_Cnt_15_Days,          sum(isnull([Owned Idle Empty Car Count 15 days138] * Pltfm_Fctr,0)) as Physical_Fleet_Size_Owned_Idle_Empty_Platform_Cnt_15_Days,          sum(isnull([Owned Idle Empty Car Count 15 days139] * Pltfm_Fctr,0)) as Pooled_Fleet_Size_Owned_Idle_Empty_Platform_Cnt_15_Days,          sum(isnull([Owned Idle Empty Car Count 15 days140] * Pltfm_Fctr,0))  as Distributable_Fleet_Size_Owned_Idle_Empty_Platform_Cnt_15_Days         --RITM0027009     , sum(isnull([Owned Idle Empty Car Count No Movement 15 days138] ,0)) as Physical_Fleet_Size_Owned_Idle_Empty_No_Movement_Car_Cnt_15_Days,         sum(isnull([Owned Idle Empty Car Count No Movement 15 days138] * Pltfm_Fctr,0)) as Physical_Fleet_Size_Owned_Idle_Empty_No_Movement_Platform_Cnt_15_Days    from (    SELECT          car_dimn_id    ,car_ver    ,Dt_Dimn_Id     ,Attr_Id_1     ,Attr_Ver_1     ,Attr_Id_2     ,Attr_Ver_2     ,Attr_Id_3    ,Attr_Ver_3    ,Attr_Val_Num_3    ,Attr_Val_Char_4    ,Ownr_Mrk    ,car_status_UFD    ,concat(CntName, Car_Cnt_Catg_Typ_Id) as PCol    ,CntValue    ,Pltfm_Fctr    ,Liability_Event_Dt    ,Crtd_Dt    ,trk_axl_cnt    ,Car_Ut_Cnt        FROM           (select car_cnt.car_dimn_id,car_cnt.car_ver,car_cnt.Dt_Dimn_Id,car_cnt.Attr_Id_1,car_cnt.Attr_Ver_1,car_cnt.Attr_Id_2,car_cnt.Attr_Ver_2     ,car_cnt.Attr_Id_3,car_cnt.Attr_Ver_3,car_cnt.Attr_Val_Char_4,car_cnt.Attr_Val_Num_3             ,car_cnt.Car_cnt_Catg_Typ_id, car_cnt.Car_Cnt,TPE_Cnt, car_cnt.Ut_Cnt, Pltfm_Cnt,car_dim.Ownr_Mrk,       car_dim.car_status_UFD,       Liability_Event_Dt ,car_cnt.Crtd_Dt ,       (CASE WHEN (Car_Idle_Cnt / 24) >= 15 AND                           [Owned_Idle_Empty_Car_Cnt] = 1 THEN cast('1' as decimal(38,10))  ELSE cast('0' as decimal(38,10)) END) AS [Owned Idle Empty Car Count 15 days],          isnull((CASE WHEN (Car_Idle_No_Movement_CNT / 24) >= 15 AND [Owned_Idle_Empty_Car_Count_No_Movement] = 1                    THEN cast('1' as decimal(38,10))            ELSE cast('0' as decimal(38,10)) END),cast('0' as decimal(38,10))) AS [Owned Idle Empty Car Count No Movement 15 days],         Pltfm_Fctr,trk_axl_cnt,car_dim.Ut_Cnt as Car_Ut_Cnt      from  dbo.vw_car_count_fact_History car_cnt(NOLOCK)      LEFT JOIN (SELECT car_dimn_id,car_ver,Ownr_Mrk,car_status_UFD,Pltfm_Fctr,trk_axl_cnt,Ut_Cnt  FROM dbo.vmrt_car_dimension_correct (NOLOCK)) car_dim ON car_cnt.car_dimn_id = car_dim.car_dimn_id AND car_cnt.car_ver = car_dim.car_ver      where row_typ_id=518 and  Car_Cnt_Catg_Typ_Id <> 149 ) ta --Operational        UNPIVOT         (CntValue FOR CntName IN (Car_Cnt, TPE_Cnt, Ut_Cnt, Pltfm_Cnt,[Owned Idle Empty Car Count 15 days],[Owned Idle Empty Car Count No Movement 15 days])) AS pvt     ) Tunpivot        PIVOT         (              sum(CntValue)         FOR Pcol IN ( [Car_Cnt128], [Car_Cnt131],[Car_Cnt132],[Car_Cnt136],[Car_Cnt138],[Car_Cnt139],[Car_Cnt140],[Car_Cnt159]          , [TPE_Cnt128], [TPE_Cnt131],[TPE_Cnt132],[TPE_Cnt136],[TPE_Cnt138],[TPE_Cnt139],[TPE_Cnt140],[TPE_Cnt159]          , [Ut_Cnt128], [Ut_Cnt131],[Ut_Cnt132],[Ut_Cnt136],[Ut_Cnt138],[Ut_Cnt139],[Ut_Cnt140], [Ut_Cnt159]          , [Pltfm_Cnt128], [Pltfm_Cnt131],[Pltfm_Cnt132],[Pltfm_Cnt136],[Pltfm_Cnt138],[Pltfm_Cnt139],[Pltfm_Cnt140],[Pltfm_Cnt159]          ,[Owned Idle Empty Car Count 15 days128],          [Owned Idle Empty Car Count 15 days138],[Owned Idle Empty Car Count 15 days139],          [Owned Idle Empty Car Count 15 days140]  ,[Owned Idle Empty Car Count No Movement 15 days138]        )       )   AS op_car_cnt        group by        op_car_cnt.car_dimn_id      ,op_car_cnt.car_ver      ,op_car_cnt.Dt_Dimn_Id       ,op_car_cnt.Attr_Id_1        ,op_car_cnt.Attr_Ver_1       ,op_car_cnt.Attr_Id_2        ,op_car_cnt.Attr_Ver_2       ,op_car_cnt.Attr_Id_3        ,op_car_cnt.Attr_Ver_3      ,op_car_cnt.Ownr_Mrk      ,op_car_cnt.car_status_UFD      ,Liability_Event_Dt      ,Crtd_Dt     --,cast(op_car_cnt.Attr_Val_Num_3 as int)      ,convert(char(1),op_car_cnt.Attr_Val_Char_4)"
    },
    {
      "id": "AR_FILTER_00005_1787153412",
      "name": "AR_FILTER_00005_1787153412",
      "type": "REPLICATION_FILTER_PROCEDURE",
      "sql": "create procedure [dbo].[AR_FILTER_00005_1787153412] for replication as if exists (select * from [dbo].[Maintenance_Type_Dim] where (1=0)) return 1 else return 0"
    },
    {
      "id": "VMRT_Revenue_Accounting_Accrual_Car_Count",
      "name": "VMRT_Revenue_Accounting_Accrual_Car_Count",
      "type": "VIEW",
      "sql": "CREATE view [dbo].[VMRT_Revenue_Accounting_Accrual_Car_Count] as      With Tunpivot as (  SELECT    car_dimn_id  ,car_ver  ,Dt_Dimn_Id   ,Attr_Id_1   ,Attr_Ver_1   ,Attr_Id_2   ,Attr_Ver_2   ,Liable_Org_Dimn_Id  ,Liable_Org_Ver  ,Responsible_Org_Dimn_Id  ,Responsible_Org_Ver  ,concat(CntName, Car_Cnt_Catg_Typ_Id) as PCol  ,CntValue      FROM     (select car_dimn_id,car_ver,Dt_Dimn_Id,Attr_Id_1,Attr_Ver_1,Attr_Id_2,Attr_Ver_2     , mem1.Org_Dimn_Id as Responsible_Org_Dimn_Id , mem1.org_Ver as Responsible_Org_Ver     , mem2.Org_Dimn_Id as Liable_Org_Dimn_Id, mem2.org_Ver as  Liable_Org_Ver           ,Car_cnt_Catg_Typ_id,Car_Cnt,TPE_Cnt, Ut_Cnt, Pltfm_Cnt     from  ddsmrt.dbo.vw_car_count_fact (NOLOCK) cnt    left join ddsmrt.dbo.Organization_Membership_dim (NOLOCK) mem1 on (Cnt.Attr_Id_1 = mem1.[Org_Mbrshp_Dimn_Id] and cnt.Attr_Ver_1 = mem1.[Org_Mbrshp_Ver])    left join ddsmrt.dbo.Organization_Membership_dim (NOLOCK) mem2 on (Cnt.Attr_Id_2 = mem2.[Org_Mbrshp_Dimn_Id] and cnt.Attr_Ver_2 = mem2.[Org_Mbrshp_Ver])    where cnt.row_typ_id=516 ) ta --Rev Acct Accrual     UNPIVOT   (CntValue FOR CntName IN (Car_Cnt, TPE_Cnt, Ut_Cnt, Pltfm_Cnt)) AS pvt    )  select      rev_car_cnt.car_dimn_id    ,rev_car_cnt.car_ver    ,rev_car_cnt.Dt_Dimn_Id as Service_Month_Start_Dt_Dimn_Id    ,rev_car_cnt.Attr_Id_1 as Responsible_Road_Org_Mbrshp_Dimn_Id     ,rev_car_cnt.Attr_Ver_1 as Responsible_Road_Org_Mbrshp_Ver    ,rev_car_cnt.Attr_Id_2 as Liable_Road_Org_Mbrshp_Dimn_Id    ,rev_car_cnt.Attr_Ver_2 as Liable_Road_Org_Mbrshp_Ver     ,rev_car_cnt.Liable_Org_Dimn_Id    ,rev_car_cnt.Liable_Org_Ver    ,rev_car_cnt.Responsible_Org_Dimn_Id    ,rev_car_cnt.Responsible_Org_Ver     --car cnt    , (isnull(rev_car_cnt.[Car_Cnt145],0) + isnull(rev_car_cnt.[Car_Cnt146],0))   As In_Shop_Car_Cnt          , isnull(rev_car_cnt.[Car_Cnt128],0)            As Enroute_Car_Cnt           , isnull(rev_car_cnt.[Car_Cnt129],0)            As In_Bad_Order_Storage_Car_Cnt    , isnull(rev_car_cnt.[Car_Cnt130],0)            as In_FMO_Car_Cnt    , (isnull(rev_car_cnt.[Car_Cnt133],0) + isnull(rev_car_cnt.[Car_Cnt129],0))   as In_Paid_Storage_Car_Cnt    , (isnull(rev_car_cnt.[Car_Cnt130],0) + isnull(rev_car_cnt.[Car_Cnt145],0) + isnull(rev_car_cnt.[Car_Cnt146],0)) as In_Repair_Entity_Car_Cnt    , isnull(rev_car_cnt.[Car_Cnt145],0)            as In_TTX_Shop_Car_Cnt    , isnull(rev_car_cnt.[Car_Cnt146],0)            as In_IRF_Car_Cnt    , isnull(rev_car_cnt.[Car_Cnt133],0)            as In_Selective_Storage_Car_Cnt    , isnull(rev_car_cnt.[Car_Cnt134],0)            as On_Offline_Relief_Car_Cnt    , isnull(rev_car_cnt.[Car_Cnt135],0)            as On_Online_Relief_Car_Cnt    , (isnull(rev_car_cnt.[Car_Cnt134],0) + isnull(rev_car_cnt.[Car_Cnt135],0))   as On_Railroad_Relief_Car_Cnt    , (isnull(rev_car_cnt.[Car_Cnt138],0)-isnull(rev_car_cnt.[Car_Cnt130],0)-isnull(rev_car_cnt.[Car_Cnt145],0)-isnull(rev_car_cnt.[Car_Cnt146],0)             -isnull(rev_car_cnt.[Car_Cnt134],0)-isnull(rev_car_cnt.[Car_Cnt135],0)             -isnull(rev_car_cnt.[Car_Cnt133],0)-isnull(rev_car_cnt.[Car_Cnt129],0)             -isnull(rev_car_cnt.[Car_Cnt128],0))     as Fleet_In_Service_Car_Cnt    , isnull(rev_car_cnt.[Car_Cnt138],0)            as Fleet_Size_Car_Cnt     --tpe cnt    , (isnull(rev_car_cnt.[TPE_Cnt145],0) + isnull(rev_car_cnt.[TPE_Cnt146],0))   As In_Shop_TPE_Cnt          , isnull(rev_car_cnt.[TPE_Cnt128],0)            As Enroute_TPE_Cnt          , isnull(rev_car_cnt.[TPE_Cnt129],0)            As In_Bad_Order_Storage_TPE_Cnt    , isnull(rev_car_cnt.[TPE_Cnt130],0)            as In_FMO_TPE_Cnt    , (isnull(rev_car_cnt.[TPE_Cnt133],0) + isnull(rev_car_cnt.[TPE_Cnt129],0))   as In_Paid_Storage_TPE_Cnt    , (isnull(rev_car_cnt.[TPE_Cnt130],0) + isnull(rev_car_cnt.[TPE_Cnt145],0) + isnull(rev_car_cnt.[TPE_Cnt146],0)) as In_Repair_Entity_TPE_Cnt    , isnull(rev_car_cnt.[TPE_Cnt145],0)            as In_TTX_Shop_TPE_Cnt    , isnull(rev_car_cnt.[TPE_Cnt146],0)            as In_IRF_TPE_Cnt    , isnull(rev_car_cnt.[TPE_Cnt133],0)            as In_Selective_Storage_TPE_Cnt    , isnull(rev_car_cnt.[TPE_Cnt134],0)            as On_Offline_Relief_TPE_Cnt    , isnull(rev_car_cnt.[TPE_Cnt135],0)            as On_Online_Relief_TPE_Cnt    , (isnull(rev_car_cnt.[TPE_Cnt134],0) + isnull(rev_car_cnt.[TPE_Cnt135],0))   as On_Railroad_Relief_TPE_Cnt    , (isnull(rev_car_cnt.[TPE_Cnt138],0)-isnull(rev_car_cnt.[TPE_Cnt130],0)-isnull(rev_car_cnt.[TPE_Cnt145],0)-isnull(rev_car_cnt.[TPE_Cnt146],0)             -isnull(rev_car_cnt.[TPE_Cnt134],0)-isnull(rev_car_cnt.[TPE_Cnt135],0)             -isnull(rev_car_cnt.[TPE_Cnt133],0)-isnull(rev_car_cnt.[TPE_Cnt129],0)             -isnull(rev_car_cnt.[TPE_Cnt128],0))     as Fleet_In_Service_TPE_Cnt    , isnull(rev_car_cnt.[TPE_Cnt138],0)            as Fleet_Size_TPE_Cnt     --Ut cnt    , (isnull(rev_car_cnt.[Ut_Cnt145],0) + isnull(rev_car_cnt.[Ut_Cnt146],0))      As In_Shop_Unit_Cnt          , isnull(rev_car_cnt.[Ut_Cnt128],0)                As Enroute_Unit_Cnt          , isnull(rev_car_cnt.[Ut_Cnt129],0)                As In_Bad_Order_Storage_Unit_Cnt    , isnull(rev_car_cnt.[Ut_Cnt130],0)                as In_FMO_Unit_Cnt    , (isnull(rev_car_cnt.[Ut_Cnt133],0) + isnull(rev_car_cnt.[Ut_Cnt129],0))      as In_Paid_Storage_Unit_Cnt    , (isnull(rev_car_cnt.[Ut_Cnt130],0) + isnull(rev_car_cnt.[Ut_Cnt145],0) + isnull(rev_car_cnt.[Ut_Cnt146],0)) as In_Repair_Entity_Unit_Cnt    , isnull(rev_car_cnt.[Ut_Cnt145],0)                as In_TTX_Shop_Unit_Cnt    , isnull(rev_car_cnt.[Ut_Cnt146],0)                as In_IRF_Unit_Cnt    , isnull(rev_car_cnt.[Ut_Cnt133],0)                as In_Selective_Storage_Unit_Cnt    , isnull(rev_car_cnt.[Ut_Cnt134],0)                as On_Offline_Relief_Unit_Cnt    , isnull(rev_car_cnt.[Ut_Cnt135],0)                as On_Online_Relief_Unit_Cnt    , (isnull(rev_car_cnt.[Ut_Cnt134],0) + isnull(rev_car_cnt.[Ut_Cnt135],0))      as On_Railroad_Relief_Unit_Cnt    , (isnull(rev_car_cnt.[Ut_Cnt138],0)-isnull(rev_car_cnt.[Ut_Cnt130],0)-isnull(rev_car_cnt.[Ut_Cnt145],0)-isnull(rev_car_cnt.[Ut_Cnt146],0)             -isnull(rev_car_cnt.[Ut_Cnt134],0)-isnull(rev_car_cnt.[Ut_Cnt135],0)             -isnull(rev_car_cnt.[Ut_Cnt133],0)-isnull(rev_car_cnt.[Ut_Cnt129],0)             -isnull(rev_car_cnt.[Ut_Cnt128],0))        as Fleet_In_Service_Unit_Cnt    , isnull(rev_car_cnt.[Ut_Cnt138],0)                as Fleet_Size_Unit_Cnt         --Platform cnt    , (isnull(rev_car_cnt.[Pltfm_Cnt145],0) + isnull(rev_car_cnt.[Pltfm_Cnt146],0))      As In_Shop_Platform_Cnt          , isnull(rev_car_cnt.[Pltfm_Cnt128],0)                As Enroute_Platform_Cnt          , isnull(rev_car_cnt.[Pltfm_Cnt129],0)                As In_Bad_Order_Storage_Platform_Cnt    , isnull(rev_car_cnt.[Pltfm_Cnt130],0)                as In_FMO_Platform_Cnt    , (isnull(rev_car_cnt.[Pltfm_Cnt133],0) + isnull(rev_car_cnt.[Pltfm_Cnt129],0))      as In_Paid_Storage_Platform_Cnt    , (isnull(rev_car_cnt.[Pltfm_Cnt130],0) + isnull(rev_car_cnt.[Pltfm_Cnt145],0) + isnull(rev_car_cnt.[Pltfm_Cnt146],0)) as In_Repair_Entity_Platform_Cnt    , isnull(rev_car_cnt.[Pltfm_Cnt145],0)                as In_TTX_Shop_Platform_Cnt    , isnull(rev_car_cnt.[Pltfm_Cnt146],0)                as In_IRF_Platform_Cnt    , isnull(rev_car_cnt.[Pltfm_Cnt133],0)                as In_Selective_Storage_Platform_Cnt    , isnull(rev_car_cnt.[Pltfm_Cnt134],0)                as On_Offline_Relief_Platform_Cnt    , isnull(rev_car_cnt.[Pltfm_Cnt135],0)                as On_Online_Relief_Platform_Cnt    , (isnull(rev_car_cnt.[Pltfm_Cnt134],0) + isnull(rev_car_cnt.[Pltfm_Cnt135],0))      as On_Railroad_Relief_Platform_Cnt    , (isnull(rev_car_cnt.[Pltfm_Cnt138],0)-isnull(rev_car_cnt.[Pltfm_Cnt130],0)-isnull(rev_car_cnt.[Pltfm_Cnt145],0)-isnull(rev_car_cnt.[Pltfm_Cnt146],0)             -isnull(rev_car_cnt.[Pltfm_Cnt134],0)-isnull(rev_car_cnt.[Pltfm_Cnt135],0)             -isnull(rev_car_cnt.[Pltfm_Cnt133],0)-isnull(rev_car_cnt.[Pltfm_Cnt129],0)             -isnull(rev_car_cnt.[Pltfm_Cnt128],0))        as Fleet_In_Service_Platform_Cnt    , isnull(rev_car_cnt.[Pltfm_Cnt138],0)                as Fleet_Size_Platform_Cnt      from Tunpivot    PIVOT   (            sum(CntValue)       FOR Pcol IN ( [Car_Cnt128], [Car_Cnt129],[Car_Cnt130],[Car_Cnt133],[Car_Cnt134],[Car_Cnt135],[Car_Cnt136],[Car_Cnt137],[Car_Cnt138],[Car_Cnt145],[Car_Cnt146]        , [TPE_Cnt128], [TPE_Cnt129],[TPE_Cnt130],[TPE_Cnt133],[TPE_Cnt134],[TPE_Cnt135],[TPE_Cnt136],[TPE_Cnt137],[TPE_Cnt138],[TPE_Cnt145],[TPE_Cnt146]        , [Ut_Cnt128], [Ut_Cnt129],[Ut_Cnt130],[Ut_Cnt133],[Ut_Cnt134],[Ut_Cnt135],[Ut_Cnt136],[Ut_Cnt137],[Ut_Cnt138],[Ut_Cnt145],[Ut_Cnt146]        , [Pltfm_Cnt128], [Pltfm_Cnt129],[Pltfm_Cnt130],[Pltfm_Cnt133],[Pltfm_Cnt134],[Pltfm_Cnt135],[Pltfm_Cnt136],[Pltfm_Cnt137],[Pltfm_Cnt138],[Pltfm_Cnt145],[Pltfm_Cnt146]          )     )   AS rev_car_cnt"
    },
    {
      "id": "VMRT_Accrual_Mileage",
      "name": "VMRT_Accrual_Mileage",
      "type": "VIEW",
      "sql": "CREATE VIEW [dbo].[VMRT_Accrual_Mileage]  AS  SELECT  [Accrual_Milg_Fact_Id]        ,[Hierchy_Id]        ,[Hierchy_Ver]        ,[Rpt_Rd_Dimn_Id]        ,[Rpt_Rd_Ver]        ,[Rpt_Mth_Dimn_Id]        ,[Svc_Mth_Dimn_Id]        ,[Totl_Mile]     ,[AccruedTotalPlatformMileage]     ,[AccruedTotalTPEMileage]     ,[AccruedTotalUnitMileage]        ,[Crtd_Id]        ,[Crtd_Dt]    FROM [DDSMRT].[dbo].[Accrual_Milg_Fact]"
    },
    {
      "id": "usp_D_House_Keeping_Repair_Event_Cost_Fact",
      "name": "usp_D_House_Keeping_Repair_Event_Cost_Fact",
      "type": "SQL_STORED_PROCEDURE",
      "sql": "CREATE PROC [dbo].[usp_D_House_Keeping_Repair_Event_Cost_Fact] (@month INT = 6)  AS  BEGIN   IF(MONTH(GETDATE()) IN (3,6,9,12))   BEGIN    DECLARE @date INT = CONVERT(VARCHAR(10), DATEADD(MONTH,- @month,GETDATE()), 112)    DECLARE @PARTITION INT      SELECT @PARTITION = $PARTITION.pf_Repair_Event_Cost_Fact_Function(@date)       ALTER TABLE [dbo].[Repair_Event_Cost_Fact] SWITCH PARTITION (@PARTITION) TO [dbo].[Repair_Event_Cost_Fact_History] PARTITION (@PARTITION)   END  END"
    },
    {
      "id": "syncobj_0x4441413141443041",
      "name": "syncobj_0x4441413141443041",
      "type": "VIEW",
      "sql": "create view [dbo].[syncobj_0x4441413141443041]as select  [Matl_Dimn_Id],[Ref_Nr],[Ref_Nr_Desc],[Tksl_Matl_Flg],[Catg_Cd],[Catg_Cd_Desc],[Attr1_Val_Num],[Attr1_Val_Char],[Crtd_Dt],[Crtd_Id],[Lst_Upd_Dt],[Lst_Upd_Id],[Src_Sys_Nm],[Dq_Flg],[Matl_Prnt_Ref_Nbr],[Matl_Prnt_Desc]  from  [dbo].[Material_Dim]  where HAS_PERMS_BY_NAME('[dbo].[Material_Dim]', 'OBJECT', 'SELECT')= 1  and ((1=0))"
    },
    {
      "id": "VMRT_Revenue_Accounting_Actual_Car_Count",
      "name": "VMRT_Revenue_Accounting_Actual_Car_Count",
      "type": "VIEW",
      "sql": "CREATE view [dbo].[VMRT_Revenue_Accounting_Actual_Car_Count] as      With Tunpivot as (  SELECT    car_dimn_id  ,car_ver  ,Dt_Dimn_Id   ,Attr_Id_1   ,Attr_Ver_1   ,Attr_Id_2   ,Attr_Ver_2   ,Liable_Org_Dimn_Id  ,Liable_Org_Ver  ,Responsible_Org_Dimn_Id  ,Responsible_Org_Ver  ,concat(CntName, Car_Cnt_Catg_Typ_Id) as PCol  ,CntValue      FROM     (select car_dimn_id,car_ver,Dt_Dimn_Id,Attr_Id_1,Attr_Ver_1,Attr_Id_2,Attr_Ver_2     , mem1.Org_Dimn_Id as Responsible_Org_Dimn_Id , mem1.org_Ver as Responsible_Org_Ver     , mem2.Org_Dimn_Id as Liable_Org_Dimn_Id, mem2.org_Ver as Liable_Org_Ver            ,Car_cnt_Catg_Typ_id,Car_Cnt,TPE_Cnt, Ut_Cnt, Pltfm_Cnt     from  ddsmrt.dbo.vw_car_count_fact (NOLOCK) cnt    left join ddsmrt.dbo.Organization_Membership_dim (NOLOCK) mem1 on (Cnt.Attr_Id_1 = mem1.[Org_Mbrshp_Dimn_Id] and cnt.Attr_Ver_1 = mem1.[Org_Mbrshp_Ver])    left join ddsmrt.dbo.Organization_Membership_dim (NOLOCK) mem2 on (Cnt.Attr_Id_2 = mem2.[Org_Mbrshp_Dimn_Id] and cnt.Attr_Ver_2 = mem2.[Org_Mbrshp_Ver])      where row_typ_id=517 ) ta --Rev Acct Actual    UNPIVOT   (CntValue FOR CntName IN (Car_Cnt, TPE_Cnt, Ut_Cnt, Pltfm_Cnt)) AS pvt    )  select      rev_car_cnt.car_dimn_id    ,rev_car_cnt.car_ver    ,rev_car_cnt.Dt_Dimn_Id as Service_Month_Start_Dt_Dimn_Id    ,rev_car_cnt.Attr_Id_1 as Responsible_Road_Org_Mbrshp_Dimn_Id    ,rev_car_cnt.Attr_Ver_1 as Responsible_Road_Org_Mbrshp_Ver    ,rev_car_cnt.Attr_Id_2 as Liable_Road_Org_Mbrshp_Dimn_Id     ,rev_car_cnt.Attr_Ver_2 as Liable_Road_Org_Mbrshp_Ver     ,rev_car_cnt.Liable_Org_Dimn_Id    ,rev_car_cnt.Liable_Org_Ver    ,rev_car_cnt.Responsible_Org_Dimn_Id    ,rev_car_cnt.Responsible_Org_Ver     --car cnt    , (isnull(rev_car_cnt.[Car_Cnt145],0) + isnull(rev_car_cnt.[Car_Cnt146],0))   As In_Shop_Car_Cnt          , isnull(rev_car_cnt.[Car_Cnt128],0)            As Enroute_Car_Cnt           , isnull(rev_car_cnt.[Car_Cnt129],0)            As In_Bad_Order_Storage_Car_Cnt    , isnull(rev_car_cnt.[Car_Cnt130],0)            as In_FMO_Car_Cnt    , (isnull(rev_car_cnt.[Car_Cnt133],0) + isnull(rev_car_cnt.[Car_Cnt129],0))   as In_Paid_Storage_Car_Cnt    , (isnull(rev_car_cnt.[Car_Cnt130],0) + isnull(rev_car_cnt.[Car_Cnt145],0) + isnull(rev_car_cnt.[Car_Cnt146],0)) as In_Repair_Entity_Car_Cnt    , isnull(rev_car_cnt.[Car_Cnt145],0)            as In_TTX_Shop_Car_Cnt    , isnull(rev_car_cnt.[Car_Cnt146],0)            as In_IRF_Car_Cnt    , isnull(rev_car_cnt.[Car_Cnt133],0)            as In_Selective_Storage_Car_Cnt    , isnull(rev_car_cnt.[Car_Cnt134],0)            as On_Offline_Relief_Car_Cnt    , isnull(rev_car_cnt.[Car_Cnt135],0)            as On_Online_Relief_Car_Cnt    , (isnull(rev_car_cnt.[Car_Cnt134],0) + isnull(rev_car_cnt.[Car_Cnt135],0))   as On_Railroad_Relief_Car_Cnt    , (isnull(rev_car_cnt.[Car_Cnt138],0)-isnull(rev_car_cnt.[Car_Cnt130],0)-isnull(rev_car_cnt.[Car_Cnt145],0)-isnull(rev_car_cnt.[Car_Cnt146],0)             -isnull(rev_car_cnt.[Car_Cnt134],0)-isnull(rev_car_cnt.[Car_Cnt135],0)             -isnull(rev_car_cnt.[Car_Cnt133],0)-isnull(rev_car_cnt.[Car_Cnt129],0)             -isnull(rev_car_cnt.[Car_Cnt128],0))     as Fleet_In_Service_Car_Cnt    , isnull(rev_car_cnt.[Car_Cnt138],0)            as Fleet_Size_Car_Cnt     --tpe cnt    , (isnull(rev_car_cnt.[TPE_Cnt145],0) + isnull(rev_car_cnt.[TPE_Cnt146],0))   As In_Shop_TPE_Cnt          , isnull(rev_car_cnt.[TPE_Cnt128],0)            As Enroute_TPE_Cnt          , isnull(rev_car_cnt.[TPE_Cnt129],0)            As In_Bad_Order_Storage_TPE_Cnt    , isnull(rev_car_cnt.[TPE_Cnt130],0)            as In_FMO_TPE_Cnt    , (isnull(rev_car_cnt.[TPE_Cnt133],0) + isnull(rev_car_cnt.[TPE_Cnt129],0))   as In_Paid_Storage_TPE_Cnt    , (isnull(rev_car_cnt.[TPE_Cnt130],0) + isnull(rev_car_cnt.[TPE_Cnt145],0) + isnull(rev_car_cnt.[TPE_Cnt146],0)) as In_Repair_Entity_TPE_Cnt    , isnull(rev_car_cnt.[TPE_Cnt145],0)            as In_TTX_Shop_TPE_Cnt    , isnull(rev_car_cnt.[TPE_Cnt146],0)            as In_IRF_TPE_Cnt    , isnull(rev_car_cnt.[TPE_Cnt133],0)            as In_Selective_Storage_TPE_Cnt    , isnull(rev_car_cnt.[TPE_Cnt134],0)            as On_Offline_Relief_TPE_Cnt    , isnull(rev_car_cnt.[TPE_Cnt135],0)            as On_Online_Relief_TPE_Cnt    , (isnull(rev_car_cnt.[TPE_Cnt134],0) + isnull(rev_car_cnt.[TPE_Cnt135],0))   as On_Railroad_Relief_TPE_Cnt    , (isnull(rev_car_cnt.[TPE_Cnt138],0)-isnull(rev_car_cnt.[TPE_Cnt130],0)-isnull(rev_car_cnt.[TPE_Cnt145],0)-isnull(rev_car_cnt.[TPE_Cnt146],0)             -isnull(rev_car_cnt.[TPE_Cnt134],0)-isnull(rev_car_cnt.[TPE_Cnt135],0)             -isnull(rev_car_cnt.[TPE_Cnt133],0)-isnull(rev_car_cnt.[TPE_Cnt129],0)             -isnull(rev_car_cnt.[TPE_Cnt128],0))     as Fleet_In_Service_TPE_Cnt    , isnull(rev_car_cnt.[TPE_Cnt138],0)            as Fleet_Size_TPE_Cnt     --Ut cnt    , (isnull(rev_car_cnt.[Ut_Cnt145],0) + isnull(rev_car_cnt.[Ut_Cnt146],0))      As In_Shop_Unit_Cnt          , isnull(rev_car_cnt.[Ut_Cnt128],0)                As Enroute_Unit_Cnt          , isnull(rev_car_cnt.[Ut_Cnt129],0)                As In_Bad_Order_Storage_Unit_Cnt    , isnull(rev_car_cnt.[Ut_Cnt130],0)                as In_FMO_Unit_Cnt    , (isnull(rev_car_cnt.[Ut_Cnt133],0) + isnull(rev_car_cnt.[Ut_Cnt129],0))      as In_Paid_Storage_Unit_Cnt    , (isnull(rev_car_cnt.[Ut_Cnt130],0) + isnull(rev_car_cnt.[Ut_Cnt145],0) + isnull(rev_car_cnt.[Ut_Cnt146],0)) as In_Repair_Entity_Unit_Cnt    , isnull(rev_car_cnt.[Ut_Cnt145],0)                as In_TTX_Shop_Unit_Cnt    , isnull(rev_car_cnt.[Ut_Cnt146],0)                as In_IRF_Unit_Cnt    , isnull(rev_car_cnt.[Ut_Cnt133],0)                as In_Selective_Storage_Unit_Cnt    , isnull(rev_car_cnt.[Ut_Cnt134],0)                as On_Offline_Relief_Unit_Cnt    , isnull(rev_car_cnt.[Ut_Cnt135],0)                as On_Online_Relief_Unit_Cnt    , (isnull(rev_car_cnt.[Ut_Cnt134],0) + isnull(rev_car_cnt.[Ut_Cnt135],0))      as On_Railroad_Relief_Unit_Cnt    , (isnull(rev_car_cnt.[Ut_Cnt138],0)-isnull(rev_car_cnt.[Ut_Cnt130],0)-isnull(rev_car_cnt.[Ut_Cnt145],0)-isnull(rev_car_cnt.[Ut_Cnt146],0)             -isnull(rev_car_cnt.[Ut_Cnt134],0)-isnull(rev_car_cnt.[Ut_Cnt135],0)             -isnull(rev_car_cnt.[Ut_Cnt133],0)-isnull(rev_car_cnt.[Ut_Cnt129],0)             -isnull(rev_car_cnt.[Ut_Cnt128],0))        as Fleet_In_Service_Unit_Cnt    , isnull(rev_car_cnt.[Ut_Cnt138],0)                as Fleet_Size_Unit_Cnt         --Platform cnt    , (isnull(rev_car_cnt.[Pltfm_Cnt145],0) + isnull(rev_car_cnt.[Pltfm_Cnt146],0))      As In_Shop_Platform_Cnt          , isnull(rev_car_cnt.[Pltfm_Cnt128],0)                As Enroute_Platform_Cnt          , isnull(rev_car_cnt.[Pltfm_Cnt129],0)                As In_Bad_Order_Storage_Platform_Cnt    , isnull(rev_car_cnt.[Pltfm_Cnt130],0)                as In_FMO_Platform_Cnt    , (isnull(rev_car_cnt.[Pltfm_Cnt133],0) + isnull(rev_car_cnt.[Pltfm_Cnt129],0))      as In_Paid_Storage_Platform_Cnt    , (isnull(rev_car_cnt.[Pltfm_Cnt130],0) + isnull(rev_car_cnt.[Pltfm_Cnt145],0) + isnull(rev_car_cnt.[Pltfm_Cnt146],0)) as In_Repair_Entity_Platform_Cnt    , isnull(rev_car_cnt.[Pltfm_Cnt145],0)                as In_TTX_Shop_Platform_Cnt    , isnull(rev_car_cnt.[Pltfm_Cnt146],0)                as In_IRF_Platform_Cnt    , isnull(rev_car_cnt.[Pltfm_Cnt133],0)                as In_Selective_Storage_Platform_Cnt    , isnull(rev_car_cnt.[Pltfm_Cnt134],0)                as On_Offline_Relief_Platform_Cnt    , isnull(rev_car_cnt.[Pltfm_Cnt135],0)                as On_Online_Relief_Platform_Cnt    , (isnull(rev_car_cnt.[Pltfm_Cnt134],0) + isnull(rev_car_cnt.[Pltfm_Cnt135],0))      as On_Railroad_Relief_Platform_Cnt    , (isnull(rev_car_cnt.[Pltfm_Cnt138],0)-isnull(rev_car_cnt.[Pltfm_Cnt130],0)-isnull(rev_car_cnt.[Pltfm_Cnt145],0)-isnull(rev_car_cnt.[Pltfm_Cnt146],0)             -isnull(rev_car_cnt.[Pltfm_Cnt134],0)-isnull(rev_car_cnt.[Pltfm_Cnt135],0)             -isnull(rev_car_cnt.[Pltfm_Cnt133],0)-isnull(rev_car_cnt.[Pltfm_Cnt129],0)             -isnull(rev_car_cnt.[Pltfm_Cnt128],0))        as Fleet_In_Service_Platform_Cnt    , isnull(rev_car_cnt.[Pltfm_Cnt138],0)                as Fleet_Size_Platform_Cnt      from Tunpivot    PIVOT   (            sum(CntValue)       FOR Pcol IN ( [Car_Cnt128], [Car_Cnt129],[Car_Cnt130],[Car_Cnt133],[Car_Cnt134],[Car_Cnt135],[Car_Cnt136],[Car_Cnt137],[Car_Cnt138],[Car_Cnt145],[Car_Cnt146]        , [TPE_Cnt128], [TPE_Cnt129],[TPE_Cnt130],[TPE_Cnt133],[TPE_Cnt134],[TPE_Cnt135],[TPE_Cnt136],[TPE_Cnt137],[TPE_Cnt138],[TPE_Cnt145],[TPE_Cnt146]        , [Ut_Cnt128], [Ut_Cnt129],[Ut_Cnt130],[Ut_Cnt133],[Ut_Cnt134],[Ut_Cnt135],[Ut_Cnt136],[Ut_Cnt137],[Ut_Cnt138],[Ut_Cnt145],[Ut_Cnt146]        , [Pltfm_Cnt128], [Pltfm_Cnt129],[Pltfm_Cnt130],[Pltfm_Cnt133],[Pltfm_Cnt134],[Pltfm_Cnt135],[Pltfm_Cnt136],[Pltfm_Cnt137],[Pltfm_Cnt138],[Pltfm_Cnt145],[Pltfm_Cnt146]          )     )   AS rev_car_cnt"
    },
    {
      "id": "vwAARWheelForecasting",
      "name": "vwAARWheelForecasting",
      "type": "VIEW",
      "sql": "CREATE     view [dbo].[vwAARWheelForecasting]  as    with cte as  (    SELECT      equipmentType    ,[year]    ,[month]    ,wheelSize   FROM    (    select distinct Eq_Typ_Shrt_Desc as equipmentType from [DDSMRT].[dbo].[VMRT_Car_Hierarchy_Eshift] with(nolock)    )cc   outer apply     (     select distinct yr as [year], Mth_Nr as [month]      from  DDSMRT.dbo.Date_Dim dt with(nolock)      where dt.yr between 2012 and year(GETDATE())   )dt   outer apply     (     select distinct Whl_Sz as wheelSize from ddsmrt.dbo.Area_Of_Car_Dim with(nolock) where Whl_Sz is not null   )whl  ),  wmcRailroadData as  (    SELECT     equipmentType   ,[Year]   ,[Month]   ,wheelSize   ,ISNULL(sum(case when [key] = 'BNSF' then [value] else 0 end),0) as [RR_BNSF]   ,ISNULL(sum(case when [key] = 'CN' then [value] else 0 end),0)   as [RR_CN]   ,ISNULL(sum(case when [key] = 'CP' then [value] else 0 end),0)   as [RR_CP]   ,ISNULL(sum(case when [key] = 'CSXT' then [value] else 0 end),0) as [RR_CSXT]   ,ISNULL(sum(case when [key] = 'UP' then [value] else 0 end),0)   as [RR_UP]   ,ISNULL(sum(case when [key] = 'KCS' then [value] else 0 end),0)  as [RR_KCS]   ,ISNULL(sum(case when [key] = 'NS' then [value] else 0 end),0)   as [RR_NS]   ,ISNULL(sum(case when [key] not in ('BNSF','CN','CP','CSXT','UP','KCS','NS') then [value] else 0 end),0) as [RR_Others]   ,ISNULL(CAST(sum([value]) AS decimal(10,4)),0) as [RR_Total]     FROM [dbo].[aarWheelForecasting] WITH(NOLOCK)    WHERE typeOfData = 'Railroad'    GROUP BY equipmentType,[Year],[Month],wheelSize  ),  wmcDescData as  (    SELECT     equipmentType   ,[Year]    ,[Month]   ,wheelSize   ,SUM(case when [key] = 'High impact wheel 90 kips or greater' then [value] else 0 end) AS [WMC_High impact wheel 90 kips or greater]   ,sum(case when [key] = 'Flange high' then [value] else 0 end) as [WMC_Flange high]   ,sum(case when [key] = 'High impact wheel from 80 kips to less than 90 kips' then [value] else 0 end) as [WMC_High impact wheel from 80 kips to less than 90 kips]   ,sum(case when [key] = 'Flange thin' then [value] else 0 end) as [WMC_Flange thin]   ,sum(case when [key] = 'Rim thin' then [value] else 0 end) as [WMC_Rim thin]   ,sum(case when [key] = 'Tread shelled' then [value] else 0 end) as [WMC_Tread shelled]   ,sum(case when [key] = 'Loose backing ring' then [value] else 0 end) as [WMC_Loose backing ring]   ,sum(case when [key] = 'Acoustic bearing detector Level 1, verified by hand roll' then [value] else 0 end) as [WMC_Acoustic bearing detector Level 1, verified by hand roll]   ,sum(case when [key] = 'Acoustic bearing detector Level 1, non-verified' then [value] else 0 end) as [WMC_Acoustic bearing detector Level 1, non-verified]   ,sum(case when [key] = 'Derailment damage per Rule 95' then [value] else 0 end) as [WMC_Derailment damage per Rule 95]   ,sum(case when [key] not in     (       'High impact wheel 90 kips or greater','Flange high','High impact wheel from 80 kips to less than 90 kips',       'Flange thin','Rim thin','Tread shelled','Loose backing ring','Acoustic bearing detector Level 1, verified by hand roll',       'Acoustic bearing detector Level 1, non-verified','Derailment damage per Rule 95'    ) then [value] else 0 end) as [WMC_Others]   ,sum([value]) as WMC_Total   FROM dbo.[aarWheelForecasting] WITH(NOLOCK)   WHERE typeOfData = 'WhyMadeCode'      GROUP BY equipmentType,[Year],[Month],wheelSize    ),  wildData as  (  SELECT       equipmentType     ,[Year]     ,[Month]     ,wheelSize     ,sum(case when [key] = 'Window Open' then [value] else 0 end)   as Alert_WindowOpen     ,sum(case when [key] = 'Opportunistic' then [value] else 0 end) as Alert_Opportunistic     ,sum(case when [key] = 'Condemnable' then [value] else 0 end)   as Alert_Condemnable     ,sum(case when [key] = 'Final' then [value] else 0 end)         as Alert_Final     FROM dbo.[aarWheelForecasting] WITH(NOLOCK)     WHERE typeOfData = 'Wild'     GROUP BY equipmentType,[Year],[Month],wheelSize  ),  zoneData as  (  SELECT     equipmentType   ,[Year]   ,[Month]   ,wheelSize   ,sum(case when [key] = 'Zone_1' then [value] else 0 end) as [Zone_1]   ,sum(case when [key] = 'Zone_2' then [value] else 0 end) as [Zone_2]   ,sum(case when [key] = 'Zone_3' then [value] else 0 end) as [Zone_3]   ,sum(case when [key] = 'Zone_4' then [value] else 0 end) as [Zone_4]   ,sum(case when [key] = 'Zone_5' then [value] else 0 end) as [Zone_5]   ,sum(case when [key] = 'Zone_6' then [value] else 0 end) as [Zone_6]     FROM dbo.[aarWheelForecasting] WITH(NOLOCK)     WHERE typeOfData = 'Zone'    GROUP BY equipmentType,[Year],[Month],wheelSize  ),  billingData as  (    SELECT     equipmentType   ,[Year]   ,[Month]   ,wheelSize   ,sum([value]) as wheelVolume    FROM dbo.[aarWheelForecasting] WITH(NOLOCK)    WHERE typeOfData = 'BillingVolume'    and [key] is not NULL    AND [key] IN ('WHEEL_28_COUNTS','WHEEL_33_COUNTS','WHEEL_36_COUNTS','WHEEL_38_COUNTS')    and [value] != 0    GROUP BY equipmentType,[Year],[Month],wheelSize  ),  fleetData as  (    SELECT       equipmentType     ,[Year]     ,[Month]     ,wheelSize     ,sum(case when [key] = 'fleetSize' then [value] else 0 end) as [fleetSize]   ,sum(case when [key] = 'fleetInService' then [value] else 0 end) as [fleetInService]     FROM dbo.[aarWheelForecasting] WITH(NOLOCK)     WHERE typeOfData in ('fleetSize','fleetInService')     GROUP BY equipmentType,[Year],[Month],wheelSize  ),  mlgData as  (  SELECT     equipmentType   ,[Year]   ,[Month]   ,wheelSize   ,sum([value]) as mileage    FROM dbo.[aarWheelForecasting] WITH(NOLOCK)     WHERE typeOfData = 'Mileage'      GROUP BY equipmentType,[Year],[Month],wheelSize  )    SELECT      cte.equipmentType   ,cte.[Year]   ,cte.[Month]   ,cte.wheelSize      ,ISNULL(fleetData.fleetSize,0) AS fleetSize      ,ISNULL(fleetData.fleetInService,0) AS fleetInService      ,ISNULL(mlgData.mileage,0) AS mileage      ,ISNULL([Zone_1],0) AS [Zone_1]      ,ISNULL([Zone_2],0) AS [Zone_2]      ,ISNULL([Zone_3],0) AS [Zone_3]      ,ISNULL([Zone_4],0) AS [Zone_4]      ,ISNULL([Zone_5],0) AS [Zone_5]      ,ISNULL([Zone_6],0) AS [Zone_6]      ,ISNULL(Alert_WindowOpen,0) AS Alert_WindowOpen      ,ISNULL(Alert_Opportunistic,0) AS Alert_Opportunistic      ,ISNULL(Alert_Condemnable,0) AS Alert_Condemnable      ,ISNULL(Alert_Final,0) AS Alert_Final   ,CAST(CASE WHEN RR_Total <> 0  THEN  [RR_BNSF]/RR_Total         ELSE 0    END AS DECIMAL(10,4)) AS [RR_BNSF]    ,CAST(CASE WHEN RR_Total <> 0  THEN  [RR_CN]/RR_Total         ELSE 0    END AS DECIMAL(10,4)) AS [RR_CN]    ,CAST(CASE WHEN RR_Total <> 0  THEN  [RR_CP]/RR_Total         ELSE 0    END AS DECIMAL(10,4)) AS [RR_CP]    ,CAST(CASE WHEN RR_Total <> 0  THEN  [RR_CSXT]/RR_Total         ELSE 0    END AS DECIMAL(10,4)) AS [RR_CSXT]    ,CAST(CASE WHEN RR_Total <> 0  THEN  [RR_UP]/RR_Total         ELSE 0    END AS DECIMAL(10,4)) AS [RR_UP]    ,CAST(CASE WHEN RR_Total <> 0  THEN  [RR_KCS]/RR_Total         ELSE 0    END AS DECIMAL(10,4)) AS [RR_KCS]    ,CAST(CASE WHEN RR_Total <> 0  THEN  [RR_NS]/RR_Total         ELSE 0    END AS DECIMAL(10,4)) AS [RR_NS]    ,CAST(CASE WHEN RR_Total <> 0  THEN  [RR_Others]/RR_Total         ELSE 0    END AS DECIMAL(10,4)) AS [RR_Others]      ,ISNULL([WMC_Acoustic bearing detector Level 1, non-verified],0) AS [WMC_Acoustic bearing detector Level 1, non-verified]      ,ISNULL([WMC_Acoustic bearing detector Level 1, verified by hand roll],0) AS [WMC_Acoustic bearing detector Level 1, verified by hand roll]      ,ISNULL([WMC_Derailment damage per Rule 95],0) AS [WMC_Derailment damage per Rule 95]      ,ISNULL([WMC_Flange high],0) AS [WMC_Flange high]      ,ISNULL([WMC_Flange thin],0) AS [WMC_Flange thin]      ,ISNULL([WMC_High impact wheel 90 kips or greater],0) AS [WMC_High impact wheel 90 kips or greater]      ,ISNULL([WMC_High impact wheel from 80 kips to less than 90 kips],0) AS [WMC_High impact wheel from 80 kips to less than 90 kips]      ,ISNULL([WMC_Loose backing ring],0) AS [WMC_Loose backing ring]      ,ISNULL([WMC_Others],0) AS [WMC_Others]      ,ISNULL([WMC_Rim thin],0) AS [WMC_Rim thin]      ,ISNULL([WMC_Tread shelled],0) AS [WMC_Tread shelled]      ,ISNULL(wheelVolume,0) AS wheelVolume    FROM cte  LEFT OUTER JOIN wmcRailroadData     ON cte.equipmentType = wmcRailroadData.equipmentType     AND cte.wheelSize = wmcRailroadData.wheelSize     AND cte.[year] = wmcRailroadData.[year]     AND cte.[month] = wmcRailroadData.[month]  LEFT OUTER JOIN wmcDescData     ON cte.equipmentType = wmcDescData.equipmentType     AND cte.wheelSize = wmcDescData.wheelSize     AND cte.[year] = wmcDescData.[year]     AND cte.[month] = wmcDescData.[month]  LEFT JOIN wildData     ON wildData.equipmentType = cte.equipmentType     AND wildData.wheelSize = cte.wheelSize     AND wildData.[year] = cte.[year]     AND wildData.[month] = cte.[month]  LEFT JOIN zoneData     ON zoneData.equipmentType = cte.equipmentType     AND zoneData.wheelSize = cte.wheelSize     AND zoneData.[year] = cte.[year]     AND zoneData.[month] = cte.[month]  LEFT JOIN billingData     ON billingData.equipmentType = cte.equipmentType     AND billingData.wheelSize = cte.wheelSize     AND billingData.[year] = cte.[year]     AND billingData.[month] = cte.[month]  LEFT JOIN fleetData     ON fleetData.equipmentType = cte.equipmentType     AND fleetData.wheelSize = cte.wheelSize     AND fleetData.[year] = cte.[year]     AND fleetData.[month] = cte.[month]  LEFT JOIN mlgData     ON mlgData.equipmentType = cte.equipmentType     AND mlgData.wheelSize = cte.wheelSize     AND mlgData.[year] = cte.[year]     AND mlgData.[month] = cte.[month]  where   fleetData.fleetSize IS NOT NULL OR  fleetData.fleetInService IS NOT NULL OR  mlgData.mileage IS NOT NULL OR  [Zone_1] IS NOT NULL OR  [Zone_2] IS NOT NULL OR  [Zone_3] IS NOT NULL OR  [Zone_4] IS NOT NULL OR  [Zone_5] IS NOT NULL OR  [Zone_6] IS NOT NULL OR  Alert_WindowOpen IS NOT NULL OR  Alert_Opportunistic IS NOT NULL OR  Alert_Condemnable IS NOT NULL OR  Alert_Final IS NOT NULL OR  [RR_Total] IS NOT NULL OR    WMC_Total IS NOT NULL OR  wheelVolume IS NOT NULL"
    },
    {
      "id": "VMRT_Actual_Mileage",
      "name": "VMRT_Actual_Mileage",
      "type": "VIEW",
      "sql": "Create View [dbo].[VMRT_Actual_Mileage]  as  SELECT  [Actual_Milg_Fact_Id]        ,[Car_Dimn_Id]        ,[Car_Ver]        ,[Rpt_Rd_Dimn_Id]        ,[Rpt_Rd_Ver]        ,[Svc_Mth_Dimn_Id]        ,[Rpt_Mth_Dimn_Id]        ,[Load_Mile]        ,[Emp_Mile]        ,[Totl_Mile]        ,[Emp_TPE_Mile]        ,[Load_TPE_Mile]        ,[Totl_TPE_Mile]        ,[Emp_Unit_Mile]        ,[Load_Unit_Mile]        ,[Totl_Unit_Mile]        ,[Emp_Pltfm_Mile]        ,[Load_Pltfm_Mile]        ,[Totl_Pltfm_Mile]        ,[Crtd_Id]        ,[Crtd_Dt]    FROM [DDSMRT].[dbo].[Actual_Milg_Fact]"
    },
    {
      "id": "AR_FILTER_00005_1819153526",
      "name": "AR_FILTER_00005_1819153526",
      "type": "REPLICATION_FILTER_PROCEDURE",
      "sql": "create procedure [dbo].[AR_FILTER_00005_1819153526] for replication as if exists (select * from [dbo].[Material_Dim] where (1=0)) return 1 else return 0"
    },
    {
      "id": "VMRT_Revenue_Accounting_Estimate_Car_Count",
      "name": "VMRT_Revenue_Accounting_Estimate_Car_Count",
      "type": "VIEW",
      "sql": "CREATE view [dbo].[VMRT_Revenue_Accounting_Estimate_Car_Count] as      With Tunpivot as (  SELECT    car_dimn_id  ,car_ver  ,Dt_Dimn_Id   ,Attr_Id_1   ,Attr_Ver_1   ,Attr_Id_2   ,Attr_Ver_2   ,Liable_Org_Dimn_Id  ,Liable_Org_Ver  ,Responsible_Org_Dimn_Id  ,Responsible_Org_Ver  ,concat(CntName, Car_Cnt_Catg_Typ_Id) as PCol  ,CntValue  ,Crtd_Dt    FROM     (select car_dimn_id,car_ver,Dt_Dimn_Id,Attr_Id_1,Attr_Ver_1,Attr_Id_2,Attr_Ver_2     , mem1.Org_Dimn_Id as Responsible_Org_Dimn_Id , mem1.org_Ver as Responsible_Org_Ver      , mem2.Org_Dimn_Id as Liable_Org_Dimn_Id, mem2.org_Ver as Liable_Org_Ver           ,Car_cnt_Catg_Typ_id,Car_Cnt,TPE_Cnt, Ut_Cnt, Pltfm_Cnt, cnt.Crtd_Dt    from  ddsmrt.dbo.vw_car_count_fact (NOLOCK)  cnt    left join ddsmrt.dbo.Organization_Membership_dim (NOLOCK) mem1 on (Cnt.Attr_Id_1 = mem1.[Org_Mbrshp_Dimn_Id] and cnt.Attr_Ver_1 = mem1.[Org_Mbrshp_Ver])    left join ddsmrt.dbo.Organization_Membership_dim (NOLOCK) mem2 on (Cnt.Attr_Id_2 = mem2.[Org_Mbrshp_Dimn_Id] and cnt.Attr_Ver_2 = mem2.[Org_Mbrshp_Ver])      where row_typ_id=515 ) ta --Rev Acct Estimates     UNPIVOT   (CntValue FOR CntName IN (Car_Cnt, TPE_Cnt, Ut_Cnt, Pltfm_Cnt)) AS pvt    )  select      rev_car_cnt.car_dimn_id    ,rev_car_cnt.car_ver    ,rev_car_cnt.Dt_Dimn_Id as Snapshot_Dt_Dimn_Id    ,rev_car_cnt.Attr_Id_1 as Responsible_Road_Org_Mbrshp_Dimn_Id    ,rev_car_cnt.Attr_Ver_1 as Responsible_Road_Org_Mbrshp_Ver    ,rev_car_cnt.Attr_Id_2 as Liable_Road_Org_Mbrshp_Dimn_Id     ,rev_car_cnt.Attr_Ver_2 as Liable_Road_Org_Mbrshp_Ver     ,rev_car_cnt.Liable_Org_Dimn_Id    ,rev_car_cnt.Liable_Org_Ver    ,rev_car_cnt.Responsible_Org_Dimn_Id    ,rev_car_cnt.Responsible_Org_Ver     --car cnt    , (isnull(rev_car_cnt.[Car_Cnt145],0) + isnull(rev_car_cnt.[Car_Cnt146],0))   As In_Shop_Car_Cnt          , isnull(rev_car_cnt.[Car_Cnt128],0)            As Enroute_Car_Cnt           , isnull(rev_car_cnt.[Car_Cnt129],0)            As In_Bad_Order_Storage_Car_Cnt    , isnull(rev_car_cnt.[Car_Cnt130],0)            as In_FMO_Car_Cnt    , (isnull(rev_car_cnt.[Car_Cnt133],0) + isnull(rev_car_cnt.[Car_Cnt129],0))   as In_Paid_Storage_Car_Cnt    , (isnull(rev_car_cnt.[Car_Cnt130],0) + isnull(rev_car_cnt.[Car_Cnt145],0) + isnull(rev_car_cnt.[Car_Cnt146],0)) as In_Repair_Entity_Car_Cnt    , isnull(rev_car_cnt.[Car_Cnt145],0)            as In_TTX_Shop_Car_Cnt    , isnull(rev_car_cnt.[Car_Cnt146],0)            as In_IRF_Car_Cnt    , isnull(rev_car_cnt.[Car_Cnt133],0)            as In_Selective_Storage_Car_Cnt    , isnull(rev_car_cnt.[Car_Cnt134],0)            as On_Offline_Relief_Car_Cnt    , isnull(rev_car_cnt.[Car_Cnt135],0)            as On_Online_Relief_Car_Cnt    , (isnull(rev_car_cnt.[Car_Cnt134],0) + isnull(rev_car_cnt.[Car_Cnt135],0))   as On_Railroad_Relief_Car_Cnt    , (isnull(rev_car_cnt.[Car_Cnt138],0)-isnull(rev_car_cnt.[Car_Cnt130],0)-isnull(rev_car_cnt.[Car_Cnt145],0)-isnull(rev_car_cnt.[Car_Cnt146],0)             -isnull(rev_car_cnt.[Car_Cnt134],0)-isnull(rev_car_cnt.[Car_Cnt135],0)             -isnull(rev_car_cnt.[Car_Cnt133],0)-isnull(rev_car_cnt.[Car_Cnt129],0)             -isnull(rev_car_cnt.[Car_Cnt128],0))     as Fleet_In_Service_Car_Cnt    , isnull(rev_car_cnt.[Car_Cnt138],0)            as Fleet_Size_Car_Cnt     --tpe cnt    , (isnull(rev_car_cnt.[TPE_Cnt145],0) + isnull(rev_car_cnt.[TPE_Cnt146],0))   As In_Shop_TPE_Cnt          , isnull(rev_car_cnt.[TPE_Cnt128],0)            As Enroute_TPE_Cnt          , isnull(rev_car_cnt.[TPE_Cnt129],0)            As In_Bad_Order_Storage_TPE_Cnt    , isnull(rev_car_cnt.[TPE_Cnt130],0)            as In_FMO_TPE_Cnt    , (isnull(rev_car_cnt.[TPE_Cnt133],0) + isnull(rev_car_cnt.[TPE_Cnt129],0))   as In_Paid_Storage_TPE_Cnt    , (isnull(rev_car_cnt.[TPE_Cnt130],0) + isnull(rev_car_cnt.[TPE_Cnt145],0) + isnull(rev_car_cnt.[TPE_Cnt146],0)) as In_Repair_Entity_TPE_Cnt    , isnull(rev_car_cnt.[TPE_Cnt145],0)            as In_TTX_Shop_TPE_Cnt    , isnull(rev_car_cnt.[TPE_Cnt146],0)            as In_IRF_TPE_Cnt    , isnull(rev_car_cnt.[TPE_Cnt133],0)            as In_Selective_Storage_TPE_Cnt    , isnull(rev_car_cnt.[TPE_Cnt134],0)            as On_Offline_Relief_TPE_Cnt    , isnull(rev_car_cnt.[TPE_Cnt135],0)            as On_Online_Relief_TPE_Cnt    , (isnull(rev_car_cnt.[TPE_Cnt134],0) + isnull(rev_car_cnt.[TPE_Cnt135],0))   as On_Railroad_Relief_TPE_Cnt    , (isnull(rev_car_cnt.[TPE_Cnt138],0)-isnull(rev_car_cnt.[TPE_Cnt130],0)-isnull(rev_car_cnt.[TPE_Cnt145],0)-isnull(rev_car_cnt.[TPE_Cnt146],0)             -isnull(rev_car_cnt.[TPE_Cnt134],0)-isnull(rev_car_cnt.[TPE_Cnt135],0)             -isnull(rev_car_cnt.[TPE_Cnt133],0)-isnull(rev_car_cnt.[TPE_Cnt129],0)             -isnull(rev_car_cnt.[TPE_Cnt128],0))     as Fleet_In_Service_TPE_Cnt    , isnull(rev_car_cnt.[TPE_Cnt138],0)            as Fleet_Size_TPE_Cnt     --Ut cnt    , (isnull(rev_car_cnt.[Ut_Cnt145],0) + isnull(rev_car_cnt.[Ut_Cnt146],0))      As In_Shop_Unit_Cnt          , isnull(rev_car_cnt.[Ut_Cnt128],0)                As Enroute_Unit_Cnt          , isnull(rev_car_cnt.[Ut_Cnt129],0)                As In_Bad_Order_Storage_Unit_Cnt    , isnull(rev_car_cnt.[Ut_Cnt130],0)                as In_FMO_Unit_Cnt    , (isnull(rev_car_cnt.[Ut_Cnt133],0) + isnull(rev_car_cnt.[Ut_Cnt129],0))      as In_Paid_Storage_Unit_Cnt    , (isnull(rev_car_cnt.[Ut_Cnt130],0) + isnull(rev_car_cnt.[Ut_Cnt145],0) + isnull(rev_car_cnt.[Ut_Cnt146],0)) as In_Repair_Entity_Unit_Cnt    , isnull(rev_car_cnt.[Ut_Cnt145],0)                as In_TTX_Shop_Unit_Cnt    , isnull(rev_car_cnt.[Ut_Cnt146],0)                as In_IRF_Unit_Cnt    , isnull(rev_car_cnt.[Ut_Cnt133],0)                as In_Selective_Storage_Unit_Cnt    , isnull(rev_car_cnt.[Ut_Cnt134],0)                as On_Offline_Relief_Unit_Cnt    , isnull(rev_car_cnt.[Ut_Cnt135],0)                as On_Online_Relief_Unit_Cnt    , (isnull(rev_car_cnt.[Ut_Cnt134],0) + isnull(rev_car_cnt.[Ut_Cnt135],0))      as On_Railroad_Relief_Unit_Cnt    , (isnull(rev_car_cnt.[Ut_Cnt138],0)-isnull(rev_car_cnt.[Ut_Cnt130],0)-isnull(rev_car_cnt.[Ut_Cnt145],0)-isnull(rev_car_cnt.[Ut_Cnt146],0)             -isnull(rev_car_cnt.[Ut_Cnt134],0)-isnull(rev_car_cnt.[Ut_Cnt135],0)             -isnull(rev_car_cnt.[Ut_Cnt133],0)-isnull(rev_car_cnt.[Ut_Cnt129],0)             -isnull(rev_car_cnt.[Ut_Cnt128],0))        as Fleet_In_Service_Unit_Cnt    , isnull(rev_car_cnt.[Ut_Cnt138],0)                as Fleet_Size_Unit_Cnt         --Platform cnt    , (isnull(rev_car_cnt.[Pltfm_Cnt145],0) + isnull(rev_car_cnt.[Pltfm_Cnt146],0))      As In_Shop_Platform_Cnt          , isnull(rev_car_cnt.[Pltfm_Cnt128],0)                As Enroute_Platform_Cnt          , isnull(rev_car_cnt.[Pltfm_Cnt129],0)                As In_Bad_Order_Storage_Platform_Cnt    , isnull(rev_car_cnt.[Pltfm_Cnt130],0)                as In_FMO_Platform_Cnt    , (isnull(rev_car_cnt.[Pltfm_Cnt133],0) + isnull(rev_car_cnt.[Pltfm_Cnt129],0))      as In_Paid_Storage_Platform_Cnt    , (isnull(rev_car_cnt.[Pltfm_Cnt130],0) + isnull(rev_car_cnt.[Pltfm_Cnt145],0) + isnull(rev_car_cnt.[Pltfm_Cnt146],0)) as In_Repair_Entity_Platform_Cnt    , isnull(rev_car_cnt.[Pltfm_Cnt145],0)                as In_TTX_Shop_Platform_Cnt    , isnull(rev_car_cnt.[Pltfm_Cnt146],0)                as In_IRF_Platform_Cnt    , isnull(rev_car_cnt.[Pltfm_Cnt133],0)                as In_Selective_Storage_Platform_Cnt    , isnull(rev_car_cnt.[Pltfm_Cnt134],0)                as On_Offline_Relief_Platform_Cnt    , isnull(rev_car_cnt.[Pltfm_Cnt135],0)                as On_Online_Relief_Platform_Cnt    , (isnull(rev_car_cnt.[Pltfm_Cnt134],0) + isnull(rev_car_cnt.[Pltfm_Cnt135],0))      as On_Railroad_Relief_Platform_Cnt    , (isnull(rev_car_cnt.[Pltfm_Cnt138],0)-isnull(rev_car_cnt.[Pltfm_Cnt130],0)-isnull(rev_car_cnt.[Pltfm_Cnt145],0)-isnull(rev_car_cnt.[Pltfm_Cnt146],0)             -isnull(rev_car_cnt.[Pltfm_Cnt134],0)-isnull(rev_car_cnt.[Pltfm_Cnt135],0)             -isnull(rev_car_cnt.[Pltfm_Cnt133],0)-isnull(rev_car_cnt.[Pltfm_Cnt129],0)             -isnull(rev_car_cnt.[Pltfm_Cnt128],0))        as Fleet_In_Service_Platform_Cnt    , isnull(rev_car_cnt.[Pltfm_Cnt138],0)                as Fleet_Size_Platform_Cnt    , Crtd_Dt      from Tunpivot    PIVOT   (            sum(CntValue)       FOR Pcol IN ( [Car_Cnt128], [Car_Cnt129],[Car_Cnt130],[Car_Cnt133],[Car_Cnt134],[Car_Cnt135],[Car_Cnt136],[Car_Cnt137],[Car_Cnt138],[Car_Cnt145],[Car_Cnt146]        , [TPE_Cnt128], [TPE_Cnt129],[TPE_Cnt130],[TPE_Cnt133],[TPE_Cnt134],[TPE_Cnt135],[TPE_Cnt136],[TPE_Cnt137],[TPE_Cnt138],[TPE_Cnt145],[TPE_Cnt146]        , [Ut_Cnt128], [Ut_Cnt129],[Ut_Cnt130],[Ut_Cnt133],[Ut_Cnt134],[Ut_Cnt135],[Ut_Cnt136],[Ut_Cnt137],[Ut_Cnt138],[Ut_Cnt145],[Ut_Cnt146]        , [Pltfm_Cnt128], [Pltfm_Cnt129],[Pltfm_Cnt130],[Pltfm_Cnt133],[Pltfm_Cnt134],[Pltfm_Cnt135],[Pltfm_Cnt136],[Pltfm_Cnt137],[Pltfm_Cnt138],[Pltfm_Cnt145],[Pltfm_Cnt146]          )     )   AS rev_car_cnt"
    },
    {
      "id": "attrep_fn_LsnSegmentToHexa",
      "name": "attrep_fn_LsnSegmentToHexa",
      "type": "SQL_SCALAR_FUNCTION",
      "sql": "CREATE FUNCTION [dbo].[attrep_fn_LsnSegmentToHexa] (@InputData VARBINARY(32)) RETURNS VARCHAR(64) AS   BEGIN     DECLARE  @HexDigits    CHAR(16),              @OutputData      VARCHAR(64),              @i            INT,              @InputDataLength INT      DECLARE  @ByteInfo   INT,              @LeftNibble  INT,              @RightNibble INT      SET @OutputData = ''      SET @i = 1      SET @InputDataLength = DATALENGTH(@InputData)      SET @HexDigits = '0123456789abcdef'      WHILE (@i <= @InputDataLength)       BEGIN         SET @ByteInfo = CONVERT(INT,SUBSTRING(@InputData,@i,1))         SET @LeftNibble= FLOOR(@ByteInfo / 16)         SET @RightNibble = @ByteInfo - (@LeftNibble* 16)         SET @OutputData = @OutputData + SUBSTRING(@HexDigits,@LeftNibble+ 1,1) + SUBSTRING(@HexDigits,@RightNibble + 1,1)         SET @i = @i + 1       END      RETURN @OutputData    END"
    },
    {
      "id": "Accrual_Reported_Mileage",
      "name": "Accrual_Reported_Mileage",
      "type": "VIEW",
      "sql": "CREATE VIEW [SV].[Accrual_Reported_Mileage]  AS  SELECT [Hierchy_Id] as Hierarchy_Id        ,[Hierchy_Ver] as Hierarchy_Ver        ,[Rpt_Rd_Dimn_Id] as Report_Road_Dimn_Id        ,[Rpt_Rd_Ver] as Report_Road_Ver        ,[Rpt_Mth_Dimn_Id] as Report_Month_Dimn_Id        ,[Svc_Mth_Dimn_Id] as Service_Month_Dimn_Id        ,[Totl_Mile] as Total_Mileage     ,[AccruedTotalPlatformMileage] as Accrued_Total_Platform_Mileage     ,[AccruedTotalTPEMileage] as Accrued_Total_TPE_Mileage     ,[AccruedTotalUnitMileage] as Accrued_Total_Unit_Mileage    FROM [DDSMRT].[dbo].[VMRT_Accrual_Mileage]"
    },
    {
      "id": "VCar_Dim_Correct",
      "name": "VCar_Dim_Correct",
      "type": "VIEW",
      "sql": "CREATE view [DDSV].[VCar_Dim_Correct]  as  select concat(convert(varchar(10),car.Car_Dimn_Id),'_',convert(varchar(5), car.Car_Ver)) as Car_Dimn_Id    --cast(car.Car_Dimn_Id as int) as Car_Dimn_Id    --,car.Car_Ver    ,coalesce(car.[Car_Status_Maximo], car.[Car_Status_UFD]) as Car_Stat_Ind    ,cast(car.[Car_Nr] as decimal(11,0)) as Car_Nr        ,car.[Car_Init]     ,car.Car_Cls as Car_Cls_Cd     ,hier3.Stat_Cd as Fin_Stat_Cd     ,NULL as Eq_Typ_Stat_Cd     ,car.[Eff_From] as Car_Eff_Strt_Dt        ,car.[Eff_To] as Car_Eff_End_Dt     ,hier3.Stat_Cd as Stat_Cd     ,hier3.Stat_Cd_Eff_Strt_Dt as Stat_Cd_Dt     ,car.TTX_Eff_Dt     ,       CASE WHEN isnull(convert(varchar(50),hier3.bus_Ln_Shrt_Desc), convert(varchar(50), hier2.[Business_Line_Description])) = 'Intermodal' AND car.TTX_Mngd_Car_Ind = 0       THEN             CASE WHEN SUBSTRING(cchar.Eq_Typ_Cd, 1, 2) IN ('S1', 'S2', 'S3', 'S4', 'S5') THEN '40'' Wells'               WHEN SUBSTRING(cchar.Eq_Typ_Cd, 1, 2) IN ('S6', 'S7') THEN '53'' Wells' END       ELSE replace(hier3.Eq_Featr_Shrt_Desc,\" ft\",\"'\")  END AS Eq_Featr_Shrt_Desc                 , CASE WHEN isnull(convert(varchar(50),hier3.bus_Ln_Shrt_Desc), convert(varchar(50), hier2.[Business_Line_Description])) = 'Intermodal' AND car.TTX_Mngd_Car_Ind  = 0       THEN          CASE WHEN SUBSTRING(cchar.Eq_Typ_Cd, 1, 1) IN ('P', 'Q') THEN 'Conventional'            WHEN SUBSTRING(cchar.Eq_Typ_Cd, 1, 2) IN ('S1', 'S2', 'S3', 'S4', 'S5', 'S6', 'S7') THEN 'Doublestack' END       ELSE isnull(hier3.[Eq_Typ_Shrt_Desc], hier2.Equipment_Type_Description) END AS Eq_Typ_Shrt_Desc       ,isnull(convert(varchar(50),hier3.bus_Ln_Shrt_Desc), convert(varchar(50), hier2.[Business_Line_Description])) as bus_Ln_Shrt_Desc     ,      CASE WHEN isnull(convert(varchar(50),hier3.bus_Ln_Shrt_Desc), convert(varchar(50), hier2.[Business_Line_Description])) = 'Intermodal' AND car.TTX_Mngd_Car_Ind = 0      THEN            CASE WHEN SUBSTRING(cchar.Eq_Typ_Cd, 1, 1) IN ('P', 'Q') THEN 'Conventional'              WHEN SUBSTRING(cchar.Eq_Typ_Cd, 1, 2) IN ('S1', 'S2', 'S3', 'S4', 'S5') THEN 'DTTX 40-48ft'              WHEN SUBSTRING(cchar.Eq_Typ_Cd, 1, 2) IN ('S6', 'S7') THEN 'DTTX 53-56ft'                          END     WHEN isnull(convert(varchar(50),hier3.bus_Ln_Shrt_Desc), convert(varchar(50), hier2.[Business_Line_Description])) = 'Intermodal'        AND (coalesce(car.[Car_Status_Maximo], car.[Car_Status_UFD]) = 'PRE-REGISTERED' or coalesce(car.[Car_Status_Maximo], car.[Car_Status_UFD]) IS NULL)     THEN NULL     ELSE convert(varchar(40),hier2.Fleet_Segment_Description) END       as Flet_Seg_Desc       ,car.Ownr_Mrk as Ownr_Mrk_Cd     ,cchar.[Intmdit_Connt_Styl] as Is_Art_Ind     ,car.Pool_Cd     ,car.TTX_Mngd_Car_Ind as TTX_Mng_Ind     ,cast(cchar.TPE_Fctr as numeric(2,1)) as TPE_Fctr  --   ,cast(ISNULL(ISNULL(cchar.[Pltfm_Fctr], 2*Ut_Cnt),1.0) as decimal(15,1)) as Pltfm_Fctr     ,ISNULL(cast(cchar.[Pltfm_Fctr] as decimal(15,1)),1.0) as Pltfm_Fctr       ,cast(cchar.Trk_Axl_Cnt as decimal(15,1)) as Trk_Fctr     ,CONVERT(VARCHAR(14), car.Car_Init + REPLICATE('0',10 - LEN(CONVERT(VARCHAR(10), car.Car_Nr)))                  + CONVERT(VARCHAR(10), car.Car_Nr)) AS EDW_Car_Id         ,cast(cchar.Axl_Cnt as int) as Axl_Cnt     ,cast(cchar.Ut_Cnt  as int) as Ut_Cnt     ,convert(char(4),cchar.Eq_Typ_Cd) as Eq_Cd     ,convert(char(8), car.Crtd_Id) as Crtd_Id     ,car.Crtd_Dt     ,car.Lst_Upd_Dt     ,convert(char(8), car.Lst_Upd_Id) as Lst_Upd_Id      from DDSMRT.DBO.[Car_Dim_Correct] car (NOLOCK)  Left join (select * from DDSMRT.DBO.[Car_Characteristic_Dim] (NOLOCK) where eff_to is null and car_dimn_id <> -1) cchar  on (car.Car_Dimn_Id = cchar.car_dimn_id )    left join [dbo].[VMRT_Car_Hierarchy_Fleet] (NOLOCK) hier2  on (car.Fleet_Hierchy_Id = hier2.Hierchy_Id and car.fleet_Hierchy_ver = hier2.hierchy_ver)  left join [dbo].[VMRT_Car_Hierarchy_Enterprise] (NOLOCK) hier3  on (car.Entr_Hierchy_Id = hier3.Hierchy_Id and car.Entr_Hierchy_ver = hier3.hierchy_ver)"
    },
    {
      "id": "syncobj_0x4638314239394536",
      "name": "syncobj_0x4638314239394536",
      "type": "VIEW",
      "sql": "create view [dbo].[syncobj_0x4638314239394536]as select  [Org_Dimn_Id],[Org_Ver],[Row_Typ_Id],[Prnt_Org_Dimn_Id],[Prnt_Org_Ver],[Geo_Dimn_Id],[SPLC_Dimn_Id],[Pty_Id],[Dist_Enty],[Org_Abrv],[Org_Nm],[Crtd_Id],[Crtd_Dt],[Lst_Upd_Id],[Lst_Upd_Dt],[Eff_From],[Eff_To],[Src_Sys_Nm],[Dq_Flg]  from  [dbo].[Organization_Dim]  where HAS_PERMS_BY_NAME('[dbo].[Organization_Dim]', 'OBJECT', 'SELECT')= 1  and ((1=0))"
    },
    {
      "id": "VMRT_Shipper_Dimension",
      "name": "VMRT_Shipper_Dimension",
      "type": "VIEW",
      "sql": "CREATE VIEW [dbo].[VMRT_Shipper_Dimension]  AS  SELECT distinct  org.[Org_Dimn_Id]  ,org.org_abrv as [Shipper_Abbreviation]  ,org.org_nm as [Shipper_Name]  ,org.[Org_Ver] as [Org_Ver]  , Eff_From  , Eff_To   FROM [Organization_Dim] (NOLOCK) org  Inner join [organization_Type_Lookup] (NOLOCK) org_typ  on (org.org_dimn_id = org_typ.org_dimn_id and org.org_ver = org_typ.org_ver)   WHERE org_typ.org_Typ_id in (104,112,126) OR org.Org_Dimn_Id = -1"
    },
    {
      "id": "attrep_fn_NumericLsnToHexa",
      "name": "attrep_fn_NumericLsnToHexa",
      "type": "SQL_SCALAR_FUNCTION",
      "sql": "CREATE FUNCTION [dbo].[attrep_fn_NumericLsnToHexa](@numeric25Lsn numeric(25,0)) returns varchar(32)  AS  BEGIN -- In order to avoid form sign overflow problems - declare the LSN segments  -- to be one 'type' larger than the intendent target type. -- For example, convert(smallint, convert(numeric(25,0),65535)) will fail  -- but convert(binary(2), convert(int,convert(numeric(25,0),65535))) will give the  -- expected result of 0xffff.  declare @high4bytelsnSegment bigint,@mid4bytelsnSegment bigint,@low2bytelsnSegment int declare @highFactor bigint, @midFactor int  declare @lsnLeftSeg binary(4) declare @lsnMidSeg binary(4) declare @lsnRightSeg binary(2)  declare @hexaLsn varchar(32)  select @highFactor = 1000000000000000 select @midFactor  = 100000  select @high4bytelsnSegment = convert(bigint, floor(@numeric25Lsn / @highFactor)) select @numeric25Lsn = @numeric25Lsn - convert(numeric(25,0), @high4bytelsnSegment) * @highFactor select @mid4bytelsnSegment = convert(bigint,floor(@numeric25Lsn / @midFactor )) select @numeric25Lsn = @numeric25Lsn - convert(numeric(25,0), @mid4bytelsnSegment) * @midFactor select @low2bytelsnSegment = convert(int, @numeric25Lsn)  set @lsnLeftSeg = convert(binary(4), @high4bytelsnSegment) set @lsnMidSeg = convert(binary(4), @mid4bytelsnSegment) set   @lsnRightSeg = convert(binary(2), @low2bytelsnSegment)  return [dbo].[attrep_fn_LsnSegmentToHexa](@lsnLeftSeg)+':'+[dbo].[attrep_fn_LsnSegmentToHexa](@lsnMidSeg)+':'+[dbo].[attrep_fn_LsnSegmentToHexa](@lsnRightSeg) END"
    },
    {
      "id": "Actual_Reported_Mileage",
      "name": "Actual_Reported_Mileage",
      "type": "VIEW",
      "sql": "Create view [SV].[Actual_Reported_Mileage]  as  SELECT [Car_Dimn_Id]        ,[Car_Ver]        ,[Rpt_Rd_Dimn_Id] as Report_Road_Dimn_Id        ,[Rpt_Rd_Ver] as Report_Road_Ver        ,[Svc_Mth_Dimn_Id] as Service_Month_Dimn_Id        ,[Rpt_Mth_Dimn_Id] as Report_Month_Dimn_Id        ,[Load_Mile] as Loaded_Mileage        ,[Emp_Mile] as Empty_Mileage        ,[Totl_Mile] as Total_Mileage     ,[Emp_TPE_Mile] as Empty_TPE_Mileage        ,[Load_TPE_Mile] as Loaded_TPE_Mileage        ,[Totl_TPE_Mile] as Total_TPE_Mileage        ,[Emp_Unit_Mile] as Empty_Unit_Mileage        ,[Load_Unit_Mile] as Loaded_Unit_Mileage        ,[Totl_Unit_Mile] as Total_Unit_Mileage        ,[Emp_Pltfm_Mile] as Empty_Platform_Mileage        ,[Load_Pltfm_Mile] as Loaded_Platform_Mileage        ,[Totl_Pltfm_Mile] as Total_Platform_Mileage    FROM [DDSMRT].[dbo].[VMRT_Actual_Mileage]"
    },
    {
      "id": "AR_FILTER_00005_1883153754",
      "name": "AR_FILTER_00005_1883153754",
      "type": "REPLICATION_FILTER_PROCEDURE",
      "sql": "create procedure [dbo].[AR_FILTER_00005_1883153754] for replication as if exists (select * from [dbo].[Organization_Dim] where (1=0)) return 1 else return 0"
    },
    {
      "id": "VShop_Car_Flow_Fact",
      "name": "VShop_Car_Flow_Fact",
      "type": "VIEW",
      "sql": "CREATE VIEW [DDSV].[VShop_Car_Flow_Fact] AS      select scf.[Shop_Car_Flow_Fact_Id]  ,scf.[Trip_Id]  ,scf.[Dt_Dimn_Id_strt]  ,scf.[Dt_Dimn_Id_end]  ,scf.[Dt_Dimn_Id_Rel]  ,scf.[Car_Dimn_Id]  ,scf.[Geo_Dimn_Id_Origin]  ,scf.[Geo_Dimn_Id_Cur]  ,scf.[Geo_Dimn_Id_Dest]  ,scf.[Shop_Car_Status_Dim_Id]  ,scf.[Mnt_Typ_Id_Old]  ,scf.[Mnt_Typ_Id]  ,scf.[Repr_Enty_Id]  ,scf.[Railcar]   ,scf.[Nr_Code]  ,scf.[Start_Dt]  ,scf.[End_Dt]  ,scf.[Release_Dt]  ,scf.[Days_In_Hours]  ,scf.[Miles_to_Dest]  ,scf.[Current_Miles_to_Dest]  ,scf.[Is_Current]  ,scf.[Is_Current_Status]  ,scf.[Serv_Yard_Name]  ,scf.[Current_PP_RR]  ,scf.[Trip_Shop]  ,scf.[Directive_Shop]  ,scf.[Shop_Nm]  ,scf.[Active_Status]  /*Added by devd1g to address bug 28551 on 3/2/2017*/  ,scf.[Direc_Fulfillment_Status]  ,scf.[Is_Violated]  ,scf.[Loaded_Empty]  ,scf.[Origin_RR]  ,scf.[Primary_Status]  ,scf.[Secondary_Status]  ,scf.[Repair_Class]  ,scf.[Repair_Code]  ,scf.[Repair_Code_Full]  ,scf.[Secondary_Repr_Cd]  ,scf.[Current_Status]  ,scf.[Comments]  ,scf.[Car_Outside_Length]  ,scf.[Cptl_Cost]  ,scf.[Mnt_Cost]  ,scf.[Total_Cost]  ,scf.[Total_Hrs]  ,scf.Cptl_Hrs  ,scf.Mnt_Hrs  ,scf.[Is_Unauth_Arrvl]  ,scf.[Discontinued_Railcar]  ,scf.[Primary_Status_ID]  ,scf.Row_Num_Osid  ,scf.Row_Num_Pri  ,scf.Row_Num_Sec  ,scf.[Secondary_Status_Start_Date]  ,scf.[Secondary_Status_End_Date]  ,cast(scf.Estimated_Release_Date as date) as Estimated_Release_Date  ,coalesce(datediff(dd, scf.secondary_status_start_date, scf.secondary_status_end_date1), 0) as Days_Sec_Sts  ,d.Dt_Dimn_Id as Cube_Proc_Dt_Dimn_Id  ,coalesce(ss.Dt_Dimn_Id, -1) as Sec_Sts_Strt_Dt_Dimn_Id  ,coalesce(se.Dt_Dimn_Id, -1) as Sec_Sts_End_Dt_Dimn_Id   ,scf.SPLC_Dimn_Id_Origin  ,scf.Directive_Repair_Code_Full  from     (SELECT CAST([Shop_Car_Flow_Fact_Id] AS int) AS [Shop_Car_Flow_Fact_Id]        ,fact.[Trip_Id]        ,[Dt_Dimn_Id_strt]        ,[Dt_Dimn_Id_end]     ,[Dt_Dimn_Id_Rel]     ,concat(convert(varchar(10),Car_Dimn_Id),'_',convert(varchar(5), Car_Ver)) as [Car_Dimn_Id]        ,[Geo_Dimn_Id_Origin]        ,[Geo_Dimn_Id_Cur]        ,[Geo_Dimn_Id_Dest]        ,[Shop_Car_Status_Dim_Id]     ,concat(convert(varchar(10),Mnt_Typ_Dimn_Id),'_',convert(varchar(5),Mnt_Typ_Ver)) as [Mnt_Typ_Id_Old]        ,case when repr_cd_lst.Mnt_Typ_Id_lst is not null then repr_cd_lst.Mnt_Typ_Id_lst       when repr_cd_lst_cur.Mnt_Typ_Id_lst_cur is not null then repr_cd_lst_cur.Mnt_Typ_Id_lst_cur        else concat(convert(varchar(10),Mnt_Typ_Dimn_Id),'_',convert(varchar(5),Mnt_Typ_Ver)) end as [Mnt_Typ_Id]       ,concat(convert(varchar(10),Repr_Enty_Dimn_Id),'_',convert(varchar(5),Repr_Enty_Ver)) as [Repr_Enty_Id]     ,[Repr_Enty_Dimn_Id] AS [Rpr_Enty_Dim_Id_Fact]        ,fact.[Railcar]         ,[Nr_Code]        ,[Start_Dt]        ,[End_Dt]     ,[Release_Dt]        ,[Days_In_Hours]        ,[Miles_to_Dest]        ,[Current_Miles_to_Dest]        ,[Is_Current]     ,[Is_Current_Status]        ,[Serv_Yard_Name]        ,[Current_PP_RR]        ,[Trip_Shop]     ,[Directive_Shop]     ,[Shop_Nm]     ,[Active_Status]     /*Added by devd1g on 3/2/2017*/     ,[Direc_Fulfillment_Status]      ,CASE WHEN [Is_Violated] = 0 THEN 'NO'     WHEN [Is_Violated] = 1 THEN 'YES' END AS [Is_Violated]     ,[Loaded_Empty]        ,[Origin_RR]        ,[Primary_Status]        ,[Secondary_Status]        ,fact.[Repair_Class]        ,fact.[Repair_Code]     ,[Repair_Code_Full]     ,[Secondary_Repr_Cd]     ,fact.[Current_Status]        ,[Comments]     ,Car_Outside_Length/12 as [Car_Outside_Length]        ,est.[Cptl_Cost]        ,est.[Mnt_Cost]        ,est.[Total_Cost]        ,est.[Total_Hrs]     ,est.Cptl_Hrs     ,est.Mnt_Hrs     ,[Is_Unauth_Arrvl]     ,[Discontinued_Railcar]     ,[Primary_Status_ID]     ,[Secondary_Status_Start_Date]     ,[Secondary_Status_End_Date]     ,Estimated_Release_Date     ,case when secondary_status is not null and secondary_status_end_date is null then getdate() else secondary_status_end_date end as [Secondary_Status_End_Date1]        ,cast(COALESCE(fact.Lst_Upd_Dt, fact.Crtd_Dt) as date) as cube_proc_dt     ,ROW_NUMBER() over (partition by fact.trip_id, fact.current_status order by fact.start_dt) as Row_Num_Osid     ,ROW_NUMBER() over (partition by fact.trip_id, fact.nr_code, fact.primary_status, fact.start_dt order by fact.start_dt) as Row_Num_Pri     ,ROW_NUMBER() over (partition by fact.trip_id, fact.nr_code, fact.secondary_status, fact.secondary_status_start_date order by fact.Start_Dt, fact.secondary_status_start_date) as Row_Num_Sec     ,fact.SPLC_Dimn_Id_Origin     ,fact.Directive_Repair_Code_Full    FROM [DDSMRT].[dbo].[Shop_Car_Flow_Fact] fact      left join       (select distinct trip_id, railcar, concat(convert(varchar(10),Mnt_Typ_Dimn_Id),'_',convert(varchar(5),Mnt_Typ_Ver)) as Mnt_Typ_Id_lst, Repair_Class, Repair_Code   from ddsmrt.dbo.shop_Car_Flow_Fact    where Nr_Code=-1 and End_Dt is not null) repr_cd_lst    on fact.Trip_Id=repr_cd_lst.Trip_ID and fact.railcar=repr_cd_lst.railcar     left join       (select distinct trip_id, railcar,current_status, concat(convert(varchar(10),Mnt_Typ_Dimn_Id),'_',convert(varchar(5),Mnt_Typ_Ver)) as Mnt_Typ_Id_lst_cur, Repair_Class, Repair_Code   from ddsmrt.dbo.shop_Car_Flow_Fact    where Is_Current='Yes') repr_cd_lst_cur  on fact.trip_id=repr_cd_lst_cur.trip_id and fact.railcar=repr_cd_lst_cur.railcar and fact.Current_Status=repr_cd_lst_cur.current_status     left join     (select Repr_Cd_Full, Cptl_Cost, Mnt_Cost, Total_Cost, Total_Hrs, Cptl_Hrs, Mnt_Hrs from DDSMRT.[dbo].[Estimated_Cost_Labor_Hours_Lookup]) est  on coalesce(repr_cd_lst.Repair_Class, repr_cd_lst_cur.Repair_Class)= left(est.[Repr_Cd_Full],1)   and coalesce(repr_cd_lst.Repair_Code, repr_cd_lst_cur.Repair_Code)= right(est.[Repr_Cd_Full],3)  ) scf        left join (select Dt_Dimn_Id, Dt from DDSMRT.dbo.Date_Dim) d   on scf.cube_proc_dt = d.dt       left join (select Dt_Dimn_Id, Dt from DDSMRT.dbo.Date_Dim) ss   on cast(scf.secondary_status_start_date as date) = ss.dt     left join (select Dt_Dimn_Id, Dt from DDSMRT.dbo.Date_Dim) se   on cast(scf.secondary_status_end_date as date) = se.dt"
    },
    {
      "id": "syncobj_0x4445384344423932",
      "name": "syncobj_0x4445384344423932",
      "type": "VIEW",
      "sql": "create view [dbo].[syncobj_0x4445384344423932]as select  [Org_Dimn_Id],[Org_Ver],[Org_Typ_Id],[Org_Sub_Typ_Id],[Crtd_Id],[Crtd_Dt],[Lst_Upd_Id],[Lst_Upd_Dt],[Src_Sys_Nm],[Dq_Flg]  from  [dbo].[Organization_Type_Lookup]  where HAS_PERMS_BY_NAME('[dbo].[Organization_Type_Lookup]', 'OBJECT', 'SELECT')= 1  and ((1=0))"
    },
    {
      "id": "VMRT_Sponsoring_Railroad_Dimension",
      "name": "VMRT_Sponsoring_Railroad_Dimension",
      "type": "VIEW",
      "sql": "CREATE VIEW [dbo].[VMRT_Sponsoring_Railroad_Dimension]  AS  SELECT   org.[Org_Dimn_Id] as Spon_Road_Org_Dimn_Id  ,org.[Org_Ver] as Spon_Road_Org_Ver  ,org.org_abrv as [Spon_Road_Org_Abrv]  ,a.org_nm as [Spon_Road_Org_Nm]  , org.Crtd_Id  , org.Crtd_Dt  , org.Lst_Upd_Id  , org.Lst_Upd_Dt  , org.Eff_From  , org.Eff_To  , org.Dq_Flg  , org.Src_Sys_Nm   FROM [Organization_Dim] (NOLOCK) org  Inner join [organization_Type_Lookup] (NOLOCK) org_typ   on (org.org_dimn_id = org_typ.org_dimn_id and org.org_ver = org_typ.org_ver)  inner join  [DDSMRT].[dbo].[Type_Lookup] (NOLOCK) typ_lkp   on  org_typ.Org_Typ_Id=typ_lkp.Typ_id  JOIN (SELECT a.* FROM DDSMRT.dbo.[Organization_Dim] a     JOIN (SELECT Org_Dimn_Id,MAX(Org_Ver) Org_Ver     FROM DDSMRT.dbo.[Organization_Dim]     GROUP BY Org_Dimn_Id)b ON a.Org_Dimn_Id = b.Org_Dimn_Id AND a.Org_Ver = b.Org_Ver   ) a on a.Org_Dimn_Id = org.Org_Dimn_Id  where typ_lkp.typ_Grp= 'Organization' and typ_lkp.Typ_Desc= 'SPONSORING RAILROAD'   and org.Row_Typ_Id= 501   and org.Org_Abrv is not null   OR org.Org_Dimn_Id = -1    --Additional union all for special handling of Facilities 'ATBM','POLA','POLB','POTI','TACO' for FMO    UNION ALL  SELECT   9999 as Spon_Road_Org_Dimn_Id  ,-2 as Spon_Road_Org_Ver  ,'BNSF/UP' as [Spon_Road_Org_Abrv]  ,(SELECT TOP 1 Org_Nm + '/' FROM [Organization_Dim] WHERE Org_Abrv = 'BNSF'AND Row_Typ_Id= 501 ORDER BY Org_Ver DESC)     + (SELECT TOP 1 Org_Nm FROM [Organization_Dim] WHERE Org_Abrv = 'UP'AND Row_Typ_Id= 501 ORDER BY Org_Ver DESC) as [Spon_Road_Org_Nm]  --,'BURLINGTON NORTHERN SANTA FE/UNION PACIFIC RR CO.' as [Spon_Road_Org_Nm]  , NULL AS Crtd_Id  , NULL AS Crtd_Dt  , NULL AS Lst_Upd_Id  , NULL AS Lst_Upd_Dt  , NULL AS Eff_From  , NULL AS Eff_To  , NULL AS Dq_Flg  , NULL AS Src_Sys_Nm"
    },
    {
      "id": "VMaintenance_Type_Dim",
      "name": "VMaintenance_Type_Dim",
      "type": "VIEW",
      "sql": "CREATE VIEW [DDSV].[VMaintenance_Type_Dim]    (  Mnt_Typ_Dimn_Id,  Repair_Code_Full,  Repair_Code,  Repair_Class,  Maintenance_Type_Level_1,  Maintenance_Type_Level_2,  Maintenance_Type_Level_3,  Repair_Code_Full_Description,  Repair_Class_Description,  Program_Description    )  AS  SELECT   concat(convert (varchar(10),[Mnt_Typ_Dimn_Id]),'_',convert(varchar(5),[Mnt_Typ_Ver])) as Mnt_Typ_Dimn_Id,  Maintenance_Type_Dim.Repr_Cd_Full,  isnull(Maintenance_Type_Dim.Repr_Cd, 'Unknown') AS Repr_Cd,  isnull(Maintenance_Type_Dim.Repr_Cls_Cd, 'Unknown') As Repr_Cls_Cd,  isnull(Maintenance_Type_Dim.Mnt_Typ_Lvl_1, 'Unknown') as Mnt_Typ_Lvl_1,  isnull(Maintenance_Type_Dim.Mnt_Typ_Lvl_2, 'Unknown') as Mnt_Typ_Lvl_2,  isnull(Maintenance_Type_Dim.Mnt_Typ_Lvl_3, 'Unknown') as Mnt_Typ_Lvl_3,  Maintenance_Type_Dim.Repr_Cd_Full_Desc,  Maintenance_Type_Dim.Repr_Cls_Desc,  Maintenance_Type_Dim.Pgm_Desc  FROM Maintenance_Type_Dim (NOLOCK)"
    },
    {
      "id": "AR_FILTER_00005_1947153982",
      "name": "AR_FILTER_00005_1947153982",
      "type": "REPLICATION_FILTER_PROCEDURE",
      "sql": "create procedure [dbo].[AR_FILTER_00005_1947153982] for replication as if exists (select * from [dbo].[Organization_Type_Lookup] where (1=0)) return 1 else return 0"
    },
    {
      "id": "VMRT_Trip_Fact",
      "name": "VMRT_Trip_Fact",
      "type": "VIEW",
      "sql": "CREATE view [dbo].[VMRT_Trip_Fact] as   SELECT      Trip.[Trip_Fact_Id]  ,Trip.[Car_Dimn_Id]  ,Trip.[Car_Ver]  ,Trip.[STCC_Dimn_Id]  ,Trip.[Trip_Orig_Org_Dimn_Id]  ,Trip.[Trip_Orig_Org_Ver]  ,Trip.[Trip_Dest_Org_Dimn_Id]  ,Trip.[Trip_Dest_Org_Ver]  ,isnull(SPLC1.SPLC_Dimn_Id, -1) as Trip_Orig_SPLC_Dimn_Id  ,isnull(SPLC2.SPLC_Dimn_Id, -1) as Trip_Dest_SPLC_Dimn_Id  ,Trip.[Trip_Orig_Resp_Road_Org_Dimn_Id]  ,Trip.[Trip_Orig_Resp_Road_Org_Ver]  ,Trip.[Trip_Orig_Poss_Road_Org_Dimn_Id]  ,Trip.[Trip_Orig_Poss_Road_Org_Ver]  ,Trip.[Trip_Orig_Lst_Parti_Road_Org_Dimn_Id]  ,Trip.[Trip_Orig_Lst_Parti_Road_Org_Ver]  ,Trip.[Trip_Dest_Resp_Road_Org_Dimn_Id]  ,Trip.[Trip_Dest_Resp_Road_Org_Ver]  ,Trip.[Trip_Dest_Poss_Road_Org_Dimn_Id]  ,Trip.[Trip_Dest_Poss_Road_Org_Ver]  ,Trip.[Trip_Dest_Lst_Parti_Road_Org_Dimn_Id]  ,Trip.[Trip_Dest_Lst_Parti_Road_Org_Ver]  ,Trip.[Trip_Orig_Parti_Shpr_Org_Dimn_Id]  ,Trip.[Trip_Orig_Parti_Shpr_Org_Ver]  ,Trip.[Trip_Dest_Parti_Shpr_Org_Dimn_Id]  ,Trip.[Trip_Dest_Parti_Shpr_Org_Ver]  ,Trip.[Trip_Begin_Dt_Dimn_Id]  ,Trip.[Trip_End_Dt_Dimn_Id]  ,Trip.[Trip]  ,Trip.[Railcar]  ,Trip.[STCC]  ,Trip.[Origin_Loc]  ,Trip.[Origin_Enty]  ,Trip.[Dest_Loc]  ,Trip.[Dest_Enty]  ,Trip.[Trip_Begin_Dt]  ,Trip.[Trip_End_Dt]  ,Trip.[Trip_Status]  ,Trip.[Trip_Typ]  ,Trip.[Current_Trip_Seg]  ,Trip.[Trip_Catg]  ,Trip.[Trip_Orig_Resp_Road]  ,Trip.[Trip_Dest_Resp_Road]  ,Trip.[Trip_Orig_Poss_Road]  ,Trip.[Trip_Dest_Poss_Road]  ,Trip.[Trip_Orig_Lst_Parti_Road]  ,Trip.[Trip_Dest_Lst_Parti_Road]  ,Trip.[Trip_Orig_Parti_Shpr_Enty]  ,Trip.[Trip_Dest_Parti_Shpr_Enty]  ,Trip.[Directive]  ,Trip.[Force_New_Trip]  ,Trip.[Crtd_Id]  ,Trip.[Crtd_Dt]  ,Trip.[Lst_Upd_Id]  ,Trip.[Lst_Upd_Dt]  ,Trip.[Src_Sys_Nm]  ,Trip.[Dq_Flg]  ,trip.Dlet_Flg  FROM [DDSMRT].[dbo].[vw_Trip_Fact_All] (NOLOCK) trip  LEFT JOIN DDSMRT.dbo.SPLC_Dim  (NOLOCK) SPLC1 on (trip.[Origin_Loc] = SPLC1.Location)  LEFT JOIN DDSMRT.dbo.SPLC_Dim  (NOLOCK) SPLC2 on (trip.[Dest_Loc] = SPLC2.Location)  where trip.Dlet_Flg is NULL"
    },
    {
      "id": "syncobj_0x3345334433334336",
      "name": "syncobj_0x3345334433334336",
      "type": "VIEW",
      "sql": "create view [dbo].[syncobj_0x3345334433334336]as select  [Repr_Enty_Dimn_Id],[Repr_Enty_Ver],[Repr_Enty_Org_Dimn_Id],[Repr_Enty_Org_Ver],[SPLC_Dimn_Id],[Repr_Enty_Org_Abrv],[SPLC_Nr],[Repr_Enty_Typ],[Ownr_Typ_Desc],[Repr_Shp_Typ],[FMO_Zone],[City],[Crtd_Dt],[Crtd_Id],[Lst_Upd_Dt],[Src_Sys_Nm],[Lst_Upd_Id],[Dq_Flg],[Eff_From],[Eff_To],[Shop_Cap],[Serv_Yard_Cap]  from  [dbo].[Repair_Entity_Dim]  where HAS_PERMS_BY_NAME('[dbo].[Repair_Entity_Dim]', 'OBJECT', 'SELECT')= 1  and ((1=0))"
    },
    {
      "id": "VMRT_Trip_Seg_Fact",
      "name": "VMRT_Trip_Seg_Fact",
      "type": "VIEW",
      "sql": "CREATE view [dbo].[VMRT_Trip_Seg_Fact] as   SELECT [Trip_Seg_Fact_Id]        ,[Trip_Fact_Id]        ,[Car_Dimn_Id]        ,[Car_Ver]        ,[Trip_Seg_Poss_Road_Org_Dimn_Id]        ,[Trip_Seg_Lst_Parti_Road_Org_Dimn_Id]        ,[Trip_Seg_Resp_Road_Org_Dimn_Id]        ,[Trip_Seg_Poss_Road_Org_Ver]        ,[Trip_Seg_Lst_Parti_Road_Org_Ver]        ,[Trip_Seg_Resp_Road_Org_Ver]        ,[Trip_Seg_Begin_SPLC_Dimn_Id]        ,[Trip_Seg_End_SPLC_Dimn_Id]        ,[Trip_Seg_End_Dt_Dimn_Id]        ,[Trip_Seg_Begin_Dt_Dimn_Id]        ,[Trip_Seg]        ,[Trip]        ,[Trip_Seg_Order]        ,[Trip_Seg_Typ]        ,[Trip_Seg_Status]        ,[Begin_Loc]        ,[Trip_Seg_Begin_Dt]        ,[End_Loc]        ,[Trip_Seg_End_Dt]        ,[Trip_Seg_Poss_Road]        ,[Trip_Seg_Resp_Road]        ,[Trip_Seg_Lst_Parti_Road]        ,[Trip_Seg_Milg]        ,[Trip_Seg_Dura]        ,[Scnd_Trip_Seg_Status]        ,[Crtd_Id]        ,[Crtd_Dt]        ,[Lst_Upd_Id]        ,[Lst_Upd_Dt]        ,[Src_Sys_Nm]        ,[Dq_Flg]    FROM [DDSMRT].[dbo].[vw_Trip_Segment_Fact] (NOLOCK)"
    },
    {
      "id": "AR_FILTER_00005_1979154096",
      "name": "AR_FILTER_00005_1979154096",
      "type": "REPLICATION_FILTER_PROCEDURE",
      "sql": "create procedure [dbo].[AR_FILTER_00005_1979154096] for replication as if exists (select * from [dbo].[Repair_Entity_Dim] where (1=0)) return 1 else return 0"
    },
    {
      "id": "VMRT_TTX_Loaded_Trip_Starts",
      "name": "VMRT_TTX_Loaded_Trip_Starts",
      "type": "VIEW",
      "sql": "CREATE VIEW [dbo].[VMRT_TTX_Loaded_Trip_Starts] as  SELECT    Trip.[Trip_Fact_Id]  ,Trip.[Car_Dimn_Id]  ,Trip.[Car_Ver]  ,Trip.[STCC_Dimn_Id]  ,Trip.[Trip_Begin_Dt_Dimn_Id]  ,Trip.[Trip_End_Dt_Dimn_Id]  ,Trip.[Trip_Orig_Parti_Shpr_Org_Dimn_Id]  ,Trip.[Trip_Orig_Parti_Shpr_Org_Ver]  ,Trip.[Trip_Dest_Parti_Shpr_Org_Dimn_Id]  ,Trip.[Trip_Dest_Parti_Shpr_Org_Ver]  ,Trip.[Trip_Orig_Poss_Road_Org_Dimn_Id]  ,Trip.[Trip_Orig_Poss_Road_Org_Ver]  ,Trip.[Trip_Dest_Poss_Road_Org_Dimn_Id]  ,Trip.[Trip_Dest_Poss_Road_Org_Ver]  ,Trip.[Trip_Orig_Lst_Parti_Road_Org_Dimn_Id]  ,Trip.[Trip_Orig_Lst_Parti_Road_Org_Ver]  ,Trip.[Trip_Dest_Lst_Parti_Road_Org_Dimn_Id]  ,Trip.[Trip_Dest_Lst_Parti_Road_Org_Ver]  ,Trip.[Trip_Orig_Resp_Road_Org_Dimn_Id]  ,Trip.[Trip_Orig_Resp_Road_Org_Ver]  ,Trip.[Trip_Dest_Resp_Road_Org_Dimn_Id]  ,Trip.[Trip_Dest_Resp_Road_Org_Ver]  ,isnull(SPLC1.SPLC_Dimn_Id, -1) as Trip_Orig_SPLC_Dimn_Id  ,isnull(SPLC2.SPLC_Dimn_Id, -1) as Trip_Dest_SPLC_Dimn_Id  ,Trip.[Trip_Orig_Org_Dimn_Id] AS Trip_Orig_Loc_Org_Dimn_Id  ,Trip.[Trip_Orig_Org_Ver] AS Trip_Orig_Loc_Org_Ver  ,Trip.[Trip_Dest_Org_Dimn_Id] AS Trip_Dest_Loc_Org_Dimn_Id  ,Trip.[Trip_Dest_Org_Ver] AS Trip_Dest_Loc_Org_Ver  ,Trip.Trip_Begin_Dt  ,Trip.Trip_Typ  ,trip.[Origin_Loc]  ,trip.[Dest_Loc]  ,Trip.[Crtd_Dt]  ,1 as Ld_Trip_Strts_Cnt  FROM [DDSMRT].[dbo].[vw_Trip_Fact] (NOLOCK) trip   INNER JOIN (select distinct Trip_Fact_Id from [DDSMRT].[dbo].[vw_Trip_Segment_Fact_All] (NOLOCK) where  Trip_Seg_Typ = 'TRAN') Trip_Segment on (Trip.Trip_Fact_Id = Trip_Segment.Trip_Fact_Id  )   LEFT JOIN DDSMRT.dbo.SPLC_Dim (NOLOCK) SPLC1 on (trip.[Origin_Loc] = SPLC1.Location)   LEFT JOIN DDSMRT.dbo.SPLC_Dim (NOLOCK) SPLC2 on (trip.[Dest_Loc] = SPLC2.Location)  WHERE Trip.Trip_Begin_Dt >= '2010-01-01 00:00:00.000'    AND Trip.Dlet_Flg is NULL     AND Trip.Trip_Typ = 'L'  group by Trip.[Trip_Fact_Id]  ,Trip.[Car_Dimn_Id]  ,Trip.[Car_Ver]  ,Trip.[STCC_Dimn_Id]  ,Trip.[Trip_Begin_Dt_Dimn_Id]  ,Trip.[Trip_End_Dt_Dimn_Id]  ,Trip.[Trip_Orig_Parti_Shpr_Org_Dimn_Id]  ,Trip.[Trip_Orig_Parti_Shpr_Org_Ver]  ,Trip.[Trip_Dest_Parti_Shpr_Org_Dimn_Id]  ,Trip.[Trip_Dest_Parti_Shpr_Org_Ver]  ,Trip.[Trip_Orig_Poss_Road_Org_Dimn_Id]  ,Trip.[Trip_Orig_Poss_Road_Org_Ver]  ,Trip.[Trip_Dest_Poss_Road_Org_Dimn_Id]  ,Trip.[Trip_Dest_Poss_Road_Org_Ver]  ,Trip.[Trip_Orig_Lst_Parti_Road_Org_Dimn_Id]  ,Trip.[Trip_Orig_Lst_Parti_Road_Org_Ver]  ,Trip.[Trip_Dest_Lst_Parti_Road_Org_Dimn_Id]  ,Trip.[Trip_Dest_Lst_Parti_Road_Org_Ver]  ,Trip.[Trip_Orig_Resp_Road_Org_Dimn_Id]  ,Trip.[Trip_Orig_Resp_Road_Org_Ver]  ,Trip.[Trip_Dest_Resp_Road_Org_Dimn_Id]  ,Trip.[Trip_Dest_Resp_Road_Org_Ver]  ,SPLC1.SPLC_Dimn_Id  ,SPLC2.SPLC_Dimn_Id  ,Trip.[Trip_Orig_Org_Dimn_Id]  ,Trip.[Trip_Orig_Org_Ver]  ,Trip.[Trip_Dest_Org_Dimn_Id]  ,Trip.[Trip_Dest_Org_Ver]  ,Trip.Trip_Begin_Dt  ,Trip.Trip_Typ  ,trip.[Origin_Loc]  ,trip.[Dest_Loc]  ,Trip.[Crtd_Dt]"
    },
    {
      "id": "VShop_Car_Status_Dim",
      "name": "VShop_Car_Status_Dim",
      "type": "VIEW",
      "sql": "create view [DDSV].[VShop_Car_Status_Dim] as     select * from dbo.Shop_Car_Status_Dim"
    },
    {
      "id": "Car",
      "name": "Car",
      "type": "VIEW",
      "sql": "CREATE VIEW [SV].[Car]  AS    SELECT    VMRT_Car_Dimension.Car_Dimn_Id  ,VMRT_Car_Dimension.Car_Ver  ,VMRT_Car_Dimension.Car_Nr AS Car_Number  ,VMRT_Car_Dimension.Car_Init AS Car_Initial  ,VMRT_Car_Dimension.Car_Status_UFD  ,VMRT_Car_Dimension.Car_Status_Maximo  ,VMRT_Car_Dimension.Car_Cls AS Car_Class  ,VMRT_Car_Dimension.TTX_Eff_Dt AS TTX_Effective_Date  ,VMRT_Car_Dimension.Car_Ownrshp_Ind AS Car_Ownership_Ind  ,VMRT_Car_Dimension.Pool_Cd AS Pool_Code   ,VMRT_Car_Dimension.TTX_Mngd_Car_Ind AS TTX_Managed_Car_Ind  ,VMRT_Car_Dimension.Umler_Blt_Dt AS Umler_Built_Date  ,VMRT_Car_Dimension.Eq_Bldr AS Eq_Builder_Name  ,VMRT_Car_Dimension.Bldr_Lot_Cd AS Builder_Lot_Code  ,VMRT_Car_Dimension.Eq_Hierchy_Id  ,VMRT_Car_Dimension.Eq_Hierchy_Ver  ,concat(VMRT_Car_Dimension.TTX_Eq_Cd,' ', VMRT_Car_Dimension.ttx_eq_cd_desc) as TTX_Eq_Cd  ,VMRT_Car_Dimension.Eq_Char AS Equipment_Characteristics  ,VMRT_Car_Dimension.Fleet_Hierchy_Id  ,VMRT_Car_Dimension.Fleet_Hierchy_Ver  ,VMRT_Car_Dimension.Fleet_Segment_Description  ,VMRT_Car_Dimension.Entr_Hierchy_Id  ,VMRT_Car_Dimension.Entr_Hierchy_Ver  ,VMRT_Car_Dimension.Stat_Code  ,VMRT_Car_Dimension.Equipment_Feature  ,VMRT_Car_Dimension.Equipment_Type  ,VMRT_Car_Dimension.Business_Line  ,VMRT_Car_Dimension.Ownr_Mrk AS Owner_Mark  ,VMRT_Car_Dimension.Pltfm_Fctr AS Platform_Factor  ,VMRT_Car_Dimension.Axl_Cnt AS Axle_Count  ,VMRT_Car_Dimension.TPE_Fctr AS TPE_Factor  ,VMRT_Car_Dimension.Ut_Cnt AS Unit_Count  ,VMRT_Car_Dimension.Trk_Axl_Cnt AS Truck_Count  ,VMRT_Car_Dimension.Eq_Typ_Cd AS Equipment_Type_Code  ,VMRT_Car_Dimension.Intmdit_Connt_Styl AS Intermediate_Conn_Style  ,VMRT_Car_Dimension.TTX_Eq_Cd_Desc AS TTX_Equipment_Description  ,VMRT_Car_Dimension.[Insd_Len] as Insd_Pltfm_Len  ,VMRT_Car_Dimension.Insd_Len /12 as Insd_Len  ,VMRT_Car_Dimension.Osid_Len /12 as Osid_Len  ,VMRT_Car_Dimension.Car_Eff_From  ,VMRT_Car_Dimension.Car_Eff_To    FROM [dbo].[VMRT_Car_Dimension]"
    },
    {
      "id": "syncobj_0x4238443433314339",
      "name": "syncobj_0x4238443433314339",
      "type": "VIEW",
      "sql": "create view [dbo].[syncobj_0x4238443433314339]as select  [Rpr_Evnt_Cst_Fct_Id],[Car_Dimn_Id],[Car_Ver],[Repr_Enty_Dimn_Id],[Repr_Enty_Ver],[Mnt_Typ_Dimn_Id],[Mnt_Typ_Ver],[Area_Of_Car_Dimn_Id],[Area_Of_Car_Ver],[Rpr_Dt_Dimn_Id],[SPLC_Dimn_Id],[TTX_Acct_Dt_Dimn_Id],[Cond_Cd_Dimn_Id],[Repr_Evnt_Typ_Cd_Dimn_Id],[Resp_Cd_Dimn_Id],[Why_Md_Cd_Dimn_Id],[Car_Loc_Dimn_Id],[Matl_Dimn_Id],[Spon_Road_Org_Dimn_Id],[Spon_Road_Org_Ver],[Invc_Enty_Org_Dimn_Id],[Invc_Enty_Org_Ver],[Vndr_Dimn_Id],[Vndr_Ver],[Uniq_Rec_Id],[Inv_Ln_Nr],[Inv_Nr],[Repr_Dt],[TTX_Acct_Dt],[Car_Nr],[Car_Init],[Repr_Enty_Org_Abrv],[SPLC_Nr],[Apl_Job_Cd],[Apl_Qlfr_Cd],[Loc_On_Car_Cd],[Repr_Cd],[Repr_Cls_Cd],[Resp_Cd],[Why_Md_Cd],[Repr_Evnt_Typ_Cd],[Car_Cls],[Invc_Typ],[Invc_Enty_Id],[Acct_Typ],[Cnd_Cd],[Orig_Party],[Vndr_Mfg_Cd],[Ref_Nr],[Repr_Desc],[Frgn_Repr_Typ],[Bil_Card_Stts],[Labr_Rt],[Labr_Hrs],[Labr_Cost],[Matl_Cost],[Cmpnt_Qty],[Repr_Cnv_Flg],[Car_Age_Bukt],[Crtd_Dt],[Crtd_Id],[Lst_Upd_Id],[Lst_Upd_Dt],[Src_Sys_Nm],[Dq_Flg],[Work_Type_Dimn_Id],[Wrk_Ord_Nr],[Invoice_Type_Id],[Photo_Indicator_Flag]  from  [dbo].[Repair_Event_Cost_Fact]  where HAS_PERMS_BY_NAME('[dbo].[Repair_Event_Cost_Fact]', 'OBJECT', 'SELECT')= 1  and ((1=0))"
    },
    {
      "id": "VMRT_Why_Made_Code_Dimension",
      "name": "VMRT_Why_Made_Code_Dimension",
      "type": "VIEW",
      "sql": "CREATE VIEW [dbo].[VMRT_Why_Made_Code_Dimension](Why_Md_Cd_Dimn_Id,Repr_Rsn_Cd,Repr_Rsn_Cd_Desc,Crtd_Dt,Crtd_Id,Lst_Upd_Dt,Lst_Upd_Id,Src_Sys_Nm)  AS  (    SELECT Code_Lookup.Cd_Lkp_Dimn_Id,Code_Lookup.Cd,Code_Lookup.Cd_Desc,Code_Lookup.Crtd_Dt,Code_Lookup.Crtd_Id,Code_Lookup.Lst_Upd_Dt,Code_Lookup.Lst_Upd_Id,Code_Lookup.Src_Sys_Nm   FROM DDSMRT.dbo.Code_Lookup (NOLOCK)    WHERE Cd_identifier ='WHY_MADE' or Cd_Lkp_Dimn_Id= -1       )   ;"
    },
    {
      "id": "Revenue_Accounting_Status_Hierarchy",
      "name": "Revenue_Accounting_Status_Hierarchy",
      "type": "VIEW",
      "sql": "create view [SV].[Revenue_Accounting_Status_Hierarchy] as    select typ_id as hier_id, [Revenue Accounting Status Level 1],[Revenue Accounting Status Level 2],[Revenue Accounting Status Level 3],[Revenue Accounting Status Level 4] from   (select 1 as id, Typ_Desc as 'Revenue Accounting Status Level 1' from ddsmrt.[dbo].[Type_Lookup] where typ_id = 137) l5   left join   (select 1 as id, Typ_Desc as 'Revenue Accounting Status Level 2' from ddsmrt.[dbo].[Type_Lookup] where typ_id = 137) l6 on 1=1  join   (select 1 as id, Typ_Desc as 'Revenue Accounting Status Level 3' from ddsmrt.[dbo].[Type_Lookup] where typ_id = 137) l7 on 1=1  join   (select 1 as id, Typ_Desc as 'Revenue Accounting Status Level 4',typ_id from ddsmrt.[dbo].[Type_Lookup] where typ_id = 137) l8 on 1=1    union  select typ_id as hier_id, [Revenue Accounting Status Level 1],[Revenue Accounting Status Level 2],[Revenue Accounting Status Level 3],[Revenue Accounting Status Level 4] from   (select 1 as id, Typ_Desc as 'Revenue Accounting Status Level 1' from ddsmrt.[dbo].[Type_Lookup] where typ_id = 153) l1   left join   (select 1 as id, 'Enroute/Other' as 'Revenue Accounting Status Level 2' from ddsmrt.[dbo].[Type_Lookup] where typ_id = 128) l2 on 1=1  join   (select 1 as id, 'Enroute/Other' as 'Revenue Accounting Status Level 3' from ddsmrt.[dbo].[Type_Lookup] where typ_id = 128) l3 on 1=1  join   (select 1 as id, 'Enroute/Other' as 'Revenue Accounting Status Level 4',typ_id from ddsmrt.[dbo].[Type_Lookup] where typ_id = 128) l4 on 1=1    union   select typ_id as hier_id, [Revenue Accounting Status Level 1],[Revenue Accounting Status Level 2],[Revenue Accounting Status Level 3],[Revenue Accounting Status Level 4] from   (select 1 as id, Typ_Desc as 'Revenue Accounting Status Level 1' from ddsmrt.[dbo].[Type_Lookup] where typ_id = 153) l5   left join   (select 1 as id, Typ_Desc as 'Revenue Accounting Status Level 2' from ddsmrt.[dbo].[Type_Lookup] where typ_id = 131) l6 on 1=1  join   (select 1 as id, Typ_Desc as 'Revenue Accounting Status Level 3' from ddsmrt.[dbo].[Type_Lookup] where typ_id = 129) l7 on 1=1  join   (select 1 as id, Typ_Desc as 'Revenue Accounting Status Level 4',typ_id from ddsmrt.[dbo].[Type_Lookup] where typ_id = 129) l8 on 1=1    union   select typ_id as hier_id, [Revenue Accounting Status Level 1],[Revenue Accounting Status Level 2],[Revenue Accounting Status Level 3],[Revenue Accounting Status Level 4] from   (select 1 as id, Typ_Desc as 'Revenue Accounting Status Level 1' from ddsmrt.[dbo].[Type_Lookup] where typ_id = 153) l5   left join   (select 1 as id, Typ_Desc as 'Revenue Accounting Status Level 2' from ddsmrt.[dbo].[Type_Lookup] where typ_id = 131) l6 on 1=1  join   (select 1 as id, Typ_Desc as 'Revenue Accounting Status Level 3' from ddsmrt.[dbo].[Type_Lookup] where typ_id = 133) l7 on 1=1  join   (select 1 as id, Typ_Desc as 'Revenue Accounting Status Level 4',typ_id from ddsmrt.[dbo].[Type_Lookup] where typ_id = 133) l8 on 1=1    union   select typ_id as hier_id, [Revenue Accounting Status Level 1],[Revenue Accounting Status Level 2],[Revenue Accounting Status Level 3],[Revenue Accounting Status Level 4] from   (select 1 as id, Typ_Desc as 'Revenue Accounting Status Level 1' from ddsmrt.[dbo].[Type_Lookup] where typ_id = 153) l5   left join   (select 1 as id, Typ_Desc as 'Revenue Accounting Status Level 2' from ddsmrt.[dbo].[Type_Lookup] where typ_id = 132) l6 on 1=1  join   (select 1 as id, Typ_Desc as 'Revenue Accounting Status Level 3' from ddsmrt.[dbo].[Type_Lookup] where typ_id = 130) l7 on 1=1  join   (select 1 as id, Typ_Desc as 'Revenue Accounting Status Level 4',typ_id from ddsmrt.[dbo].[Type_Lookup] where typ_id = 130) l8 on 1=1    union   select typ_id as hier_id, [Revenue Accounting Status Level 1],[Revenue Accounting Status Level 2],[Revenue Accounting Status Level 3],[Revenue Accounting Status Level 4] from   (select 1 as id, Typ_Desc as 'Revenue Accounting Status Level 1' from ddsmrt.[dbo].[Type_Lookup] where typ_id = 153) l5   left join   (select 1 as id, Typ_Desc as 'Revenue Accounting Status Level 2' from ddsmrt.[dbo].[Type_Lookup] where typ_id = 132) l6 on 1=1  join   (select 1 as id, Typ_Desc as 'Revenue Accounting Status Level 3' from ddsmrt.[dbo].[Type_Lookup] where typ_id = 127) l7 on 1=1  join   (select 1 as id, Typ_Desc as 'Revenue Accounting Status Level 4',typ_id from ddsmrt.[dbo].[Type_Lookup] where typ_id = 146) l8 on 1=1    union   select typ_id as hier_id, [Revenue Accounting Status Level 1],[Revenue Accounting Status Level 2],[Revenue Accounting Status Level 3],[Revenue Accounting Status Level 4] from   (select 1 as id, Typ_Desc as 'Revenue Accounting Status Level 1' from ddsmrt.[dbo].[Type_Lookup] where typ_id = 153) l5   left join   (select 1 as id, Typ_Desc as 'Revenue Accounting Status Level 2' from ddsmrt.[dbo].[Type_Lookup] where typ_id = 132) l6 on 1=1  join   (select 1 as id, Typ_Desc as 'Revenue Accounting Status Level 3' from ddsmrt.[dbo].[Type_Lookup] where typ_id = 127) l7 on 1=1  join   (select 1 as id, Typ_Desc as 'Revenue Accounting Status Level 4',typ_id from ddsmrt.[dbo].[Type_Lookup] where typ_id = 145) l8 on 1=1    union   select typ_id as hier_id, [Revenue Accounting Status Level 1],[Revenue Accounting Status Level 2],[Revenue Accounting Status Level 3],[Revenue Accounting Status Level 4] from   (select 1 as id, Typ_Desc as 'Revenue Accounting Status Level 1' from ddsmrt.[dbo].[Type_Lookup] where typ_id = 153) l5   left join   (select 1 as id, Typ_Desc as 'Revenue Accounting Status Level 2' from ddsmrt.[dbo].[Type_Lookup] where typ_id = 136) l6 on 1=1  join   (select 1 as id, Typ_Desc as 'Revenue Accounting Status Level 3' from ddsmrt.[dbo].[Type_Lookup] where typ_id = 134) l7 on 1=1  join   (select 1 as id, Typ_Desc as 'Revenue Accounting Status Level 4',typ_id from ddsmrt.[dbo].[Type_Lookup] where typ_id = 134) l8 on 1=1    union   select typ_id as hier_id, [Revenue Accounting Status Level 1],[Revenue Accounting Status Level 2],[Revenue Accounting Status Level 3],[Revenue Accounting Status Level 4] from   (select 1 as id, Typ_Desc as 'Revenue Accounting Status Level 1' from ddsmrt.[dbo].[Type_Lookup] where typ_id = 153) l5   left join   (select 1 as id, Typ_Desc as 'Revenue Accounting Status Level 2' from ddsmrt.[dbo].[Type_Lookup] where typ_id = 136) l6 on 1=1  join   (select 1 as id, Typ_Desc as 'Revenue Accounting Status Level 3' from ddsmrt.[dbo].[Type_Lookup] where typ_id = 135) l7 on 1=1  join   (select 1 as id, Typ_Desc as 'Revenue Accounting Status Level 4',typ_id from ddsmrt.[dbo].[Type_Lookup] where typ_id = 135) l8 on 1=1"
    },
    {
      "id": "AR_FILTER_00005_832722019",
      "name": "AR_FILTER_00005_832722019",
      "type": "REPLICATION_FILTER_PROCEDURE",
      "sql": "create procedure [dbo].[AR_FILTER_00005_832722019] for replication as if exists (select * from [dbo].[Repair_Event_Cost_Fact] where (1=0)) return 1 else return 0"
    },
    {
      "id": "VArea_Of_Car_Dim",
      "name": "VArea_Of_Car_Dim",
      "type": "VIEW",
      "sql": "CREATE view [DDSV].[VArea_Of_Car_Dim] as  SELECT concat(convert(varchar(10),Area_Of_Car_Dimn_Id),'_',convert(varchar(5), Area_Of_Car_Ver)) as Area_Of_Car_Dimn_Id        ,Apl_Job_Cd as [Job_Cd]        ,Apl_Qlfr_Cd as [Qlfr_Cd]        ,cast(Apl_Job_Cd_Desc as varchar(100)) as [Job_Cd_Desc]        ,cast(Apl_Qlfr_Cd_Desc as varchar(100)) as [Qlfr_Cd_Desc]        ,cast((case when Src_Sys_Nm in ('AAR', 'SEI') then Apl_Job_Cd end) as varchar(6)) as [FCSRA_Apl_Job_Cd]     ,cast((case when Src_Sys_Nm in ('AAR', 'SEI') then Apl_Qlfr_Cd end) as varchar(3)) as [FCSRA_Apl_Qlfr_Cd]        ,cast((case when Src_Sys_Nm in ('SHOP/FMO BILLING') then Apl_Job_Cd end) as varchar(4)) as [FCSRE_Apl_Job_Cd]        ,cast((case when Src_Sys_Nm in ('SHOP/FMO BILLING') then Apl_Qlfr_Cd end) as varchar(3)) as[FCSRE_Apl_Qlfr_Cd]        ,cast([Area_Of_Car_Lvl_1] as varchar(50)) as [Area_Of_Car]        ,cast([Area_Of_Car_Lvl_2] as varchar(50)) as [Area_Of_Car_Lvl_1]        ,cast([Area_Of_Car_Lvl_3] as varchar(50)) as [Area_Of_Car_Lvl_2]        ,cast([Area_Of_Car_Lvl_4] as varchar(50)) as [Area_Of_Car_Lvl_3]     ,cast([Area_Of_Car_Lvl_4] as varchar(50)) as [Area_Of_Car_Lvl_4]        ,[Job_Cd_Act_Ind]        ,cast ([Whl_Sz] as varchar(37)) as [Whl_Sz]        ,[Whl_Typ] = NULL        ,[Notes] = NULL        ,[Crtd_Dt]        ,cast([Crtd_Id] as char(8)) as [Crtd_Id]        ,[Lst_Upd_Dt]        ,cast([Lst_Upd_Id] as char(8)) as [Lst_Upd_Id]    FROM [ddsmrt].[dbo].[Area_Of_Car_Dim] (NOLOCK)"
    },
    {
      "id": "Repair_Event_Cost",
      "name": "Repair_Event_Cost",
      "type": "VIEW",
      "sql": "CREATE VIEW [SV].[Repair_Event_Cost]  AS  SELECT   Repair_Event_Cost_Fact.Rpr_Evnt_Cst_Fct_Id as Repair_Event_Cost_Fact_Id,  Repair_Event_Cost_Fact.Car_Dimn_Id,  Repair_Event_Cost_Fact.Car_Ver,  Repair_Event_Cost_Fact.Repr_Enty_Dimn_Id,  Repair_Event_Cost_Fact.Repr_Enty_Ver,  Repair_Event_Cost_Fact.Rpr_Dt_Dimn_Id,  Repair_Event_Cost_Fact.Area_Of_Car_Dimn_Id,  Repair_Event_Cost_Fact.Area_Of_Car_Ver,  Repair_Event_Cost_Fact.Mnt_Typ_Dimn_Id,  Repair_Event_Cost_Fact.Mnt_Typ_Ver,  Repair_Event_Cost_Fact.Car_Loc_Dimn_Id,  case when Src_Sys_Nm = 'Open AAR' then (select cast(convert(varchar(8),dateadd( mm,1, max(TTX_Acct_Dt)),112) as int) from ddsmrt.dbo.Repair_Event_Cost_Fact where src_sys_nm = 'Closed AAR')  else Repair_Event_Cost_Fact.TTX_Acct_Dt_Dimn_Id end as TTX_Acct_Dt_Dimn_Id,  Repair_Event_Cost_Fact.Resp_Cd_Dimn_Id,  Repair_Event_Cost_Fact.Cond_Cd_Dimn_Id,  Repair_Event_Cost_Fact.Repr_Evnt_Typ_Cd_Dimn_Id,  Repair_Event_Cost_Fact.Why_Md_Cd_Dimn_Id,  Repair_Event_Cost_Fact.Matl_Dimn_Id,  Repair_Event_Cost_Fact.Spon_Road_Org_Ver as Spons_Road_Org_Ver,  Repair_Event_Cost_Fact.Spon_road_Org_Dimn_Id as Spons_Road_Org_Dim_Id ,  Repair_Event_Cost_Fact.Invc_Enty_Org_Dimn_Id,  Repair_Event_Cost_Fact.Invc_Enty_Org_Ver,  Repair_Event_Cost_Fact.[Vndr_Dimn_Id] as [Vndr_Dimn_Id],  Repair_Event_Cost_Fact.[Vndr_Ver] as [Vndr_Ver],  Repair_Event_Cost_Fact.Splc_Dimn_Id,  Repair_Event_Cost_Fact.Inv_Nr as Invoice_Number,  Repair_Event_Cost_Fact.Inv_Ln_Nr as Invoice_Line_Number,  Repair_Event_Cost_Fact.Repr_Dt as Repair_Date,  case when Src_Sys_Nm = 'Open AAR' then (select dateadd( mm,1, max(TTX_Acct_Dt)) from ddsmrt.dbo.Repair_Event_Cost_Fact where src_sys_nm = 'Closed AAR')  else Repair_Event_Cost_Fact.TTX_Acct_Dt end as TTX_Account_Date,  Repair_Event_Cost_Fact.Car_Nr as Car_Number,  Repair_Event_Cost_Fact.Car_Init as Car_Initial,  Repair_Event_Cost_Fact.Repr_Enty_Org_Abrv as Repair_Entity_ID,  Repair_Event_Cost_Fact.Apl_Job_Cd as Applied_Job_Code,  Repair_Event_Cost_Fact.Apl_Qlfr_Cd as Qualifier_Code,  Repair_Event_Cost_Fact.Loc_On_Car_Cd as Location_on_Car,  Repair_Event_Cost_Fact.Repr_Cd as Repair_Code,  Repair_Event_Cost_Fact.Repr_Cls_Cd as Repair_Class,  Repair_Event_Cost_Fact.Resp_Cd as Responsibility_Code,  Repair_Event_Cost_Fact.Why_Md_Cd as Why_Made_Code,  Repair_Event_Cost_Fact.Repr_Evnt_Typ_Cd as Repair_Event_Type_ID,  Repair_Event_Cost_Fact.Car_Cls as Car_Class_Code,  Repair_Event_Cost_Fact.Invc_Typ as Invoice_Type,  Repair_Event_Cost_Fact.Invc_Enty_Id as Invoicing_Entity_Id,  case when Repair_Event_Cost_Fact.Acct_Typ = 'M' then 'Maintenance' when Repair_Event_Cost_Fact.Acct_Typ = 'C' then 'Capital' else NULL end as Accounting_Type,  Repair_Event_Cost_Fact.Cnd_Cd as Condition_Code,  Repair_Event_Cost_Fact.Orig_Party as Orig_Party,  Repair_Event_Cost_Fact.Ref_Nr as Reference_Number,  Repair_Event_Cost_Fact.Car_Age_Bukt as Car_Age_Bucket,  Repair_Event_Cost_Fact.Repr_Desc as Repair_Description,  Repair_Event_Cost_Fact.Labr_Rt as Labor_Rate,  Repair_Event_Cost_Fact.Labr_Hrs as Labor_Hours,  Repair_Event_Cost_Fact.Labr_Cost as Labor_Cost,  Repair_Event_Cost_Fact.Matl_Cost as Material_Cost,  Repair_Event_Cost_Fact.Cmpnt_Qty as Component_Quantity,  case when Src_Sys_Nm in ('Open AAR', 'Closed AAR') then 'AAR'     when Src_Sys_Nm = 'Foreign' then 'Foreign Repair Billing'    else   Repair_Event_Cost_Fact.Src_Sys_Nm end as Source,  Src_Sys_Nm as Open_Close_Flag,  Bil_Card_Stts as Bill_Card_Status,  frgn_Repr_Typ as Foreign_Repair_Type,  Repair_Event_Cost_Fact.SPLC_Nr,  Repair_Event_Cost_Fact.Wrk_Ord_Nr,  Repair_Event_Cost_Fact.Work_Type_Dimn_Id,  CASE WHEN Repair_Event_Cost_Fact.Invoice_Type_Id = 10 THEN 'Y'  ELSE 'N'  END Full_Service_Lease,  Repair_Event_Cost_Fact.Photo_Indicator_Flag  FROM ddsmrt.dbo.vw_Repair_Event_Cost_Fact (NOLOCK) Repair_Event_Cost_Fact"
    },
    {
      "id": "syncobj_0x4446304635353735",
      "name": "syncobj_0x4446304635353735",
      "type": "VIEW",
      "sql": "create view [dbo].[syncobj_0x4446304635353735]as select  [Rpr_Evnt_Cst_Fct_Id],[Car_Dimn_Id],[Car_Ver],[Repr_Enty_Dimn_Id],[Repr_Enty_Ver],[Mnt_Typ_Dimn_Id],[Mnt_Typ_Ver],[Area_Of_Car_Dimn_Id],[Area_Of_Car_Ver],[Rpr_Dt_Dimn_Id],[SPLC_Dimn_Id],[TTX_Acct_Dt_Dimn_Id],[Cond_Cd_Dimn_Id],[Repr_Evnt_Typ_Cd_Dimn_Id],[Resp_Cd_Dimn_Id],[Why_Md_Cd_Dimn_Id],[Car_Loc_Dimn_Id],[Matl_Dimn_Id],[Spon_Road_Org_Dimn_Id],[Spon_Road_Org_Ver],[Invc_Enty_Org_Dimn_Id],[Invc_Enty_Org_Ver],[Vndr_Dimn_Id],[Vndr_Ver],[Uniq_Rec_Id],[Inv_Ln_Nr],[Inv_Nr],[Repr_Dt],[TTX_Acct_Dt],[Car_Nr],[Car_Init],[Repr_Enty_Org_Abrv],[SPLC_Nr],[Apl_Job_Cd],[Apl_Qlfr_Cd],[Loc_On_Car_Cd],[Repr_Cd],[Repr_Cls_Cd],[Resp_Cd],[Why_Md_Cd],[Repr_Evnt_Typ_Cd],[Car_Cls],[Invc_Typ],[Invc_Enty_Id],[Acct_Typ],[Cnd_Cd],[Orig_Party],[Vndr_Mfg_Cd],[Ref_Nr],[Repr_Desc],[Frgn_Repr_Typ],[Bil_Card_Stts],[Labr_Rt],[Labr_Hrs],[Labr_Cost],[Matl_Cost],[Cmpnt_Qty],[Repr_Cnv_Flg],[Car_Age_Bukt],[Crtd_Dt],[Crtd_Id],[Lst_Upd_Id],[Lst_Upd_Dt],[Src_Sys_Nm],[Dq_Flg],[Work_Type_Dimn_Id],[Wrk_Ord_Nr],[Invoice_Type_Id],[Photo_Indicator_Flag]  from  [dbo].[Repair_Event_Cost_Fact_History]  where HAS_PERMS_BY_NAME('[dbo].[Repair_Event_Cost_Fact_History]', 'OBJECT', 'SELECT')= 1  and ((1=0))"
    },
    {
      "id": "Vast_Inct_Grp_Dimn",
      "name": "Vast_Inct_Grp_Dimn",
      "type": "VIEW",
      "sql": "CREATE VIEW [DDSV].[Vast_Inct_Grp_Dimn] as  SELECT [Inct_Grp_Dimn_Id]        ,[Inct_Grp_Nm]     ,Eff_Strt_Dt     ,Eff_End_Dt        ,[Crtd_Dt]        ,[Crtd_Id]     ,[Lst_Upd_Dt]        ,[Lst_Upd_Id]  FROM [ddsmrt].[dbo].[Tast_Inct_Grp_Dimn] (NOLOCK)"
    },
    {
      "id": "Revenue_Accounting_Accrual_Car_Count",
      "name": "Revenue_Accounting_Accrual_Car_Count",
      "type": "VIEW",
      "sql": "-----------------Update Existing Views Script---------------------------------    CREATE view [SV].[Revenue_Accounting_Accrual_Car_Count] as    --Accrual  select   Car_Dimn_Id  ,Car_Ver    ,Dt_Dimn_Id as Service_Month_Start_Dt_Dimn_Id  ,Car_Cnt_Catg_Typ_Id  ,Responsible_Road_Org_Mbrshp_Dimn_Id  ,Responsible_Road_Org_Mbrshp_Ver  ,liable_rd_mbrshp_dimn_id  ,liable_rd_mbrshp_ver  ,Liable_org_dimn_id  ,Liable_Org_Ver     ,(Cast([Car_Dimn_Id] AS VARCHAR) + '|' + Cast([Car_Ver] AS VARCHAR)) AS Car_ID     ,(Cast(liable_rd_mbrshp_dimn_id AS VARCHAr) + '|' + Cast(liable_rd_mbrshp_ver AS VARCHAR)) AS Liable_Road_ID     ,(Cast([Responsible_Road_Org_Mbrshp_Dimn_Id] AS VARCHAR) + '|' + Cast([Responsible_Road_Org_Mbrshp_Ver] AS VARCHAR)) AS Resp_Road_ID     ,(Cast([Liable_Org_Dimn_Id] AS VARCHAr) + '|' + Cast([Liable_Org_Ver] AS VARCHAR)) AS Liable_Dimn_ID     ,(Cast([Responsible_Org_Dimn_Id] AS VARCHAR) + '|' + Cast([Responsible_Org_Ver] AS VARCHAR)) AS Resp_Dimn_ID    ,Car_Cnt  ,TPE_Cnt  ,Ut_Cnt  ,Pltfm_Cnt    from (  select    f.car_dimn_id  ,f.car_ver  ,f.Dt_Dimn_Id  ,f.car_Cnt_Catg_Typ_id  ,f.Attr_Id_1  as Responsible_Road_Org_Mbrshp_Dimn_Id  ,f.Attr_Ver_1 as Responsible_Road_Org_Mbrshp_Ver  ,f.Attr_Id_2  as liable_rd_mbrshp_dimn_id  ,f.Attr_Ver_2 as liable_rd_mbrshp_ver  ,isnull(mem.Org_Dimn_Id,-1) as Liable_org_dimn_id  ,isnull(mem.org_ver    ,-1) as Liable_Org_Ver  ,isnull(mem2.Org_Dimn_Id,-1) as [Responsible_Org_Dimn_Id]  ,isnull(mem2.org_ver ,-1) as [Responsible_Org_Ver]  ,isnull(f.Car_Cnt ,0) as Car_Cnt  ,isnull(f.TPE_Cnt ,0) as TPE_Cnt  ,isnull(f.Ut_Cnt ,0) as Ut_Cnt  ,isnull(f.Pltfm_Cnt ,0) as Pltfm_Cnt    from (SELECT car_dimn_id     ,car_ver     ,Dt_Dimn_Id     ,car_Cnt_Catg_Typ_id     ,1 as grp_nr     ,Attr_Id_1     ,Attr_Ver_1     ,Attr_Id_2     ,Attr_Ver_2     ,Row_Typ_Id     ,sum(Car_Cnt   ) as Car_Cnt     ,sum(TPE_Cnt   ) as TPE_Cnt     ,sum(Ut_Cnt    ) as Ut_Cnt     ,sum(Pltfm_Cnt ) as Pltfm_Cnt     FROM ddsmrt.dbo.vw_car_count_fact (NOLOCK)     WHERE Row_Typ_Id = 516 and car_Cnt_Catg_Typ_id <> 138 and Dt_Dimn_Id >=20100101      Group by car_dimn_id,car_ver,Dt_Dimn_Id,car_Cnt_Catg_Typ_id,Attr_Id_1,Attr_Ver_1,Attr_Id_2,Attr_Ver_2,Row_Typ_Id     UNION      select * from (     select       car_dimn_id     ,car_ver     ,Dt_Dimn_Id     ,137 as car_Cnt_Catg_Typ_id     ,grp_nr     ,Attr_Id_1     ,Attr_Ver_1     ,Attr_Id_2     ,Attr_Ver_2     ,Row_Typ_Id     ,isnull(Car_Cnt-lag(Car_Cnt) over (partition by dt_dimn_id, car_dimn_id, car_ver, Attr_Id_2,Attr_Ver_2, Attr_Id_1,Attr_Ver_1 order by grp_nr), Car_Cnt) as Car_Cnt     ,isnull(TPE_Cnt-lag(TPE_Cnt) over (partition by dt_dimn_id, car_dimn_id, car_ver, Attr_Id_2,Attr_Ver_2, Attr_Id_1,Attr_Ver_1 order by grp_nr), TPE_Cnt) as TPE_Cnt     ,isnull(Ut_Cnt-lag(Ut_Cnt) over (partition by dt_dimn_id, car_dimn_id, car_ver, Attr_Id_2,Attr_Ver_2, Attr_Id_1,Attr_Ver_1 order by grp_nr), Ut_Cnt) as Ut_Cnt     ,isnull(Pltfm_Cnt-lag(Pltfm_Cnt) over (partition by dt_dimn_id, car_dimn_id, car_ver, Attr_Id_2,Attr_Ver_2, Attr_Id_1,Attr_Ver_1 order by grp_nr), Pltfm_Cnt) as Pltfm_Cnt     from (     SELECT car_dimn_id     ,car_ver     ,Dt_Dimn_Id     ,case when car_Cnt_Catg_Typ_id = 138 then 2 else 1 end as grp_nr     ,Attr_Id_1     ,Attr_Ver_1     ,Attr_Id_2     ,Attr_Ver_2     ,Row_Typ_Id     ,sum(Car_Cnt   ) as Car_Cnt     ,sum(TPE_Cnt   ) as TPE_Cnt     ,sum(Ut_Cnt    ) as Ut_Cnt     ,sum(Pltfm_Cnt ) as Pltfm_Cnt     FROM ddsmrt.dbo.vw_car_count_fact (NOLOCK)     WHERE Row_Typ_Id = 516 and Dt_Dimn_Id  >=20100101      Group by car_dimn_id,car_ver,Dt_Dimn_Id,Attr_Id_1,Attr_Ver_1,Attr_Id_2,Attr_Ver_2,Row_Typ_Id, case when car_Cnt_Catg_Typ_id = 138 then 2 else 1 end     ) FISs     ) FIS    WHERE grp_nr = 2     )  f    left join ddsmrt.dbo.VMRT_Organization_Membership_Dimension mem on (f.Attr_Id_2 = mem.Org_Mbrshp_Dimn_Id and f.Attr_Ver_2 = mem.Org_Mbrshp_Ver)  left join ddsmrt.dbo.VMRT_Organization_Membership_Dimension mem2 on (f.Attr_Id_1 = mem2.Org_Mbrshp_Dimn_Id and f.Attr_Ver_1 = mem2.Org_Mbrshp_Ver)    ) f2"
    },
    {
      "id": "AR_FILTER_00005_626817295",
      "name": "AR_FILTER_00005_626817295",
      "type": "REPLICATION_FILTER_PROCEDURE",
      "sql": "create procedure [dbo].[AR_FILTER_00005_626817295] for replication as if exists (select * from [dbo].[Repair_Event_Cost_Fact_History] where (1=0)) return 1 else return 0"
    },
    {
      "id": "Revenue_Accounting_Actual_Car_Count",
      "name": "Revenue_Accounting_Actual_Car_Count",
      "type": "VIEW",
      "sql": "CREATE view [SV].[Revenue_Accounting_Actual_Car_Count] as    --Actual  select   Car_Dimn_Id  ,Car_Ver    ,Dt_Dimn_Id as Service_Month_Start_Dt_Dimn_Id  ,Car_Cnt_Catg_Typ_Id  ,Responsible_Road_Org_Mbrshp_Dimn_Id  ,Responsible_Road_Org_Mbrshp_Ver  ,liable_rd_mbrshp_dimn_id  ,liable_rd_mbrshp_ver  ,Liable_org_dimn_id  ,Liable_Org_Ver     ,(Cast([Car_Dimn_Id] AS VARCHAR) + '|' + Cast([Car_Ver] AS VARCHAR)) AS Car_ID     ,(Cast(liable_rd_mbrshp_dimn_id AS VARCHAr) + '|' + Cast(liable_rd_mbrshp_ver AS VARCHAR)) AS Liable_Road_ID     ,(Cast([Responsible_Road_Org_Mbrshp_Dimn_Id] AS VARCHAR) + '|' + Cast([Responsible_Road_Org_Mbrshp_Ver] AS VARCHAR)) AS Resp_Road_ID     ,(Cast([Liable_Org_Dimn_Id] AS VARCHAr) + '|' + Cast([Liable_Org_Ver] AS VARCHAR)) AS Liable_Dimn_ID     ,(Cast([Responsible_Org_Dimn_Id] AS VARCHAR) + '|' + Cast([Responsible_Org_Ver] AS VARCHAR)) AS Resp_Dimn_ID    ,Car_Cnt  ,TPE_Cnt  ,Ut_Cnt  ,Pltfm_Cnt    from (  select    f.car_dimn_id  ,f.car_ver  ,f.Dt_Dimn_Id  ,f.car_Cnt_Catg_Typ_id  ,f.Attr_Id_1  as Responsible_Road_Org_Mbrshp_Dimn_Id  ,f.Attr_Ver_1 as Responsible_Road_Org_Mbrshp_Ver  ,f.Attr_Id_2  as liable_rd_mbrshp_dimn_id  ,f.Attr_Ver_2 as liable_rd_mbrshp_ver  ,isnull(mem.Org_Dimn_Id,-1) as Liable_org_dimn_id  ,isnull(mem.org_ver    ,-1) as Liable_Org_Ver  ,isnull(mem2.Org_Dimn_Id,-1) as [Responsible_Org_Dimn_Id]  ,isnull(mem2.org_ver ,-1) as [Responsible_Org_Ver]  ,isnull(f.Car_Cnt ,0) as Car_Cnt  ,isnull(f.TPE_Cnt ,0) as TPE_Cnt  ,isnull(f.Ut_Cnt ,0) as Ut_Cnt  ,isnull(f.Pltfm_Cnt ,0) as Pltfm_Cnt    from (SELECT car_dimn_id     ,car_ver     ,Dt_Dimn_Id     ,car_Cnt_Catg_Typ_id     ,1 as grp_nr     ,Attr_Id_1     ,Attr_Ver_1     ,Attr_Id_2     ,Attr_Ver_2     ,Row_Typ_Id     ,sum(Car_Cnt   ) as Car_Cnt     ,sum(TPE_Cnt   ) as TPE_Cnt     ,sum(Ut_Cnt    ) as Ut_Cnt     ,sum(Pltfm_Cnt ) as Pltfm_Cnt     FROM ddsmrt.dbo.vw_car_count_fact (NOLOCK)     WHERE Row_Typ_Id = 517 and car_Cnt_Catg_Typ_id <> 138 and Dt_Dimn_Id >=20100101      Group by car_dimn_id,car_ver,Dt_Dimn_Id,car_Cnt_Catg_Typ_id,Attr_Id_1,Attr_Ver_1,Attr_Id_2,Attr_Ver_2,Row_Typ_Id     UNION      select * from (     select       car_dimn_id     ,car_ver     ,Dt_Dimn_Id     ,137 as car_Cnt_Catg_Typ_id     ,grp_nr     ,Attr_Id_1     ,Attr_Ver_1     ,Attr_Id_2     ,Attr_Ver_2     ,Row_Typ_Id     ,isnull(Car_Cnt-lag(Car_Cnt) over (partition by dt_dimn_id, car_dimn_id, car_ver, Attr_Id_2,Attr_Ver_2, Attr_Id_1,Attr_Ver_1 order by grp_nr), Car_Cnt) as Car_Cnt     ,isnull(TPE_Cnt-lag(TPE_Cnt) over (partition by dt_dimn_id, car_dimn_id, car_ver, Attr_Id_2,Attr_Ver_2, Attr_Id_1,Attr_Ver_1 order by grp_nr), TPE_Cnt) as TPE_Cnt     ,isnull(Ut_Cnt-lag(Ut_Cnt) over (partition by dt_dimn_id, car_dimn_id, car_ver, Attr_Id_2,Attr_Ver_2, Attr_Id_1,Attr_Ver_1 order by grp_nr), Ut_Cnt) as Ut_Cnt     ,isnull(Pltfm_Cnt-lag(Pltfm_Cnt) over (partition by dt_dimn_id, car_dimn_id, car_ver, Attr_Id_2,Attr_Ver_2, Attr_Id_1,Attr_Ver_1 order by grp_nr), Pltfm_Cnt) as Pltfm_Cnt     from (     SELECT car_dimn_id     ,car_ver     ,Dt_Dimn_Id     ,case when car_Cnt_Catg_Typ_id = 138 then 2 else 1 end as grp_nr     ,Attr_Id_1     ,Attr_Ver_1     ,Attr_Id_2     ,Attr_Ver_2     ,Row_Typ_Id     ,sum(Car_Cnt   ) as Car_Cnt     ,sum(TPE_Cnt   ) as TPE_Cnt     ,sum(Ut_Cnt    ) as Ut_Cnt     ,sum(Pltfm_Cnt ) as Pltfm_Cnt     FROM ddsmrt.dbo.vw_car_count_fact (NOLOCK)     WHERE Row_Typ_Id = 517 and Dt_Dimn_Id  >=20100101      Group by car_dimn_id,car_ver,Dt_Dimn_Id,Attr_Id_1,Attr_Ver_1,Attr_Id_2,Attr_Ver_2,Row_Typ_Id, case when car_Cnt_Catg_Typ_id = 138 then 2 else 1 end     ) FISs     ) FIS    WHERE grp_nr = 2     )  f    left join ddsmrt.dbo.VMRT_Organization_Membership_Dimension mem on (f.Attr_Id_2 = mem.Org_Mbrshp_Dimn_Id and f.Attr_Ver_2 = mem.Org_Mbrshp_Ver)  left join ddsmrt.dbo.VMRT_Organization_Membership_Dimension mem2 on (f.Attr_Id_1 = mem2.Org_Mbrshp_Dimn_Id and f.Attr_Ver_1 = mem2.Org_Mbrshp_Ver)    ) f2"
    },
    {
      "id": "Vast_Stat_Cd_Dimn",
      "name": "Vast_Stat_Cd_Dimn",
      "type": "VIEW",
      "sql": "CREATE VIEW [DDSV].[Vast_Stat_Cd_Dimn]  AS  SELECT   '-1_-1' Stat_Cd_Dimn_Id ,         '-1' Stat_Cd ,         '-1' Stat_Cd_Char ,  NULL Stat_Cd_Eff_Strt_Dt ,  NULL Stat_Cd_Eff_End_Dt ,  NULL Car_Init ,  NULL Car_Rpt_Mrk ,  NULL Car_Hrly_Rt ,  NULL Est_Car_Hrly_Rt ,  NULL Milg_Rt ,  NULL Est_Dy_Mile ,  NULL Eq_Featr_Shrt_Desc ,  NULL Eq_Typ_Shrt_Desc ,  NULL Bus_Ln_Shrt_Desc ,  NULL Flet_Typ ,  NULL Car_Cls ,  NULL Rack_Typ ,  NULL TPE_Fctr ,  0 Ut_Cnt ,     '1900-01-01' Crtd_Dt ,   '-1' Crtd_Id ,  NULL Lst_Upd_Dt ,  NULL Lst_Upd_Id   UNION ALL      SELECT  CONCAT(CONVERT(VARCHAR(10), [Hierchy_Id]), '_',                     CONVERT(VARCHAR(5), Hierchy_Ver)) AS [Stat_Cd_Dimn_Id] ,              ISNULL(CAST([Lvl4_Nm] AS INT), -1) AS [Stat_Cd] ,              CONVERT(CHAR(3), Lvl4_Nm) AS Stat_Cd_Char ,              CONVERT(DATETIME, [Attr5_Val_Char]) AS [Stat_Cd_Eff_Strt_Dt] ,              CONVERT(DATETIME, [Attr6_Val_Char]) AS [Stat_Cd_Eff_End_Dt] ,              CONVERT(CHAR(4), car.Car_Init) AS Car_Init ,              CONVERT(VARCHAR(20), Attr7_Val_Char) AS [Car_Rpt_Mrk] ,              CAST(ISNULL([Attr1_Val_Num], 0) AS DECIMAL(5, 2)) AS [Car_Hrly_Rt] ,              CAST(ISNULL([Attr2_Val_Num], 0) AS DECIMAL(5, 2)) AS [Est_Car_Hrly_Rt] ,              CAST(ISNULL([Attr4_Val_Num], 0) AS DECIMAL(5, 3)) AS [Milg_Rt] ,              CAST(ISNULL([Attr3_Val_Num], 0) AS DECIMAL(18, 1)) AS Est_Dy_Mile ,              CONVERT(VARCHAR(50), [Lvl3_Desc]) AS [Eq_Featr_Shrt_Desc] ,              CONVERT(VARCHAR(50), [Lvl2_Desc]) AS [Eq_Typ_Shrt_Desc] ,              CONVERT(VARCHAR(25), [Lvl1_Desc]) AS Bus_Ln_Shrt_Desc ,              CONVERT(VARCHAR(25), ( CASE WHEN CAST([Lvl4_Nm] AS INT) BETWEEN 1 AND 99                                          THEN 'Intermodal Cars'                                          WHEN CAST([Lvl4_Nm] AS INT) BETWEEN 100 AND 299                                          THEN 'General Use Cars'                                          WHEN CAST([Lvl4_Nm] AS INT) BETWEEN 300 AND 399                                          THEN 'Intermodal Cars'                                          WHEN CAST([Lvl4_Nm] AS INT) BETWEEN 400 AND 499                                          THEN 'Rack Cars'                                          WHEN CAST([Lvl4_Nm] AS INT) BETWEEN 500 AND 599                                          THEN 'General Use Cars'                                          WHEN CAST([Lvl4_Nm] AS INT) > 599                                          THEN 'Not Available'                                     END )) AS [Flet_Typ] ,              CONVERT(VARCHAR(50), Car_Cls) AS Car_Cls ,              CONVERT(VARCHAR(50), [Attr8_Val_Char]) AS [Rack_Typ] ,              CAST(ISNULL([Attr9_Val_Num], 1.0) AS NUMERIC(2, 1)) AS TPE_Fctr ,              ISNULL(car.Ut_Cnt, 1.0) AS Ut_Cnt ,              hier.Crtd_Dt ,              hier.Crtd_Id ,              hier.Lst_Upd_Dt ,              hier.Lst_Upd_Id      FROM    DDSMRT.dbo.[Hierarchy_Dim] (NOLOCK) hier              LEFT JOIN ( SELECT  TPE_Fctr ,                                  Ut_Cnt ,                                  Stat_Code ,                                  Entr_Hierchy_Id ,                            --      Entr_Hierchy_Ver ,                                  Car_Init ,                                  Car_Cls                          FROM    ( SELECT    ISNULL(TPE_Fctr, 1) AS TPE_Fctr ,                                              ISNULL(Ut_Cnt, 1) AS Ut_Cnt ,                                              COUNT(*) AS cnt ,                                              Stat_Code ,                                              Entr_Hierchy_Id ,                                           --   Entr_Hierchy_Ver ,                                              Car_Init ,                                              Car_Cls ,                                              ROW_NUMBER() OVER ( PARTITION BY Stat_Code,                                                                Entr_Hierchy_Id ORDER BY  COUNT(*) DESC, car_cls ) AS row_nr                   /** IR527842 Fix**/                                    FROM      DDSMRT.dbo.VMRT_Car_Dimension_Correct                                    WHERE   --  Car_Eff_To IS NULL                                            --  AND Car_Char_Eff_To IS NULL                                               Stat_Code IS NOT NULL                                              AND Ut_Cnt IS NOT NULL                                              AND TPE_Fctr IS NOT NULL                                    GROUP BY  Stat_Code ,                                              Entr_Hierchy_Id ,                                            --  Entr_Hierchy_Ver ,                                              TPE_Fctr ,                                              Ut_Cnt ,                                              Car_Init ,                                              Car_Cls                                  ) ta                          WHERE   row_nr = 1                        ) car ON ( hier.Hierchy_Id = car.Entr_Hierchy_Id )      WHERE   ( [Hierchy_Typ_Id] = 101              )"
    },
    {
      "id": "syncobj_0x3636304243434536",
      "name": "syncobj_0x3636304243434536",
      "type": "VIEW",
      "sql": "create view [dbo].[syncobj_0x3636304243434536]as select  [SPLC_Dimn_Id],[Geo_Dimn_Id],[Location],[SPLC],[SPLC_Nm],[SPLC_Long],[SPLC_Lat],[SPLC_Status],[Rule_260_Cd],[RDS_Loc_Cd],[Stn_Cd],[Crtd_Id],[Crtd_Dt],[Lst_Upd_Id],[Lst_Upd_Dt],[Src_Sys_Nm],[Dq_Flg]  from  [dbo].[SPLC_Dim]  where HAS_PERMS_BY_NAME('[dbo].[SPLC_Dim]', 'OBJECT', 'SELECT')= 1  and ((1=0))"
    },
    {
      "id": "VBilling_Summary_Fact",
      "name": "VBilling_Summary_Fact",
      "type": "VIEW",
      "sql": "CREATE VIEW [DDSV].[VBilling_Summary_Fact]   AS    SELECT [Mth_Dimn_Id]=Cast(left([Dt_Dimn_Id],6) as Int)         ,concat((Repr_Enty_Dimn_Id),'_',(Repr_Enty_Ver)) as Repr_Enty_Dimn_Id        ,[TTX_B_Cnt]        ,[TTX_V_Cnt]        ,[TTX_I_Cnt]        ,[TTX_M_Cnt]        ,[For_V]        ,[Rack_V]        ,[Std_Bill_Hrs]        ,[Labr_Cost]        ,[Crtd_Dt]        ,[Crtd_Id]        ,[Lst_Upd_Dt]        ,[Lst_Upd_Id]    FROM [DDSMRT].[dbo].[Billing_Summary_Fact] (NOLOCK)"
    },
    {
      "id": "Revenue_Accounting_Estimate_Car_Count",
      "name": "Revenue_Accounting_Estimate_Car_Count",
      "type": "VIEW",
      "sql": "CREATE view [SV].[Revenue_Accounting_Estimate_Car_Count] as    --Estimate  select   Car_Dimn_Id  ,Car_Ver    ,Dt_Dimn_Id as Snapshot_Dt_Dimn_Id  ,Car_Cnt_Catg_Typ_Id  ,Responsible_Road_Org_Mbrshp_Dimn_Id  ,Responsible_Road_Org_Mbrshp_Ver  ,liable_rd_mbrshp_dimn_id  ,liable_rd_mbrshp_ver  ,Liable_org_dimn_id  ,Liable_Org_Ver     ,(Cast([Car_Dimn_Id] AS VARCHAR) + '|' + Cast([Car_Ver] AS VARCHAR)) AS Car_ID     ,(Cast(liable_rd_mbrshp_dimn_id AS VARCHAr) + '|' + Cast(liable_rd_mbrshp_ver AS VARCHAR)) AS Liable_Road_ID     ,(Cast([Responsible_Road_Org_Mbrshp_Dimn_Id] AS VARCHAR) + '|' + Cast([Responsible_Road_Org_Mbrshp_Ver] AS VARCHAR)) AS Resp_Road_ID     ,(Cast([Liable_Org_Dimn_Id] AS VARCHAr) + '|' + Cast([Liable_Org_Ver] AS VARCHAR)) AS Liable_Dimn_ID     ,(Cast([Responsible_Org_Dimn_Id] AS VARCHAR) + '|' + Cast([Responsible_Org_Ver] AS VARCHAR)) AS Resp_Dimn_ID  ,crtd_dt  ,Car_Cnt  ,TPE_Cnt  ,Ut_Cnt  ,Pltfm_Cnt    from (  select    f.car_dimn_id  ,f.car_ver  ,f.Dt_Dimn_Id  ,f.car_Cnt_Catg_Typ_id  ,f.crtd_dt  ,f.Attr_Id_1  as Responsible_Road_Org_Mbrshp_Dimn_Id  ,f.Attr_Ver_1 as Responsible_Road_Org_Mbrshp_Ver  ,f.Attr_Id_2  as liable_rd_mbrshp_dimn_id  ,f.Attr_Ver_2 as liable_rd_mbrshp_ver  ,isnull(mem.Org_Dimn_Id,-1) as Liable_org_dimn_id  ,isnull(mem.org_ver    ,-1) as Liable_Org_Ver  ,isnull(mem2.Org_Dimn_Id,-1) as [Responsible_Org_Dimn_Id]  ,isnull(mem2.org_ver ,-1) as [Responsible_Org_Ver]  ,isnull(f.Car_Cnt ,0) as Car_Cnt  ,isnull(f.TPE_Cnt ,0) as TPE_Cnt  ,isnull(f.Ut_Cnt ,0) as Ut_Cnt  ,isnull(f.Pltfm_Cnt ,0) as Pltfm_Cnt    from (SELECT car_dimn_id     ,car_ver     ,Dt_Dimn_Id     ,car_Cnt_Catg_Typ_id     ,1 as grp_nr     ,Attr_Id_1     ,Attr_Ver_1     ,Attr_Id_2     ,Attr_Ver_2     ,Row_Typ_Id     ,min(crtd_Dt) as crtd_dt     ,sum(Car_Cnt   ) as Car_Cnt     ,sum(TPE_Cnt   ) as TPE_Cnt     ,sum(Ut_Cnt    ) as Ut_Cnt     ,sum(Pltfm_Cnt ) as Pltfm_Cnt     FROM ddsmrt.dbo.vw_car_count_fact (NOLOCK)     WHERE Row_Typ_Id = 515 and car_Cnt_Catg_Typ_id <> 138 and Dt_Dimn_Id >=20100101      Group by car_dimn_id,car_ver,Dt_Dimn_Id,car_Cnt_Catg_Typ_id,Attr_Id_1,Attr_Ver_1,Attr_Id_2,Attr_Ver_2,Row_Typ_Id     UNION      select * from (     select       car_dimn_id     ,car_ver     ,Dt_Dimn_Id     ,137 as car_Cnt_Catg_Typ_id     ,grp_nr     ,Attr_Id_1     ,Attr_Ver_1     ,Attr_Id_2     ,Attr_Ver_2     ,Row_Typ_Id     ,crtd_dt     ,isnull(Car_Cnt-lag(Car_Cnt) over (partition by dt_dimn_id, car_dimn_id, car_ver, Attr_Id_2,Attr_Ver_2, Attr_Id_1,Attr_Ver_1 order by grp_nr), Car_Cnt) as Car_Cnt     ,isnull(TPE_Cnt-lag(TPE_Cnt) over (partition by dt_dimn_id, car_dimn_id, car_ver, Attr_Id_2,Attr_Ver_2, Attr_Id_1,Attr_Ver_1 order by grp_nr), TPE_Cnt) as TPE_Cnt     ,isnull(Ut_Cnt-lag(Ut_Cnt) over (partition by dt_dimn_id, car_dimn_id, car_ver, Attr_Id_2,Attr_Ver_2, Attr_Id_1,Attr_Ver_1 order by grp_nr), Ut_Cnt) as Ut_Cnt     ,isnull(Pltfm_Cnt-lag(Pltfm_Cnt) over (partition by dt_dimn_id, car_dimn_id, car_ver, Attr_Id_2,Attr_Ver_2, Attr_Id_1,Attr_Ver_1 order by grp_nr), Pltfm_Cnt) as Pltfm_Cnt     from (     SELECT car_dimn_id     ,car_ver     ,Dt_Dimn_Id     ,case when car_Cnt_Catg_Typ_id = 138 then 2 else 1 end as grp_nr     ,Attr_Id_1     ,Attr_Ver_1     ,Attr_Id_2     ,Attr_Ver_2     ,Row_Typ_Id     ,min(crtd_Dt) as crtd_dt     ,sum(Car_Cnt   ) as Car_Cnt     ,sum(TPE_Cnt   ) as TPE_Cnt     ,sum(Ut_Cnt    ) as Ut_Cnt     ,sum(Pltfm_Cnt ) as Pltfm_Cnt     FROM ddsmrt.dbo.vw_car_count_fact (NOLOCK)     WHERE Row_Typ_Id = 515 and Dt_Dimn_Id  >=20100101      Group by car_dimn_id,car_ver,Dt_Dimn_Id,Attr_Id_1,Attr_Ver_1,Attr_Id_2,Attr_Ver_2,Row_Typ_Id, case when car_Cnt_Catg_Typ_id = 138 then 2 else 1 end     ) FISs     ) FIS    WHERE grp_nr = 2     )  f    left join ddsmrt.dbo.VMRT_Organization_Membership_Dimension mem on (f.Attr_Id_2 = mem.Org_Mbrshp_Dimn_Id and f.Attr_Ver_2 = mem.Org_Mbrshp_Ver)  left join ddsmrt.dbo.VMRT_Organization_Membership_Dimension mem2 on (f.Attr_Id_1 = mem2.Org_Mbrshp_Dimn_Id and f.Attr_Ver_1 = mem2.Org_Mbrshp_Ver)    ) f2"
    },
    {
      "id": "AR_FILTER_00005_2075154438",
      "name": "AR_FILTER_00005_2075154438",
      "type": "REPLICATION_FILTER_PROCEDURE",
      "sql": "create procedure [dbo].[AR_FILTER_00005_2075154438] for replication as if exists (select * from [dbo].[SPLC_Dim] where (1=0)) return 1 else return 0"
    },
    {
      "id": "VCar_Characteristics_Dim",
      "name": "VCar_Characteristics_Dim",
      "type": "VIEW",
      "sql": "CREATE VIEW [DDSV].[VCar_Characteristics_Dim]  AS SELECT    concat(convert(varchar(10),[Car_Char_Dimn_Id]),'_',convert(varchar(5), [Car_Char_Ver])) as [Car_Char_Dimn_Id]   --[Car_Char_Dimn_Id] [bigint] NOT NULL,   --[Car_Char_Ver] [int] NOT NULL,   ,concat(convert(varchar(10),char.Car_Dimn_Id),'_',convert(varchar(5), char.Car_Ver)) as Car_Dimn_Id   ,CONVERT(VARCHAR(14), char.Car_Init + REPLICATE('0',10 - LEN(CONVERT(VARCHAR(10), char.Car_Nr)))                  + CONVERT(VARCHAR(10), char.Car_Nr)) AS EDW_Car_Id   --[Car_Dimn_Id] [bigint] NOT NULL,   --[Car_Ver] [int] NOT NULL,  --   ,[Car_Init]   --     ,[Car_Nr]     ,car.[TTX_Eff_Dt] as [Eff_Dt_Car]     ,car.[Ownr_Mrk] as [Umler_Ownr_Cd]        ,char.[RIC_Car_Status] as RIC_Car_Stat     ,isnull(car.[Car_Status_Maximo], car.[Car_Status_UFD]) as [TTX_Car_Stat]     ,cast(NULL as varchar(254)) as [Car_Dsgn_Desc]     ,car.[Car_Cls] as [Car_Cls_Cd]     ,cast(NULL as varchar(10)) as [Car_Cntr_Amdt_Nr]     ,cast(NULL as varchar(20)) as [Cntr_Nr]     ,car.[Car_Ownrshp_Ind] as [Agr_Leas_Cd]     ,cast(NULL as int) as [Blkhd_Hgt]     ,cast(NULL as int) as [Blkhd_Wdth]        ,cast(char.[Umler_Blt_Dt] as smalldatetime) as [Blt_Dt]        ,char.[Blt_From_Use_Ast]        ,char.[Brk_Cd]     ,cast(NULL as [decimal](11, 0)) as [Pri_Car_Nr]     ,cast(NULL as [char](4)) as [Pri_Car_Init]        ,char.[Car_Cost_Est_Act]     ,hier.stat_Cd as [Car_Stat_Cd]     ,cast(null as [smalldatetime]) as  [Car_Wgt_Dt]     ,cast(null as [datetime]) as [Eff_Dt_Ttx_Char]      ,convert(char(4),char.[Eq_Bldr]) as [Eq_Bldr]        ,char.[Ldgr_Val]        ,char.[Lst_Shp_Dt]     ,cast(NULL as varchar(10)) as [Incr_Srvc_Life_Ind]     ,char.[Milg_Upd_Dt]     ,cast(NULL as int) as [Milg_When_Car_Blt]        ,char.[Orig_Car_Ownr]        ,char.[Orig_Cost]     ,char.[Pltfm_Fctr] as Pltfm_Cnt     ,cast(null as [smalldatetime]) as [Rck_Chng_Dt]        ,char.[Reblt_Dt]        ,char.[Scnd_Hand_Dt]        ,char.[Scnd_Lese]        ,char.[Seller_Orig_Cost]        ,char.[Setl_Val]        ,char.[Split_Or_Cmbnd_Invl_Ind]        ,char.[Wghg_Pty]        ,char.[Milg_Sinc_Lst_Cls_A_Rpr_Dt]        ,char.[Milg_Sinc_Lst_Cls_B_Rpr_Dt]        ,char.[Milg_Sinc_Lst_Cls_I_Rpr_Dt]        ,char.[Lst_Cls_A_Rpr_Dt]        ,char.[Lst_Cls_B_Rpr_Dt]        ,char.[Lst_Cls_I_Rpr_Dt]        ,char.[Num_Dy_Car_Can]        ,char.[Num_Dy_Car_Mex]     ,cast(null as char(1)) as [Pstv_Ngtv_Addn_Betr_Ind_Pre_91]      ,cast(null as [int]) as  [Addn_Betr_Val_Pre_91]       ,cast(null as [smalldatetime]) as  [Grndfthrd_Cert_Dt]     ,cast(null as [smalldatetime]) as [Hvy_Duty_Insp_Cert_Dt]        ,char.[Can_Mex_Dy_Lst_Updt_Dt]     ,cast(null as int) as [Milg_Pri_1964]      ,cast(null as char(2)) as [EWMA_Notc_ID]      ,char.[Blng_Extd_Srvc_Ind]     ,char.[Rub_Rail_Upd]     ,cast(null as varchar(10)) as [Frgn_Cc]        ,char.[Cert_Dt]        ,char.[Cert_Cd]     ,cast(null as varchar(10)) as [EWMA_Cd]        ,char.[Car_Grd]       ,cast(null as smalldatetime) as  [Car_Grd_Dt]     ,cast(null as smalldatetime) as  [Insp_Cert_Dt]     ,cast(null as datetime) as  [Eff_Dt_Mttx]        ,char.[Osid_Usa_Ind]        ,cast(char.[Axl_Cnt] as int) as [Axl_Cnt]        ,cast(char.[Ut_Cnt] as int ) as [Ut_Cnt]        ,char.[Insd_Len]        ,char.[Osid_Len]        ,char.[Eff_From] as [Char_Eff_Strt_Dt]        ,char.[Eff_To] as [Char_Eff_End_Dt]        ,char.[Crtd_Dt]        ,char.[Crtd_Id]        ,char.[Lst_Upd_Id]        ,char.[Lst_Upd_Dt]      FROM ddsmrt.[dbo].[Car_Characteristic_Dim] (NOLOCK) char    left join ddsmrt.dbo.car_dim_correct (NOLOCK) car on  (char.car_dimn_id = car.car_dimn_Id and char.car_ver = car.car_ver)    left join ddsmrt.dbo.vmrt_car_hierarchy_Enterprise hier on (car.entr_hierchy_Id = hier.hierchy_Id and car.entr_Hierchy_Ver = hier.hierchy_ver)"
    },
    {
      "id": "Revenue_Accounting_Car_Count",
      "name": "Revenue_Accounting_Car_Count",
      "type": "VIEW",
      "sql": "CREATE VIEW [SV].[Revenue_Accounting_Car_Count]  AS      -- ESTIMATE current month  select   [Car_Dimn_Id]        ,[Car_Ver]        ,cast(convert(varchar(8), (DATEADD(DAY, -( DAY(GETDATE()) - 1 ), GETDATE())),112) as int) as dt_dimn_id        ,[Car_Cnt_Catg_Typ_Id]        ,[Responsible_Road_Org_Mbrshp_Dimn_Id]        ,[Responsible_Road_Org_Mbrshp_Ver]        ,[liable_rd_mbrshp_dimn_id]        ,[liable_rd_mbrshp_ver]        ,[Liable_org_dimn_id]        ,[Liable_Org_Ver]        ,[Car_ID]        ,[Liable_Road_ID]        ,[Resp_Road_ID]        ,[Liable_Dimn_ID]        ,[Resp_Dimn_ID]      ,isnull(sum(Car_Cnt)/datediff(day, dateadd(day, 1-day(getdate()), getdate()),                dateadd(month, 1, dateadd(day, 1-day(getdate()), getdate())))   ,0) as Car_Cnt   -- sum/Number of days in currentmonth for avg      ,isnull(sum(TPE_Cnt)/datediff(day, dateadd(day, 1-day(getdate()), getdate()),                dateadd(month, 1, dateadd(day, 1-day(getdate()), getdate())))   ,0) as TPE_Cnt      ,isnull(sum(Ut_Cnt)/datediff(day, dateadd(day, 1-day(getdate()), getdate()),                dateadd(month, 1, dateadd(day, 1-day(getdate()), getdate())))   ,0) as Ut_Cnt      ,isnull(sum(Pltfm_Cnt)/datediff(day, dateadd(day, 1-day(getdate()), getdate()),                dateadd(month, 1, dateadd(day, 1-day(getdate()), getdate())))   ,0) as Pltfm_Cnt     ,'E' as Car_Count_Indicator    FROM [DDSMRT].[SV].[Revenue_Accounting_Estimate_Car_Count]     WHERE [Snapshot_Dt_Dimn_Id] >= cast(convert(varchar(8), (DATEADD(DAY, -( DAY(GETDATE()) - 1 ), GETDATE())),112) as int)    GROUP BY [Car_Dimn_Id]        ,[Car_Ver]        ,[Car_Cnt_Catg_Typ_Id]        ,[Responsible_Road_Org_Mbrshp_Dimn_Id]        ,[Responsible_Road_Org_Mbrshp_Ver]        ,[liable_rd_mbrshp_dimn_id]        ,[liable_rd_mbrshp_ver]        ,[Liable_org_dimn_id]        ,[Liable_Org_Ver]        ,[Car_ID]        ,[Liable_Road_ID]        ,[Resp_Road_ID]        ,[Liable_Dimn_ID]        ,[Resp_Dimn_ID]  union  -- ESTIMATE last month  select   [Car_Dimn_Id]        ,[Car_Ver]        ,cast(convert(varchar(8), ( DATEADD(month, DATEDIFF(month, 0, GETDATE())-1, 0)),112) as int) as dt_dimn_id        ,[Car_Cnt_Catg_Typ_Id]        ,[Responsible_Road_Org_Mbrshp_Dimn_Id]        ,[Responsible_Road_Org_Mbrshp_Ver]        ,[liable_rd_mbrshp_dimn_id]        ,[liable_rd_mbrshp_ver]        ,[Liable_org_dimn_id]        ,[Liable_Org_Ver]        ,[Car_ID]        ,[Liable_Road_ID]        ,[Resp_Road_ID]        ,[Liable_Dimn_ID]        ,[Resp_Dimn_ID]      ,isnull(sum(Car_Cnt)/datediff(day, DATEADD(month, DATEDIFF(month, 0, GETDATE())-1, 0),       dateadd(month, 1, DATEADD(month, DATEDIFF(month, 0, GETDATE())-1, 0)))  ,0) as Car_Cnt   -- sum/Number of days in lastmonth for avg      ,isnull(sum(TPE_Cnt)/datediff(day, DATEADD(month, DATEDIFF(month, 0, GETDATE())-1, 0),       dateadd(month, 1, DATEADD(month, DATEDIFF(month, 0, GETDATE())-1, 0)))  ,0) as TPE_Cnt      ,isnull(sum(Ut_Cnt)/datediff(day, DATEADD(month, DATEDIFF(month, 0, GETDATE())-1, 0),       dateadd(month, 1, DATEADD(month, DATEDIFF(month, 0, GETDATE())-1, 0)))  ,0) as Ut_Cnt      ,isnull(sum(Pltfm_Cnt)/datediff(day, DATEADD(month, DATEDIFF(month, 0, GETDATE())-1, 0),       dateadd(month, 1, DATEADD(month, DATEDIFF(month, 0, GETDATE())-1, 0)))  ,0) as Pltfm_Cnt     ,'E' as Car_Count_Indicator    FROM [DDSMRT].[SV].[Revenue_Accounting_Estimate_Car_Count]     WHERE [Snapshot_Dt_Dimn_Id] >= (select cast(convert(varchar(8),dateadd(mm,1, cast(cast(max(dt_dimn_id)as varchar) as date)),112) as int)  from ddsmrt.dbo.vw_car_count_fact where row_typ_id = 516)     and [Snapshot_Dt_Dimn_Id] < cast(convert(varchar(8), (DATEADD(DAY, -( DAY(GETDATE()) - 1 ), GETDATE())),112) as int)    GROUP BY [Car_Dimn_Id]        ,[Car_Ver]        ,[Car_Cnt_Catg_Typ_Id]        ,[Responsible_Road_Org_Mbrshp_Dimn_Id]        ,[Responsible_Road_Org_Mbrshp_Ver]        ,[liable_rd_mbrshp_dimn_id]        ,[liable_rd_mbrshp_ver]        ,[Liable_org_dimn_id]        ,[Liable_Org_Ver]        ,[Car_ID]        ,[Liable_Road_ID]        ,[Resp_Road_ID]        ,[Liable_Dimn_ID]        ,[Resp_Dimn_ID]  union  -- Accrual    SELECT [Car_Dimn_Id]        ,[Car_Ver]        ,[Service_Month_Start_Dt_Dimn_Id]        ,[Car_Cnt_Catg_Typ_Id]        ,[Responsible_Road_Org_Mbrshp_Dimn_Id]        ,[Responsible_Road_Org_Mbrshp_Ver]        ,[liable_rd_mbrshp_dimn_id]        ,[liable_rd_mbrshp_ver]        ,[Liable_org_dimn_id]        ,[Liable_Org_Ver]        ,[Car_ID]        ,[Liable_Road_ID]        ,[Resp_Road_ID]        ,[Liable_Dimn_ID]        ,[Resp_Dimn_ID]        ,[Car_Cnt]        ,[TPE_Cnt]        ,[Ut_Cnt]        ,[Pltfm_Cnt]     ,'R' as Car_Count_Indicator  From DDSMRT.[SV].[Revenue_Accounting_Accrual_Car_Count]  where [Service_Month_Start_Dt_Dimn_Id] > (select max(dt_dimn_id) from ddsmrt.dbo.vw_car_count_fact where row_typ_id = 517)    Union   -- Actuals  SELECT [Car_Dimn_Id]        ,[Car_Ver]        ,[Service_Month_Start_Dt_Dimn_Id]        ,[Car_Cnt_Catg_Typ_Id]        ,[Responsible_Road_Org_Mbrshp_Dimn_Id]        ,[Responsible_Road_Org_Mbrshp_Ver]        ,[liable_rd_mbrshp_dimn_id]        ,[liable_rd_mbrshp_ver]        ,[Liable_org_dimn_id]        ,[Liable_Org_Ver]        ,[Car_ID]        ,[Liable_Road_ID]        ,[Resp_Road_ID]        ,[Liable_Dimn_ID]        ,[Resp_Dimn_ID]        ,[Car_Cnt]        ,[TPE_Cnt]        ,[Ut_Cnt]        ,[Pltfm_Cnt]     ,'A' as Car_Count_Indicator  From DDSMRT.[SV].[Revenue_Accounting_Accrual_Car_Count]  where [Service_Month_Start_Dt_Dimn_Id] >= 20100101"
    },
    {
      "id": "syncobj_0x4132363143304343",
      "name": "syncobj_0x4132363143304343",
      "type": "VIEW",
      "sql": "create view [dbo].[syncobj_0x4132363143304343]as select  [Typ_Id],[Typ_Desc],[Typ_Grp],[Crtd_Id],[Crtd_Dt],[Lst_Upd_Id],[Lst_Upd_Dt]  from  [dbo].[Type_Lookup]  where HAS_PERMS_BY_NAME('[dbo].[Type_Lookup]', 'OBJECT', 'SELECT')= 1  and ((1=0))"
    },
    {
      "id": "Forecast_Planning",
      "name": "Forecast_Planning",
      "type": "VIEW",
      "sql": "CREATE VIEW [SV].[Forecast_Planning]    AS  SELECT   pf.Hierchy_Id,  isnull(Entr_Hierchy_Ver, pf.hierchy_Ver) as Hierchy_Ver,  car.car_dimn_id,  car.car_ver,  Dt_Dimn_Id,  Fcst_Bad_Ordr_Cnt AS Forecast_Bad_Order_Count,   Fcst_Bad_Ordr_Shop_Cnt AS Forecast_Bad_Order_Shop_Count,    Fcst_Car_Cnt    AS Forecast_Car_Count,  Fcst_Car_Cnt * TPE_Fctr  as Forecast_TPE_Count,  Fcst_Car_Cnt * car.Ut_Cnt  as Forecast_Unit_Count,  Fcst_Car_Cnt * Pltfm_Fctr as Forecast_Platform_Count,    Fcst_Enrt_To_Shop_Cnt AS Forecast_Enroute_To_Shop_Count,  Fcst_Inct_Pct AS Forecast_Inct_Pct,  Fcst_Car_hire_Rt AS Forecast_Car_Hire_Rate,  Fcst_Milg_Per_Day AS Forecast_Milage_Per_Day,  Fcst_Milg_Rt AS Forecast_Milage_Rate,  Fcst_Car_Hire_Inct_Amt AS Forecast_Car_Hire_Inct_Amount,  Fcst_Milg_Schg AS Forecast_Milage_Schg,  Fcst_On_Hand_Cnt AS Forecast_On_Hand_Count,  Fcst_Selct_Stor_Cnt AS Forecast_Select_Storage_Count,  Fcst_Srvc_Stor_Cnt AS Forecast_Service_Storage_Count,  Fcst_In_Srvc_Totl_Cnt / TPE_Fctr    AS Forecast_In_Service_Total_Count,  Fcst_In_Srvc_Totl_Cnt       as Forecast_In_Service_TPE_Count,  Fcst_In_Srvc_Totl_Cnt /TPE_Fctr * car.Ut_Cnt  as Forecast_In_Service_Unit_Count,  Fcst_In_Srvc_Totl_Cnt /TPE_Fctr * Pltfm_Fctr as Forecast_In_Service_Platform_Count,    Fcst_Out_Srvc_Totl_Cnt / TPE_Fctr AS Forecast_Out_Service_Total_Count,  Fcst_Out_Srvc_Totl_Cnt AS Forecast_Out_Service_TPE_Count,  (Fcst_Out_Srvc_Totl_Cnt /TPE_Fctr) * car.Ut_Cnt  as Forecast_Out_Service_Unit_Count,  (Fcst_Out_Srvc_Totl_Cnt /TPE_Fctr) * Pltfm_Fctr as Forecast_Out_Service_Platform_Count,    Pln_Bad_Ordr_Cnt AS Planning_Bad_Order_Count,  Pln_Bad_Ordr_Shop_Cnt AS Planning_Bad_Order_Shop_Count,    Pln_Car_Cnt     AS Planning_Car_Count,  Pln_Car_Cnt * TPE_Fctr  as Planning_TPE_Count,  Pln_Car_Cnt * car.Ut_Cnt  as Planning_Unit_Count,  Pln_Car_Cnt * Pltfm_Fctr as Planning_Platform_Count,    Pln_Enrt_To_Shop_Cnt AS Planning_Enroute_To_Shop_Count,  Pln_Inct_Pct AS Planning_Inct_Pct,  Pln_On_Hand_Cnt AS Planning_On_Hand_Count,  Pln_Selct_Stor_Cnt AS Planning_Select_Storage_Count,  Pln_Srvc_Stor_Cnt AS Planning_Service_Storage_Count,  Pln_Milg_Per_Day AS Planning_Milage_Per_Day,  Pln_Car_hire_Rt AS Planning_Car_Hire_Rate,  Pln_Car_Hire_Inct_Amt AS Planning_Car_Hire_Inct_Amt,  Pln_Milg_Rt AS Planning_Milage_Rate,  Pln_Milg_Schg AS Planning_Milg_Schg,    Pln_In_Srvc_Totl_Cnt / TPE_Fctr    AS Planning_In_Service_Total_Count,  Pln_In_Srvc_Totl_Cnt      as Planning_In_Service_TPE_Count,  Pln_In_Srvc_Totl_Cnt /Tpe_Fctr * car.Ut_Cnt  as Planning_In_Service_Unit_Count,  Pln_In_Srvc_Totl_Cnt /TPE_Fctr * Pltfm_Fctr  as Planning_In_Service_Platform_Count,    Pln_Out_Srvc_Totl_Cnt / TPE_Fctr  AS Planning_Out_Service_Total_Count,  Pln_Out_Srvc_Totl_Cnt AS Planning_Out_Service_TPE_Count,  (Pln_Out_Srvc_Totl_Cnt /Tpe_Fctr) * car.Ut_Cnt  as Planning_Out_Service_Unit_Count,  (Pln_Out_Srvc_Totl_Cnt /TPE_Fctr) * Pltfm_Fctr  as Planning_Out_Service_Platform_Count,    pf.Crtd_Dt,  pf.Crtd_Id,  pf.Lst_Upd_Dt,  pf.Lst_Upd_Id   FROM dbo.Tfin_Flet_Perf_Fcst_Pln_Fact (NOLOCK) pf     Left join (select t.Entr_hierchy_Id, t.Entr_Hierchy_Ver,  Ut_Cnt, Pltfm_Fctr, Stat_Code,t.Car_Dimn_ID,v.car_ver       from (        select Entr_hierchy_Id, Entr_Hierchy_Ver,Stat_Code, Ut_Cnt, Pltfm_Fctr,MAX(Car_Dimn_ID) Car_Dimn_ID         ,row_number() over(partition by Entr_hierchy_Id order by Entr_Hierchy_Ver desc, count(distinct car_dimn_Id) desc) as row_nr      from  ddsmrt.dbo.VMRT_Car_Dimension_Correct       where entr_hierchy_id <> -1 AND car_status_maximo = 'ACTIVE'      group by Entr_hierchy_Id ,Entr_Hierchy_Ver, Ut_Cnt,  Pltfm_Fctr, Stat_Code      ) t      JOIN (SELECT Car_Dimn_ID,entr_hierchy_id,Entr_Hierchy_Ver,MAX(car_ver) car_ver       from  ddsmrt.dbo.VMRT_Car_Dimension_Correct       where entr_hierchy_id <> -1 AND car_status_maximo = 'ACTIVE' GROUP BY Car_Dimn_ID,entr_hierchy_id,Entr_Hierchy_Ver) v        ON t.Car_Dimn_ID = v.car_dimn_id and t.entr_hierchy_id = v.entr_hierchy_id AND t.entr_hierchy_ver = v.entr_hierchy_ver      where row_nr =1 ) car   on (pf.Hierchy_Id = car.entr_hierchy_id ) --and pf.Hierchy_Ver = car.Entr_Hierchy_Ver     left join ddsmrt.dbo.VMRT_Car_Hierarchy_Enterprise dstat on (pf.Hierchy_Id = dstat.Hierchy_Id and pf.Hierchy_Ver=dstat.Hierchy_Ver)"
    },
    {
      "id": "AR_FILTER_00005_55671246",
      "name": "AR_FILTER_00005_55671246",
      "type": "REPLICATION_FILTER_PROCEDURE",
      "sql": "create procedure [dbo].[AR_FILTER_00005_55671246] for replication as if exists (select * from [dbo].[Type_Lookup] where (1=0)) return 1 else return 0"
    },
    {
      "id": "VCar_Location_Dim",
      "name": "VCar_Location_Dim",
      "type": "VIEW",
      "sql": "create view [DDSV].[VCar_Location_Dim] as  SELECT [Car_Loc_Dimn_Id]        ,[On_Car_Loc_Cd]        ,[Axl_Loc_Cd]        ,[Trk_Loc_Cd]        ,[Crtd_Dt]        ,[Crtd_Id]        ,[Lst_Upd_Dt]        ,[Lst_Upd_Id]    FROM [ddsmrt].[dbo].[Car_Location_Dim] (NOLOCK)"
    },
    {
      "id": "syncobj_0x4539363033464338",
      "name": "syncobj_0x4539363033464338",
      "type": "VIEW",
      "sql": "create view [dbo].[syncobj_0x4539363033464338]as select  [Wrk_Typ_Dimn_Id],[Wrk_Typ_Lvl_1_Desc],[Wrk_Typ_Lvl_2_Desc],[Cond_Based_Mnt_Flg],[Crtd_Dt],[Crtd_Id],[Lst_Upd_Dt],[Lst_Upd_Id]  from  [dbo].[Work_Type_Dim]  where HAS_PERMS_BY_NAME('[dbo].[Work_Type_Dim]', 'OBJECT', 'SELECT')= 1  and ((1=0))"
    },
    {
      "id": "VCondition_Code_Dim",
      "name": "VCondition_Code_Dim",
      "type": "VIEW",
      "sql": "create view [DDSV].[VCondition_Code_Dim] as  SELECT  cast(Cond_Cd_Dimn_Id as int) as [Cnd_Cd_Dimn_Id]        ,cast(ccd.[Cnd_Cd] as varchar(5)) as [Cnd_Cd]        ,cast(Cnd_Cd_Desc as varchar(50)) as [Cnd_Desc]        ,cast(trr.[Matl_Ref_Prc_Ind] as char(1)) as [Matl_Ref_Prc_Ind]        ,cast(trr.[Std_Job_Cd_Ind] as char(1)) as [Std_Job_Cd_Ind]        ,cast(trr.[Var_Job_Cd_Ind] as char(1)) as [Var_Job_Cd_Ind]        ,[Crtd_Dt]        ,cast([Crtd_Id] as char(8)) as [Crtd_Id]        ,[Lst_Upd_Dt]        ,cast([Lst_Upd_Id] as char(8)) as [Lst_Upd_Id]    FROM VMRT_Condition_Code_Dimension as ccd    left join hdsast.dbo.Trr_Cnd (NOLOCK) as trr    on ccd.[Cnd_Cd] = cast(trr.cnd_cd as varchar(5))"
    },
    {
      "id": "VMRT_UFD_Act_Car_Milg_Fact",
      "name": "VMRT_UFD_Act_Car_Milg_Fact",
      "type": "VIEW",
      "sql": "CREATE VIEW dbo.VMRT_UFD_Act_Car_Milg_Fact AS  select   svc_mth, car_init, car_nr, business_line, equipment_type,   coalesce(org_memb.org_abrv,org_memb_cur.org_abrv) org_abrv,   coalesce(org_memb.road_hun_pct_stmt_part_ind, org_memb_cur.road_hun_pct_stmt_part_ind) road_hun_pct_stmt_part_ind,   coalesce(org_memb.road_ownrshp_ind,org_memb_cur.road_ownrshp_ind) road_ownrshp_ind,    coalesce(org_memb.signatory_road_ind, org_memb_cur.signatory_road_ind) signatory_road_ind  ,sum(UFD_Tot_Mile) UFD_Tot_Mile, sum(UFD_Emp_Mile) UFD_Emp_Mile, sum(UFD_Load_Mile) UFD_Load_Mile  ,sum(Act_Totl_Mile) Act_Totl_Mile, sum(Act_Emp_Mile) Act_Emp_Mile, sum(Act_Load_Mile) Act_Load_Mile  ,sum(Diff_Totl_Mile) Diff_Totl_Mile , sum(Diff_Emp_Mile) Diff_Emp_Mile, sum(Diff_Load_Mile) Diff_Load_Mile  from  (select coalesce(ufd.svc_mth, act.dt) svc_mth,   coalesce(act.car_dimn_id, ufd.car_dimn_id) car_dimn_id, coalesce(act.car_ver, ufd.car_ver) car_ver,  coalesce(ufd.resp_rd_org_dimn_id, act.rpt_rd_dimn_id) rd_dimn_id,  coalesce( ufd.resp_rd_org_ver, act.rpt_rd_ver) rd_ver,  ufd.tot_mile UFD_Tot_Mile, ufd.emp_mile UFD_Emp_Mile, ufd.load_mile UFD_Load_Mile,   act.totl_mile Act_Totl_Mile, act.emp_mile Act_Emp_Mile, act.load_mile Act_Load_Mile,  coalesce(act.totl_mile,0) - coalesce(ufd.tot_mile,0) Diff_Totl_Mile,   coalesce(act.emp_mile,0) - coalesce(ufd.emp_mile,0) Diff_Emp_Mile,   coalesce(act.load_mile,0) - coalesce(ufd.load_mile,0) Diff_Load_Mile  FROM    (select ufd.car_dimn_id, ufd.car_ver, ufd.Resp_Rd_Org_Dimn_Id, ufd.Resp_Rd_Org_Ver, ufd.svc_mth,  sum(ufd.tot_mile) tot_mile, sum(ufd.emp_mile) emp_mile, sum(ufd.load_mile) load_mile  from ddsmrt.dbo.vw_UFD_Milg_Fact_All UFD   group by ufd.car_dimn_id, ufd.car_ver, ufd.Resp_Rd_Org_Dimn_Id, ufd.Resp_Rd_Org_Ver, ufd.svc_mth) UFD  full outer join    (select act.car_dimn_id, act.car_ver, dt.dt, act.rpt_rd_dimn_id, act.rpt_rd_ver,  sum(load_mile) load_mile, sum(emp_mile) emp_mile, sum(totl_mile) totl_mile   from ddsmrt.dbo.vmrt_actual_mileage act  inner join ddsmrt.dbo.vmrt_car_dimension_correct car on car.car_dimn_id = act.car_dimn_id and car.car_ver = act.car_ver  inner join ddsmrt.dbo.date_dim dt on dt.dt_dimn_id = act.svc_mth_dimn_id  group by act.car_dimn_id, act.car_ver, dt.dt, act.rpt_rd_dimn_id, act.rpt_rd_ver) act  on act.car_dimn_id= ufd.car_dimn_id and act.car_ver = ufd.car_ver and act.dt = ufd.svc_mth    and act.rpt_rd_dimn_id= ufd.resp_rd_org_dimn_id and act.rpt_rd_ver = ufd.resp_rd_org_ver  ) ufd_act_car_milg  inner join ddsmrt.dbo.vmrt_car_dimension_correct car on car.car_dimn_id =ufd_act_car_milg.car_dimn_id and car.car_ver = ufd_act_car_milg.car_ver  left join ddsmrt.dbo.vmrt_organization_membership_dimension org_memb on    ufd_act_car_milg.rd_dimn_id = org_memb.org_dimn_id and ufd_act_car_milg.rd_ver = org_memb.org_ver    and (org_memb.orgmemb_eff_from <= svc_mth and (org_memb.orgmemb_eff_to is null or org_memb.orgmemb_eff_to > svc_mth))  left join ddsmrt.dbo.vmrt_organization_membership_dimension org_memb_cur on    ufd_act_car_milg.rd_dimn_id = org_memb_cur.org_dimn_id and ufd_act_car_milg.rd_ver = org_memb_cur.org_ver    and org_memb_cur.orgmemb_eff_to is null   where svc_mth >= '2016-01-01'   group by svc_mth, car_init, car_nr, business_line, equipment_type,   org_memb.org_abrv, org_memb.road_hun_pct_stmt_part_ind, org_memb.road_ownrshp_ind, org_memb.signatory_road_ind,  org_memb_cur.org_abrv, org_memb_cur.road_hun_pct_stmt_part_ind, org_memb_cur.road_ownrshp_ind, org_memb_cur.signatory_road_ind"
    },
    {
      "id": "AR_FILTER_00005_438292621",
      "name": "AR_FILTER_00005_438292621",
      "type": "REPLICATION_FILTER_PROCEDURE",
      "sql": "create procedure [dbo].[AR_FILTER_00005_438292621] for replication as if exists (select * from [dbo].[Work_Type_Dim] where (1=0)) return 1 else return 0"
    },
    {
      "id": "VMRT_UFD_Mileage",
      "name": "VMRT_UFD_Mileage",
      "type": "VIEW",
      "sql": "CREATE VIEW dbo.VMRT_UFD_Mileage as   select    UFD_Milg_Fact_Id,   milg.Car_Init,   milg.Car_Nbr ,   car.Business_Line ,   car.Equipment_Type ,    car.Equipment_Feature ,    car.Stat_Code ,    Milg.Svc_Mth ,   Milg.Load_Mile ,   Milg.Load_Unit_Mile ,   Milg.Load_TPE_Mile ,   Milg.Load_Pltfm_Mile ,   Milg.Emp_Mile ,   Milg.Emp_Unit_Mile ,   Milg.Emp_TPE_Mile ,   Milg.Emp_Pltfm_Mile ,   Milg.Tot_Mile ,   Milg.Tot_Unit_Mile ,   Milg.Tot_TPE_Mile ,   Milg.Tot_Pltfm_Mile ,   Milg.Car_Dimn_Id ,   Milg.Car_Ver ,   Milg.Resp_Rd_Org_Dimn_Id ,   Milg.Resp_Rd_Org_Ver ,   Milg.Svc_Mth_Dimn_Id ,   Milg.Crtd_Id ,   Milg.Crtd_Dt,   Milg.Lst_Upd_Id ,   Milg.Lst_Upd_Dt ,   Milg.Src_Sys_Nm,   Milg.Dq_Flg     from ddsmrt.dbo.vw_ufd_milg_fact_all milg   INNER JOIN ddsmrt.dbo.vmrt_car_dimension_correct car     on car.car_dimn_id = milg.car_dimn_id and car.car_ver = milg.car_ver        --select count(*) from ddsmrt.dbo.vmrt_car_mileage"
    },
    {
      "id": "vw_Trip_Fact",
      "name": "vw_Trip_Fact",
      "type": "VIEW",
      "sql": "CREATE VIEW [dbo].[vw_Trip_Fact]  AS  SELECT [Trip_Fact_Id]        ,[Car_Dimn_Id]        ,[Car_Ver]        ,[STCC_Dimn_Id]        ,[Trip_Orig_Org_Dimn_Id]        ,[Trip_Orig_Org_Ver]        ,[Trip_Dest_Org_Dimn_Id]        ,[Trip_Dest_Org_Ver]        ,[Trip_Orig_Resp_Road_Org_Dimn_Id]        ,[Trip_Orig_Resp_Road_Org_Ver]        ,[Trip_Orig_Poss_Road_Org_Dimn_Id]        ,[Trip_Orig_Poss_Road_Org_Ver]        ,[Trip_Orig_Lst_Parti_Road_Org_Dimn_Id]        ,[Trip_Orig_Lst_Parti_Road_Org_Ver]        ,[Trip_Dest_Resp_Road_Org_Dimn_Id]        ,[Trip_Dest_Resp_Road_Org_Ver]        ,[Trip_Dest_Poss_Road_Org_Dimn_Id]        ,[Trip_Dest_Poss_Road_Org_Ver]        ,[Trip_Dest_Lst_Parti_Road_Org_Dimn_Id]        ,[Trip_Dest_Lst_Parti_Road_Org_Ver]        ,[Trip_Orig_Parti_Shpr_Org_Dimn_Id]        ,[Trip_Orig_Parti_Shpr_Org_Ver]        ,[Trip_Dest_Parti_Shpr_Org_Dimn_Id]        ,[Trip_Dest_Parti_Shpr_Org_Ver]        ,[Trip_Begin_Dt_Dimn_Id]        ,[Trip_End_Dt_Dimn_Id]        ,[Trip]        ,[Railcar]        ,[STCC]        ,[Origin_Loc]        ,[Origin_Enty]        ,[Dest_Loc]        ,[Dest_Enty]        ,[Trip_Begin_Dt]        ,[Trip_End_Dt]        ,[Trip_Status]        ,[Trip_Typ]        ,[Current_Trip_Seg]        ,[Trip_Catg]        ,[Trip_Orig_Resp_Road]        ,[Trip_Dest_Resp_Road]        ,[Trip_Orig_Poss_Road]        ,[Trip_Dest_Poss_Road]        ,[Trip_Orig_Lst_Parti_Road]        ,[Trip_Dest_Lst_Parti_Road]        ,[Trip_Orig_Parti_Shpr_Enty]        ,[Trip_Dest_Parti_Shpr_Enty]        ,[Directive]        ,[Force_New_Trip]        ,[Crtd_Id]        ,[Crtd_Dt]        ,[Lst_Upd_Id]        ,[Lst_Upd_Dt]        ,[Src_Sys_Nm]        ,[Dq_Flg]        ,[Dlet_Flg]    FROM [DDSMRT].[dbo].[Trip_Fact]"
    },
    {
      "id": "VCycles_Fact",
      "name": "VCycles_Fact",
      "type": "VIEW",
      "sql": "CREATE VIEW [DDSV].[VCycles_Fact] AS  SELECT     cast(A.Cycle_Begin_Dt_Dimn_Id as INT) as Cyc_Beg_Dt_Dimn_Id ,  cast(A.Cycle_End_Dt_Dimn_Id as INT) as Cyc_End_Dt_Dimn_Id ,  cast(F.SPLC_Dimn_Id as INT) as Orig_Geo_Dimn_Id ,  cast(G.SPLC_Dimn_Id as INT) as Dest_Geo_Dimn_Id ,  concat(convert(varchar(10),A.Car_Dimn_Id),'_',convert(varchar(5), A.Car_Ver)) as Car_Dimn_Id,  concat(convert(varchar(10),A.Cycle_Shpr_Org_Dimn_Id),'_',convert(varchar(5), A.Cycle_Shpr_Org_Ver)) as Ship_Enty_Dimn_Id ,  concat(convert(varchar(10),B.Cycle_Seg_Road_Seg_Lst_Parti_Road_Org_Dimn_Id),'_',convert(varchar(5), B.Cycle_Seg_Road_Seg_Lst_Parti_Road_Org_Ver)) as Lst_Part_Rd_Dimn_Id ,  A.Cycle as Cycle ,  A.Railcar as Railcar ,  cast(E.Car_Nr as [decimal](11, 0)) as Car_Nr ,  E.Car_Init ,  A.Cycle_End_Dt as End_Dt ,  A.Cycle_Shpr as Shipper ,  A.Orig_Loc_Ld as Orig_Loc_Load ,  A.Dest_Loc_Ld as Dest_Loc_Load ,  cast(H.org_abrv as char(4)) as Lst_Part_RR_Entity ,  cast(A.Cycle_Calc_Milg_Empt as decimal(15,2)) as Calc_Emp_Mil ,  cast(A.Cycle_Calc_Milg_Ld as decimal(15,2)) as Calc_Ld_Mil ,  A.Cycle_Calc_Dura_Empt as Calc_Emp_Dur ,  A.Cycle_Calc_Dura_Ld as Calc_Ld_Dur ,  A.Invalid_Rsn  as Inv_Rsn ,  Is_Valid_Ind,  RecMod_Dt_Id,  A.Crtd_Id as Crtd_Id ,  A.Crtd_Dt as Crtd_Dt ,  A.Lst_Upd_Id as Lst_Upd_Id ,  A.Lst_Upd_Dt  Lst_Upd_Dt   from  (SELECT  Cycle_Fact_Id,  Cycle_Begin_Dt_Dimn_Id,  Cycle_End_Dt_Dimn_Id,  Car_Dimn_Id, Car_Ver,  Cycle_Shpr_Org_Dimn_Id, Cycle_Shpr_Org_Ver,  Cycle ,  Railcar ,  Cycle_End_Dt,  Cycle_Shpr,  Orig_Loc_Ld,  Dest_Loc_Ld,  Cycle_Calc_Milg_Empt,  Cycle_Calc_Milg_Ld,  Cycle_Calc_Dura_Empt,  Cycle_Calc_Dura_Ld,  cycle_typ,  Invalid_Rsn,  cast((case when Invalid_Rsn is NULL then 'Y' else 'N' end) as char(1)) as Is_Valid_Ind,  cast(NULL as int) as RecMod_Dt_Id,  Crtd_Id ,  Crtd_Dt ,  Lst_Upd_Id ,  Lst_Upd_Dt from  ddsmrt.dbo.vw_Cycle_Fact_All (NOLOCK)  where cycle_typ = 'SH' and Dlet_Flg = 0 and Cycle_End_Dt_Dimn_Id >= 20100101 ) A  left join ( select Cycle_Fact_Id       , Cycle_Seg_Fact_Id       , row_number() OVER ( partition by Cycle_Fact_Id  ORDER BY [Cycle_Seg_Order] desc) AS Row_ID     from  ddsmrt.dbo.vw_Cycle_Seg_Fact_All (NOLOCK) ) C  on A.Cycle_Fact_Id = C.Cycle_Fact_Id  left join ( select Cycle_Seg_Fact_Id       , Cycle_Seg_Road_Seg_Lst_Parti_Road_Org_Dimn_Id       , Cycle_Seg_Road_Seg_Lst_Parti_Road_Org_Ver       , row_number() OVER ( partition by Cycle_Seg_Fact_Id  ORDER BY [Cycle_Seg_Road_Seg_Order] desc) AS Row_ID     from ddsmrt.dbo.vw_cycle_seg_road_seg_fact_All (NOLOCK)) B on C.Cycle_Seg_Fact_Id = B.Cycle_Seg_Fact_Id  /** IR527842 Fix **/  left join ddsmrt.dbo.Car_Dim_Correct  (NOLOCK) E on A.Car_Dimn_Id = E.Car_Dimn_Id and A.Car_Ver = E.Car_Ver  left join ddsmrt.dbo.SPLC_Dim (NOLOCK) F on A.Orig_Loc_Ld = F.location   left join ddsmrt.dbo.SPLC_Dim (NOLOCK) G on A.Dest_Loc_Ld = G.Location  left join (select * from ddsmrt.dbo.VMRT_Organization_Dimension where eff_to is null) H on B.Cycle_Seg_Road_Seg_Lst_Parti_Road_Org_Dimn_Id = H.Org_Dimn_Id    where  (c.row_id = 1 or c.Row_ID is null) and (b.row_id = 1 or b.Row_ID is null)"
    },
    {
      "id": "vw_Trip_Fact_History",
      "name": "vw_Trip_Fact_History",
      "type": "VIEW",
      "sql": "CREATE VIEW [dbo].[vw_Trip_Fact_History]  AS  SELECT [Trip_Fact_Id]        ,[Car_Dimn_Id]        ,[Car_Ver]        ,[STCC_Dimn_Id]        ,[Trip_Orig_Org_Dimn_Id]        ,[Trip_Orig_Org_Ver]        ,[Trip_Dest_Org_Dimn_Id]        ,[Trip_Dest_Org_Ver]        ,[Trip_Orig_Resp_Road_Org_Dimn_Id]        ,[Trip_Orig_Resp_Road_Org_Ver]        ,[Trip_Orig_Poss_Road_Org_Dimn_Id]        ,[Trip_Orig_Poss_Road_Org_Ver]        ,[Trip_Orig_Lst_Parti_Road_Org_Dimn_Id]        ,[Trip_Orig_Lst_Parti_Road_Org_Ver]        ,[Trip_Dest_Resp_Road_Org_Dimn_Id]        ,[Trip_Dest_Resp_Road_Org_Ver]        ,[Trip_Dest_Poss_Road_Org_Dimn_Id]        ,[Trip_Dest_Poss_Road_Org_Ver]        ,[Trip_Dest_Lst_Parti_Road_Org_Dimn_Id]        ,[Trip_Dest_Lst_Parti_Road_Org_Ver]        ,[Trip_Orig_Parti_Shpr_Org_Dimn_Id]        ,[Trip_Orig_Parti_Shpr_Org_Ver]        ,[Trip_Dest_Parti_Shpr_Org_Dimn_Id]        ,[Trip_Dest_Parti_Shpr_Org_Ver]        ,[Trip_Begin_Dt_Dimn_Id]        ,[Trip_End_Dt_Dimn_Id]        ,[Trip]        ,[Railcar]        ,[STCC]        ,[Origin_Loc]        ,[Origin_Enty]        ,[Dest_Loc]        ,[Dest_Enty]        ,[Trip_Begin_Dt]        ,[Trip_End_Dt]        ,[Trip_Status]        ,[Trip_Typ]        ,[Current_Trip_Seg]        ,[Trip_Catg]        ,[Trip_Orig_Resp_Road]        ,[Trip_Dest_Resp_Road]        ,[Trip_Orig_Poss_Road]        ,[Trip_Dest_Poss_Road]        ,[Trip_Orig_Lst_Parti_Road]        ,[Trip_Dest_Lst_Parti_Road]        ,[Trip_Orig_Parti_Shpr_Enty]        ,[Trip_Dest_Parti_Shpr_Enty]        ,[Directive]        ,[Force_New_Trip]        ,[Crtd_Id]        ,[Crtd_Dt]        ,[Lst_Upd_Id]        ,[Lst_Upd_Dt]        ,[Src_Sys_Nm]        ,[Dq_Flg]        ,[Dlet_Flg]    FROM [DDSMRT].[dbo].[Trip_Fact_History]"
    },
    {
      "id": "VDistribution_Entity_Dim",
      "name": "VDistribution_Entity_Dim",
      "type": "VIEW",
      "sql": "create view [DDSV].[VDistribution_Entity_Dim] as  SELECT concat(convert(varchar(10),Dist_Enty_Dimn_Id),'_',convert(varchar(5), Dist_Enty_Ver)) as Dist_Enty_Dimn_Id        ,concat(convert(varchar(10),dist.Org_Dimn_Id),'_',convert(varchar(5), dist.Org_Ver)) as Dist_Enty_Org_Dimn_Id     ,dist.[Dist_Enty] as Dist_Enty_Cd     ,convert(varchar(15), typ.Typ_Desc) as Dis_Typ_Desc     ,org.Org_Abrv as Dist_Enty_Abrv     ,org.Org_Nm as dist_enty_Nm          ,[Apl_To_Trip_Ind]        ,[SCT_Ent_Ind]        ,[TTX_Aprv_Ind]     , 1 as [TTX_Mbr_Ind]        ,[Ld_Typ]        ,[Act_Sts_Ind]        ,dist.[Crtd_Id]        ,dist.[Crtd_Dt]        ,dist.[Lst_Upd_Id]        ,dist.[Lst_Upd_Dt]      FROM [ddsmrt].[dbo].[Distribution_Entity_Dim] (NOLOCK) dist    left join ddsmrt.dbo.Organization_Dim (NOLOCK) org on (dist.Org_Dimn_Id = org.Org_Dimn_Id and dist.Org_Ver = org.Org_Ver)    left join ddsmrt.dbo.organization_type_lookup (NOLOCK) lkp    on lkp.org_dimn_id=dist.org_dimn_id and dist.org_ver=org.org_ver    left join ddsmrt.dbo.type_lookup (NOLOCK) typ    on lkp.org_typ_id=typ.typ_id    where (lkp.src_sys_nm='BD-PTY' and lkp.org_typ_id=105) or lkp.src_sys_nm='BD-DIS' or lkp.src_sys_nm is null"
    },
    {
      "id": "vw_Trip_Fact_All",
      "name": "vw_Trip_Fact_All",
      "type": "VIEW",
      "sql": "CREATE VIEW [dbo].[vw_Trip_Fact_All]  AS    SELECT [Trip_Fact_Id]        ,[Car_Dimn_Id]        ,[Car_Ver]        ,[STCC_Dimn_Id]        ,[Trip_Orig_Org_Dimn_Id]        ,[Trip_Orig_Org_Ver]        ,[Trip_Dest_Org_Dimn_Id]        ,[Trip_Dest_Org_Ver]        ,[Trip_Orig_Resp_Road_Org_Dimn_Id]        ,[Trip_Orig_Resp_Road_Org_Ver]        ,[Trip_Orig_Poss_Road_Org_Dimn_Id]        ,[Trip_Orig_Poss_Road_Org_Ver]        ,[Trip_Orig_Lst_Parti_Road_Org_Dimn_Id]        ,[Trip_Orig_Lst_Parti_Road_Org_Ver]        ,[Trip_Dest_Resp_Road_Org_Dimn_Id]        ,[Trip_Dest_Resp_Road_Org_Ver]        ,[Trip_Dest_Poss_Road_Org_Dimn_Id]        ,[Trip_Dest_Poss_Road_Org_Ver]        ,[Trip_Dest_Lst_Parti_Road_Org_Dimn_Id]        ,[Trip_Dest_Lst_Parti_Road_Org_Ver]        ,[Trip_Orig_Parti_Shpr_Org_Dimn_Id]        ,[Trip_Orig_Parti_Shpr_Org_Ver]        ,[Trip_Dest_Parti_Shpr_Org_Dimn_Id]        ,[Trip_Dest_Parti_Shpr_Org_Ver]        ,[Trip_Begin_Dt_Dimn_Id]        ,[Trip_End_Dt_Dimn_Id]        ,[Trip]        ,[Railcar]        ,[STCC]        ,[Origin_Loc]        ,[Origin_Enty]        ,[Dest_Loc]        ,[Dest_Enty]        ,[Trip_Begin_Dt]        ,[Trip_End_Dt]        ,[Trip_Status]        ,[Trip_Typ]        ,[Current_Trip_Seg]        ,[Trip_Catg]        ,[Trip_Orig_Resp_Road]        ,[Trip_Dest_Resp_Road]        ,[Trip_Orig_Poss_Road]        ,[Trip_Dest_Poss_Road]        ,[Trip_Orig_Lst_Parti_Road]        ,[Trip_Dest_Lst_Parti_Road]        ,[Trip_Orig_Parti_Shpr_Enty]        ,[Trip_Dest_Parti_Shpr_Enty]        ,[Directive]        ,[Force_New_Trip]        ,[Crtd_Id]        ,[Crtd_Dt]        ,[Lst_Upd_Id]        ,[Lst_Upd_Dt]        ,[Src_Sys_Nm]        ,[Dq_Flg]        ,[Dlet_Flg]    FROM [DDSMRT].[dbo].[Trip_Fact]      UNION ALL    SELECT [Trip_Fact_Id]        ,[Car_Dimn_Id]        ,[Car_Ver]        ,[STCC_Dimn_Id]        ,[Trip_Orig_Org_Dimn_Id]        ,[Trip_Orig_Org_Ver]        ,[Trip_Dest_Org_Dimn_Id]        ,[Trip_Dest_Org_Ver]        ,[Trip_Orig_Resp_Road_Org_Dimn_Id]        ,[Trip_Orig_Resp_Road_Org_Ver]        ,[Trip_Orig_Poss_Road_Org_Dimn_Id]        ,[Trip_Orig_Poss_Road_Org_Ver]        ,[Trip_Orig_Lst_Parti_Road_Org_Dimn_Id]        ,[Trip_Orig_Lst_Parti_Road_Org_Ver]        ,[Trip_Dest_Resp_Road_Org_Dimn_Id]        ,[Trip_Dest_Resp_Road_Org_Ver]        ,[Trip_Dest_Poss_Road_Org_Dimn_Id]        ,[Trip_Dest_Poss_Road_Org_Ver]        ,[Trip_Dest_Lst_Parti_Road_Org_Dimn_Id]        ,[Trip_Dest_Lst_Parti_Road_Org_Ver]        ,[Trip_Orig_Parti_Shpr_Org_Dimn_Id]        ,[Trip_Orig_Parti_Shpr_Org_Ver]        ,[Trip_Dest_Parti_Shpr_Org_Dimn_Id]        ,[Trip_Dest_Parti_Shpr_Org_Ver]        ,[Trip_Begin_Dt_Dimn_Id]        ,[Trip_End_Dt_Dimn_Id]        ,[Trip]        ,[Railcar]        ,[STCC]        ,[Origin_Loc]        ,[Origin_Enty]        ,[Dest_Loc]        ,[Dest_Enty]        ,[Trip_Begin_Dt]        ,[Trip_End_Dt]        ,[Trip_Status]        ,[Trip_Typ]        ,[Current_Trip_Seg]        ,[Trip_Catg]        ,[Trip_Orig_Resp_Road]        ,[Trip_Dest_Resp_Road]        ,[Trip_Orig_Poss_Road]        ,[Trip_Dest_Poss_Road]        ,[Trip_Orig_Lst_Parti_Road]        ,[Trip_Dest_Lst_Parti_Road]        ,[Trip_Orig_Parti_Shpr_Enty]        ,[Trip_Dest_Parti_Shpr_Enty]        ,[Directive]        ,[Force_New_Trip]        ,[Crtd_Id]        ,[Crtd_Dt]        ,[Lst_Upd_Id]        ,[Lst_Upd_Dt]        ,[Src_Sys_Nm]        ,[Dq_Flg]        ,[Dlet_Flg]    FROM [DDSMRT].[dbo].[Trip_Fact_History]"
    },
    {
      "id": "VDistribution_Instructions_Fact",
      "name": "VDistribution_Instructions_Fact",
      "type": "VIEW",
      "sql": "CREATE VIEW [DDSV].[VDistribution_Instructions_Fact]    AS    SELECT   CAST([Dt_Dimn_Id] as int) Dt_Dimn_Id,   concat(convert(varchar(10),[From_Part_Dist_Enty_Dimn_Id]),'_',convert(varchar(5), [From_Part_Dist_Enty_Ver])) as [From_Part_Dist_Enty_Dimn_Id] ,   concat(convert(varchar(10),[To_Part_Dist_Enty_Dimn_Id]),'_',convert(varchar(5), [To_Part_Dist_Enty_Ver])) as [To_Part_Dist_Enty_Dimn_Id] ,   concat(convert(varchar(10),Car_Dimn_Id),'_',convert(varchar(5), Car_Ver)) as [Car_Dimn_Id] ,   [Flet_Seg] ,   [Dist_Instr_Cd] ,   [Act_Stat] ,   [Fulfillment_Stat] ,   [Delv_Emp_Cnt] ,   [Delv_Ld_Cnt] ,   [DI_Req_Cnt] ,   [Sev_Typ_Cd]  ,   [Crtd_Dt] ,   [Crtd_Id] ,   [Lst_Upd_Dt] ,   [Lst_Upd_Id]   FROM ddsmrt.dbo.[Distribution_Instructions_Fact] (NOLOCK)"
    },
    {
      "id": "vw_Trip_Segment_Fact",
      "name": "vw_Trip_Segment_Fact",
      "type": "VIEW",
      "sql": "CREATE VIEW [dbo].[vw_Trip_Segment_Fact]  AS   SELECT [Trip_Seg_Fact_Id]        ,[Trip_Fact_Id]        ,[Car_Dimn_Id]        ,[Car_Ver]        ,[Trip_Seg_Poss_Road_Org_Dimn_Id]        ,[Trip_Seg_Lst_Parti_Road_Org_Dimn_Id]        ,[Trip_Seg_Resp_Road_Org_Dimn_Id]        ,[Trip_Seg_Poss_Road_Org_Ver]        ,[Trip_Seg_Lst_Parti_Road_Org_Ver]        ,[Trip_Seg_Resp_Road_Org_Ver]        ,[Trip_Seg_Begin_SPLC_Dimn_Id]        ,[Trip_Seg_End_SPLC_Dimn_Id]        ,[Trip_Seg_End_Dt_Dimn_Id]        ,[Trip_Seg_Begin_Dt_Dimn_Id]        ,[Trip_Seg]        ,[Trip]        ,[Trip_Seg_Order]        ,[Trip_Seg_Typ]        ,[Trip_Seg_Status]        ,[Begin_Loc]        ,[Trip_Seg_Begin_Dt]        ,[End_Loc]        ,[Trip_Seg_End_Dt]        ,[Trip_Seg_Poss_Road]        ,[Trip_Seg_Resp_Road]        ,[Trip_Seg_Lst_Parti_Road]        ,[Trip_Seg_Milg]        ,[Trip_Seg_Dura]        ,[Scnd_Trip_Seg_Status]        ,[Crtd_Id]        ,[Crtd_Dt]        ,[Lst_Upd_Id]        ,[Lst_Upd_Dt]        ,[Src_Sys_Nm]        ,[Dq_Flg]    FROM [DDSMRT].[dbo].[Trip_Segment_Fact]"
    },
    {
      "id": "VFacility_KPI_Plan_Dim",
      "name": "VFacility_KPI_Plan_Dim",
      "type": "VIEW",
      "sql": "create view [DDSV].[VFacility_KPI_Plan_Dim] as  SELECT  [Fac_KPI_Pln_Id]        ,[Pln_Nm]        ,[Pln_Ver]        ,[Pln_Yr]        ,[Pln_Mth]        ,[Fac_Curr_Abrv]    FROM [ddsmrt].[dbo].[Facility_KPI_Plan_Dim] (NOLOCK)"
    },
    {
      "id": "vw_Trip_Segment_Fact_History",
      "name": "vw_Trip_Segment_Fact_History",
      "type": "VIEW",
      "sql": "CREATE VIEW [dbo].[vw_Trip_Segment_Fact_History]  AS   SELECT [Trip_Seg_Fact_Id]        ,[Trip_Fact_Id]        ,[Car_Dimn_Id]        ,[Car_Ver]        ,[Trip_Seg_Poss_Road_Org_Dimn_Id]        ,[Trip_Seg_Lst_Parti_Road_Org_Dimn_Id]        ,[Trip_Seg_Resp_Road_Org_Dimn_Id]        ,[Trip_Seg_Poss_Road_Org_Ver]        ,[Trip_Seg_Lst_Parti_Road_Org_Ver]        ,[Trip_Seg_Resp_Road_Org_Ver]        ,[Trip_Seg_Begin_SPLC_Dimn_Id]        ,[Trip_Seg_End_SPLC_Dimn_Id]        ,[Trip_Seg_End_Dt_Dimn_Id]        ,[Trip_Seg_Begin_Dt_Dimn_Id]        ,[Trip_Seg]        ,[Trip]        ,[Trip_Seg_Order]        ,[Trip_Seg_Typ]        ,[Trip_Seg_Status]        ,[Begin_Loc]        ,[Trip_Seg_Begin_Dt]        ,[End_Loc]        ,[Trip_Seg_End_Dt]        ,[Trip_Seg_Poss_Road]        ,[Trip_Seg_Resp_Road]        ,[Trip_Seg_Lst_Parti_Road]        ,[Trip_Seg_Milg]        ,[Trip_Seg_Dura]        ,[Scnd_Trip_Seg_Status]        ,[Crtd_Id]        ,[Crtd_Dt]        ,[Lst_Upd_Id]        ,[Lst_Upd_Dt]        ,[Src_Sys_Nm]        ,[Dq_Flg]    FROM [DDSMRT].[dbo].[Trip_Segment_Fact_History]"
    },
    {
      "id": "VAST_STAT_LOOKUP_FOR_SSIS_DT",
      "name": "VAST_STAT_LOOKUP_FOR_SSIS_DT",
      "type": "VIEW",
      "sql": "CREATE view [dbo].[VAST_STAT_LOOKUP_FOR_SSIS_DT]  AS  SELECT [Stat_Cd_Dimn_Id]        ,[Stat_Cd]        ,dt_dimn_id         FROM [ddsstg].[dbo].[Tast_Stat_Cd]        where dt_dimn_id > 20080100    and dt_dimn_id < convert(char(8),getdate(),112) + 20000"
    },
    {
      "id": "VFacility_KPI_Target_Fact",
      "name": "VFacility_KPI_Target_Fact",
      "type": "VIEW",
      "sql": "CREATE VIEW [DDSV].[VFacility_KPI_Target_Fact]  AS    SELECT       concat(convert (varchar(10),Repr_Enty_Dimn_Id),'_',convert(varchar(5),Repr_Enty_Ver)) as Repr_Enty_Dimn_Id     ,[Fac_KPI_Pln_Id]        ,[Mth_Dimn_Id]=Cast(left([Dt_Dimn_Id],6) as Int)        ,[Mth_Insp_Cnt_Trgt]        ,[Mth_Insp_Hrs_Trgt]        ,[Car_Insp_Hrs_Trgt]        ,[Repr_Hrs_Pct_Trgt]        ,[Mth_Brake_Tst_Hrs_Trgt]        ,[Car_Brake_Tst_Hrs_Trgt]        ,[Tot_Bill_Hrs_Trgt]        ,[Tot_LO_Cst_Trgt]        ,[Est_Bill_CPH_Trgt]        ,[Head_Cnt_Trgt]        ,[Other_Hrs_Pct_Trgt]        ,[Repr_Effy_Trgt]        ,[Tot_Worked_Hrs]        ,[Tot_Other_Hrs]        ,[IBT_Effy_Trgt]        ,[Supv_Head_cnt_Trgt]        ,[Paid_Absences_Trgt]        ,[Overtime_Hrs_Trgt]        ,[Tot_Lbr_Effy_Trgt]        ,[Tot_Repr_Hrs_Trgt]        ,[Crtd_Dt]        ,[Crtd_Id]        ,[Lst_Upd_Dt]        ,[Lst_Upd_Id]    FROM [DDSMRT].[dbo].Facility_KPI_Target_Fact (NOLOCK)"
    },
    {
      "id": "vw_Trip_Segment_Fact_All",
      "name": "vw_Trip_Segment_Fact_All",
      "type": "VIEW",
      "sql": "CREATE VIEW [dbo].[vw_Trip_Segment_Fact_All]  AS  SELECT [Trip_Seg_Fact_Id]        ,[Trip_Fact_Id]        ,[Car_Dimn_Id]        ,[Car_Ver]        ,[Trip_Seg_Poss_Road_Org_Dimn_Id]        ,[Trip_Seg_Lst_Parti_Road_Org_Dimn_Id]        ,[Trip_Seg_Resp_Road_Org_Dimn_Id]        ,[Trip_Seg_Poss_Road_Org_Ver]        ,[Trip_Seg_Lst_Parti_Road_Org_Ver]        ,[Trip_Seg_Resp_Road_Org_Ver]        ,[Trip_Seg_Begin_SPLC_Dimn_Id]        ,[Trip_Seg_End_SPLC_Dimn_Id]        ,[Trip_Seg_End_Dt_Dimn_Id]        ,[Trip_Seg_Begin_Dt_Dimn_Id]        ,[Trip_Seg]        ,[Trip]        ,[Trip_Seg_Order]        ,[Trip_Seg_Typ]        ,[Trip_Seg_Status]        ,[Begin_Loc]        ,[Trip_Seg_Begin_Dt]        ,[End_Loc]        ,[Trip_Seg_End_Dt]        ,[Trip_Seg_Poss_Road]        ,[Trip_Seg_Resp_Road]        ,[Trip_Seg_Lst_Parti_Road]        ,[Trip_Seg_Milg]        ,[Trip_Seg_Dura]        ,[Scnd_Trip_Seg_Status]        ,[Crtd_Id]        ,[Crtd_Dt]        ,[Lst_Upd_Id]        ,[Lst_Upd_Dt]        ,[Src_Sys_Nm]        ,[Dq_Flg]    FROM [DDSMRT].[dbo].[Trip_Segment_Fact]    UNION ALL    SELECT [Trip_Seg_Fact_Id]        ,[Trip_Fact_Id]        ,[Car_Dimn_Id]        ,[Car_Ver]        ,[Trip_Seg_Poss_Road_Org_Dimn_Id]        ,[Trip_Seg_Lst_Parti_Road_Org_Dimn_Id]        ,[Trip_Seg_Resp_Road_Org_Dimn_Id]        ,[Trip_Seg_Poss_Road_Org_Ver]        ,[Trip_Seg_Lst_Parti_Road_Org_Ver]        ,[Trip_Seg_Resp_Road_Org_Ver]        ,[Trip_Seg_Begin_SPLC_Dimn_Id]        ,[Trip_Seg_End_SPLC_Dimn_Id]        ,[Trip_Seg_End_Dt_Dimn_Id]        ,[Trip_Seg_Begin_Dt_Dimn_Id]        ,[Trip_Seg]        ,[Trip]        ,[Trip_Seg_Order]        ,[Trip_Seg_Typ]        ,[Trip_Seg_Status]        ,[Begin_Loc]        ,[Trip_Seg_Begin_Dt]        ,[End_Loc]        ,[Trip_Seg_End_Dt]        ,[Trip_Seg_Poss_Road]        ,[Trip_Seg_Resp_Road]        ,[Trip_Seg_Lst_Parti_Road]        ,[Trip_Seg_Milg]        ,[Trip_Seg_Dura]        ,[Scnd_Trip_Seg_Status]        ,[Crtd_Id]        ,[Crtd_Dt]        ,[Lst_Upd_Id]        ,[Lst_Upd_Dt]        ,[Src_Sys_Nm]        ,[Dq_Flg]    FROM [DDSMRT].[dbo].[Trip_Segment_Fact_History]"
    },
    {
      "id": "Vfin_Flet_Perf_Car_Milg_Car_Cnt_Fact",
      "name": "Vfin_Flet_Perf_Car_Milg_Car_Cnt_Fact",
      "type": "VIEW",
      "sql": "CREATE view [DDSV].[Vfin_Flet_Perf_Car_Milg_Car_Cnt_Fact] as  SELECT           case when op_car_cnt.Attr_Id_1 is null then '-1_-1'        else concat(convert(varchar(10),op_car_cnt.Attr_Id_1),'_',convert(varchar(5), op_car_cnt.Attr_Ver_1))         end as Lst_Part_Rd_Dimn_Id                              ,case when op_car_cnt.Attr_Id_3 is null then '-1_-1'              else concat(convert(varchar(10),op_car_cnt.Attr_Id_3),'_',convert(varchar(5), op_car_cnt.Attr_Ver_3))                end as Rpt_Rd_Dimn_Id                  --, case when op_car_cnt.Org_Abrv IN ('BNSF', 'CN', 'CPRS', 'CSXT', 'FXE', 'KCS', 'KCSM','NS', 'ST', 'UP') then cast(Org_Dimn_Id as int)              --  else -1              --  end as Mbr_Rd_Dimn_Id              --, case when org.Org_Abrv IN ('BNSF', 'CN', 'CPRS', 'CSXT', 'FXE', 'KCS', 'KCSM','NS', 'ST', 'UP') then Org_Ver              --  else -1              --  end as Mbr_Rd_Ver                ,cast(op_car_cnt.Dt_Dimn_Id as int) as Dt_Dimn_Id                  ,case when car.Entr_Hierchy_Id is null then '-1_-1'              else concat(convert(varchar(10),car.Entr_Hierchy_Id),'_',convert(varchar(5), car.Entr_Hierchy_Ver))                end as Stat_Cd_Dimn_Id                ,case when op_car_cnt.Attr_Id_2 is null then '-1_-1'              else concat(convert(varchar(10),op_car_cnt.Attr_Id_2),'_',convert(varchar(5), op_car_cnt.Attr_Ver_2))                end as Curr_Part_Rd_Dimn_Id                            ,case when Car_cnt_Catg_Typ_id = 149 and convert(char(1),op_car_cnt.Attr_Val_Char_4) = 'L' then 1 else 0 end as Load_Cnt              ,case when Car_cnt_Catg_Typ_id = 149 and convert(char(1),op_car_cnt.Attr_Val_Char_4) = 'E' then 1 else 0 end as Emp_Cnt              ,case when Car_cnt_Catg_Typ_id = 149 and convert(char(1),op_car_cnt.Attr_Val_Char_4) = 'U' then 1 else 0 end as LE_Unknown_Cnt              ,case when Car_cnt_Catg_Typ_id = 149 then 1 else 0 end as LE_Totl_Cnt                ,cast(car.Pltfm_Fctr as numeric(18,1)) as [Pltfm_Per_Car_Cnt]        --    ,cast(car.Pltfm_Fctr as numeric(18,1)) as [Car_Pltfm_Cnt_Fctr]              ,cast(car.TPE_Fctr as numeric(18,1)) as [TPE_Per_Car_Cnt]              --,cast(car.TPE_Fctr as numeric(18,1)) as [TPE_Fctr]                                        ,case when car.Business_Line = 'Intermodal' then ISNULL(tpe_fctr, 1.0) else 1.0 end as tpe_fctr                                      ,case when car.Business_Line = 'Intermodal' then ISNULL(TPE_Fctr * 2, 1.0)  else 1.0 end as Car_Pltfm_Cnt_Fctr            --car cnt            , cast(case Car_cnt_Catg_Typ_id when 128 then op_car_cnt.car_cnt else 0 end as int) As Cars_Enrt_Cnt               -- Enroute_Car_Cnt               , cast(case Car_cnt_Catg_Typ_id when 131 then op_car_cnt.car_cnt else 0 end as int) as Cars_Pd_Stor_Cnt         --In_Paid_Storage_Car_Cnt              , cast(case Car_cnt_Catg_Typ_id when 136 then op_car_cnt.car_cnt else 0 end as int) as Cars_Stor_Cnt                  -- In_Repair_Entity_Car_Cnt              , cast(case Car_cnt_Catg_Typ_id when 132 then op_car_cnt.car_cnt else 0 end as int) as Cars_In_Shop_Cnt         -- On_Railroad_Relief_Car_Cnt              , cast(case when Car_cnt_Catg_Typ_id = 149 and convert(char(1),op_car_cnt.Attr_Val_Char_5) in ('Y','N') then op_car_cnt.car_cnt else 0 end as int) as Cars_Onln_Cnt         --Total_Car_Cnt                  , op_car_cnt.Crtd_Dt  as Crtd_Dt              , op_car_cnt.Crtd_Id  as Crtd_Id              , op_car_cnt.Lst_Upd_Dt  as Lst_Upd_Dt              , op_car_cnt.Lst_Upd_Id  as Lst_Upd_Id                                FROM          (select * from  ddsmrt.dbo.vw_car_count_fact_All  (NOLOCK)        where row_typ_id=518        ) op_car_cnt -- Operational    --left join [dbo].[VMRT_Organization_Dimension] org on (op_car_cnt.Attr_Id_1 = org.org_dimn_id and op_car_cnt.Attr_Ver_1 = org.org_ver)    left join (select car_dimn_id,car_ver,tpe_Fctr,Pltfm_Fctr,Entr_Hierchy_Id,Entr_Hierchy_Ver, Business_Line                from ddsmrt.dbo.VMRT_Car_Dimension_correct) car on (op_car_cnt.Car_Dimn_Id = car.Car_dimn_id and op_car_cnt.Car_Ver = car.car_ver)"
    },
    {
      "id": "VMRT_Trip_Fact_History",
      "name": "VMRT_Trip_Fact_History",
      "type": "VIEW",
      "sql": "CREATE view [dbo].[VMRT_Trip_Fact_History] as   SELECT      Trip.[Trip_Fact_Id]  ,Trip.[Car_Dimn_Id]  ,Trip.[Car_Ver]  ,Trip.[STCC_Dimn_Id]  ,Trip.[Trip_Orig_Org_Dimn_Id]  ,Trip.[Trip_Orig_Org_Ver]  ,Trip.[Trip_Dest_Org_Dimn_Id]  ,Trip.[Trip_Dest_Org_Ver]  ,isnull(SPLC1.SPLC_Dimn_Id, -1) as Trip_Orig_SPLC_Dimn_Id  ,isnull(SPLC2.SPLC_Dimn_Id, -1) as Trip_Dest_SPLC_Dimn_Id  ,Trip.[Trip_Orig_Resp_Road_Org_Dimn_Id]  ,Trip.[Trip_Orig_Resp_Road_Org_Ver]  ,Trip.[Trip_Orig_Poss_Road_Org_Dimn_Id]  ,Trip.[Trip_Orig_Poss_Road_Org_Ver]  ,Trip.[Trip_Orig_Lst_Parti_Road_Org_Dimn_Id]  ,Trip.[Trip_Orig_Lst_Parti_Road_Org_Ver]  ,Trip.[Trip_Dest_Resp_Road_Org_Dimn_Id]  ,Trip.[Trip_Dest_Resp_Road_Org_Ver]  ,Trip.[Trip_Dest_Poss_Road_Org_Dimn_Id]  ,Trip.[Trip_Dest_Poss_Road_Org_Ver]  ,Trip.[Trip_Dest_Lst_Parti_Road_Org_Dimn_Id]  ,Trip.[Trip_Dest_Lst_Parti_Road_Org_Ver]  ,Trip.[Trip_Orig_Parti_Shpr_Org_Dimn_Id]  ,Trip.[Trip_Orig_Parti_Shpr_Org_Ver]  ,Trip.[Trip_Dest_Parti_Shpr_Org_Dimn_Id]  ,Trip.[Trip_Dest_Parti_Shpr_Org_Ver]  ,Trip.[Trip_Begin_Dt_Dimn_Id]  ,Trip.[Trip_End_Dt_Dimn_Id]  ,Trip.[Trip]  ,Trip.[Railcar]  ,Trip.[STCC]  ,Trip.[Origin_Loc]  ,Trip.[Origin_Enty]  ,Trip.[Dest_Loc]  ,Trip.[Dest_Enty]  ,Trip.[Trip_Begin_Dt]  ,Trip.[Trip_End_Dt]  ,Trip.[Trip_Status]  ,Trip.[Trip_Typ]  ,Trip.[Current_Trip_Seg]  ,Trip.[Trip_Catg]  ,Trip.[Trip_Orig_Resp_Road]  ,Trip.[Trip_Dest_Resp_Road]  ,Trip.[Trip_Orig_Poss_Road]  ,Trip.[Trip_Dest_Poss_Road]  ,Trip.[Trip_Orig_Lst_Parti_Road]  ,Trip.[Trip_Dest_Lst_Parti_Road]  ,Trip.[Trip_Orig_Parti_Shpr_Enty]  ,Trip.[Trip_Dest_Parti_Shpr_Enty]  ,Trip.[Directive]  ,Trip.[Force_New_Trip]  ,Trip.[Crtd_Id]  ,Trip.[Crtd_Dt]  ,Trip.[Lst_Upd_Id]  ,Trip.[Lst_Upd_Dt]  ,Trip.[Src_Sys_Nm]  ,Trip.[Dq_Flg]  ,trip.Dlet_Flg  FROM [DDSMRT].[dbo].[vw_Trip_Fact_History] (NOLOCK) trip  LEFT JOIN DDSMRT.dbo.SPLC_Dim  (NOLOCK) SPLC1 on (trip.[Origin_Loc] = SPLC1.Location)  LEFT JOIN DDSMRT.dbo.SPLC_Dim  (NOLOCK) SPLC2 on (trip.[Dest_Loc] = SPLC2.Location)   where trip.Dlet_Flg is NULL"
    },
    {
      "id": "Vfin_Flet_Perf_Car_Milg_Car_Cnt_Snpsht_Fact",
      "name": "Vfin_Flet_Perf_Car_Milg_Car_Cnt_Snpsht_Fact",
      "type": "VIEW",
      "sql": "create view [DDSV].[Vfin_Flet_Perf_Car_Milg_Car_Cnt_Snpsht_Fact] as  SELECT [Dt_Dimn_Id]          , concat(convert(varchar(10),[Hierchy_Id] ),'_', convert(varchar(5), [Hierchy_Ver]))     as [Stat_Cd_Dimn_Id]        ,[Emp_Cnt]        ,[Load_Cnt]        ,[LE_Unknown_Cnt]        ,[LE_Totl_Cnt]        ,[Pltfm_Per_Car_Cnt]        ,[TPE_Per_Car_Cnt]        ,[TPE_Fctr]        ,[Car_Pltfm_Cnt_Fctr]        ,[Cars_Onln_Cnt]        ,[Cars_Stor_Cnt]        ,[Cars_Pd_Stor_Cnt]        ,[Cars_In_Shop_Cnt]        ,[Cars_Enrt_Cnt]        ,[Car_Hire_Rev]        ,[Crtd_Dt]        ,[Crtd_Id]        ,[Lst_Upd_Dt]        ,[Lst_Upd_Id]      FROM [ddsmrt].[dbo].[Tfin_Flet_Perf_Car_Milg_Car_Cnt_Snpsht_Fact] (NOLOCK)    where [Hierchy_Id] is not Null and [Hierchy_Id] <> -1"
    },
    {
      "id": "VMRT_Trip_Seg_Fact_History",
      "name": "VMRT_Trip_Seg_Fact_History",
      "type": "VIEW",
      "sql": "CREATE VIEW [dbo].[VMRT_Trip_Seg_Fact_History] as   SELECT [Trip_Seg_Fact_Id]        ,[Trip_Fact_Id]        ,[Car_Dimn_Id]        ,[Car_Ver]        ,[Trip_Seg_Poss_Road_Org_Dimn_Id]        ,[Trip_Seg_Lst_Parti_Road_Org_Dimn_Id]        ,[Trip_Seg_Resp_Road_Org_Dimn_Id]        ,[Trip_Seg_Poss_Road_Org_Ver]        ,[Trip_Seg_Lst_Parti_Road_Org_Ver]        ,[Trip_Seg_Resp_Road_Org_Ver]        ,[Trip_Seg_Begin_SPLC_Dimn_Id]        ,[Trip_Seg_End_SPLC_Dimn_Id]        ,[Trip_Seg_End_Dt_Dimn_Id]        ,[Trip_Seg_Begin_Dt_Dimn_Id]        ,[Trip_Seg]        ,[Trip]        ,[Trip_Seg_Order]        ,[Trip_Seg_Typ]        ,[Trip_Seg_Status]        ,[Begin_Loc]        ,[Trip_Seg_Begin_Dt]        ,[End_Loc]        ,[Trip_Seg_End_Dt]        ,[Trip_Seg_Poss_Road]        ,[Trip_Seg_Resp_Road]        ,[Trip_Seg_Lst_Parti_Road]        ,[Trip_Seg_Milg]        ,[Trip_Seg_Dura]        ,[Scnd_Trip_Seg_Status]        ,[Crtd_Id]        ,[Crtd_Dt]        ,[Lst_Upd_Id]        ,[Lst_Upd_Dt]        ,[Src_Sys_Nm]        ,[Dq_Flg]    FROM [DDSMRT].[dbo].[vw_Trip_Segment_Fact_History] (NOLOCK)"
    },
    {
      "id": "Vfin_Flet_Perf_Car_Milg_Rev_Fact",
      "name": "Vfin_Flet_Perf_Car_Milg_Rev_Fact",
      "type": "VIEW",
      "sql": "create view [DDSV].[Vfin_Flet_Perf_Car_Milg_Rev_Fact] as  SELECT concat(convert(varchar(10),[Hierchy_Id] ),'_', convert(varchar(5), [Hierchy_Ver]))     as [Stat_Cd_Dimn_Id]        ,CONVERT(int,substring(convert(varchar(8),[Svc_Mth_Dt_Dimn_Id]),1,6)) as [Svc_Mth_Dimn_Id]        ,CONVERT(int,substring(convert(varchar(8),[Rpt_Mth_Dt_Dimn_Id]),1,6)) as [Rpt_Mth_Dimn_Id]        ,concat(convert(varchar(10),[Org_Mbrshp_Dimn_Id] ),'_', convert(varchar(5), [Org_Mbrshp_Ver]))    as [Rd_Mbrshp_Dimn_Id]        ,[Inct_Typ]        ,[Car_Hrs]        ,[Car_Hire_Rev]        ,[Load_Mile]        ,[Emp_Mile]        ,[Milg_Rev]        ,[Ernd_Mlg_Amt]        ,[Inct_Amt]        ,[TPE_Car_Hrs]        ,[TPE_Load_Mile]        ,[TPE_Emp_Mile]     ,[Pnlty_Amt]        ,[Crtd_Dt]        ,[Crtd_Id]        ,[Lst_Upd_Dt]        ,[Lst_Upd_Id]        FROM [ddsmrt].[dbo].[Tfin_Flet_Perf_Car_Milg_Rev_Fact] (NOLOCK)"
    },
    {
      "id": "VMRT_TTX_Loaded_Trip_Starts_History",
      "name": "VMRT_TTX_Loaded_Trip_Starts_History",
      "type": "VIEW",
      "sql": "CREATE VIEW [dbo].[VMRT_TTX_Loaded_Trip_Starts_History] as  SELECT    Trip.[Trip_Fact_Id]  ,Trip.[Car_Dimn_Id]  ,Trip.[Car_Ver]  ,Trip.[STCC_Dimn_Id]  ,Trip.[Trip_Begin_Dt_Dimn_Id]  ,Trip.[Trip_End_Dt_Dimn_Id]  ,Trip.[Trip_Orig_Parti_Shpr_Org_Dimn_Id]  ,Trip.[Trip_Orig_Parti_Shpr_Org_Ver]  ,Trip.[Trip_Dest_Parti_Shpr_Org_Dimn_Id]  ,Trip.[Trip_Dest_Parti_Shpr_Org_Ver]  ,Trip.[Trip_Orig_Poss_Road_Org_Dimn_Id]  ,Trip.[Trip_Orig_Poss_Road_Org_Ver]  ,Trip.[Trip_Dest_Poss_Road_Org_Dimn_Id]  ,Trip.[Trip_Dest_Poss_Road_Org_Ver]  ,Trip.[Trip_Orig_Lst_Parti_Road_Org_Dimn_Id]  ,Trip.[Trip_Orig_Lst_Parti_Road_Org_Ver]  ,Trip.[Trip_Dest_Lst_Parti_Road_Org_Dimn_Id]  ,Trip.[Trip_Dest_Lst_Parti_Road_Org_Ver]  ,Trip.[Trip_Orig_Resp_Road_Org_Dimn_Id]  ,Trip.[Trip_Orig_Resp_Road_Org_Ver]  ,Trip.[Trip_Dest_Resp_Road_Org_Dimn_Id]  ,Trip.[Trip_Dest_Resp_Road_Org_Ver]  ,isnull(SPLC1.SPLC_Dimn_Id, -1) as Trip_Orig_SPLC_Dimn_Id  ,isnull(SPLC2.SPLC_Dimn_Id, -1) as Trip_Dest_SPLC_Dimn_Id  ,Trip.[Trip_Orig_Org_Dimn_Id] AS Trip_Orig_Loc_Org_Dimn_Id  ,Trip.[Trip_Orig_Org_Ver] AS Trip_Orig_Loc_Org_Ver  ,Trip.[Trip_Dest_Org_Dimn_Id] AS Trip_Dest_Loc_Org_Dimn_Id  ,Trip.[Trip_Dest_Org_Ver] AS Trip_Dest_Loc_Org_Ver  ,Trip.Trip_Begin_Dt  ,Trip.Trip_Typ  ,trip.[Origin_Loc]  ,trip.[Dest_Loc]  ,Trip.[Crtd_Dt]  ,1 as Ld_Trip_Strts_Cnt  FROM [DDSMRT].[dbo].[vw_Trip_Fact_History] (NOLOCK) trip   INNER JOIN (select distinct Trip_Fact_Id from [DDSMRT].[dbo].[vw_Trip_Segment_Fact_All] (NOLOCK) where  Trip_Seg_Typ = 'TRAN') Trip_Segment on (Trip.Trip_Fact_Id = Trip_Segment.Trip_Fact_Id  )   LEFT JOIN DDSMRT.dbo.SPLC_Dim (NOLOCK) SPLC1 on (trip.[Origin_Loc] = SPLC1.Location)   LEFT JOIN DDSMRT.dbo.SPLC_Dim (NOLOCK) SPLC2 on (trip.[Dest_Loc] = SPLC2.Location)  WHERE Trip.Trip_Begin_Dt >= '2010-01-01 00:00:00.000'    AND Trip.Dlet_Flg is NULL     AND Trip.Trip_Typ = 'L'  group by Trip.[Trip_Fact_Id]  ,Trip.[Car_Dimn_Id]  ,Trip.[Car_Ver]  ,Trip.[STCC_Dimn_Id]  ,Trip.[Trip_Begin_Dt_Dimn_Id]  ,Trip.[Trip_End_Dt_Dimn_Id]  ,Trip.[Trip_Orig_Parti_Shpr_Org_Dimn_Id]  ,Trip.[Trip_Orig_Parti_Shpr_Org_Ver]  ,Trip.[Trip_Dest_Parti_Shpr_Org_Dimn_Id]  ,Trip.[Trip_Dest_Parti_Shpr_Org_Ver]  ,Trip.[Trip_Orig_Poss_Road_Org_Dimn_Id]  ,Trip.[Trip_Orig_Poss_Road_Org_Ver]  ,Trip.[Trip_Dest_Poss_Road_Org_Dimn_Id]  ,Trip.[Trip_Dest_Poss_Road_Org_Ver]  ,Trip.[Trip_Orig_Lst_Parti_Road_Org_Dimn_Id]  ,Trip.[Trip_Orig_Lst_Parti_Road_Org_Ver]  ,Trip.[Trip_Dest_Lst_Parti_Road_Org_Dimn_Id]  ,Trip.[Trip_Dest_Lst_Parti_Road_Org_Ver]  ,Trip.[Trip_Orig_Resp_Road_Org_Dimn_Id]  ,Trip.[Trip_Orig_Resp_Road_Org_Ver]  ,Trip.[Trip_Dest_Resp_Road_Org_Dimn_Id]  ,Trip.[Trip_Dest_Resp_Road_Org_Ver]  ,SPLC1.SPLC_Dimn_Id  ,SPLC2.SPLC_Dimn_Id  ,Trip.[Trip_Orig_Org_Dimn_Id]  ,Trip.[Trip_Orig_Org_Ver]  ,Trip.[Trip_Dest_Org_Dimn_Id]  ,Trip.[Trip_Dest_Org_Ver]  ,Trip.Trip_Begin_Dt  ,Trip.Trip_Typ  ,trip.[Origin_Loc]  ,trip.[Dest_Loc]  ,Trip.[Crtd_Dt]"
    },
    {
      "id": "VTrips_Fact_History",
      "name": "VTrips_Fact_History",
      "type": "VIEW",
      "sql": "CREATE VIEW [DDSV].[VTrips_Fact_History]  AS      SELECT  CAST(Trip_Begin_Dt_Dimn_Id AS INT) AS Trip_Beg_Dt_Dimn_Id ,              CAST(Trip_End_Dt_Dimn_Id AS INT) AS Trip_End_Dt_Dimn_Id ,              CAST(Trip_Orig_SPLC_Dimn_Id AS INT) AS Orig_Geo_Dimn_Id ,              CAST(Trip_Dest_SPLC_Dimn_Id AS INT) AS Dest_Geo_Dimn_Id ,              CONCAT(CONVERT(VARCHAR(10), Trip_Orig_Lst_Parti_Road_Org_Dimn_Id),                     '_', CONVERT(VARCHAR(5), Trip_Orig_Lst_Parti_Road_Org_Ver)) AS Orig_Last_Part_Rd_Dimn_Id ,              CONCAT(CONVERT(VARCHAR(10), Trip_Dest_Lst_Parti_Road_Org_Dimn_Id),                     '_', CONVERT(VARCHAR(5), Trip_Dest_Lst_Parti_Road_Org_Ver)) AS Dest_Last_Part_Rd_Dimn_Id ,              CONCAT(CONVERT(VARCHAR(10), Trip_Dest_Resp_Road_Org_Dimn_Id), '_',                     CONVERT(VARCHAR(5), Trip_Dest_Resp_Road_Org_Ver)) AS Dest_Resp_Rd_Dimn_Id ,              CAST(STCC_Dimn_Id AS INT) AS Stcc_Dimn_Id ,              CONCAT(CONVERT(VARCHAR(10), B.Car_Dimn_Id), '_',                     CONVERT(VARCHAR(5), B.Car_Ver)) AS Car_Dimn_Id ,              CONCAT(CONVERT(VARCHAR(10), Trip_Orig_Org_Dimn_Id), '_',                     CONVERT(VARCHAR(5), Trip_Orig_Org_Ver)) AS Orig_Dist_Enty_Dimn_Id ,              CONCAT(CONVERT(VARCHAR(10), Trip_Dest_Org_Dimn_Id), '_',                     CONVERT(VARCHAR(5), Trip_Dest_Org_Ver)) AS Dest_Dist_Enty_Dimn_Id ,              Trip AS Trips ,              Railcar AS Railcar ,              B.Car_Nr ,              B.Car_Init ,              Origin_Loc AS Origin_Loc ,              Dest_Loc AS Dest_Loc ,              Trip_Begin_Dt AS Trip_Begin_Dt ,              Trip_End_Dt AS Trip_End_Dt ,              Trip_Orig_Lst_Parti_Road AS Origin_Last_Part_RR ,              Trip_Dest_Lst_Parti_Road AS Dest_Last_Part_RR ,              Trip_Dest_Resp_Road AS Dest_Resp_RR ,              STCC AS STCC_Cd ,              Origin_Enty AS Origin_Entity ,              Dest_Enty AS Dest_Entity ,              1 AS Car_Cnt ,              ( CASE ( Trip_Typ )                  WHEN 'E' THEN 1                  ELSE 0                END ) AS Dy_Emp_Cnt ,              ( CASE ( Trip_Typ )                  WHEN 'L' THEN 1                  ELSE 0                END ) AS Dy_Ld_Cnt ,              Trip_Seg_Typ ,              Crtd_Dt AS Crtd_Dt ,              Crtd_Id AS Crtd_Id ,              Lst_Upd_Dt AS Lst_Upd_Dt ,              Lst_Upd_Id AS Lst_Upd_Id      FROM    ( ( SELECT  Trip_Fact_Id ,                          Car_Dimn_Id ,                          Car_Ver ,                          Trip_Begin_Dt_Dimn_Id ,                          Trip_End_Dt_Dimn_Id ,                          Trip_Orig_SPLC_Dimn_Id ,                          Trip_Dest_SPLC_Dimn_Id ,                          Trip_Orig_Lst_Parti_Road_Org_Dimn_Id ,                          Trip_Orig_Lst_Parti_Road_Org_Ver ,                          Trip_Dest_Lst_Parti_Road_Org_Dimn_Id ,                          Trip_Dest_Lst_Parti_Road_Org_Ver ,                          Trip_Dest_Resp_Road_Org_Dimn_Id ,                          Trip_Dest_Resp_Road_Org_Ver ,                          Trip_Orig_Org_Dimn_Id ,                          Trip_Orig_Org_Ver ,                          Trip_Dest_Org_Dimn_Id ,                          Trip_Dest_Org_Ver ,                          STCC_Dimn_Id ,                          Trip ,                          Railcar ,                          Origin_Loc ,                          Dest_Loc ,                          Trip_Begin_Dt ,                          Trip_End_Dt ,                          Trip_Orig_Lst_Parti_Road ,                          Trip_Dest_Lst_Parti_Road ,                          Trip_Dest_Resp_Road ,                          STCC ,                          Origin_Enty ,                          Dest_Enty ,                          Trip_Typ ,                          Crtd_Dt ,                          Crtd_Id ,                          Lst_Upd_Dt ,                          Lst_Upd_Id                  FROM    [DDSMRT].[dbo].[VMRT_Trip_Fact_History] (NOLOCK)                ) A                LEFT JOIN ( SELECT    Car_Nr ,                                      Car_Init ,                                      Car_Dimn_Id ,                                      Car_Ver           /** IR527842 Fix **/                            FROM      [DDSMRT].[dbo].[Car_Dim_Correct] (NOLOCK)                          ) B ON A.Car_Dimn_Id = B.Car_Dimn_Id                                 AND A.Car_Ver = B.Car_Ver                LEFT JOIN ( SELECT    Trip_Seg_Typ ,                                      Trip_Fact_Id                            FROM      [DDSMRT].[dbo].[vw_Trip_Segment_Fact_All] (NOLOCK)                          ) C ON A.Trip_Fact_Id = C.Trip_Fact_Id              )  where Trip_Begin_Dt > = '2010-01-01 00:00:00'"
    },
    {
      "id": "Vfin_Flet_Perf_Rev_Act_Car_Cnt_Fact",
      "name": "Vfin_Flet_Perf_Rev_Act_Car_Cnt_Fact",
      "type": "VIEW",
      "sql": "CREATE VIEW [DDSV].[Vfin_Flet_Perf_Rev_Act_Car_Cnt_Fact]  AS      WITH    CntCTE                AS ( SELECT   CAST(SUBSTRING(CONVERT(VARCHAR(8), car_cnt.Dt_Dimn_Id),                                             1, 6) AS INT) AS Mth_Dimn_Id ,                              CASE WHEN car_cnt.Attr_Id_1 IS NULL THEN '-1_-1'                                   ELSE CONCAT(CONVERT(VARCHAR(10), car_cnt.Attr_Id_1),                                               '_',                                               CONVERT(VARCHAR(5), car_cnt.Attr_Ver_1))                              END AS Rd_Mbrshp_Dimn_Id ,                              CASE WHEN car.Entr_Hierchy_Id IS NULL THEN '-1_-1'                                   ELSE CONCAT(CONVERT(VARCHAR(10), car.Entr_Hierchy_Id),                                               '_',                                               CONVERT(VARCHAR(5), car.Entr_Hierchy_Ver))                              END AS Stat_Cd_Dimn_Id ,                              Dt_Dimn_Id ,                              Attr_Id_1 ,                              Attr_Ver_1 ,                              Entr_Hierchy_Id ,                              Entr_Hierchy_Ver ,                              CAST(SUM(CASE Car_Cnt_Catg_Typ_Id                                         WHEN 128 THEN car_cnt.Car_Cnt                                         ELSE 0                                       END) AS NUMERIC(38, 10)) AS Cars_Enrt_Cnt                 --  Enroute_Car_Cnt                              ,                              CAST(SUM(CASE Car_Cnt_Catg_Typ_Id                                         WHEN 130 THEN car_cnt.Car_Cnt                                         ELSE 0                                       END) AS NUMERIC(38, 10)) AS Cars_FMO_Mnt_Cnt              --  In_FMO_Car_Cnt                              ,                              CAST(SUM(CASE Car_Cnt_Catg_Typ_Id                                         WHEN 138 THEN car_cnt.Car_Cnt                                         ELSE 0                                       END) AS NUMERIC(38, 10)) AS Cars_Onln_Cnt     -- Fleet Size                              ,                              CAST(SUM(CASE Car_Cnt_Catg_Typ_Id                                         WHEN 135 THEN car_cnt.Car_Cnt                                         ELSE 0                                       END) AS NUMERIC(38, 10)) AS Cars_On_Relf_Cnt    --  On Online Relief                              ,                              CAST(SUM(CASE Car_Cnt_Catg_Typ_Id                                         WHEN 134 THEN car_cnt.Car_Cnt                                         ELSE 0                                       END) AS NUMERIC(38, 10)) AS Cars_On_Off_Ln_Relf_Cnt  --  On Offline Relief                              ,                              CAST(SUM(( CASE Car_Cnt_Catg_Typ_Id                                           WHEN 146 THEN car_cnt.Car_Cnt                                           ELSE 0                                         END )                                       + ( CASE Car_Cnt_Catg_Typ_Id                                             WHEN 145 THEN car_cnt.Car_Cnt                                             ELSE 0                                           END )) AS NUMERIC(38, 10)) AS Cars_In_Shop_Cnt  --  Cars_In_Shop_Cnt                              ,                              CAST(SUM(CASE Car_Cnt_Catg_Typ_Id                                         WHEN 129 THEN car_cnt.Car_Cnt                                         ELSE 0                                       END) AS NUMERIC(38, 10)) AS Cars_Bad_Ordr_Stor_Cnt  --  In_Bad_Order_Storage_Car_Cnt                              ,                              CAST(SUM(CASE Car_Cnt_Catg_Typ_Id                                         WHEN 133 THEN car_cnt.Car_Cnt                                         ELSE 0                                       END) AS NUMERIC(38, 10)) AS Cars_Stor_Cnt    --  In_Selective_Storage_Car_Cnt                              ,                              CAST(SUM(CASE Car_Cnt_Catg_Typ_Id                                         WHEN 138 THEN car_cnt.TPE_Cnt                                         ELSE 0                                       END) AS NUMERIC(38, 10))                              - SUM(( CASE Car_Cnt_Catg_Typ_Id                                        WHEN 128 THEN car_cnt.TPE_Cnt                                        ELSE 0                                      END ) + ( CASE Car_Cnt_Catg_Typ_Id                                                  WHEN 129 THEN car_cnt.TPE_Cnt                                                  ELSE 0                                                END )                                    + ( CASE Car_Cnt_Catg_Typ_Id                                          WHEN 130 THEN car_cnt.TPE_Cnt                                          ELSE 0                                        END )                                    + ( CASE Car_Cnt_Catg_Typ_Id                                          WHEN 145 THEN car_cnt.TPE_Cnt                                          ELSE 0                                        END )                                    + ( CASE Car_Cnt_Catg_Typ_Id                                          WHEN 146 THEN car_cnt.TPE_Cnt                                          ELSE 0                                        END )                                    + ( CASE Car_Cnt_Catg_Typ_Id                                          WHEN 133 THEN car_cnt.TPE_Cnt                                          ELSE 0                                        END )                                    + ( CASE Car_Cnt_Catg_Typ_Id                                          WHEN 134 THEN car_cnt.TPE_Cnt                                          ELSE 0                                        END )                                    + ( CASE Car_Cnt_Catg_Typ_Id                                          WHEN 135 THEN car_cnt.TPE_Cnt                                          ELSE 0                                        END )) AS In_Srvc_TPE_Cnt ,                              SUM(CASE Car_Cnt_Catg_Typ_Id                                    WHEN 138 THEN car_cnt.TPE_Cnt                                    ELSE 0                                  END) AS Totl_TPE_Cnt     --  Totl_TPE_Cnt                              ,                              SUM(( CASE Car_Cnt_Catg_Typ_Id                                      WHEN 128 THEN car_cnt.TPE_Cnt                                      ELSE 0                                    END ) + ( CASE Car_Cnt_Catg_Typ_Id                                                WHEN 129 THEN car_cnt.TPE_Cnt                                                ELSE 0                                              END )                                  + ( CASE Car_Cnt_Catg_Typ_Id                                        WHEN 130 THEN car_cnt.TPE_Cnt                                        ELSE 0                                      END ) + ( CASE Car_Cnt_Catg_Typ_Id                                                  WHEN 145 THEN car_cnt.TPE_Cnt                                                  ELSE 0                                                END )                                  + ( CASE Car_Cnt_Catg_Typ_Id                                        WHEN 146 THEN car_cnt.TPE_Cnt                                        ELSE 0                                      END ) + ( CASE Car_Cnt_Catg_Typ_Id                                                  WHEN 133 THEN car_cnt.TPE_Cnt                                                  ELSE 0                                                END )                                  + ( CASE Car_Cnt_Catg_Typ_Id                                        WHEN 134 THEN car_cnt.TPE_Cnt                                        ELSE 0                                      END ) + ( CASE Car_Cnt_Catg_Typ_Id                                                  WHEN 135 THEN car_cnt.TPE_Cnt                                                  ELSE 0                                                END )) AS Out_Of_Srvc_TPE_Cnt ,                              MAX(car_cnt.Crtd_Dt) AS Crtd_Dt ,                              MAX(car_cnt.Crtd_Id) AS Crtd_Id ,                              MAX(car_cnt.Lst_Upd_Dt) AS Lst_Upd_Dt ,                              MAX(car_cnt.Lst_Upd_Id) AS Lst_Upd_Id                     FROM     ( SELECT    Dt_Dimn_Id ,                                          Attr_Id_1 ,                                          Attr_Ver_1 ,                                          Car_Cnt ,                                          TPE_Cnt ,                                          Car_Cnt_Catg_Typ_Id ,                                          Row_Typ_Id ,                                          Car_Dimn_Id ,                                          Car_Ver ,                                          Crtd_Dt ,                                          Crtd_Id ,                                          Lst_Upd_Dt ,                                          Lst_Upd_Id                                FROM      DDSMRT.dbo.vw_car_count_fact_All (NOLOCK)                                WHERE     Row_Typ_Id = 517                              ) car_cnt -- Rev Actuals                              LEFT JOIN ( SELECT  Car_Dimn_Id ,                                                  Car_Ver ,                                                  Entr_Hierchy_Id ,                                                  Entr_Hierchy_Ver                                          FROM    DDSMRT.dbo.VMRT_Car_Dimension_Correct                                        ) car ON ( car_cnt.Car_Dimn_Id = car.Car_Dimn_Id                                                   AND car_cnt.Car_Ver = car.Car_Ver                                                 )                     GROUP BY Dt_Dimn_Id ,                              Attr_Id_1 ,                              Attr_Ver_1 ,                              Row_Typ_Id ,                              Entr_Hierchy_Id ,                              Entr_Hierchy_Ver                   )      SELECT  cnt.Mth_Dimn_Id ,              cnt.Rd_Mbrshp_Dimn_Id ,              cnt.Stat_Cd_Dimn_Id ,              cnt.Cars_Enrt_Cnt ,              cnt.Cars_FMO_Mnt_Cnt ,              cnt.Cars_Onln_Cnt ,              cnt.Cars_On_Relf_Cnt ,              cnt.Cars_On_Off_Ln_Relf_Cnt ,              cnt.Cars_In_Shop_Cnt ,              cnt.Cars_Bad_Ordr_Stor_Cnt ,              cnt.Cars_Stor_Cnt ,              mil.Cars_Zero_Rt_Cnt ,              cnt.In_Srvc_TPE_Cnt ,              cnt.Totl_TPE_Cnt ,              cnt.Out_Of_Srvc_TPE_Cnt ,              cnt.Crtd_Dt ,              cnt.Crtd_Id ,              cnt.Lst_Upd_Dt ,              cnt.Lst_Upd_Id ,              mil.[Zero_Rt_Out_Of_Srvc_TPE_Cnt] ,              mil.TPE_Mils ,              mil.TPE_Car_Hire ,              mil.TPE_Milg_Rev ,              mil.TPE_Whl_Schg_Milg_Rev      FROM    CntCTE cnt              LEFT JOIN ( SELECT  Mth_Beg_Dt_Dimn_Id ,                                  Hierchy_Id ,                                  Hierchy_Ver ,                                  Org_Mbrshp_Dimn_Id ,                                  Org_Mbrshp_Ver ,                                                sum(TPE_Mils         ) as TPE_Mils       ,                                  sum(TPE_Car_Hire        ) as TPE_Car_Hire      ,                                  sum(TPE_Milg_Rev        ) as TPE_Milg_Rev      ,                                  sum(TPE_Whl_Schg_Milg_Rev      ) as TPE_Whl_Schg_Milg_Rev    ,                                  sum([Zero_Rt_Out_Of_Srvc_TPE_Cnt]  ) as [Zero_Rt_Out_Of_Srvc_TPE_Cnt]  ,                                  sum([Cars_Zero_Rt_Cnt]      ) as [Cars_Zero_Rt_Cnt]                          FROM    DDSMRT.dbo.Tfin_Flet_Perf_Rev_Act_Car_Cnt_Fact (NOLOCK)        group by         Mth_Beg_Dt_Dimn_Id ,                                  Hierchy_Id ,                                  Hierchy_Ver ,                                  Org_Mbrshp_Dimn_Id ,                                  Org_Mbrshp_Ver                         ) mil ON ( mil.Mth_Beg_Dt_Dimn_Id = cnt.Dt_Dimn_Id                                   AND mil.Hierchy_Id = cnt.Entr_Hierchy_Id                                   AND mil.Hierchy_Ver = cnt.Entr_Hierchy_Ver                                   AND mil.Org_Mbrshp_Dimn_Id = cnt.Attr_Id_1                                   AND mil.Org_Mbrshp_Ver = cnt.Attr_Ver_1                                 )"
    },
    {
      "id": "Loading_TTXLoaded_Trip_Starts_History",
      "name": "Loading_TTXLoaded_Trip_Starts_History",
      "type": "VIEW",
      "sql": "CREATE VIEW [SV].[Loading_TTXLoaded_Trip_Starts_History]  AS  SELECT [Car_Dimn_Id]        ,[Car_Ver]        ,[STCC_Dimn_Id]        ,[Trip_Begin_Dt_Dimn_Id]        ,[Trip_End_Dt_Dimn_Id]        ,[Trip_Orig_Parti_Shpr_Org_Dimn_Id]        ,[Trip_Orig_Parti_Shpr_Org_Ver]        ,[Trip_Dest_Parti_Shpr_Org_Dimn_Id]        ,[Trip_Dest_Parti_Shpr_Org_Ver]        ,[Trip_Orig_Poss_Road_Org_Dimn_Id]        ,[Trip_Orig_Poss_Road_Org_Ver]        ,[Trip_Dest_Poss_Road_Org_Dimn_Id]        ,[Trip_Dest_Poss_Road_Org_Ver]        ,[Trip_Orig_Lst_Parti_Road_Org_Dimn_Id]        ,[Trip_Orig_Lst_Parti_Road_Org_Ver]        ,[Trip_Dest_Lst_Parti_Road_Org_Dimn_Id]        ,[Trip_Dest_Lst_Parti_Road_Org_Ver]        ,[Trip_Orig_Resp_Road_Org_Dimn_Id]        ,[Trip_Orig_Resp_Road_Org_Ver]        ,[Trip_Dest_Resp_Road_Org_Dimn_Id]        ,[Trip_Dest_Resp_Road_Org_Ver]        ,[Trip_Orig_SPLC_Dimn_Id]        ,[Trip_Dest_SPLC_Dimn_Id]        ,[Trip_Orig_Loc_Org_Dimn_Id]        ,[Trip_Orig_Loc_Org_Ver]        ,[Trip_Dest_Loc_Org_Dimn_Id]        ,[Trip_Dest_Loc_Org_Ver]        ,COALESCE([Ld_Trip_Strts_Cnt], 0) AS [Ld_Trip_Starts_Count]    FROM [DDSMRT].[dbo].[VMRT_TTX_Loaded_Trip_Starts_History]"
    },
    {
      "id": "Vfin_Flet_Perf_Rev_Act_Snpsht_Fact",
      "name": "Vfin_Flet_Perf_Rev_Act_Snpsht_Fact",
      "type": "VIEW",
      "sql": "CREATE VIEW [DDSV].[Vfin_Flet_Perf_Rev_Act_Snpsht_Fact] as  SELECT CONVERT(int,substring(convert(varchar(8),Mth_Beg_Dt_Dimn_Id),1,6)) as Mth_Dimn_Id        ,[Inct_Grp_Dimn_Id]        ,[TPE_Car_Hire]        ,[TPE_Milg_Rev]        ,[TPE_Whl_Schg_Milg_Rev]        ,[Inct_Deduc_Amt]     ,[Stat_Cd_Dimn_Id]        ,[Crtd_Dt]        ,[Crtd_Id]        ,[Lst_Upd_Dt]        ,[Lst_Upd_Id]  FROM [ddsmrt].[dbo].[Tfin_Flet_Perf_Rev_Act_Snpsht_Fact] (NOLOCK)"
    },
    {
      "id": "usp_D_House_Keeping_Trip_Fact",
      "name": "usp_D_House_Keeping_Trip_Fact",
      "type": "SQL_STORED_PROCEDURE",
      "sql": "CREATE PROC [dbo].[usp_D_House_Keeping_Trip_Fact] (@month INT = 6)  AS  BEGIN   IF(MONTH(GETDATE()) IN (3,6,9,12))   BEGIN    DECLARE @date INT = CONVERT(VARCHAR(10), DATEADD(MONTH,- @month,GETDATE()), 112)    DECLARE @PARTITION INT      SELECT @PARTITION = $PARTITION.pf_Trip_Fact_Function(@date)       ALTER TABLE [dbo].[Trip_Fact] SWITCH PARTITION (@PARTITION) TO [dbo].[Trip_Fact_History] PARTITION (@PARTITION)   END  END"
    },
    {
      "id": "Vfin_Flet_Perf_Rev_Est_Car_Cnt_Fact",
      "name": "Vfin_Flet_Perf_Rev_Est_Car_Cnt_Fact",
      "type": "VIEW",
      "sql": "CREATE VIEW [DDSV].[Vfin_Flet_Perf_Rev_Est_Car_Cnt_Fact]  AS      WITH    CntCTE                AS ( SELECT   CAST(SUBSTRING(CONVERT(VARCHAR(8), car_cnt.Dt_Dimn_Id),                                             1, 6) AS INT) AS Mth_Dimn_Id ,                              CASE WHEN car_cnt.Attr_Id_1 IS NULL THEN '-1_-1'                                   ELSE CONCAT(CONVERT(VARCHAR(10), car_cnt.Attr_Id_1),                                               '_',                                               CONVERT(VARCHAR(5), car_cnt.Attr_Ver_1))                              END AS Rd_Mbrshp_Dimn_Id ,                              CASE WHEN car.Entr_Hierchy_Id IS NULL THEN '-1_-1'                                   ELSE CONCAT(CONVERT(VARCHAR(10), car.Entr_Hierchy_Id),                                               '_',                                               CONVERT(VARCHAR(5), car.Entr_Hierchy_Ver))                              END AS Stat_Cd_Dimn_Id ,                              Dt_Dimn_Id ,                              Attr_Id_1 ,                              Attr_Ver_1 ,                              Entr_Hierchy_Id ,                              Entr_Hierchy_Ver ,                              CAST(SUM(CASE Car_Cnt_Catg_Typ_Id                                         WHEN 128 THEN car_cnt.Car_Cnt                                         ELSE 0                                       END) AS NUMERIC(24, 10)) AS Cars_Enrt_Cnt                 --  Enroute_Car_Cnt                              ,                              CAST(SUM(CASE Car_Cnt_Catg_Typ_Id                                         WHEN 130 THEN car_cnt.Car_Cnt                                         ELSE 0                                       END) AS NUMERIC(24, 10)) AS Cars_FMO_Mnt_Cnt              --  In_FMO_Car_Cnt                              ,                              CAST(SUM(CASE Car_Cnt_Catg_Typ_Id                                         WHEN 138 THEN car_cnt.Car_Cnt                                         ELSE 0                                       END) AS NUMERIC(24, 10)) AS Cars_Onln_Cnt     -- Fleet Size                              ,                              CAST(SUM(CASE Car_Cnt_Catg_Typ_Id                                         WHEN 135 THEN car_cnt.Car_Cnt                                         ELSE 0                                       END) AS NUMERIC(24, 10)) AS Cars_On_Relf_Cnt    --  On Online Relief                              ,                              CAST(SUM(CASE Car_Cnt_Catg_Typ_Id                                         WHEN 134 THEN car_cnt.Car_Cnt                                         ELSE 0                                       END) AS NUMERIC(24, 10)) AS Cars_On_Off_Ln_Relf_Cnt  --  On Offline Relief                              ,                              CAST(SUM(( CASE Car_Cnt_Catg_Typ_Id                                           WHEN 146 THEN car_cnt.Car_Cnt                                           ELSE 0                                         END )                                       + ( CASE Car_Cnt_Catg_Typ_Id                                             WHEN 145 THEN car_cnt.Car_Cnt                                             ELSE 0                                           END )) AS NUMERIC(24, 10)) AS Cars_In_Shop_Cnt  --  Cars_In_Shop_Cnt                              ,                              CAST(SUM(CASE Car_Cnt_Catg_Typ_Id                                         WHEN 129 THEN car_cnt.Car_Cnt                                         ELSE 0                                       END) AS NUMERIC(24, 10)) AS Cars_Bad_Ordr_Stor_Cnt  --  In_Bad_Order_Storage_Car_Cnt                              ,                              CAST(SUM(CASE Car_Cnt_Catg_Typ_Id                                         WHEN 133 THEN car_cnt.Car_Cnt                                         ELSE 0                                       END) AS NUMERIC(24, 10)) AS Cars_Stor_Cnt    --  In_Selective_Storage_Car_Cnt                              ,                              CAST(SUM(CASE Car_Cnt_Catg_Typ_Id                                         WHEN 138 THEN car_cnt.TPE_Cnt                                         ELSE 0                                       END) AS NUMERIC(24, 10))                              - CAST(SUM(( CASE Car_Cnt_Catg_Typ_Id                                             WHEN 128 THEN car_cnt.TPE_Cnt                                             ELSE 0                                           END )                                         + ( CASE Car_Cnt_Catg_Typ_Id                                               WHEN 129 THEN car_cnt.TPE_Cnt                                               ELSE 0                                             END )                                         + ( CASE Car_Cnt_Catg_Typ_Id                                               WHEN 130 THEN car_cnt.TPE_Cnt                                               ELSE 0                                             END )                                         + ( CASE Car_Cnt_Catg_Typ_Id                                               WHEN 145 THEN car_cnt.TPE_Cnt                                               ELSE 0                                             END )                                         + ( CASE Car_Cnt_Catg_Typ_Id                                               WHEN 146 THEN car_cnt.TPE_Cnt                                               ELSE 0                                             END )                                         + ( CASE Car_Cnt_Catg_Typ_Id                                               WHEN 133 THEN car_cnt.TPE_Cnt                                               ELSE 0                                             END )                                         + ( CASE Car_Cnt_Catg_Typ_Id                                               WHEN 134 THEN car_cnt.TPE_Cnt                                               ELSE 0                                             END )                                         + ( CASE Car_Cnt_Catg_Typ_Id                                               WHEN 135 THEN car_cnt.TPE_Cnt                                               ELSE 0                                             END )) AS NUMERIC(24, 10)) AS In_Srvc_TPE_Cnt ,                              CAST(SUM(( CASE Car_Cnt_Catg_Typ_Id                                           WHEN 128 THEN car_cnt.TPE_Cnt                                           ELSE 0                                         END )                                       + ( CASE Car_Cnt_Catg_Typ_Id                                             WHEN 129 THEN car_cnt.TPE_Cnt                                             ELSE 0                                           END )                                       + ( CASE Car_Cnt_Catg_Typ_Id                                             WHEN 130 THEN car_cnt.TPE_Cnt                                             ELSE 0                                           END )                                       + ( CASE Car_Cnt_Catg_Typ_Id                                             WHEN 145 THEN car_cnt.TPE_Cnt                                             ELSE 0                                           END )                                       + ( CASE Car_Cnt_Catg_Typ_Id                                             WHEN 146 THEN car_cnt.TPE_Cnt                                             ELSE 0                                           END )                                       + ( CASE Car_Cnt_Catg_Typ_Id                                             WHEN 133 THEN car_cnt.TPE_Cnt                                             ELSE 0                                           END )                                       + ( CASE Car_Cnt_Catg_Typ_Id                                             WHEN 134 THEN car_cnt.TPE_Cnt                                             ELSE 0                                           END )                                       + ( CASE Car_Cnt_Catg_Typ_Id                                             WHEN 135 THEN car_cnt.TPE_Cnt                                             ELSE 0                                           END )) AS NUMERIC(24, 10)) AS Out_Of_Srvc_TPE_Cnt ,                              MAX(car_cnt.Crtd_Dt) AS Crtd_Dt ,                              MAX(car_cnt.Crtd_Id) AS Crtd_Id ,                              MAX(car_cnt.Lst_Upd_Dt) AS Lst_Upd_Dt ,                              MAX(car_cnt.Lst_Upd_Id) AS Lst_Upd_Id                     FROM     ( SELECT    Dt_Dimn_Id ,                                          Attr_Id_1 ,                                          Attr_Ver_1 ,                                          Car_Cnt ,                                          TPE_Cnt ,                                          Car_Cnt_Catg_Typ_Id ,                                          Row_Typ_Id ,                                          Car_Dimn_Id ,                                          Car_Ver ,                                          Crtd_Dt ,                                          Crtd_Id ,                                          Lst_Upd_Dt ,                                          Lst_Upd_Id                                FROM      DDSMRT.dbo.vw_car_count_fact_All (NOLOCK)                                WHERE     Row_Typ_Id = 516                              ) car_cnt -- Rev Accrual                               LEFT JOIN ( SELECT  Car_Dimn_Id ,                                                  Car_Ver ,                                                  Entr_Hierchy_Id ,                                                  Entr_Hierchy_Ver                                          FROM    DDSMRT.dbo.VMRT_Car_Dimension_Correct                                        ) car ON ( car_cnt.Car_Dimn_Id = car.Car_Dimn_Id                                                   AND car_cnt.Car_Ver = car.Car_Ver                                                 )                     GROUP BY Dt_Dimn_Id ,                              Attr_Id_1 ,                              Attr_Ver_1 ,                              Row_Typ_Id ,                              Entr_Hierchy_Id ,                              Entr_Hierchy_Ver                   )      SELECT  cnt.Mth_Dimn_Id ,              cnt.Rd_Mbrshp_Dimn_Id ,              cnt.Stat_Cd_Dimn_Id ,              cnt.Cars_Enrt_Cnt ,              cnt.Cars_FMO_Mnt_Cnt ,              cnt.Cars_Onln_Cnt ,              cnt.Cars_On_Relf_Cnt ,              cnt.Cars_On_Off_Ln_Relf_Cnt ,              cnt.Cars_In_Shop_Cnt ,              cnt.Cars_Bad_Ordr_Stor_Cnt ,              cnt.Cars_Stor_Cnt ,              mil.Cars_Zero_Rt_Cnt ,              cnt.In_Srvc_TPE_Cnt ,              cnt.Out_Of_Srvc_TPE_Cnt ,              cnt.Crtd_Dt ,              cnt.Crtd_Id ,              cnt.Lst_Upd_Dt ,              cnt.Lst_Upd_Id ,              mil.Totl_Hrs ,              mil.Mile_Rt ,              mil.Avg_Mils_Dy ,              mil.TPE_Car_Rt_Per_Dy ,              mil.TPE_Mils ,              mil.TPE_Mile_Rt ,              mil.TPE_Whl_Schg_Mile_Rt ,              mil.TPE_Totl_Rt_Per_Dy ,              mil.Est_TPE_Car_Hire ,              mil.TPE_Milg_Rev ,              mil.TPE_Whl_Schg_Milg_Rev      FROM    CntCTE cnt              LEFT JOIN ( SELECT  Mth_Beg_Dt_Dimn_Id ,                                  Hierchy_Id ,                                  Hierchy_Ver ,                                  Org_Mbrshp_Dimn_Id ,                                  Org_Mbrshp_Ver ,                                  Totl_Hrs ,                                  Mile_Rt ,                                  Avg_Mils_Dy ,                                  TPE_Car_Rt_Per_Dy ,                                  TPE_Mils ,                                  TPE_Mile_Rt ,                                  [TPE_Whl_Schg_Mile_Rt] ,                                  [TPE_Totl_Rt_Per_Dy] ,                                  [Est_TPE_Car_Hire] ,                                  TPE_Milg_Rev ,                                  TPE_Whl_Schg_Milg_Rev ,                                  [Cars_Zero_Rt_Cnt]                          FROM    DDSMRT.dbo.Tfin_Flet_Perf_Rev_Est_Car_Cnt_Fact (NOLOCK)                        ) mil ON ( mil.Mth_Beg_Dt_Dimn_Id = cnt.Dt_Dimn_Id                                   AND mil.Hierchy_Id = cnt.Entr_Hierchy_Id                                   AND mil.Hierchy_Ver = cnt.Entr_Hierchy_Ver                                   AND mil.Org_Mbrshp_Dimn_Id = cnt.Attr_Id_1                                   AND mil.Org_Mbrshp_Ver = cnt.Attr_Ver_1                                 )"
    },
    {
      "id": "usp_D_House_Keeping_Trip_Segment_Fact",
      "name": "usp_D_House_Keeping_Trip_Segment_Fact",
      "type": "SQL_STORED_PROCEDURE",
      "sql": "CREATE PROC [dbo].[usp_D_House_Keeping_Trip_Segment_Fact] (@month INT = 6)  AS  BEGIN   IF(MONTH(GETDATE()) IN (3,6,9,12))   BEGIN    DECLARE @date DATE = DATEADD(MONTH,- @month,GETDATE())    DECLARE @PARTITION INT      SELECT @PARTITION = $PARTITION.pf_Trip_Segment_Fact_Function(@date)       ALTER TABLE [dbo].[Trip_Segment_Fact] SWITCH PARTITION (@PARTITION) TO [dbo].[Trip_Segment_Fact_History] PARTITION (@PARTITION)   END  END"
    },
    {
      "id": "Vfin_Flet_Perf_Fcst_Pln_Fact",
      "name": "Vfin_Flet_Perf_Fcst_Pln_Fact",
      "type": "VIEW",
      "sql": "CREATE view [DDSV].[Vfin_Flet_Perf_Fcst_Pln_Fact] as  SELECT       concat( convert(varchar(10),[Hierchy_Id]), '_', convert(varchar(5),[Hierchy_Ver]))  as [Stat_Cd_Dimn_Id]        ,[Dt_Dimn_Id]        ,[Fcst_Bad_Ordr_Cnt]        ,[Fcst_Bad_Ordr_Shop_Cnt]        ,[Fcst_Car_Cnt]        ,[Fcst_Enrt_To_Shop_Cnt]        ,[Fcst_Inct_Pct]        ,[Fcst_Car_hire_Rt]        ,[Fcst_Milg_Per_Day]        ,[Fcst_Milg_Rt]        ,[Fcst_Car_Hire_Inct_Amt]        ,[Fcst_Milg_Schg]        ,[Fcst_On_Hand_Cnt]        ,[Fcst_Selct_Stor_Cnt]        ,[Fcst_Srvc_Stor_Cnt]        ,[Fcst_In_Srvc_Totl_Cnt]        ,[Fcst_Out_Srvc_Totl_Cnt]        ,[Pln_Bad_Ordr_Cnt]        ,[Pln_Bad_Ordr_Shop_Cnt]        ,[Pln_Car_Cnt]        ,[Pln_Enrt_To_Shop_Cnt]        ,[Pln_Inct_Pct]        ,[Pln_On_Hand_Cnt]        ,[Pln_Selct_Stor_Cnt]        ,[Pln_Srvc_Stor_Cnt]        ,[Pln_Milg_Per_Day]        ,[Pln_Car_hire_Rt]        ,[Pln_Car_Hire_Inct_Amt]        ,[Pln_Milg_Rt]        ,[Pln_Milg_Schg]        ,[Pln_In_Srvc_Totl_Cnt]        ,[Pln_Out_Srvc_Totl_Cnt]        ,[Crtd_Dt]        ,[Crtd_Id]        ,[Lst_Upd_Dt]        ,[Lst_Upd_Id]      FROM       [ddsmrt].[dbo].[Tfin_Flet_Perf_Fcst_Pln_Fact] (NOLOCK)      where [Hierchy_Id] is not Null and [Hierchy_Id] <> -1    UNION   --- patch to Plan Forecast Summary Cube     SELECT       concat( convert(varchar(10),T1.[Hierchy_Id]), '_', convert(varchar(5),T1.[Hierchy_Ver]))  as [Stat_Cd_Dimn_Id]        ,T1.[Dt_Dimn_Id]        ,[Fcst_Bad_Ordr_Cnt]        ,[Fcst_Bad_Ordr_Shop_Cnt]        ,[Fcst_Car_Cnt]        ,[Fcst_Enrt_To_Shop_Cnt]        ,[Fcst_Inct_Pct]        ,[Fcst_Car_hire_Rt]        ,[Fcst_Milg_Per_Day]        ,[Fcst_Milg_Rt]        ,[Fcst_Car_Hire_Inct_Amt]        ,[Fcst_Milg_Schg]        ,[Fcst_On_Hand_Cnt]        ,[Fcst_Selct_Stor_Cnt]        ,[Fcst_Srvc_Stor_Cnt]        ,[Fcst_In_Srvc_Totl_Cnt]        ,[Fcst_Out_Srvc_Totl_Cnt]        ,[Pln_Bad_Ordr_Cnt]        ,[Pln_Bad_Ordr_Shop_Cnt]        ,[Pln_Car_Cnt]        ,[Pln_Enrt_To_Shop_Cnt]        ,[Pln_Inct_Pct]        ,[Pln_On_Hand_Cnt]        ,[Pln_Selct_Stor_Cnt]        ,[Pln_Srvc_Stor_Cnt]        ,[Pln_Milg_Per_Day]        ,[Pln_Car_hire_Rt]        ,[Pln_Car_Hire_Inct_Amt]        ,[Pln_Milg_Rt]        ,[Pln_Milg_Schg]        ,[Pln_In_Srvc_Totl_Cnt]        ,[Pln_Out_Srvc_Totl_Cnt]        ,[Crtd_Dt]        ,[Crtd_Id]        ,[Lst_Upd_Dt]        ,[Lst_Upd_Id]      FROM         (SELECT Distinct [Dt_Dimn_Id],[Hierchy_Id],[Hierchy_Ver] FROM DDSMRT.dbo.Tfin_Flet_Perf_Car_Milg_Car_Cnt_Snpsht_Fact ) T1    LEFT JOIN    [ddsmrt].[dbo].[Tfin_Flet_Perf_Fcst_Pln_Fact] (NOLOCK) T2 on (T1.[Dt_Dimn_Id]=T2.[Dt_Dimn_Id] and T1.[Hierchy_Id] = T2.[Hierchy_Id] and T1.[Hierchy_Ver]=T2.[Hierchy_Ver])     where T2.[Hierchy_Id] is Null and T1.Hierchy_id not in (-1,999) and T1.Hierchy_Id is not null"
    },
    {
      "id": "Vfin_Flet_Perf_Rev_Est_Snpsht_Fact",
      "name": "Vfin_Flet_Perf_Rev_Est_Snpsht_Fact",
      "type": "VIEW",
      "sql": "CREATE VIEW [DDSV].[Vfin_Flet_Perf_Rev_Est_Snpsht_Fact] as  SELECT CONVERT(int,substring(convert(varchar(8),[Mth_Beg_Dt_Dimn_Id]),1,6)) as Mth_Dimn_Id     , concat(convert(varchar(10),[Org_Mbrshp_Dimn_Id] ),'_', convert(varchar(5), [Org_Mbrshp_Ver]))      as [Rd_Mbrshp_Dimn_Id]        ,[Inct_Grp_Dimn_Id]     ,[Stat_Cd_Dimn_Id]         ,[Est_TPE_Car_Hire]        ,[TPE_Milg_Rev]        ,[TPE_Whl_Schg_Milg_Rev]        ,[Inct_Deduc_Amt]     ,[Crtd_Dt]        ,[Crtd_Id]        ,[Lst_Upd_Dt]        ,[Lst_Upd_Id]    FROM [ddsmrt].[dbo].[Tfin_Flet_Perf_Rev_Est_Snpsht_Fact] (NOLOCK)"
    },
    {
      "id": "VMRT_SPLC_Dimension",
      "name": "VMRT_SPLC_Dimension",
      "type": "VIEW",
      "sql": "CREATE VIEW [dbo].[VMRT_SPLC_Dimension]  AS  SELECT SPLC_Dim.SPLC_Dimn_Id    ,SPLC_Dim.SPLC    ,SPLC_Dim.SPLC_Nm    ,SPLC_Dim.SPLC_Long    ,SPLC_Dim.SPLC_Lat    ,SPLC_Dim.SPLC_Status    ,Geography_Dim.cntry as Country    ,Geography_Dim.[Cntry_Desc] as Country_Desc    ,Geography_Dim.Regn    ,Geography_Dim.Regn_Desc    ,Geography_Dim.Regn_Ext as Regn_IANA    ,Geography_Dim.Regn_Ext_Desc as Regn_IANA_Desc    ,Geography_Dim.Metro_Area    ,Geography_Dim.St_Prov    ,Geography_Dim.St_Prov_Desc    ,Geography_Dim.City    ,SPLC_Dim.Geo_Dimn_Id     FROM DDSMRT.dbo.SPLC_Dim (NOLOCK)   left join DDSMRT.dbo.Geography_Dim  (NOLOCK)   on (SPLC_Dim.geo_dimn_id = Geography_Dim.geo_dimn_id)"
    },
    {
      "id": "VAST_Car_Lineage_Lease",
      "name": "VAST_Car_Lineage_Lease",
      "type": "VIEW",
      "sql": "CREATE VIEW [dbo].[VAST_Car_Lineage_Lease]  as  select   a.ttx_carid AS TheCarID  ,a.ttx_carinitial as TheCarInit  ,a.ttx_carnum as TheCarNum    ,CASE WHEN fromcar.ttx_carid IS NULL THEN a.ttx_carid ELSE fromcar.ttx_carid END AS ParentCarID  ,CASE WHEN fromcar.ttx_carid IS NULL THEN a.ttx_carinitial ELSE fromcar.ttx_carinitial END AS ParentCarInit  ,CASE WHEN fromcar.ttx_carid IS NULL THEN a.ttx_carnum ELSE fromcar.ttx_carnum END AS ParentCarNum    ,fromcar.ttx_carid AS FromCar  ,fromcar.ttx_carinitial as FromCarInit  ,fromcar.ttx_carnum as FromCarNum  ,fromcar.TTX_carclass as FromCarClass  ,fromcar.classstructureid as FromCarStructure  ,fromcar.ttx_templateid as FromCarTemplate  ,fromcar.ttx_unitcount as FromCarUnitcount  ,CAST(fromspeclen.Numvalue/12 AS INT) AS FromCarInsideLen  --,(fromcarchar.[Inside Length]/12) as FromCarInsideLen  ,fromcar.status AS FromCarStatus  ,fromcar.ttx_builtdate as FromCarBuiltDate    ,tocar.ttx_cntrct as ToCarContract  ,tocar.ttx_carid  AS ToCar  ,tocar.ttx_carinitial as ToCarInit  ,tocar.ttx_carnum as ToCarNum  ,tocar.TTX_carclass as ToCarClass  ,tocar.classstructureid as ToCarStructure  ,tocar.ttx_templateid as ToCarTemplate  ,tocar.ttx_unitcount as ToCarUnitcount  ,CAST(tospeclen.Numvalue/12 AS INT) AS ToCarInsideLen  --,(tocarchar.[Inside Length]/12) as ToCarInsideLen  ,tocar.status AS ToCarStatus  ,tocar.ttx_builtdate as ToCarBuiltDate    --,unit.plustpos AS LocationOnToCar    --,fromcar.ttx_carid AS FromCar  --,fromcar.ttx_carinitial as FromCarInit  --,fromcar.ttx_carnum as FromCarNum  --,fromcar.TTX_carclass as FromCarClass  --,fromcar.classstructureid as FromCarStructure  --,fromcar.ttx_templateid as FromCarTemplate  --,fromcar.ttx_unitcount as FromCarUnitcount  --,CAST(fromspeclen.Numvalue/12 AS INT) AS FromCarInsideLen  ----,(fromcarchar.[Inside Length]/12) as FromCarInsideLen  --,fromcar.status AS FromCarStatus  --,fromcar.ttx_builtdate as FromCarBuiltDate  --,tospec.alnvalue AS LocOnToCar    --,assetdim.assetid AS AssetID1  --,assetdim.usagecondition  --,assetdim.assetstatus  --,assetdim.leasesequencenumber  --,assetdim.iscurrent  --  --,leasedim.leaseid  --,leasedim.agreementname  --,leasedim.sequencenumber  --,leasedim.currenttermstartdate  --,leasedim.currenttermenddate  --,leasedim.maturitydate  --,leasedim.agreementstatus  --,leasedim.leasestatus  --,termfact.terminationreason  --  --,assetdim2.assetid as AssetID2  --,assetdim2.usagecondition as UsageCond2  --,assetdim2.assetstatus as AssetStatus2  --,assetdim2.leasesequencenumber as LeaseSeqNum2  --,assetdim2.iscurrent as IsCurrent2  --  --,leasedim2.leaseid as LeaseID2  --,leasedim2.agreementname as AgreementName2  --,leasedim2.sequencenumber as SequenceNum2  --,leasedim2.currenttermstartdate as CurrentTermStart2  --,leasedim2.currenttermenddate as CurrentTermEnd2  --,leasedim2.maturitydate as MaturityDate2  --,leasedim2.agreementstatus as AgreementStatus2  --,leasedim2.leasestatus as LeaseStatus2  --,termfact2.terminationreason as TermReason2    --,termfact.leasehistoryid as LHID  --,termfact2.leasehistoryid as LHID2  --,termfact.assethistoryid as AHID  --,termfact2.assethistoryid as AHID2    ,COALESCE(assetdim.assetid,assetdim2.assetid) AS AssetID  ,COALESCE(assetdim.usagecondition, assetdim2.usagecondition) AS UsageCondition  ,COALESCE(assetdim.assetstatus, assetdim2.assetstatus) AS AssetStatus  ,COALESCE(assetdim.leasesequencenumber, assetdim2.leasesequencenumber) AS LeaseSeqNum  ,COALESCE(assetdim.iscurrent, assetdim2.iscurrent) AS IsCurrent  ,COALESCE(leasedim.leaseid, leasedim2.leaseid) AS LeaseID  ,COALESCE(leasedim.agreementname, leasedim2.agreementname) AS AgreementName  ,COALESCE(leasedim.sequencenumber, leasedim2.sequencenumber) AS SequenceNum  ,COALESCE(leasedim.currenttermstartdate, leasedim2.currenttermstartdate) AS CurrentTermStartDate  ,COALESCE(leasedim.currenttermenddate, leasedim2.currenttermenddate) AS CurrentTermEndDate  ,COALESCE(leasedim.maturitydate, leasedim2.maturitydate) AS MaturityDate  ,COALESCE(leasedim.leasestatus, leasedim2.leasestatus) AS LeaseStatus  ,COALESCE(termfact.terminationreason,termfact2.terminationreason) AS TerminationReason  ,COALESCE(termdate.mmddccyydate,termdate2.mmddccyydate) as TerminationDate    from ddsstg.DBO.TAST_MAX_ASSET a    left outer join ddsstg.DBO.TAST_MAX_assettrans trans   on (a.assetnum = trans.fromparent or a.assetnum = trans.toparent)    --left outer join ddsstg.DBO.TAST_MAX_asset unit  -- on trans.assetnum = unit.assetnum and trans.siteid = unit.siteid    left outer join ddsstg.DBO.TAST_MAX_asset fromcar   on fromcar.assetnum = trans.fromparent   and fromcar.siteid = trans.siteid    left outer join ddsstg.DBO.TAST_MAX_asset tocar   on tocar.assetnum = trans.toparent   and tocar.siteid = trans.siteid    left join ddsstg.DBO.TAST_MAX_assetspec tospec   on tocar.assetnum = tospec.assetnum   and tocar.siteid = tospec.siteid   and tospec.assetattrid='TTXPRULOC'    left join ddsstg.DBO.TAST_MAX_assetspec tospeclen   on tocar.assetnum = tospeclen.assetnum   and tocar.siteid = tospeclen.siteid   and tospeclen.assetattrid='A135'    left join ddsstg.DBO.TAST_MAX_assetspec fromspeclen   on fromcar.assetnum = fromspeclen.assetnum   and fromcar.siteid = fromspeclen.siteid   and fromspeclen.assetattrid='A135'    left outer join ddsstg.dbo.ttry_asset_profile_dimn assetdim   on assetdim.originalcarnumber = a.ttx_carnum   --WHERE FROMCAR.TTX_CARID IS NULL    left outer join ddsstg.dbo.ttry_lease_asset_fact asset   on asset.assethistoryid = assetdim.assethistoryid    left outer join ddsstg.dbo.ttry_lease_agreement_dimn leasedim   on leasedim.leasehistoryid = asset.leasehistoryid    left outer join ddsstg.dbo.ttry_lease_termination_fact termfact   on termfact.leasehistoryid = asset.leasehistoryid   and termfact.assethistoryid = asset.assethistoryid    left outer join ddsstg.dbo.ttry_date_dimn termdate   on termdate.dateid = termfact.terminationdateid    left outer join ddsstg.dbo.ttry_asset_profile_dimn assetdim2   on assetdim2.originalcarnumber = FROMCAR.ttx_carnum   --WHERE FROMCAR.TTX_CARID IS NOT NULL    left outer join ddsstg.dbo.ttry_lease_asset_fact asset2   on asset2.assethistoryid = assetdim2.assethistoryid    left outer join ddsstg.dbo.ttry_lease_agreement_dimn leasedim2   on leasedim2.leasehistoryid = asset2.leasehistoryid    left outer join ddsstg.dbo.ttry_lease_termination_fact termfact2   on termfact2.leasehistoryid = asset2.leasehistoryid   and termfact2.assethistoryid = asset2.assethistoryid    left outer join ddsstg.dbo.ttry_date_dimn termdate2   on termdate2.dateid = termfact2.terminationdateid    -- CASE WHEN fromcar.ttx_carid IS NULL THEN a.ttx_carid ELSE fromcar.ttx_carid  where  a.plustcomp='CAR'  and a.siteid='RAIL'"
    },
    {
      "id": "Vfin_Rd_Mbrshp_Dimn",
      "name": "Vfin_Rd_Mbrshp_Dimn",
      "type": "VIEW",
      "sql": "CREATE VIEW [DDSV].[Vfin_Rd_Mbrshp_Dimn]  AS  SELECT          concat(convert(varchar(10),org_m.Org_Mbrshp_Dimn_Id),'_',convert(varchar(5), org_m.Org_Mbrshp_Ver)) as Rd_Mbrshp_Dimn_Id     ,org_m.TTX_Mbrshp_Strt_Dt as Mbrshp_Eff_Strt_Dt     ,org_m.TTX_Mbrshp_End_Dt as Mbrshp_Eff_End_Dt       ,convert(char(4), org.Org_Abrv) as Org_Abrv     ,cast(org_m.TTX_Road_Mbrshp_Stat_Typ_Id as int) as TTX_Rd_Mbrshp_Stat_Typ_Id     ,cast ((case when org_m.Road_Hun_Pct_Stmt_Part_Ind = 1 then 'Y' else 'N' end)      as char(1)) as Road_Hun_Pct_Stmt_Part_Ind     ,org.Pty_Id     ,org_m.Crtd_Dt     ,org_m.Crtd_Id     ,org_m.Lst_Upd_Dt     ,org_m.Lst_Upd_Id   FROM        ddsmrt.dbo.Organization_Membership_Dim (NOLOCK) org_m    left join ddsmrt.dbo.Organization_Dim (NOLOCK) org       on (org_m.org_dimn_id = org.org_dimn_id and org_m.org_ver = org.org_ver)       where org.Org_Dimn_Id<>-1 and org_m.Org_Mbrshp_Dimn_Id<>-1"
    },
    {
      "id": "VGeography_Dim",
      "name": "VGeography_Dim",
      "type": "VIEW",
      "sql": "CREATE view [DDSV].[VGeography_Dim] as  SELECT   cast([Geo_Dimn_Id] as int) as [Geo_Dimn_Id]        ,[Row_Typ_Id]        ,cntry as Country     ,Cntry_Desc        ,[Metro_Area]        ,[Regn]     ,Regn_Desc        ,[Regn_Ext]     ,Regn_Ext_Desc     ,[St_Prov]     ,St_Prov_Desc     ,Src_Sys_Nm        ,[County]        ,[City]        ,[Geo_Long]        ,[Geo_Lat]        ,[Crtd_Id]        ,[Crtd_Dt]        ,[Lst_Upd_Id]        ,[Lst_Upd_Dt]      FROM [ddsmrt].[dbo].[Geography_Dim]"
    },
    {
      "id": "VInvoicing_Entity_Dim",
      "name": "VInvoicing_Entity_Dim",
      "type": "VIEW",
      "sql": "create view [DDSV].[VInvoicing_Entity_Dim] as  SELECT concat(convert(varchar(10),Invc_Enty_Org_Dimn_Id),'_',convert(varchar(5), Invc_Enty_Org_Ver)) as [Inv_Enty_Dimn_Id]        ,concat(convert(varchar(10),Invc_Enty_Org_Dimn_Id),'_',convert(varchar(5), Invc_Enty_Org_Ver)) as [Org_Enty_Dimn_Id]        ,[Pty_Id]        ,Invc_Enty_Org_Abrv as [Curr_Abrv]        ,[Crtd_Dt]        ,[Crtd_Id]        ,[Lst_Upd_Dt]        ,[Lst_Upd_Id]     ,Src_Sys_Nm    FROM dbo.VMRT_Invoicing_Entity_Dimension"
    },
    {
      "id": "USP_I_Wheelset_Repair_Outlier",
      "name": "USP_I_Wheelset_Repair_Outlier",
      "type": "SQL_STORED_PROCEDURE",
      "sql": "CREATE     PROCEDURE [dbo].[USP_I_Wheelset_Repair_Outlier]  AS    /***********************************************************************  This query is used to generate the required field to produce an SPC   chart for all of the weekly wheelset repairs for individual repair   entities. This is required for the dashboard in order to be able   to display outlier entities on a map all together. Using tableau   table calculation allows for individual entity SPC charts.     Date  Author  Changes  ----  ------  ------------  2023-10-27 ENGDPC  Created  2023-12-13  DEVVZS      Procedure Created    Run time: 10 min   Rows: ~300k  **********************************************************************/  BEGIN  SET NOCOUNT ON  -- Initial CTE to pull the wheelset changes by specific location   DROP TABLE IF EXISTS #WSCCalc2  DROP TABLE IF EXISTS #WSCCalc3    ;WITH WSC AS    (    SELECT DISTINCT     carInitial,    carNumber,    repairDate,    sourceSystemName,     shopInitial,    repairFacilityType,    repairFacilityTypeName,    jobCodeDescription,    locationOnCar,    appliedJobCode,    appliedQualifier,    billing.splc,    geo.SPLC_Name,    geo.Latitude,    geo.Longitude,    quantity      FROM HDSMNT.dbo.tmntShopFmoUbsAarBilling billing WITH(NOLOCK)    LEFT JOIN DDSMRT.SV.Geography geo WITH(NOLOCK)       ON billing.splc = geo.splc    LEFT JOIN DDSMRT.SV.Area_of_Car aoc WITH(NOLOCK)       ON billing.appliedJobCode = aoc.[Applied_Job_Code]      WHERE 1=1     AND (appliedJobCode IN ('4128','4133','4136','4138') OR appliedJobCode BETWEEN '3328' AND '3379')    AND repairDate >= dateadd(month,datediff(month,0,getdate()),0) -730    AND repairDate <= dateadd(month,datediff(month,0,getdate()),0)      ),   -- Initial aggregation CTE to sum the wheelset changes per location per week     WSCAgg AS    (    SELECT DISTINCT     DATEADD(DAY,1-DATEPART(WEEKDAY,repairDate),CAST(repairDate AS DATE)) AS repairDateWeek,     Latitude,    Longitude,    shopInitial,    SPLC_Name,     (shopInitial+' '+'-'+' '+ISNULL(SPLC_Name,'')+' '+'-'+' '+STR(ISNULL(CAST(latitude as varchar),''),11,6)+STR(ISNULL(cast(longitude as varchar),''),11,6)) AS repairEntityNameTypeLatLon,    ISNULL(SUM(quantity),0) AS weeklyComponentQuantity    FROM WSC     GROUP BY     DATEADD(DAY,1-DATEPART(WEEKDAY,repairDate),CAST(repairDate AS DATE)),    Latitude,    Longitude,    shopInitial,    SPLC_Name,    (shopInitial+' '+'-'+' '+ISNULL(SPLC_Name,'')+' '+'-'+' '+STR(ISNULL(CAST(latitude as varchar),''),11,6)+STR(ISNULL(cast(longitude as varchar),''),11,6))   ),  -- Calculation of moving range and moving average, note moving average is defined here over 9 weeks    WSCCalc1 AS    (     SELECT     repairDateWeek,     Latitude,    Longitude,    shopInitial,    SPLC_Name,     repairEntityNameTypeLatLon,    weeklyComponentQuantity,    ABS(weeklyComponentQuantity - LAG(weeklyComponentQuantity,1) OVER (PARTITION BY repairEntityNameTypeLatLon ORDER BY repairDateWeek)) AS movingRange,    AVG(weeklyComponentQuantity*1.0) OVER (PARTITION BY repairEntityNameTypeLatLon ORDER BY repairDateWeek ROWS BETWEEN CURRENT ROW AND 8 FOLLOWING) AS movingAvgQty9weekInitial,    AVG(weeklyComponentQuantity*1.0) OVER (PARTITION BY repairEntityNameTypeLatLon ORDER BY repairDateWeek ROWS BETWEEN CURRENT ROW AND 8 FOLLOWING) AS movingAvgQty9week    FROM WSCAgg    GROUP BY repairDateWeek, Latitude, Longitude, shopInitial, SPLC_Name, repairEntityNameTypeLatLon, weeklyComponentQuantity   )  -- Calculation next 9 weeks of component quantity as well as moving average moving range and the centerline starting point    SELECT        repairDateWeek,     Latitude,    Longitude,    shopInitial,    SPLC_Name,     repairEntityNameTypeLatLon,    weeklyComponentQuantity,     movingRange,    movingAvgQty9weekInitial,    movingAvgQty9week,   FIRST_VALUE(movingAvgQty9weekInitial) OVER (PARTITION BY repairEntityNameTypeLatLon ORDER BY repairDateWeek ROWS UNBOUNDED PRECEDING) AS centerLineStartingPt,   AVG(movingRange*1.0) OVER (PARTITION BY repairEntityNameTypeLatLon ORDER BY repairDateWeek ROWS BETWEEN CURRENT ROW AND 8 FOLLOWING) AS movingAvgMR9weekInitial,   AVG(movingRange*1.0) OVER (PARTITION BY repairEntityNameTypeLatLon ORDER BY repairDateWeek ROWS BETWEEN CURRENT ROW AND 8 FOLLOWING) AS movingAvgMR9week,   LEAD(weeklyComponentQuantity,1) OVER (PARTITION BY repairEntityNameTypeLatLon ORDER BY repairDateWeek) AS next1CQ,   LEAD(weeklyComponentQuantity,2) OVER (PARTITION BY repairEntityNameTypeLatLon ORDER BY repairDateWeek) AS next2CQ,   LEAD(weeklyComponentQuantity,3) OVER (PARTITION BY repairEntityNameTypeLatLon ORDER BY repairDateWeek) AS next3CQ,   LEAD(weeklyComponentQuantity,4) OVER (PARTITION BY repairEntityNameTypeLatLon ORDER BY repairDateWeek) AS next4CQ,   LEAD(weeklyComponentQuantity,5) OVER (PARTITION BY repairEntityNameTypeLatLon ORDER BY repairDateWeek) AS next5CQ,   LEAD(weeklyComponentQuantity,6) OVER (PARTITION BY repairEntityNameTypeLatLon ORDER BY repairDateWeek) AS next6CQ,   LEAD(weeklyComponentQuantity,7) OVER (PARTITION BY repairEntityNameTypeLatLon ORDER BY repairDateWeek) AS next7CQ,   LEAD(weeklyComponentQuantity,8) OVER (PARTITION BY repairEntityNameTypeLatLon ORDER BY repairDateWeek) AS next8CQ     INTO #WSCCalc2   FROM WSCCalc1   GROUP BY    repairDateWeek,Latitude,Longitude,shopInitial, SPLC_name,repairEntityNameTypeLatLon,weeklyComponentQuantity,movingRange,movingAvgQty9weekInitial,movingAvgQty9week   ORDER BY repairDateWeek    -- Calculation of starting point for movingAvgMR9week    ;WITH RankedData AS (   SELECT    repairDateWeek,Latitude,Longitude,shopInitial, SPLC_name,repairEntityNameTypeLatLon,weeklyComponentQuantity,movingRange,   movingAvgQty9weekInitial,movingAvgQty9week, centerLineStartingPt, movingAvgMR9weekInitial,   movingAvgMR9week, next1CQ, next2CQ, next3CQ, next4CQ, next5CQ, next6CQ, next7CQ, next8CQ,   --ROW_NUMBER() OVER (PARTITION BY repairEntityNameTypeLatLon ORDER BY repairDateWeek) AS RowNum,   FIRST_VALUE(isnull(movingAvgMR9weekInitial,0)) OVER (PARTITION BY repairEntityNameTypeLatLon ORDER BY repairDateWeek ROWS UNBOUNDED PRECEDING) AS MRStartingPt   FROM #WSCCalc2   )   SELECT   repairDateWeek,Latitude,Longitude,shopInitial, SPLC_name,repairEntityNameTypeLatLon,weeklyComponentQuantity,movingRange,   movingAvgQty9weekInitial,movingAvgQty9week, centerLineStartingPt, movingAvgMR9weekInitial,   movingAvgMR9week,   --(SELECT TOP 1 isnull(movingAvgMR9week,0) FROM RankedData WHERE RowNum = 2) AS MRStartingPt,   MRStartingPt,   next1CQ, next2CQ, next3CQ, next4CQ, next5CQ, next6CQ, next7CQ, next8CQ     INTO #WSCCalc3   FROM RankedData     -- The following code is in order to update the value for centerline step with the new component quantity if the values hit a certain threshold   IF OBJECT_ID('tempdb..#t1') IS NOT NULL DROP TABLE #t1   IF OBJECT_ID('tempdb..#t2') IS NOT NULL DROP TABLE #t2     CREATE TABLE #t1   (    ID int identity(1,1)    ,repairDateWeek date    ,repairEntityNameTypeLatLon varchar(200)     ,CenterlineStartingPt float    ,MRStartingPt float    )   CREATE TABLE #t2   (     repairDateWeek date    ,repairEntityNameTypeLatLon varchar(200)    ,CenterlineStep float    ,MRStep float    )     ;WITH CTE AS   (    SELECT      ROW_NUMBER() OVER (PARTITION BY repairEntityNameTypeLatLon ORDER BY repairDateWeek) AS RowNum,     repairDateWeek,     repairEntityNameTypeLatLon,      CenterlineStartingPt,     MRStartingPt      FROM #WSCCalc3   )     INSERT INTO #t1 (repairDateWeek,repairEntityNameTypeLatLon,CenterlineStartingPt,MRStartingPt)   SELECT repairDateWeek,repairEntityNameTypeLatLon,centerlineStartingPt,MRStartingPt   FROM CTE   ORDER BY repairEntityNameTypeLatLon,repairDateWeek     DECLARE @centerlinestep float = (select CenterlineStartingPt from #t1 where id =1)    DECLARE @centerlinestep_prv float   DECLARE @mrstep float = (select MRStartingPt from #t1 where id =1)    DECLARE @repairDateWeek date    DECLARE @repairEntityNameTypeLatLon_prv varchar(200) =(SELECT repairEntityNameTypeLatLon from #t1 where id=1)   DECLARE @repairEntityNameTypeLatLon varchar(200)    DECLARE @init int=1   DECLARE @cnt int=(SELECT COUNT(1) FROM #t1)      WHILE(@init<=@cnt)   BEGIN           SET @repairEntityNameTypeLatLon=(SELECT repairEntityNameTypeLatLon from #t1 where id=@init)    SET @repairDateWeek= (select repairDateWeek from #t1 where id=@init)    if(@repairEntityNameTypeLatLon_prv!= @repairEntityNameTypeLatLon)    begin       set @centerlinestep = (select CenterlineStartingPt from #t1 where id = @init)        set @mrstep = (select MRStartingPt from #t1 where id = @init)        set @repairEntityNameTypeLatLon_prv = @repairEntityNameTypeLatLon    end    SET @centerlinestep_prv = @centerlinestep    SET @centerlinestep =        (SELECT DISTINCT        IIF (        (weeklyComponentQuantity > @centerlinestep        AND next1CQ > @centerlinestep        AND next2CQ > @centerlinestep        AND next3CQ > @centerlinestep        AND next4CQ > @centerlinestep        AND next5CQ > @centerlinestep        AND next6CQ > @centerlinestep        AND next7CQ > @centerlinestep        AND next8CQ > @centerlinestep)        OR        (weeklyComponentQuantity < @centerlinestep        AND next1CQ < @centerlinestep        AND next2CQ < @centerlinestep        AND next3CQ < @centerlinestep        AND next4CQ < @centerlinestep        AND next5CQ < @centerlinestep        AND next6CQ < @centerlinestep        AND next7CQ < @centerlinestep        AND next8CQ < @centerlinestep),        movingAvgQty9week,         @centerlinestep)        FROM #t1        INNER JOIN #WSCCalc3 AS wsc        ON #t1.repairDateWeek = wsc.repairDateWeek        AND #t1.repairEntityNameTypeLatLon = wsc.repairEntityNameTypeLatLon               WHERE #t1.ID = @init)          if (@centerlinestep_prv <> @centerlinestep or (@repairEntityNameTypeLatLon_prv!= @repairEntityNameTypeLatLon))    begin    SET @mrstep =        (SELECT DISTINCT         IIF (         (weeklyComponentQuantity > @centerlinestep_prv         AND next1CQ > @centerlinestep_prv         AND next2CQ > @centerlinestep_prv         AND next3CQ > @centerlinestep_prv         AND next4CQ > @centerlinestep_prv         AND next5CQ > @centerlinestep_prv         AND next6CQ > @centerlinestep_prv         AND next7CQ > @centerlinestep_prv         AND next8CQ > @centerlinestep_prv)         OR         (weeklyComponentQuantity < @centerlinestep_prv         AND next1CQ < @centerlinestep_prv         AND next2CQ < @centerlinestep_prv         AND next3CQ < @centerlinestep_prv         AND next4CQ < @centerlinestep_prv         AND next5CQ < @centerlinestep_prv         AND next6CQ < @centerlinestep_prv         AND next7CQ < @centerlinestep_prv         AND next8CQ < @centerlinestep_prv),         movingAvgMR9week,          @mrstep)        FROM #t1        INNER JOIN #WSCCalc3 AS wsc        ON #t1.repairDateWeek = wsc.repairDateWeek        AND #t1.repairEntityNameTypeLatLon = wsc.repairEntityNameTypeLatLon               WHERE #t1.ID = @init)     end          INSERT INTO #t2    values(@repairDateWeek,@repairEntityNameTypeLatLon,@centerlinestep,@mrstep)      SET @init= @init+1   END    DELETE FROM dbo.wheelsetRepairOutlier WHERE 1=1  INSERT INTO dbo.wheelsetRepairOutlier  (    repairDateWeek   ,shopInitial   ,splcName   ,repairEntityNameTypeLatLon   ,latitude   ,longitude   ,weeklyComponentQuantity   ,movingAvgQty9week   ,movingRange   ,movingAvgMR9week   ,mrStartingPt   ,mrStep   ,centerLineStartingPt   ,centerLineStep   ,next1CQ   ,next2CQ   ,next3CQ   ,next4CQ   ,next5CQ   ,next6CQ   ,next7CQ   ,next8CQ   ,createdDate   ,createdUsername  )  SELECT  t1.repairDateWeek  ,t1.shopInitial  ,t1.SPLC_Name  ,t1.repairEntityNameTypeLatLon  ,t1.Latitude  ,t1.Longitude  ,t1.weeklyComponentQuantity  ,t1.movingAvgQty9week  ,t1.movingRange  ,t1.movingAvgMR9week  ,t1.MRStartingPt  ,t2.MRStep  ,t1.centerLineStartingPt  ,t2.centerlineStep  ,t1.next1CQ  ,t1.next2CQ  ,t1.next3CQ  ,t1.next4CQ  ,t1.next5CQ  ,t1.next6CQ  ,t1.next7CQ  ,t1.next8CQ  , GETDATE() AS createdDate  ,'SSIS_PKG' AS createdUsername  FROM #WSCCalc3 AS t1   INNER JOIN #t2 AS t2 ON t1.repairDateWeek = t2.repairDateWeek and t1.repairEntityNameTypeLatLon = t2.repairEntityNameTypeLatLon    GROUP BY t1.repairDateWeek,t1.shopInitial,t1.SPLC_Name,t1.repairEntityNameTypeLatLon,t1.Latitude,t1.Longitude,t1.weeklyComponentQuantity,  t1.movingRange,t1.movingAvgQty9week,t1.MRStartingPt,t2.MRStep,t1.centerLineStartingPt,t1.movingAvgMR9week,t1.next1CQ,t1.next2CQ,t1.next3CQ,  t1.next4CQ,t1.next5CQ,t1.next6CQ,t1.next7CQ,t1.next8CQ, t2.CenterlineStep    ORDER BY t1.repairEntityNameTypeLatLon,repairDateWeek  END"
    },
    {
      "id": "vw_Car_Count_Fact",
      "name": "vw_Car_Count_Fact",
      "type": "VIEW",
      "sql": "CREATE VIEW [dbo].[vw_Car_Count_Fact]  WITH SCHEMABINDING  AS  SELECT [Car_Count_Fact_Id]        ,[Car_Dimn_Id]        ,[Car_Ver]        ,[Dt_Dimn_Id]        ,[Row_Typ_Id]        ,[Car_Cnt_Catg_Typ_Id]        ,[Car_Init]        ,[Car_Nr]        ,[Attr_Val_Char_1]        ,[Attr_Val_Char_2]        ,[Attr_Val_Char_3]        ,[Attr_Val_Char_4]        ,[Attr_Val_Char_5]        ,[Attr_Val_Num_1]        ,[Attr_Val_Num_2]        ,[Attr_Val_Num_3]        ,[Attr_Val_Num_4]        ,[Attr_Val_Num_5]        ,[Attr_Id_1]        ,[Attr_Id_2]        ,[Attr_Id_3]        ,[Attr_Id_4]        ,[Attr_Id_5]        ,[Attr_Ver_1]        ,[Attr_Ver_2]        ,[Attr_Ver_3]        ,[Attr_Ver_4]        ,[Attr_Ver_5]        ,[Car_Cnt]        ,[TPE_Cnt]        ,[Ut_Cnt]        ,[Pltfm_Cnt]     ,[Car_Idle_Cnt]     ,[Owned_Idle_Empty_Car_Cnt]        ,[Crtd_Id]        ,[Crtd_Dt]        ,[Lst_Upd_Id]        ,[Lst_Upd_Dt]        ,[Src_Sys_Nm]        ,[Dq_Flg]     ,Liability_Event_Dt,     Car_Idle_No_Movement_CNT,     Owned_Idle_Empty_Car_Count_No_Movement    FROM [dbo].[car_count_fact]"
    },
    {
      "id": "VLabor_Time_Entry_Fact",
      "name": "VLabor_Time_Entry_Fact",
      "type": "VIEW",
      "sql": "CREATE VIEW [DDSV].[VLabor_Time_Entry_Fact] AS    SELECT [Mth_Dimn_Id]=Cast(left([Dt_Dimn_Id],6) as Int)        ,concat(convert (varchar(10),Repr_Enty_Dimn_Id),'_',convert(varchar(5),Repr_Enty_Ver)) as Repr_Enty_Dimn_Id        ,cast(Repr_Typ_Dimn_Id as int) as [Repr_Typ_Dimn_Id]        ,[FMO_Dir_Hrs]        ,[FMO_Indir_Hrs]        ,[Air_Brk_Tst_Hrs]        ,[Car_Insp_Hrs]        ,[Car_Repr_Hrs]        ,[Tot_Car_Repr_Hrs]        ,[Rack_Insp_Hrs]        ,[Rack_Repr_Hrs]        ,[Tot_Rack_Repr_Hrs]        ,[Paid_Absn_Hrs]        ,[Spvs_Hrs]        ,[Vac_Hrs]        ,[Brk_Tst_Hrs]        ,[Repr_Hrs]        ,[Totl_Hrs]        ,[Totl_Insp_Cnt]        ,[Overtime_Hrs]        ,[Avg_Mth_LO_Cost]        ,[Head_Cnt]        ,[Totl_Other_Hrs]        ,[Crtd_Dt]        ,[Crtd_Id]        ,[Lst_Upd_Dt]        ,[Lst_Upd_Id]    FROM [DDSMRT].[dbo].[Labor_Time_Entry_Fact] (NOLOCK)"
    },
    {
      "id": "Car_Hire_Status",
      "name": "Car_Hire_Status",
      "type": "VIEW",
      "sql": "CREATE VIEW [SV].[Car_Hire_Status]  AS    SELECT -1 as Car_Hire_Status_Dimn_Id, NULL as Car_Hire_Status_Value  union all  SELECT 1 as Car_Hire_Status_Dimn_Id, 'Y' as Car_Hire_Status_Value  union all   SELECT 2 as Car_Hire_Status_Dimn_Id, 'N' as Car_Hire_Status_Value"
    },
    {
      "id": "vw_Car_Count_Fact_History",
      "name": "vw_Car_Count_Fact_History",
      "type": "VIEW",
      "sql": "CREATE VIEW [dbo].[vw_Car_Count_Fact_History]  WITH SCHEMABINDING  AS    SELECT [Car_Count_Fact_Id]        ,[Car_Dimn_Id]        ,[Car_Ver]        ,[Dt_Dimn_Id]        ,[Row_Typ_Id]        ,[Car_Cnt_Catg_Typ_Id]        ,[Car_Init]        ,[Car_Nr]        ,[Attr_Val_Char_1]        ,[Attr_Val_Char_2]        ,[Attr_Val_Char_3]        ,[Attr_Val_Char_4]        ,[Attr_Val_Char_5]        ,[Attr_Val_Num_1]        ,[Attr_Val_Num_2]        ,[Attr_Val_Num_3]        ,[Attr_Val_Num_4]        ,[Attr_Val_Num_5]        ,[Attr_Id_1]        ,[Attr_Id_2]        ,[Attr_Id_3]        ,[Attr_Id_4]        ,[Attr_Id_5]        ,[Attr_Ver_1]        ,[Attr_Ver_2]        ,[Attr_Ver_3]        ,[Attr_Ver_4]        ,[Attr_Ver_5]        ,[Car_Cnt]        ,[TPE_Cnt]        ,[Ut_Cnt]        ,[Pltfm_Cnt]     ,[Car_Idle_Cnt]     ,[Owned_Idle_Empty_Car_Cnt]        ,[Crtd_Id]        ,[Crtd_Dt]        ,[Lst_Upd_Id]        ,[Lst_Upd_Dt]        ,[Src_Sys_Nm]        ,[Dq_Flg]     ,Liability_Event_Dt     ,Car_Idle_No_Movement_CNT,     Owned_Idle_Empty_Car_Count_No_Movement  FROM [dbo].[Car_Count_Fact_History]"
    },
    {
      "id": "VLocation",
      "name": "VLocation",
      "type": "VIEW",
      "sql": "CREATE VIEW [DDSV].[VLocation]  AS    SELECT cast(SPLC_Dim.SPLC_Dimn_Id as int) as  Geo_Dimn_Id        ,concat(SPLC_Dim.SPLC, SPLC_Dim.SPLC_Nm) as Location    ,geo.cntry as Country    ,geo.St_Prov    ,geo.county as County    -- Change for IR755306    ,isnull(CASE WHEN ((geo.Row_Typ_Id = 512 AND  geo.Src_Sys_Nm = 'IANA') OR (geo.Row_typ_id <>512 and geo.Src_Sys_Nm <> 'IANA'))  THEN geo.Regn_Ext ELSE NULL END, 'Unknown') AS Regn_IANA    ,ISNULL(CASE WHEN ((geo.Row_Typ_Id = 512 AND geo.Src_Sys_Nm = 'IANA') OR (geo.Row_typ_id <>512 and geo.Src_Sys_Nm <> 'IANA'))  THEN geo.Regn_Ext_Desc ELSE NULL END, 'Unknown') AS Regn_IANA_Desc    ,SPLC_Dim.SPLC_Nm AS SPLC_Name      -- IR920227    ,CASE           WHEN PortLocation IS NOT NULL THEN 'Y'          ELSE 'N' END AS Is_Port_Location        -- IR920227   FROM SPLC_Dim   left join Geography_Dim geo   on (SPLC_Dim.geo_dimn_id = geo.geo_dimn_id)     -- IR920227   LEFT JOIN SPLC_PortLocations pl on concat(SPLC_Dim.SPLC, SPLC_Dim.SPLC_Nm) = pl.PortLocation     -- IR920227"
    },
    {
      "id": "missedOpportunity",
      "name": "missedOpportunity",
      "type": "VIEW",
      "sql": "CREATE VIEW sv.missedOpportunity  AS    with cte  as  (   Select  wd.Wo_Num,   Wo_Stat_Desc,   dd1.Dt As APPR_From_Date,   ISNULL(CASE WHEN wd.wo_num = LEAD(wd.wo_num, 1, NULL) OVER ( ORDER BY wd.wo_num, wd.Wo_Ver )  THEN LEAD(dd1.Dt, 1, NULL) OVER ( ORDER BY wd.wo_num, wd.Wo_Ver )      ELSE NULL   END,'2099-12-31') AS APPR_To_Date   FROM workorder_dim wd with(nolock)   INNER JOIN workorder_fact wf with(nolock)     ON wd.Wo_Dimn_Id = wf.Wo_Dimn_Id AND wd.Wo_Ver = wf.Wo_Ver   INNER JOIN Date_Dim dd1 with(nolock)     ON dd1.Dt_Dimn_Id = wf.Change_Dt_Dimn_Id   INNER JOIN    (    SELECT DISTINCT Wo_Num     FROM workorder_dim wd1 with(nolock)      INNER JOIN workorder_fact wf1 with(nolock)       ON wd1.Wo_Dimn_Id = wf1.Wo_Dimn_Id AND wd1.Wo_Ver = wf1.Wo_Ver     WHERE wd1.Eff_To is null   ) flag   ON flag.Wo_Num = wd.Wo_Num  ),    CTE1 AS  (  SELECT      Car_Id   ,Insp_Repr_Enty_Id AS Repr_Enty_Id   ,Wo_Id   ,Insp_Dt_Dimn_Id   ,Job_Plan_Dimn_Id   ,Unit_Dimn_Id   ,Wo_Gen_Map_Id   ,Area_Of_Car_Id   ,Spare_Prt_Dimn_Id   ,Car_Loc_Dimn_Id   ,0 AS Insp_Cnt   ,0 AS Labr_Hrs   ,Opn_Wo_Cnt   ,Cls_Wo_Cnt   ,0 AS UnitCount  FROM (        SELECT  CONCAT(ISNULL(cif.Car_Dimn_Id,'-1'),'|',ISNULL(cif.Car_Ver,'-1')) As Car_Id,          CONCAT(ISNULL(cif.Repr_Enty_Dimn_Id,'-1'),'|',ISNULL(cif.Repr_Enty_Ver,'-1')) As Insp_Repr_Enty_Id,          CONCAT(ISNULL(Wo.Repr_Enty_Dimn_Id,'-1'),'|',ISNULL(Wo.Repr_Enty_Ver,'-1')) As Cls_Repr_Enty_Id,          CONCAT(ISNULL(wo.Wo_Dimn_Id,'-1'),'|',ISNULL(wo.Wo_Ver,'-1')) As Wo_Id          ,ISNULL(cif.Insp_Dt_Dimn_Id,'-1') Insp_Dt_Dimn_Id          ,ISNULL(Wo.Change_Dt_Dimn_Id,'-1') Change_Dt_Dimn_Id          ,ISNULL(wo.Job_Plan_Dimn_Id,'-1') Job_Plan_Dimn_Id          ,ISNULL(wo.Unit_Dimn_Id,'-1') Unit_Dimn_Id          ,ISNULL(wo.Wo_Gen_Map_Id,'-1') Wo_Gen_Map_Id          ,CONCAT(ISNULL(wo.Area_Of_Car_Dimn_Id,'-1'),'|',ISNULL(wo.Area_Of_Car_Ver,'-1')) As Area_Of_Car_Id          ,ISNULL(wo.Spare_Prt_Dimn_Id,'-1') Spare_Prt_Dimn_Id          ,ISNULL(wo.Car_Loc_Dimn_Id,'-1') Car_Loc_Dimn_Id          ,cif.Insp_Cnt          ,NULL As Labr_Hrs          ,1 As Opn_Wo_Cnt          ,(CASE WHEN wo.Wo_Stat_Desc = 'CLOSE'               AND convert(date,dd3.dt) <= (convert(date,(dateadd(day,5,dd2.dt))))               AND cif.Repr_Enty_Dimn_Id = wo.Repr_Enty_Dimn_Id               AND cif.Repr_Enty_Ver = wo.Repr_Enty_Ver THEN 1               WHEN ISNULL(wo.Wo_Num,'-1') = '-1' THEN 1              ELSE 0 END) As Cls_Wo_Cnt           ,cif.Ut_Cnt As UnitCount          ,Wo_Stat_Desc As Crnt_Status      FROM Car_Inspection_Fact cif with(nolock)      INNER JOIN Date_Dim dd2 with(nolock)       ON dd2.Dt_Dimn_Id = cif.Insp_Dt_Dimn_Id       INNER JOIN    (     SELECT wd.Wo_Num     ,cdc.car_init As car_init     ,cdc.Car_Nr As Car_nr     ,wf.Repr_Enty_Dimn_Id As Repr_Enty_Dimn_Id     ,wf.Repr_Enty_Ver As Repr_Enty_Ver     ,wf.Job_Plan_Dimn_Id     ,wf.Unit_Dimn_Id     ,wf.Wo_Gen_Map_Id     ,wf.Area_Of_Car_Dimn_Id     ,wf.Area_Of_Car_Ver     ,wf.Spare_Prt_Dimn_Id     ,wf.Car_Loc_Dimn_Id     ,wd.Wo_Dimn_Id As Wo_Dimn_Id     ,wd.Wo_Ver As Wo_Ver     ,APPR_From_Date     ,APPR_To_Date     ,wd.Wo_Stat_Desc     ,wf.Change_Dt_Dimn_Id     FROM CTE AS td      INNER JOIN Workorder_Dim wd with(nolock)     ON td.wo_num = wd.wo_num AND wd.Eff_to IS NULL     INNER JOIN Workorder_Fact wf with(nolock)     ON wd.Wo_Dimn_Id = wf.Wo_Dimn_Id AND wd.Wo_Ver = wf.Wo_Ver     INNER JOIN CAR_DIM_CORRECT cdc with(nolock)     ON wf.Car_Dimn_Id = cdc.Car_Dimn_Id and wf.Car_Ver = cdc.Car_Ver      WHERE td.Wo_Stat_Desc = 'APPR'     ) WO         ON cif.car_init = wo.car_init and cif.Car_Nr = wo.Car_Nr        AND dd2.Dt BETWEEN wo.APPR_From_Date AND wo.APPR_To_Date     INNER JOIN Date_Dim dd3 with(nolock)     on dd3.dt_dimn_id = ISNULL(wo.Change_Dt_Dimn_Id,'20991231')  )Dtl1  WHERE NOT(  (Insp_Dt_Dimn_Id=  Change_Dt_Dimn_Id AND Insp_Repr_Enty_Id <> Cls_Repr_Enty_Id AND Crnt_Status = 'CLOSE')   OR  (Insp_Dt_Dimn_Id = Change_Dt_Dimn_Id AND Crnt_Status = 'MNTCOMP'))  ),    CTE2 AS  (  SELECT CONCAT(ISNULL(Car_Dimn_Id,'-1'),'|',ISNULL(Car_Ver,'-1')) As Car_Id,    CONCAT(ISNULL(Repr_Enty_Dimn_Id,'-1'),'|',ISNULL(Repr_Enty_Ver,'-1')) As Repr_Enty_Id    ,'-1|-1' AS Wo_Id    ,Insp_Dt_Dimn_Id    ,'-1' AS Job_Plan_Dimn_Id    ,'-1' AS Unit_Dimn_Id    ,'-1' AS Wo_Gen_Map_Id    ,'-1|-1' AS Area_Of_Car_Id    ,'-1' AS Spare_Prt_Dimn_Id    ,'-1' AS Car_Loc_Dimn_Id    ,1 AS Insp_Cnt    ,0 As Labr_Hrs    ,0 AS Opn_Wo_Cnt    ,0 AS Cls_Wo_Cnt    ,Ut_Cnt AS UnitCount  FROM CAR_INSPECTION_FACT WITH(NOLOCK)  ),    CTE3 AS(  SELECT          Car_Id      ,Insp_Repr_Enty_Id AS Repr_Enty_Id      ,Wo_Id      ,Insp_Dt_Dimn_Id      ,Job_Plan_Dimn_Id      ,Unit_Dimn_Id      ,Wo_Gen_Map_Id      ,Area_Of_Car_Id      ,Spare_Prt_Dimn_Id      ,Car_Loc_Dimn_Id      ,0 AS Insp_Cnt      ,0 AS Labr_Hrs      ,Opn_Wo_Cnt      ,Cls_Wo_Cnt      ,0 AS UnitCount  FROM   (      SELECT  CONCAT(ISNULL(cif.Car_Dimn_Id,'-1'),'|',ISNULL(cif.Car_Ver,'-1')) As Car_Id,      CONCAT(ISNULL(cif.Repr_Enty_Dimn_Id,'-1'),'|',ISNULL(cif.Repr_Enty_Ver,'-1')) As Insp_Repr_Enty_Id,      CONCAT(ISNULL(Wo.Repr_Enty_Dimn_Id,'-1'),'|',ISNULL(Wo.Repr_Enty_Ver,'-1')) As Cls_Repr_Enty_Id,      CONCAT(ISNULL(wo.Wo_Dimn_Id,'-1'),'|',ISNULL(wo.Wo_Ver,'-1')) As Wo_Id      ,ISNULL(cif.Insp_Dt_Dimn_Id,'-1') Insp_Dt_Dimn_Id      ,ISNULL(Wo.Change_Dt_Dimn_Id,'-1') Change_Dt_Dimn_Id      ,ISNULL(wo.Job_Plan_Dimn_Id,'-1') Job_Plan_Dimn_Id      ,ISNULL(wo.Unit_Dimn_Id,'-1') Unit_Dimn_Id      ,ISNULL(wo.Wo_Gen_Map_Id,'-1') Wo_Gen_Map_Id      ,CONCAT(ISNULL(wo.Area_Of_Car_Dimn_Id,'-1'),'|',ISNULL(wo.Area_Of_Car_Ver,'-1')) As Area_Of_Car_Id      ,ISNULL(wo.Spare_Prt_Dimn_Id,'-1') Spare_Prt_Dimn_Id      ,ISNULL(wo.Car_Loc_Dimn_Id,'-1') Car_Loc_Dimn_Id      ,cif.Insp_Cnt      ,NULL As Labr_Hrs      ,1 As Opn_Wo_Cnt      ,(CASE WHEN wo.Wo_Stat_Desc = 'CLOSE'           AND convert(date,dd3.dt) <= (convert(date,(dateadd(day,5,dd2.dt))))           AND cif.Repr_Enty_Dimn_Id = wo.Repr_Enty_Dimn_Id           AND cif.Repr_Enty_Ver = wo.Repr_Enty_Ver THEN 1           WHEN ISNULL(wo.Wo_Num,'-1') = '-1' THEN 1          ELSE 0 END) As Cls_Wo_Cnt          ,cif.Ut_Cnt As UnitCount      ,Wo_Stat_Desc As Crnt_Status      FROM Car_Inspection_Fact cif  WITH(NOLOCK)      INNER JOIN Date_Dim dd2  WITH(NOLOCK)       ON dd2.Dt_Dimn_Id = cif.Insp_Dt_Dimn_Id       INNER JOIN    (     SELECT wd.Wo_Num     ,cdc.car_init As car_init     ,cdc.Car_Nr As Car_nr     ,wf.Repr_Enty_Dimn_Id As Repr_Enty_Dimn_Id     ,wf.Repr_Enty_Ver As Repr_Enty_Ver     ,wf.Job_Plan_Dimn_Id     ,wf.Unit_Dimn_Id     ,wf.Wo_Gen_Map_Id     ,wf.Area_Of_Car_Dimn_Id     ,wf.Area_Of_Car_Ver     ,wf.Spare_Prt_Dimn_Id     ,wf.Car_Loc_Dimn_Id     ,wd.Wo_Dimn_Id As Wo_Dimn_Id     ,wd.Wo_Ver As Wo_Ver     ,APPR_From_Date     ,APPR_To_Date     ,wd.Wo_Stat_Desc     ,wf.Change_Dt_Dimn_Id     FROM CTE AS td      INNER JOIN Workorder_Dim wd WITH(NOLOCK)     ON td.wo_num = wd.wo_num AND wd.Eff_to IS NULL     INNER JOIN Workorder_Fact wf  WITH(NOLOCK)     ON wd.Wo_Dimn_Id = wf.Wo_Dimn_Id AND wd.Wo_Ver = wf.Wo_Ver     INNER JOIN CAR_DIM_CORRECT cdc  WITH(NOLOCK)     ON wf.Car_Dimn_Id = cdc.Car_Dimn_Id and wf.Car_Ver = cdc.Car_Ver      WHERE td.Wo_Stat_Desc <> 'CLOSE'       ) WO        ON cif.car_init = wo.car_init and cif.Car_Nr = wo.Car_Nr          AND dd2.Dt BETWEEN wo.APPR_From_Date AND wo.APPR_To_Date       INNER JOIN Date_Dim dd3  WITH(NOLOCK)          ON dd3.dt_dimn_id = ISNULL(wo.Change_Dt_Dimn_Id,'20991231')          AND convert(date,dd3.dt) <= (convert(date,(dateadd(day,5,dd2.dt))))     )Dtl1  WHERE   Insp_Repr_Enty_Id = Cls_Repr_Enty_Id AND Crnt_Status = 'CLOSE'   )    SELECT * FROM CTE1   UNION   SELECT * FROM CTE2   UNION   SELECT * FROM CTE3"
    },
    {
      "id": "vw_Car_Count_Fact_All",
      "name": "vw_Car_Count_Fact_All",
      "type": "VIEW",
      "sql": "CREATE VIEW [dbo].[vw_Car_Count_Fact_All]  WITH SCHEMABINDING  AS  SELECT [Car_Count_Fact_Id]        ,[Car_Dimn_Id]        ,[Car_Ver]        ,[Dt_Dimn_Id]        ,[Row_Typ_Id]        ,[Car_Cnt_Catg_Typ_Id]        ,[Car_Init]        ,[Car_Nr]        ,[Attr_Val_Char_1]        ,[Attr_Val_Char_2]        ,[Attr_Val_Char_3]        ,[Attr_Val_Char_4]        ,[Attr_Val_Char_5]        ,[Attr_Val_Num_1]        ,[Attr_Val_Num_2]        ,[Attr_Val_Num_3]        ,[Attr_Val_Num_4]        ,[Attr_Val_Num_5]        ,[Attr_Id_1]        ,[Attr_Id_2]        ,[Attr_Id_3]        ,[Attr_Id_4]        ,[Attr_Id_5]        ,[Attr_Ver_1]        ,[Attr_Ver_2]        ,[Attr_Ver_3]        ,[Attr_Ver_4]        ,[Attr_Ver_5]        ,[Car_Cnt]        ,[TPE_Cnt]        ,[Ut_Cnt]        ,[Pltfm_Cnt]     ,[Car_Idle_Cnt]     ,[Owned_Idle_Empty_Car_Cnt]        ,[Crtd_Id]        ,[Crtd_Dt]        ,[Lst_Upd_Id]        ,[Lst_Upd_Dt]        ,[Src_Sys_Nm]        ,[Dq_Flg]     ,Liability_Event_Dt     ,Car_Idle_No_Movement_CNT,     Owned_Idle_Empty_Car_Count_No_Movement    FROM [dbo].[car_count_fact]      UNION ALL      SELECT [Car_Count_Fact_Id]        ,[Car_Dimn_Id]        ,[Car_Ver]        ,[Dt_Dimn_Id]        ,[Row_Typ_Id]        ,[Car_Cnt_Catg_Typ_Id]        ,[Car_Init]        ,[Car_Nr]        ,[Attr_Val_Char_1]        ,[Attr_Val_Char_2]        ,[Attr_Val_Char_3]        ,[Attr_Val_Char_4]        ,[Attr_Val_Char_5]        ,[Attr_Val_Num_1]        ,[Attr_Val_Num_2]        ,[Attr_Val_Num_3]        ,[Attr_Val_Num_4]        ,[Attr_Val_Num_5]        ,[Attr_Id_1]        ,[Attr_Id_2]        ,[Attr_Id_3]        ,[Attr_Id_4]        ,[Attr_Id_5]        ,[Attr_Ver_1]        ,[Attr_Ver_2]        ,[Attr_Ver_3]        ,[Attr_Ver_4]        ,[Attr_Ver_5]        ,[Car_Cnt]        ,[TPE_Cnt]        ,[Ut_Cnt]        ,[Pltfm_Cnt]     ,[Car_Idle_Cnt]     ,[Owned_Idle_Empty_Car_Cnt]        ,[Crtd_Id]        ,[Crtd_Dt]        ,[Lst_Upd_Id]        ,[Lst_Upd_Dt]        ,[Src_Sys_Nm]        ,[Dq_Flg]     ,Liability_Event_Dt     ,Car_Idle_No_Movement_CNT,     Owned_Idle_Empty_Car_Count_No_Movement  FROM [dbo].[Car_Count_Fact_History]"
    },
    {
      "id": "VOrganization_Entity_Dim",
      "name": "VOrganization_Entity_Dim",
      "type": "VIEW",
      "sql": "create view [DDSV].[VOrganization_Entity_Dim] as   select concat(convert(varchar(10),Org_Dimn_Id),'_',convert(varchar(5), Org_Ver)) as [Org_Enty_Dimn_Id]        ,[Pty_Id]        ,concat(convert(varchar(10),ISNULL(Prnt_Org_Dimn_Id,-1)),'_',convert(varchar(5), ISNULL(Prnt_Org_Ver,-1))) as [Parnt_Org_Id]        ,Org_Abrv as [Curr_Abrv]        ,Org_Nm as [Curr_Org_Nm]        ,cast(NULL as varchar(50)) as [City_Nm]        ,cast(NULL as varchar(25)) as [St_Prov_Regn]        ,cast(NULL as varchar(255)) as [Org_Typ_Desc]        ,[Crtd_Dt]        ,[Crtd_Id]        ,[Lst_Upd_Dt]        ,[Lst_Upd_Id]  from ddsmrt.dbo.Organization_Dim (NOLOCK)"
    },
    {
      "id": "vw_Pool_Contribution_Fact",
      "name": "vw_Pool_Contribution_Fact",
      "type": "VIEW",
      "sql": "CREATE VIEW [dbo].[vw_Pool_Contribution_Fact] AS  SELECT [Pool_Contribution_Id]        ,[Dt_Dimn_Id]        ,[Asgn_Rd_Dimn_Id]        ,[Asgn_Rd_Ver]        ,[Resp_Rd_Dimn_Id]        ,[Resp_Rd_Ver]        ,[Last_Part_Rd_Dimn_Id]        ,[Last_Part_Rd_Ver]        ,[Car_Dimn_Id]        ,[Car_Ver]        ,[Nr_Cd_Dimn_Id]        ,[UFD_Eq_Sts_Dimn_Id]        ,[Curr_Part_Rd_Dimn_Id]        ,[Curr_Part_Rd_Ver]        ,[Rpt_Rd_Dimn_Id]        ,[Rpt_Rd_Ver]        ,[Orig_Dist_Enty_Dimn_Id]        ,[Orig_Dist_Enty_Ver]        ,[Dest_Dist_Enty_Dimn_Id]        ,[Dest_Dist_Enty_Ver]        ,[Run_Dt]        ,[Asgn_Rd_Mrk]        ,[Resp_Rd_Mrk]        ,[Last_Part_Rd_Mrk]        ,[Rpt_Rd_Mrk]        ,[Railcar]        ,[Car_Nr]        ,[Car_Init]        ,[NR_Cd]        ,[UFD_Equip_Sts]        ,[Dy_Ld_Cnt]        ,[Dy_Emp_Cnt]        ,[Dy_Unknown_Cnt]        ,[Car_Stor_Cnt]        ,[Car_Pd_Stor_Cnt]        ,[Car_In_Shop_Cnt]        ,[Car_Enrt_Cnt]        ,[Car_Bad_Ordr_Cnt]        ,[Car_Idle_Cnt]        ,[Car_Hire_Sts]        ,[Bad_Ordr_Sts]        ,[Curr_Trip_Sts]        ,[Lst_Evnt_Typ]        ,[Ld_Plc_Cnt]        ,[Ld_Arr_Cnt]        ,[Crtd_Dt]        ,[Crtd_Id]        ,[Lst_Upd_Dt]        ,[Lst_Upd_Id]     ,Liability_Event_Dt    FROM [dbo].[Pool_Contribution_Fact]"
    },
    {
      "id": "Revenue_Accounting_Accrual_Car_Count_Hist",
      "name": "Revenue_Accounting_Accrual_Car_Count_Hist",
      "type": "VIEW",
      "sql": "CREATE view [SV].[Revenue_Accounting_Accrual_Car_Count_Hist] as    --Accrual  select   Car_Dimn_Id  ,Car_Ver    ,Dt_Dimn_Id as Service_Month_Start_Dt_Dimn_Id  ,Car_Cnt_Catg_Typ_Id  ,Responsible_Road_Org_Mbrshp_Dimn_Id  ,Responsible_Road_Org_Mbrshp_Ver  ,liable_rd_mbrshp_dimn_id  ,liable_rd_mbrshp_ver  ,Liable_org_dimn_id  ,Liable_Org_Ver     ,(Cast([Car_Dimn_Id] AS VARCHAR) + '|' + Cast([Car_Ver] AS VARCHAR)) AS Car_ID     ,(Cast(liable_rd_mbrshp_dimn_id AS VARCHAr) + '|' + Cast(liable_rd_mbrshp_ver AS VARCHAR)) AS Liable_Road_ID     ,(Cast([Responsible_Road_Org_Mbrshp_Dimn_Id] AS VARCHAR) + '|' + Cast([Responsible_Road_Org_Mbrshp_Ver] AS VARCHAR)) AS Resp_Road_ID     ,(Cast([Liable_Org_Dimn_Id] AS VARCHAr) + '|' + Cast([Liable_Org_Ver] AS VARCHAR)) AS Liable_Dimn_ID     ,(Cast([Responsible_Org_Dimn_Id] AS VARCHAR) + '|' + Cast([Responsible_Org_Ver] AS VARCHAR)) AS Resp_Dimn_ID    ,Car_Cnt  ,TPE_Cnt  ,Ut_Cnt  ,Pltfm_Cnt    from (  select    f.car_dimn_id  ,f.car_ver  ,f.Dt_Dimn_Id  ,f.car_Cnt_Catg_Typ_id  ,f.Attr_Id_1  as Responsible_Road_Org_Mbrshp_Dimn_Id  ,f.Attr_Ver_1 as Responsible_Road_Org_Mbrshp_Ver  ,f.Attr_Id_2  as liable_rd_mbrshp_dimn_id  ,f.Attr_Ver_2 as liable_rd_mbrshp_ver  ,isnull(mem.Org_Dimn_Id,-1) as Liable_org_dimn_id  ,isnull(mem.org_ver    ,-1) as Liable_Org_Ver  ,isnull(mem2.Org_Dimn_Id,-1) as [Responsible_Org_Dimn_Id]  ,isnull(mem2.org_ver ,-1) as [Responsible_Org_Ver]  ,isnull(f.Car_Cnt ,0) as Car_Cnt  ,isnull(f.TPE_Cnt ,0) as TPE_Cnt  ,isnull(f.Ut_Cnt ,0) as Ut_Cnt  ,isnull(f.Pltfm_Cnt ,0) as Pltfm_Cnt    from (SELECT car_dimn_id     ,car_ver     ,Dt_Dimn_Id     ,car_Cnt_Catg_Typ_id     ,1 as grp_nr     ,Attr_Id_1     ,Attr_Ver_1     ,Attr_Id_2     ,Attr_Ver_2     ,Row_Typ_Id     ,sum(Car_Cnt   ) as Car_Cnt     ,sum(TPE_Cnt   ) as TPE_Cnt     ,sum(Ut_Cnt    ) as Ut_Cnt     ,sum(Pltfm_Cnt ) as Pltfm_Cnt     FROM ddsmrt.dbo.vw_car_count_fact_History (NOLOCK)     WHERE Row_Typ_Id = 516 and car_Cnt_Catg_Typ_id <> 138 and Dt_Dimn_Id >=20100101      Group by car_dimn_id,car_ver,Dt_Dimn_Id,car_Cnt_Catg_Typ_id,Attr_Id_1,Attr_Ver_1,Attr_Id_2,Attr_Ver_2,Row_Typ_Id     UNION      select * from (     select       car_dimn_id     ,car_ver     ,Dt_Dimn_Id     ,137 as car_Cnt_Catg_Typ_id     ,grp_nr     ,Attr_Id_1     ,Attr_Ver_1     ,Attr_Id_2     ,Attr_Ver_2     ,Row_Typ_Id     ,isnull(Car_Cnt-lag(Car_Cnt) over (partition by dt_dimn_id, car_dimn_id, car_ver, Attr_Id_2,Attr_Ver_2, Attr_Id_1,Attr_Ver_1 order by grp_nr), Car_Cnt) as Car_Cnt     ,isnull(TPE_Cnt-lag(TPE_Cnt) over (partition by dt_dimn_id, car_dimn_id, car_ver, Attr_Id_2,Attr_Ver_2, Attr_Id_1,Attr_Ver_1 order by grp_nr), TPE_Cnt) as TPE_Cnt     ,isnull(Ut_Cnt-lag(Ut_Cnt) over (partition by dt_dimn_id, car_dimn_id, car_ver, Attr_Id_2,Attr_Ver_2, Attr_Id_1,Attr_Ver_1 order by grp_nr), Ut_Cnt) as Ut_Cnt     ,isnull(Pltfm_Cnt-lag(Pltfm_Cnt) over (partition by dt_dimn_id, car_dimn_id, car_ver, Attr_Id_2,Attr_Ver_2, Attr_Id_1,Attr_Ver_1 order by grp_nr), Pltfm_Cnt) as Pltfm_Cnt     from (     SELECT car_dimn_id     ,car_ver     ,Dt_Dimn_Id     ,case when car_Cnt_Catg_Typ_id = 138 then 2 else 1 end as grp_nr     ,Attr_Id_1     ,Attr_Ver_1     ,Attr_Id_2     ,Attr_Ver_2     ,Row_Typ_Id     ,sum(Car_Cnt   ) as Car_Cnt     ,sum(TPE_Cnt   ) as TPE_Cnt     ,sum(Ut_Cnt    ) as Ut_Cnt     ,sum(Pltfm_Cnt ) as Pltfm_Cnt     FROM ddsmrt.dbo.vw_car_count_fact_History (NOLOCK)     WHERE Row_Typ_Id = 516 and Dt_Dimn_Id  >=20100101      Group by car_dimn_id,car_ver,Dt_Dimn_Id,Attr_Id_1,Attr_Ver_1,Attr_Id_2,Attr_Ver_2,Row_Typ_Id, case when car_Cnt_Catg_Typ_id = 138 then 2 else 1 end     ) FISs     ) FIS    WHERE grp_nr = 2     )  f    left join ddsmrt.dbo.VMRT_Organization_Membership_Dimension mem on (f.Attr_Id_2 = mem.Org_Mbrshp_Dimn_Id and f.Attr_Ver_2 = mem.Org_Mbrshp_Ver)  left join ddsmrt.dbo.VMRT_Organization_Membership_Dimension mem2 on (f.Attr_Id_1 = mem2.Org_Mbrshp_Dimn_Id and f.Attr_Ver_1 = mem2.Org_Mbrshp_Ver)    ) f2"
    },
    {
      "id": "VOut_Of_Country_Fact",
      "name": "VOut_Of_Country_Fact",
      "type": "VIEW",
      "sql": "CREATE VIEW [DDSV].[VOut_Of_Country_Fact]  AS  SELECT CAST(SUBSTRING(CONVERT(VARCHAR(10),Dt_Dimn_Id),1,6) AS INT) AS Mth_Dimn_Id        ,CAST([Geo_Dimn_Id] AS INT) AS [Geo_Dimn_Id]        ,CONCAT(CONVERT(VARCHAR(10),Car_Dimn_Id),'_',CONVERT(VARCHAR(5), Car_Ver)) AS [Car_Dimn_Id]        ,[Tm_Dur_Min]        ,[Debt_Agr_Nm]        ,[Leas_Agr_Nm]        ,[Crtd_Dt]        ,[Crtd_Id]        ,[Lst_Upd_Dt]        ,[Lst_Upd_Id]    FROM [ddsmrt].[dbo].[Out_Of_Country_Fact] (NOLOCK)"
    },
    {
      "id": "vw_Pool_Contribution_Fact_History",
      "name": "vw_Pool_Contribution_Fact_History",
      "type": "VIEW",
      "sql": "CREATE VIEW [dbo].[vw_Pool_Contribution_Fact_History] AS  SELECT [Pool_Contribution_Id]        ,[Dt_Dimn_Id]        ,[Asgn_Rd_Dimn_Id]        ,[Asgn_Rd_Ver]        ,[Resp_Rd_Dimn_Id]        ,[Resp_Rd_Ver]        ,[Last_Part_Rd_Dimn_Id]        ,[Last_Part_Rd_Ver]        ,[Car_Dimn_Id]        ,[Car_Ver]        ,[Nr_Cd_Dimn_Id]        ,[UFD_Eq_Sts_Dimn_Id]        ,[Curr_Part_Rd_Dimn_Id]        ,[Curr_Part_Rd_Ver]        ,[Rpt_Rd_Dimn_Id]        ,[Rpt_Rd_Ver]        ,[Orig_Dist_Enty_Dimn_Id]        ,[Orig_Dist_Enty_Ver]        ,[Dest_Dist_Enty_Dimn_Id]        ,[Dest_Dist_Enty_Ver]        ,[Run_Dt]        ,[Asgn_Rd_Mrk]        ,[Resp_Rd_Mrk]        ,[Last_Part_Rd_Mrk]        ,[Rpt_Rd_Mrk]        ,[Railcar]        ,[Car_Nr]        ,[Car_Init]        ,[NR_Cd]        ,[UFD_Equip_Sts]        ,[Dy_Ld_Cnt]        ,[Dy_Emp_Cnt]        ,[Dy_Unknown_Cnt]        ,[Car_Stor_Cnt]        ,[Car_Pd_Stor_Cnt]        ,[Car_In_Shop_Cnt]        ,[Car_Enrt_Cnt]        ,[Car_Bad_Ordr_Cnt]        ,[Car_Idle_Cnt]        ,[Car_Hire_Sts]        ,[Bad_Ordr_Sts]        ,[Curr_Trip_Sts]        ,[Lst_Evnt_Typ]        ,[Ld_Plc_Cnt]        ,[Ld_Arr_Cnt]        ,[Crtd_Dt]        ,[Crtd_Id]        ,[Lst_Upd_Dt]        ,[Lst_Upd_Id]     ,Liability_Event_Dt    FROM [dbo].[Pool_Contribution_Fact_History]"
    },
    {
      "id": "Revenue_Accounting_Estimate_Car_Count_Hist",
      "name": "Revenue_Accounting_Estimate_Car_Count_Hist",
      "type": "VIEW",
      "sql": "CREATE view [SV].[Revenue_Accounting_Estimate_Car_Count_Hist] as    --Estimate  select   Car_Dimn_Id  ,Car_Ver    ,Dt_Dimn_Id as Snapshot_Dt_Dimn_Id  ,Car_Cnt_Catg_Typ_Id  ,Responsible_Road_Org_Mbrshp_Dimn_Id  ,Responsible_Road_Org_Mbrshp_Ver  ,liable_rd_mbrshp_dimn_id  ,liable_rd_mbrshp_ver  ,Liable_org_dimn_id  ,Liable_Org_Ver     ,(Cast([Car_Dimn_Id] AS VARCHAR) + '|' + Cast([Car_Ver] AS VARCHAR)) AS Car_ID     ,(Cast(liable_rd_mbrshp_dimn_id AS VARCHAr) + '|' + Cast(liable_rd_mbrshp_ver AS VARCHAR)) AS Liable_Road_ID     ,(Cast([Responsible_Road_Org_Mbrshp_Dimn_Id] AS VARCHAR) + '|' + Cast([Responsible_Road_Org_Mbrshp_Ver] AS VARCHAR)) AS Resp_Road_ID     ,(Cast([Liable_Org_Dimn_Id] AS VARCHAr) + '|' + Cast([Liable_Org_Ver] AS VARCHAR)) AS Liable_Dimn_ID     ,(Cast([Responsible_Org_Dimn_Id] AS VARCHAR) + '|' + Cast([Responsible_Org_Ver] AS VARCHAR)) AS Resp_Dimn_ID  ,crtd_dt  ,Car_Cnt  ,TPE_Cnt  ,Ut_Cnt  ,Pltfm_Cnt    from (  select    f.car_dimn_id  ,f.car_ver  ,f.Dt_Dimn_Id  ,f.car_Cnt_Catg_Typ_id  ,f.crtd_dt  ,f.Attr_Id_1  as Responsible_Road_Org_Mbrshp_Dimn_Id  ,f.Attr_Ver_1 as Responsible_Road_Org_Mbrshp_Ver  ,f.Attr_Id_2  as liable_rd_mbrshp_dimn_id  ,f.Attr_Ver_2 as liable_rd_mbrshp_ver  ,isnull(mem.Org_Dimn_Id,-1) as Liable_org_dimn_id  ,isnull(mem.org_ver    ,-1) as Liable_Org_Ver  ,isnull(mem2.Org_Dimn_Id,-1) as [Responsible_Org_Dimn_Id]  ,isnull(mem2.org_ver ,-1) as [Responsible_Org_Ver]  ,isnull(f.Car_Cnt ,0) as Car_Cnt  ,isnull(f.TPE_Cnt ,0) as TPE_Cnt  ,isnull(f.Ut_Cnt ,0) as Ut_Cnt  ,isnull(f.Pltfm_Cnt ,0) as Pltfm_Cnt    from (SELECT car_dimn_id     ,car_ver     ,Dt_Dimn_Id     ,car_Cnt_Catg_Typ_id     ,1 as grp_nr     ,Attr_Id_1     ,Attr_Ver_1     ,Attr_Id_2     ,Attr_Ver_2     ,Row_Typ_Id     ,min(crtd_Dt) as crtd_dt     ,sum(Car_Cnt   ) as Car_Cnt     ,sum(TPE_Cnt   ) as TPE_Cnt     ,sum(Ut_Cnt    ) as Ut_Cnt     ,sum(Pltfm_Cnt ) as Pltfm_Cnt     FROM ddsmrt.dbo.vw_car_count_fact_History (NOLOCK)     WHERE Row_Typ_Id = 515 and car_Cnt_Catg_Typ_id <> 138 and Dt_Dimn_Id >=20100101      Group by car_dimn_id,car_ver,Dt_Dimn_Id,car_Cnt_Catg_Typ_id,Attr_Id_1,Attr_Ver_1,Attr_Id_2,Attr_Ver_2,Row_Typ_Id     UNION      select * from (     select       car_dimn_id     ,car_ver     ,Dt_Dimn_Id     ,137 as car_Cnt_Catg_Typ_id     ,grp_nr     ,Attr_Id_1     ,Attr_Ver_1     ,Attr_Id_2     ,Attr_Ver_2     ,Row_Typ_Id     ,crtd_dt     ,isnull(Car_Cnt-lag(Car_Cnt) over (partition by dt_dimn_id, car_dimn_id, car_ver, Attr_Id_2,Attr_Ver_2, Attr_Id_1,Attr_Ver_1 order by grp_nr), Car_Cnt) as Car_Cnt     ,isnull(TPE_Cnt-lag(TPE_Cnt) over (partition by dt_dimn_id, car_dimn_id, car_ver, Attr_Id_2,Attr_Ver_2, Attr_Id_1,Attr_Ver_1 order by grp_nr), TPE_Cnt) as TPE_Cnt     ,isnull(Ut_Cnt-lag(Ut_Cnt) over (partition by dt_dimn_id, car_dimn_id, car_ver, Attr_Id_2,Attr_Ver_2, Attr_Id_1,Attr_Ver_1 order by grp_nr), Ut_Cnt) as Ut_Cnt     ,isnull(Pltfm_Cnt-lag(Pltfm_Cnt) over (partition by dt_dimn_id, car_dimn_id, car_ver, Attr_Id_2,Attr_Ver_2, Attr_Id_1,Attr_Ver_1 order by grp_nr), Pltfm_Cnt) as Pltfm_Cnt     from (     SELECT car_dimn_id     ,car_ver     ,Dt_Dimn_Id     ,case when car_Cnt_Catg_Typ_id = 138 then 2 else 1 end as grp_nr     ,Attr_Id_1     ,Attr_Ver_1     ,Attr_Id_2     ,Attr_Ver_2     ,Row_Typ_Id     ,min(crtd_Dt) as crtd_dt     ,sum(Car_Cnt   ) as Car_Cnt     ,sum(TPE_Cnt   ) as TPE_Cnt     ,sum(Ut_Cnt    ) as Ut_Cnt     ,sum(Pltfm_Cnt ) as Pltfm_Cnt     FROM ddsmrt.dbo.vw_car_count_fact_History (NOLOCK)     WHERE Row_Typ_Id = 515 and Dt_Dimn_Id  >=20100101      Group by car_dimn_id,car_ver,Dt_Dimn_Id,Attr_Id_1,Attr_Ver_1,Attr_Id_2,Attr_Ver_2,Row_Typ_Id, case when car_Cnt_Catg_Typ_id = 138 then 2 else 1 end     ) FISs     ) FIS    WHERE grp_nr = 2     )  f    left join ddsmrt.dbo.VMRT_Organization_Membership_Dimension mem on (f.Attr_Id_2 = mem.Org_Mbrshp_Dimn_Id and f.Attr_Ver_2 = mem.Org_Mbrshp_Ver)  left join ddsmrt.dbo.VMRT_Organization_Membership_Dimension mem2 on (f.Attr_Id_1 = mem2.Org_Mbrshp_Dimn_Id and f.Attr_Ver_1 = mem2.Org_Mbrshp_Ver)    ) f2"
    },
    {
      "id": "VPool_Contribution_Fact",
      "name": "VPool_Contribution_Fact",
      "type": "VIEW",
      "sql": "CREATE view [DDSV].[VPool_Contribution_Fact] as  SELECT        F.Dt_Dimn_Id  , concat(convert(varchar(10),Orig_Dist_Enty_Dimn_Id),'_',convert(varchar(5), Orig_Dist_Enty_Ver)) as Orig_Dist_Enty_Dimn_Id  , concat(convert(varchar(10),Dest_Dist_Enty_Dimn_Id),'_',convert(varchar(5), Dest_Dist_Enty_Ver)) as Dest_Dist_Enty_Dimn_Id  , concat(convert(varchar(10),Asgn_Rd_Dimn_Id),'_',convert(varchar(5), Asgn_Rd_Ver)) as Asgn_Rd_Dimn_Id  , concat(convert(varchar(10),Resp_Rd_Dimn_Id),'_',convert(varchar(5), Resp_Rd_Ver)) as Resp_Rd_Dimn_Id  , concat(convert(varchar(10),Last_Part_Rd_Dimn_Id),'_',convert(varchar(5), Last_Part_Rd_Ver)) as Last_Part_Rd_Dimn_Id  , concat(convert(varchar(10),Curr_Part_Rd_Dimn_Id),'_',convert(varchar(5), Curr_Part_Rd_Ver)) as Curr_Part_Rd_Dimn_Id  , concat(convert(varchar(10),Rpt_Rd_Dimn_Id),'_',convert(varchar(5), Rpt_Rd_Ver)) as Rpt_Rd_Dimn_Id  , concat(convert(varchar(10),F.Car_Dimn_Id),'_',convert(varchar(5), F.Car_Ver)) as Car_Dimn_Id  , F.Nr_Cd_Dimn_Id  , F.UFD_Eq_Sts_Dimn_Id  , F.Ld_Arr_Cnt  , F.Ld_Plc_Cnt  , F.Run_Dt  , F.Asgn_Rd_Mrk  , F.Resp_Rd_Mrk  , F.Last_Part_Rd_Mrk  , F.Rpt_Rd_Mrk  , F.Railcar  , F.Car_Nr  , F.Curr_Trip_Sts  , F.Lst_Evnt_Typ  , F.Car_Init  , F.NR_Cd  , F.UFD_Equip_Sts  , F.Dy_Ld_Cnt  , F.Dy_Emp_Cnt  , F.Dy_Unknown_Cnt  , F.Car_Stor_Cnt  , F.Car_Pd_Stor_Cnt  , F.Car_In_Shop_Cnt  , F.Car_Enrt_Cnt  , F.Car_Bad_Ordr_Cnt  , F.Car_Idle_Cnt  , F.Car_Hire_Sts  , F.Bad_Ordr_Sts  , F.Crtd_Dt  , F.Crtd_Id  , F.Lst_Upd_Dt  , F.Lst_Upd_Id  , CASE WHEN UFD_EQUIP_STS IN ('INSH', 'ETSP') THEN 1 ELSE 0 END AS UFD_Shop_Equip_STS_Count  , CASE WHEN (Dy_Ld_Cnt = 1 AND                   C.Ownr_Mrk_Cd = 'TTX' AND NR_Cd NOT IN ('00', '01', '02', '05', '06', '08', '09', '10', '11', '12', '13', '16', '17', '52', '22', '26', '28', '20', '21'))                   THEN 1 ELSE 0 END AS [Owned Idle Loaded Car Count]  , CASE WHEN (Dy_Ld_Cnt = 1 AND C.Ownr_Mrk_Cd <> 'TTX' AND C.[Pool_Cd] IN ('9990012',                   '9990013', '9990014', '9990015', '9990016', '9990017', '9990018', '9990019', '9990020', '9990021', '9990610', '9990611', '9990620', '9990640',                   '9990022', '9990023', '9990024', '9990025', '9990026', '9990027', '9990028', '9990029', '9990030', '9990031', '9990032', '9990033', '9990034',                   '9990035', '9990036', '9990037', '9990038', '9990039', '9990040', '9990041', '9990042', '9990043', '9990044', '9990045', '9990046', '9990047',                   '9990048', '9990049', '9990050', '9990051', '9990052', '9990053', '9990054', '9990055', '9990056', '9990057', '9990058', '9990059', '9990060',                   '9990061', '9990062', '9990063', '9990064', '9990065', '9990066', '9990067', '9990068', '9990069', '9990070', '9990071', '9990072', '9990073',                   '9990074', '9990075', '9990076', '9990077', '9990078', '9990079', '9990080', '9990081', '9990082', '9990083', '9990084', '9990085', '9990086',                   '9990087', '9990088', '9990089', '9990090', '9990091', '9990092', '9990093', '9990094', '9990095', '9990096', '9990097', '9990098', '9990099'))                   THEN 1 ELSE 0 END AS [Managed Idle Loaded Car Count],   CASE WHEN (Dy_Emp_Cnt = 1 AND C.Ownr_Mrk_Cd = 'TTX' AND NR_Cd NOT IN ('00', '01',                   '02', '05', '06', '08', '09', '10', '11', '12', '13', '16', '17', '52', '22', '26', '28', '20', '21'))       THEN 1 ELSE 0 END AS [Owned Idle Empty Car Count],   CASE WHEN (Dy_Emp_Cnt = 1 AND C.Ownr_Mrk_Cd <> 'TTX' AND C.[Pool_Cd] IN ('9990012', '9990013', '9990014', '9990015', '9990016', '9990017',                   '9990018', '9990019', '9990020', '9990021', '9990022', '9990023', '9990024', '9990025', '9990026', '9990027', '9990028', '9990029', '9990030',                   '9990031', '9990032', '9990033', '9990034', '9990035', '9990036', '9990037', '9990038', '9990039', '9990040', '9990610', '9990611', '9990620',                   '9990640', '9990041', '9990042', '9990043', '9990044', '9990045', '9990046', '9990047', '9990048', '9990049', '9990050', '9990051', '9990052',                   '9990053', '9990054', '9990055', '9990056', '9990057', '9990058', '9990059', '9990060', '9990061', '9990062', '9990063', '9990064', '9990065',                   '9990066', '9990067', '9990068', '9990069', '9990070', '9990071', '9990072', '9990073', '9990074', '9990075', '9990076', '9990077', '9990078',                   '9990079', '9990080', '9990081', '9990082', '9990083', '9990084', '9990085', '9990086', '9990087', '9990088', '9990089', '9990090', '9990091',                   '9990092', '9990093', '9990094', '9990095', '9990096', '9990097', '9990098', '9990099'))             THEN 1 ELSE 0 END AS [Managed Idle Empty Car Count] ,        Case when (NR_Cd IN ('20', ' 21') OR (Car_Hire_Sts = 'Y' AND Car_Idle_Cnt = 0))            and (datediff(hour, Liability_Event_Dt ,Crtd_Dt) >= 72 and  datediff(hour, Liability_Event_Dt , Crtd_Dt) < 96)                        then 1 else Null End as  [Hours since offered 72-96 Car Count],          Case when (NR_Cd IN ('20', ' 21') OR (Car_Hire_Sts = 'Y' AND Car_Idle_Cnt = 0))            and (datediff(hour, Liability_Event_Dt , Crtd_Dt) >= 96 and  datediff(hour, Liability_Event_Dt , Crtd_Dt) < 120 )                    then 1 else null end as [Hours since offered 96+ Car Count]         FROM            [dbo].[vw_Pool_Contribution_Fact_All] (NOLOCK) AS F INNER JOIN                  (select Ownr_Mrk as Ownr_Mrk_Cd, [Pool_Cd], Car_Dimn_Id, Car_Ver      /** IR527842 Fix **/       from dbo.car_dim_correct (NOLOCK))  AS C ON F.Car_Dimn_Id = C.Car_Dimn_Id and F.Car_Ver = C.Car_Ver"
    },
    {
      "id": "vw_Pool_Contribution_Fact_All",
      "name": "vw_Pool_Contribution_Fact_All",
      "type": "VIEW",
      "sql": "CREATE VIEW [dbo].[vw_Pool_Contribution_Fact_All] AS  SELECT [Pool_Contribution_Id]        ,[Dt_Dimn_Id]        ,[Asgn_Rd_Dimn_Id]        ,[Asgn_Rd_Ver]        ,[Resp_Rd_Dimn_Id]        ,[Resp_Rd_Ver]        ,[Last_Part_Rd_Dimn_Id]        ,[Last_Part_Rd_Ver]        ,[Car_Dimn_Id]        ,[Car_Ver]        ,[Nr_Cd_Dimn_Id]        ,[UFD_Eq_Sts_Dimn_Id]        ,[Curr_Part_Rd_Dimn_Id]        ,[Curr_Part_Rd_Ver]        ,[Rpt_Rd_Dimn_Id]        ,[Rpt_Rd_Ver]        ,[Orig_Dist_Enty_Dimn_Id]        ,[Orig_Dist_Enty_Ver]        ,[Dest_Dist_Enty_Dimn_Id]        ,[Dest_Dist_Enty_Ver]        ,[Run_Dt]        ,[Asgn_Rd_Mrk]        ,[Resp_Rd_Mrk]        ,[Last_Part_Rd_Mrk]        ,[Rpt_Rd_Mrk]        ,[Railcar]        ,[Car_Nr]        ,[Car_Init]        ,[NR_Cd]        ,[UFD_Equip_Sts]        ,[Dy_Ld_Cnt]        ,[Dy_Emp_Cnt]        ,[Dy_Unknown_Cnt]        ,[Car_Stor_Cnt]        ,[Car_Pd_Stor_Cnt]        ,[Car_In_Shop_Cnt]        ,[Car_Enrt_Cnt]        ,[Car_Bad_Ordr_Cnt]        ,[Car_Idle_Cnt]        ,[Car_Hire_Sts]        ,[Bad_Ordr_Sts]        ,[Curr_Trip_Sts]        ,[Lst_Evnt_Typ]        ,[Ld_Plc_Cnt]        ,[Ld_Arr_Cnt]        ,[Crtd_Dt]        ,[Crtd_Id]        ,[Lst_Upd_Dt]        ,[Lst_Upd_Id]     ,Liability_Event_Dt    FROM [dbo].[Pool_Contribution_Fact]    UNION ALL    SELECT [Pool_Contribution_Id]        ,[Dt_Dimn_Id]        ,[Asgn_Rd_Dimn_Id]        ,[Asgn_Rd_Ver]        ,[Resp_Rd_Dimn_Id]        ,[Resp_Rd_Ver]        ,[Last_Part_Rd_Dimn_Id]        ,[Last_Part_Rd_Ver]        ,[Car_Dimn_Id]        ,[Car_Ver]        ,[Nr_Cd_Dimn_Id]        ,[UFD_Eq_Sts_Dimn_Id]        ,[Curr_Part_Rd_Dimn_Id]        ,[Curr_Part_Rd_Ver]        ,[Rpt_Rd_Dimn_Id]        ,[Rpt_Rd_Ver]        ,[Orig_Dist_Enty_Dimn_Id]        ,[Orig_Dist_Enty_Ver]        ,[Dest_Dist_Enty_Dimn_Id]        ,[Dest_Dist_Enty_Ver]        ,[Run_Dt]        ,[Asgn_Rd_Mrk]        ,[Resp_Rd_Mrk]        ,[Last_Part_Rd_Mrk]        ,[Rpt_Rd_Mrk]        ,[Railcar]        ,[Car_Nr]        ,[Car_Init]        ,[NR_Cd]        ,[UFD_Equip_Sts]        ,[Dy_Ld_Cnt]        ,[Dy_Emp_Cnt]        ,[Dy_Unknown_Cnt]        ,[Car_Stor_Cnt]        ,[Car_Pd_Stor_Cnt]        ,[Car_In_Shop_Cnt]        ,[Car_Enrt_Cnt]        ,[Car_Bad_Ordr_Cnt]        ,[Car_Idle_Cnt]        ,[Car_Hire_Sts]        ,[Bad_Ordr_Sts]        ,[Curr_Trip_Sts]        ,[Lst_Evnt_Typ]        ,[Ld_Plc_Cnt]        ,[Ld_Arr_Cnt]        ,[Crtd_Dt]        ,[Crtd_Id]        ,[Lst_Upd_Dt]        ,[Lst_Upd_Id]     ,Liability_Event_Dt    FROM [dbo].[Pool_Contribution_Fact_History]"
    },
    {
      "id": "Revenue_Accounting_Car_Count_Hist",
      "name": "Revenue_Accounting_Car_Count_Hist",
      "type": "VIEW",
      "sql": "CREATE VIEW [SV].[Revenue_Accounting_Car_Count_Hist]  AS      -- ESTIMATE current month  select   [Car_Dimn_Id]        ,[Car_Ver]        ,cast(convert(varchar(8), (DATEADD(DAY, -( DAY(GETDATE()) - 1 ), GETDATE())),112) as int) as dt_dimn_id        ,[Car_Cnt_Catg_Typ_Id]        ,[Responsible_Road_Org_Mbrshp_Dimn_Id]        ,[Responsible_Road_Org_Mbrshp_Ver]        ,[liable_rd_mbrshp_dimn_id]        ,[liable_rd_mbrshp_ver]        ,[Liable_org_dimn_id]        ,[Liable_Org_Ver]        ,[Car_ID]        ,[Liable_Road_ID]        ,[Resp_Road_ID]        ,[Liable_Dimn_ID]        ,[Resp_Dimn_ID]      ,isnull(sum(Car_Cnt)/datediff(day, dateadd(day, 1-day(getdate()), getdate()),                dateadd(month, 1, dateadd(day, 1-day(getdate()), getdate())))   ,0) as Car_Cnt   -- sum/Number of days in currentmonth for avg      ,isnull(sum(TPE_Cnt)/datediff(day, dateadd(day, 1-day(getdate()), getdate()),                dateadd(month, 1, dateadd(day, 1-day(getdate()), getdate())))   ,0) as TPE_Cnt      ,isnull(sum(Ut_Cnt)/datediff(day, dateadd(day, 1-day(getdate()), getdate()),                dateadd(month, 1, dateadd(day, 1-day(getdate()), getdate())))   ,0) as Ut_Cnt      ,isnull(sum(Pltfm_Cnt)/datediff(day, dateadd(day, 1-day(getdate()), getdate()),                dateadd(month, 1, dateadd(day, 1-day(getdate()), getdate())))   ,0) as Pltfm_Cnt     ,'E' as Car_Count_Indicator    FROM [DDSMRT].[SV].[Revenue_Accounting_Estimate_Car_Count_Hist]     WHERE [Snapshot_Dt_Dimn_Id] >= cast(convert(varchar(8), (DATEADD(DAY, -( DAY(GETDATE()) - 1 ), GETDATE())),112) as int)    GROUP BY [Car_Dimn_Id]        ,[Car_Ver]        ,[Car_Cnt_Catg_Typ_Id]        ,[Responsible_Road_Org_Mbrshp_Dimn_Id]        ,[Responsible_Road_Org_Mbrshp_Ver]        ,[liable_rd_mbrshp_dimn_id]        ,[liable_rd_mbrshp_ver]        ,[Liable_org_dimn_id]        ,[Liable_Org_Ver]        ,[Car_ID]        ,[Liable_Road_ID]        ,[Resp_Road_ID]        ,[Liable_Dimn_ID]        ,[Resp_Dimn_ID]  union  -- ESTIMATE last month  select   [Car_Dimn_Id]        ,[Car_Ver]        ,cast(convert(varchar(8), ( DATEADD(month, DATEDIFF(month, 0, GETDATE())-1, 0)),112) as int) as dt_dimn_id        ,[Car_Cnt_Catg_Typ_Id]        ,[Responsible_Road_Org_Mbrshp_Dimn_Id]        ,[Responsible_Road_Org_Mbrshp_Ver]        ,[liable_rd_mbrshp_dimn_id]        ,[liable_rd_mbrshp_ver]        ,[Liable_org_dimn_id]        ,[Liable_Org_Ver]        ,[Car_ID]        ,[Liable_Road_ID]        ,[Resp_Road_ID]        ,[Liable_Dimn_ID]        ,[Resp_Dimn_ID]      ,isnull(sum(Car_Cnt)/datediff(day, DATEADD(month, DATEDIFF(month, 0, GETDATE())-1, 0),       dateadd(month, 1, DATEADD(month, DATEDIFF(month, 0, GETDATE())-1, 0)))  ,0) as Car_Cnt   -- sum/Number of days in lastmonth for avg      ,isnull(sum(TPE_Cnt)/datediff(day, DATEADD(month, DATEDIFF(month, 0, GETDATE())-1, 0),       dateadd(month, 1, DATEADD(month, DATEDIFF(month, 0, GETDATE())-1, 0)))  ,0) as TPE_Cnt      ,isnull(sum(Ut_Cnt)/datediff(day, DATEADD(month, DATEDIFF(month, 0, GETDATE())-1, 0),       dateadd(month, 1, DATEADD(month, DATEDIFF(month, 0, GETDATE())-1, 0)))  ,0) as Ut_Cnt      ,isnull(sum(Pltfm_Cnt)/datediff(day, DATEADD(month, DATEDIFF(month, 0, GETDATE())-1, 0),       dateadd(month, 1, DATEADD(month, DATEDIFF(month, 0, GETDATE())-1, 0)))  ,0) as Pltfm_Cnt     ,'E' as Car_Count_Indicator    FROM [DDSMRT].[SV].[Revenue_Accounting_Estimate_Car_Count_Hist]     WHERE [Snapshot_Dt_Dimn_Id] >= (select cast(convert(varchar(8),dateadd(mm,1, cast(cast(max(dt_dimn_id)as varchar) as date)),112) as int)  from ddsmrt.dbo.vw_car_count_fact_History where row_typ_id = 516)     and [Snapshot_Dt_Dimn_Id] < cast(convert(varchar(8), (DATEADD(DAY, -( DAY(GETDATE()) - 1 ), GETDATE())),112) as int)    GROUP BY [Car_Dimn_Id]        ,[Car_Ver]        ,[Car_Cnt_Catg_Typ_Id]        ,[Responsible_Road_Org_Mbrshp_Dimn_Id]        ,[Responsible_Road_Org_Mbrshp_Ver]        ,[liable_rd_mbrshp_dimn_id]        ,[liable_rd_mbrshp_ver]        ,[Liable_org_dimn_id]        ,[Liable_Org_Ver]        ,[Car_ID]        ,[Liable_Road_ID]        ,[Resp_Road_ID]        ,[Liable_Dimn_ID]        ,[Resp_Dimn_ID]  union  -- Accrual    SELECT [Car_Dimn_Id]        ,[Car_Ver]        ,[Service_Month_Start_Dt_Dimn_Id]        ,[Car_Cnt_Catg_Typ_Id]        ,[Responsible_Road_Org_Mbrshp_Dimn_Id]        ,[Responsible_Road_Org_Mbrshp_Ver]        ,[liable_rd_mbrshp_dimn_id]        ,[liable_rd_mbrshp_ver]        ,[Liable_org_dimn_id]        ,[Liable_Org_Ver]        ,[Car_ID]        ,[Liable_Road_ID]        ,[Resp_Road_ID]        ,[Liable_Dimn_ID]        ,[Resp_Dimn_ID]        ,[Car_Cnt]        ,[TPE_Cnt]        ,[Ut_Cnt]        ,[Pltfm_Cnt]     ,'R' as Car_Count_Indicator  From DDSMRT.[SV].[Revenue_Accounting_Accrual_Car_Count_Hist]  where [Service_Month_Start_Dt_Dimn_Id] > (select max(dt_dimn_id) from ddsmrt.dbo.vw_car_count_fact_History where row_typ_id = 517)    Union   -- Actuals  SELECT [Car_Dimn_Id]        ,[Car_Ver]        ,[Service_Month_Start_Dt_Dimn_Id]        ,[Car_Cnt_Catg_Typ_Id]        ,[Responsible_Road_Org_Mbrshp_Dimn_Id]        ,[Responsible_Road_Org_Mbrshp_Ver]        ,[liable_rd_mbrshp_dimn_id]        ,[liable_rd_mbrshp_ver]        ,[Liable_org_dimn_id]        ,[Liable_Org_Ver]        ,[Car_ID]        ,[Liable_Road_ID]        ,[Resp_Road_ID]        ,[Liable_Dimn_ID]        ,[Resp_Dimn_ID]        ,[Car_Cnt]        ,[TPE_Cnt]        ,[Ut_Cnt]        ,[Pltfm_Cnt]     ,'A' as Car_Count_Indicator  From DDSMRT.[SV].[Revenue_Accounting_Accrual_Car_Count_Hist]  where [Service_Month_Start_Dt_Dimn_Id] >= 20100101"
    },
    {
      "id": "VPTY_Rd_Dimn",
      "name": "VPTY_Rd_Dimn",
      "type": "VIEW",
      "sql": "CREATE VIEW [DDSV].[VPTY_Rd_Dimn]  AS  SELECT     concat(convert(varchar(10),Org.Org_Dimn_Id),'_',convert(varchar(5), Org.Org_Ver)) as Rd_Dimn_Id     --,org.Org_Ver as Rd_Ver     ,case when org.org_dimn_id=-1 then convert(varchar(4),'NA')      else convert(varchar(4),Org.Org_Abrv) end as  Rd     ,case when org.org_dimn_id=-1 then convert(varchar(30),'No Road')      else convert(varchar(30),Org.Org_Nm) end as Rd_Nm     ,org.crtd_Id as Crtd_Id     ,org.crtd_Dt as Ctrd_Dt     ,org.lst_upd_Id as Lst_Upd_Id     ,org.lst_Upd_Dt as Lst_Upd_Dt     FROM ddsmrt.dbo.Organization_Dim (NOLOCK) org  -- where org.Row_Typ_Id=501 or org.Row_Typ_Id is null   inner join ddsmrt.dbo.organization_type_lookup (NOLOCK) org_lkp   on org.org_dimn_id=org_lkp.org_dimn_id and org.org_ver=org_lkp.org_ver   inner join ddsmrt.dbo.type_lookup  (NOLOCK) lkp   on org_lkp.Org_Typ_Id=lkp.typ_id   where ([Typ_Desc]='Railroad' ) or org_abrv = 'UNKN' or org.org_dimn_id=-1"
    },
    {
      "id": "VPool_Contribution_Fact_History",
      "name": "VPool_Contribution_Fact_History",
      "type": "VIEW",
      "sql": "CREATE view [DDSV].[VPool_Contribution_Fact_History] as  SELECT        F.Dt_Dimn_Id     , concat(convert(varchar(10),Orig_Dist_Enty_Dimn_Id),'_',convert(varchar(5), Orig_Dist_Enty_Ver)) as Orig_Dist_Enty_Dimn_Id     , concat(convert(varchar(10),Dest_Dist_Enty_Dimn_Id),'_',convert(varchar(5), Dest_Dist_Enty_Ver)) as Dest_Dist_Enty_Dimn_Id     , concat(convert(varchar(10),Asgn_Rd_Dimn_Id),'_',convert(varchar(5), Asgn_Rd_Ver)) as Asgn_Rd_Dimn_Id     , concat(convert(varchar(10),Resp_Rd_Dimn_Id),'_',convert(varchar(5), Resp_Rd_Ver)) as Resp_Rd_Dimn_Id     , concat(convert(varchar(10),Last_Part_Rd_Dimn_Id),'_',convert(varchar(5), Last_Part_Rd_Ver)) as Last_Part_Rd_Dimn_Id     , concat(convert(varchar(10),Curr_Part_Rd_Dimn_Id),'_',convert(varchar(5), Curr_Part_Rd_Ver)) as Curr_Part_Rd_Dimn_Id     , concat(convert(varchar(10),Rpt_Rd_Dimn_Id),'_',convert(varchar(5), Rpt_Rd_Ver)) as Rpt_Rd_Dimn_Id     , concat(convert(varchar(10),F.Car_Dimn_Id),'_',convert(varchar(5), F.Car_Ver)) as Car_Dimn_Id     , F.Nr_Cd_Dimn_Id     , F.UFD_Eq_Sts_Dimn_Id     , F.Ld_Arr_Cnt     , F.Ld_Plc_Cnt     , F.Run_Dt     , F.Asgn_Rd_Mrk     , F.Resp_Rd_Mrk     , F.Last_Part_Rd_Mrk     , F.Rpt_Rd_Mrk     , F.Railcar     , F.Car_Nr     , F.Curr_Trip_Sts     , F.Lst_Evnt_Typ     , F.Car_Init     , F.NR_Cd     , F.UFD_Equip_Sts     , F.Dy_Ld_Cnt     , F.Dy_Emp_Cnt     , F.Dy_Unknown_Cnt     , F.Car_Stor_Cnt     , F.Car_Pd_Stor_Cnt     , F.Car_In_Shop_Cnt     , F.Car_Enrt_Cnt     , F.Car_Bad_Ordr_Cnt     , F.Car_Idle_Cnt     , F.Car_Hire_Sts     , F.Bad_Ordr_Sts     , F.Crtd_Dt     , F.Crtd_Id     , F.Lst_Upd_Dt     , F.Lst_Upd_Id     , CASE WHEN UFD_EQUIP_STS IN ('INSH', 'ETSP') THEN 1 ELSE 0 END AS UFD_Shop_Equip_STS_Count     , CASE WHEN (Dy_Ld_Cnt = 1 AND                                   C.Ownr_Mrk_Cd = 'TTX' AND NR_Cd NOT IN ('00', '01', '02', '05', '06', '08', '09', '10', '11', '12', '13', '16', '17', '52', '22', '26', '28', '20', '21'))                                   THEN 1 ELSE 0 END AS [Owned Idle Loaded Car Count]     , CASE WHEN (Dy_Ld_Cnt = 1 AND C.Ownr_Mrk_Cd <> 'TTX' AND C.[Pool_Cd] IN ('9990012',                                   '9990013', '9990014', '9990015', '9990016', '9990017', '9990018', '9990019', '9990020', '9990021', '9990610', '9990611', '9990620', '9990640',                                   '9990022', '9990023', '9990024', '9990025', '9990026', '9990027', '9990028', '9990029', '9990030', '9990031', '9990032', '9990033', '9990034',                                   '9990035', '9990036', '9990037', '9990038', '9990039', '9990040', '9990041', '9990042', '9990043', '9990044', '9990045', '9990046', '9990047',                                   '9990048', '9990049', '9990050', '9990051', '9990052', '9990053', '9990054', '9990055', '9990056', '9990057', '9990058', '9990059', '9990060',                                   '9990061', '9990062', '9990063', '9990064', '9990065', '9990066', '9990067', '9990068', '9990069', '9990070', '9990071', '9990072', '9990073',                                   '9990074', '9990075', '9990076', '9990077', '9990078', '9990079', '9990080', '9990081', '9990082', '9990083', '9990084', '9990085', '9990086',                                   '9990087', '9990088', '9990089', '9990090', '9990091', '9990092', '9990093', '9990094', '9990095', '9990096', '9990097', '9990098', '9990099'))                                   THEN 1 ELSE 0 END AS [Managed Idle Loaded Car Count], CASE WHEN (Dy_Emp_Cnt = 1 AND C.Ownr_Mrk_Cd = 'TTX' AND NR_Cd NOT IN ('00', '01',                                   '02', '05', '06', '08', '09', '10', '11', '12', '13', '16', '17', '52', '22', '26', '28', '20', '21')) THEN 1 ELSE 0 END AS [Owned Idle Empty Car Count],                                   CASE WHEN (Dy_Emp_Cnt = 1 AND C.Ownr_Mrk_Cd <> 'TTX' AND C.[Pool_Cd] IN ('9990012', '9990013', '9990014', '9990015', '9990016', '9990017',                                   '9990018', '9990019', '9990020', '9990021', '9990022', '9990023', '9990024', '9990025', '9990026', '9990027', '9990028', '9990029', '9990030',                                   '9990031', '9990032', '9990033', '9990034', '9990035', '9990036', '9990037', '9990038', '9990039', '9990040', '9990610', '9990611', '9990620',                                   '9990640', '9990041', '9990042', '9990043', '9990044', '9990045', '9990046', '9990047', '9990048', '9990049', '9990050', '9990051', '9990052',                                   '9990053', '9990054', '9990055', '9990056', '9990057', '9990058', '9990059', '9990060', '9990061', '9990062', '9990063', '9990064', '9990065',                                   '9990066', '9990067', '9990068', '9990069', '9990070', '9990071', '9990072', '9990073', '9990074', '9990075', '9990076', '9990077', '9990078',                                                       '9990079', '9990080', '9990081', '9990082', '9990083', '9990084', '9990085', '9990086', '9990087', '9990088', '9990089', '9990090', '9990091',                                                       '9990092', '9990093', '9990094', '9990095', '9990096', '9990097', '9990098', '9990099')) THEN 1 ELSE 0 END AS [Managed Idle Empty Car Count]                  , Case when (NR_Cd IN ('20', ' 21') OR (Car_Hire_Sts = 'Y' AND Car_Idle_Cnt = 0))            and (datediff(hour, Liability_Event_Dt , Crtd_Dt) >= 72 and  datediff(hour, Liability_Event_Dt , Crtd_Dt) < 96)                        then 1 else Null End as  [Hours since offered 72-96 Car Count]         , Case when (NR_Cd IN ('20', ' 21') OR (Car_Hire_Sts = 'Y' AND Car_Idle_Cnt = 0))            and (datediff(hour, Liability_Event_Dt , Crtd_Dt) >= 96 and  datediff(hour, Liability_Event_Dt , Crtd_Dt) < 120 )                    then 1 else null end as [Hours since offered 96+ Car Count]              FROM  [dbo].[vw_Pool_Contribution_Fact_History] AS F INNER JOIN      (select Ownr_Mrk as Ownr_Mrk_Cd, [Pool_Cd], Car_Dimn_Id, Car_Ver       from dbo.Car_Dim_Correct)  AS C ON F.Car_Dimn_Id = C.Car_Dimn_Id and F.Car_Ver = C.Car_Ver"
    },
    {
      "id": "VRepair_Code_Dim",
      "name": "VRepair_Code_Dim",
      "type": "VIEW",
      "sql": "create view [DDSV].[VRepair_Code_Dim] as  SELECT concat(convert(varchar(10),Mnt_Typ_Dimn_Id),'_',convert(varchar(5), Mnt_Typ_Ver)) as [Repr_Cd_Dimn_Id]        ,[Repr_Cd]        ,cast(Repr_Cls_Cd as varchar(1)) as [Repr_Cls]        ,[Repr_Cls_Desc]        ,[Repr_Cd_Full]        ,Repr_Cd_Full_Desc as [Repr_Cd_Desc]        ,cast(Mnt_Typ_Lvl_1 as varchar(50)) as [Mnt_Typ_Desc]        ,[Repr_Cd_Non_Bill_Ind]        ,[Repr_Cd_Actv_Ind]        ,[Repr_Cls_Grp]     ,[Repr_Cnv_flg] as Repr_Cnv_fl        ,[Crtd_Dt]        ,[Crtd_Id]        ,[Lst_Upd_Dt]        ,[Lst_Upd_Id]        ,[Src_Sys_Nm]      FROM [ddsmrt].[dbo].Maintenance_Type_Dim  (NOLOCK)"
    },
    {
      "id": "usp_D_House_Keeping_Pool_Contribution_Fact",
      "name": "usp_D_House_Keeping_Pool_Contribution_Fact",
      "type": "SQL_STORED_PROCEDURE",
      "sql": "CREATE PROC [dbo].[usp_D_House_Keeping_Pool_Contribution_Fact] (@month INT = 6)  AS  BEGIN   IF(MONTH(GETDATE()) IN (3,6,9,12))   BEGIN    DECLARE @date INT = CONVERT(VARCHAR(10), DATEADD(MONTH,- @month,GETDATE()), 112)    DECLARE @PARTITION INT      SELECT @PARTITION = $PARTITION.pf_Pool_Contribution_Fact_Function(@date)       ALTER TABLE [dbo].[Pool_Contribution_Fact] SWITCH PARTITION (@PARTITION) TO [dbo].[Pool_Contribution_Fact_History] PARTITION (@PARTITION)   END  END"
    },
    {
      "id": "Operational_Car_Count_Hist",
      "name": "Operational_Car_Count_Hist",
      "type": "VIEW",
      "sql": "CREATE VIEW [SV].[Operational_Car_Count_Hist]   AS  SELECT     VMRT_Operational_Car_Count.Car_Dimn_Id As Car_Dimn_Id,  VMRT_Operational_Car_Count.Car_Ver As Car_Ver,  VMRT_Operational_Car_Count.Snapshot_Dt_Dimn_Id  As Snapshot_Dt_Dimn_Id,  VMRT_Operational_Car_Count.Reporting_Road_Org_Dimn_Id As Reporting_Road_Org_Dimn_Id,  VMRT_Operational_Car_Count.Reporting_Road_Org_Ver As Reporting_Road_Org_Ver,  VMRT_Operational_Car_Count.Last_Participating_Road_Org_Dimn_Id As Last_Participating_Road_Org_Dimn_Id,  VMRT_Operational_Car_Count.Last_Participating_Road_Org_Ver As Last_Participating_Road_Org_Ver,  VMRT_Operational_Car_Count.Current_Participating_Road_Org_Dimn_Id As Current_Participating_Road_Org_Dimn_Id,  VMRT_Operational_Car_Count.Current_Participating_Road_Org_Ver  As Current_Participating_Road_Org_Ver,  VMRT_Operational_Car_Count.Enroute_Car_Cnt As Enroute_Car_Count,  VMRT_Operational_Car_Count.Enroute_TPE_Cnt As Enroute_TPE_Count,  VMRT_Operational_Car_Count.Enroute_Unit_Cnt As Enroute_Unit_Count,  VMRT_Operational_Car_Count.Enroute_Platform_Cnt As Enroute_Platform_Count,  VMRT_Operational_Car_Count.In_Paid_Storage_Car_Cnt As In_Paid_Storage_Car_Count,  VMRT_Operational_Car_Count.In_Paid_Storage_TPE_Cnt As In_Paid_Storage_TPE_Count,  VMRT_Operational_Car_Count.In_Paid_Storage_Unit_Cnt As In_Paid_Storage_Unit_Count,  VMRT_Operational_Car_Count.In_Paid_Storage_Platform_Cnt As In_Paid_Storage_Platform_Count,  VMRT_Operational_Car_Count.In_Repair_Entity_Car_Cnt As In_Repair_Entity_Car_Count,  VMRT_Operational_Car_Count.In_Repair_Entity_TPE_Cnt As In_Repair_Entity_TPE_Count,  VMRT_Operational_Car_Count.In_Repair_Entity_Unit_Cnt As In_Repair_Entity_Unit_Count,  VMRT_Operational_Car_Count.In_Repair_Entity_Platform_Cnt As In_Repair_Entity_Platform_Count,  VMRT_Operational_Car_Count.On_Railroad_Relief_Car_Cnt As On_Railroad_Relief_Car_Count,  VMRT_Operational_Car_Count.On_Railroad_Relief_TPE_Cnt As On_Railroad_Relief_TPE_Count,  VMRT_Operational_Car_Count.On_Railroad_Relief_Unit_Cnt As On_Railroad_Relief_Unit_Count,  VMRT_Operational_Car_Count.On_Railroad_Relief_Platform_Cnt As On_Railroad_Relief_Platform_Count,  VMRT_Operational_Car_Count.Fleet_In_Service_Car_Cnt  As Fleet_In_Service_Car_Count,  VMRT_Operational_Car_Count.Fleet_In_Service_TPE_Cnt  As Fleet_In_Service_TPE_Count,  VMRT_Operational_Car_Count.Fleet_In_Service_Unit_Cnt  As Fleet_In_Service_Unit_Count,  VMRT_Operational_Car_Count.Fleet_In_Service_Platform_Cnt  As Fleet_In_Service_Pltfm_Count,  VMRT_Operational_Car_Count.Distributable_Fleet_Size_Car_Cnt As Distributable_Fleet_Size_Car_Count,  VMRT_Operational_Car_Count.Distributable_Fleet_Size_Platform_Cnt As Distributable_Fleet_Size_Platform_Count,  VMRT_Operational_Car_Count.Distributable_Fleet_Size_TPE_Cnt As Distributable_Fleet_Size_TPE_Count,  VMRT_Operational_Car_Count.Distributable_Fleet_Size_Unit_Cnt As Distributable_Fleet_Size_Unit_Count,  VMRT_Operational_Car_Count.Physical_Fleet_Size_Car_Cnt As Physical_Fleet_Size_Car_Count,  VMRT_Operational_Car_Count.Physical_Fleet_Size_Platform_Cnt As Physical_Fleet_Size_Platform_Count ,  VMRT_Operational_Car_Count.Physical_Fleet_Size_TPE_Cnt As Physical_Fleet_Size_TPE_Count,  VMRT_Operational_Car_Count.Physical_Fleet_Size_Unit_Cnt As Physical_Fleet_Size_Unit_Count  ,  VMRT_Operational_Car_Count.Pooled_Fleet_Size_Car_Cnt As Pooled_Fleet_Size_Car_Count,   VMRT_Operational_Car_Count.Pooled_Fleet_Size_Platform_Cnt As Pooled_Fleet_Size_Platform_Count,  VMRT_Operational_Car_Count.Pooled_Fleet_Size_TPE_Cnt As Pooled_Fleet_Size_TPE_Count,  VMRT_Operational_Car_Count.Pooled_Fleet_Size_Unit_Cnt As Pooled_Fleet_Size_Unit_Count,  VMRT_Operational_Car_Count.Enroute_Owned_Idle_Empty_Car_Cnt_15_Days As Enroute_Owned_Idle_Empty_Car_Count_15_Days,  VMRT_Operational_Car_Count.Physical_Fleet_Size_Owned_Idle_Empty_Car_Cnt_15_Days As   Physical_Fleet_Size_Owned_Idle_Empty_Car_Count_15_Days,  VMRT_Operational_Car_Count.Pooled_Fleet_Size_Owned_Idle_Empty_Car_Cnt_15_Days As Pooled_Fleet_Size_Owned_Idle_Empty_Car_Count_15_Days,  VMRT_Operational_Car_Count.Distributable_Fleet_Size_Owned_Idle_Empty_Car_Cnt_15_Days As Distributable_Fleet_Size_Owned_Idle_Empty_Car_Count_15_Days ,  VMRT_Operational_Car_Count.Enroute_Owned_Idle_Empty_Platform_Cnt_15_Days As Enroute_Owned_Idle_Empty_Platform_Count_15_Days,  VMRT_Operational_Car_Count.Physical_Fleet_Size_Owned_Idle_Empty_Platform_Cnt_15_Days As Physical_Fleet_Size_Owned_Idle_Empty_Platform_Count_15_Days ,  VMRT_Operational_Car_Count.Pooled_Fleet_Size_Owned_Idle_Empty_Platform_Cnt_15_Days As Pooled_Fleet_Size_Owned_Idle_Empty_Platform_Count_15_Days ,  VMRT_Operational_Car_Count.Distributable_Fleet_Size_Owned_Idle_Empty_Platform_Cnt_15_Days As  Distributable_Fleet_Size_Owned_Idle_Empty_Platform_Count_15_Days,  (CASE WHEN [Ld_Empt_Ind] IS NULL THEN 'U' ELSE [Ld_Empt_Ind] END) AS [LE_Status]  ,VMRT_Operational_Car_Count.Offered_for_Relief_Fleet_Size_Car_cnt  ,VMRT_Operational_Car_Count.Offered_for_Relief_Fleet_Size_TPE_cnt  ,VMRT_Operational_Car_Count.Offered_for_Relief_Fleet_Size_Unit_cnt  ,VMRT_Operational_Car_Count.Offered_for_Relief_Fleet_Size_Pltfm_cnt    ,Case when datediff(hour, Liability_Event_Dt , Crtd_Dt) >= 72 and  datediff(hour, Liability_Event_Dt , Crtd_Dt) < 96      then Offered_for_Relief_Fleet_Size_Car_cnt else null end as [Hours since offered 72-96 Car Count]  ,Case when datediff(hour, Liability_Event_Dt , Crtd_Dt) >= 96 and  datediff(hour, Liability_Event_Dt , Crtd_Dt) < 120      then Offered_for_Relief_Fleet_Size_Car_cnt Else Null End as   [Hours since offered 96+ Car Count]     ,Liability_Event_Dt   ,VMRT_Operational_Car_Count.Active_Circulation_Car_Cnt,   VMRT_Operational_Car_Count.Active_Circulation_Truck_Cnt   ,VMRT_Operational_Car_Count.Active_Circulation_Unit_Cnt   ,VMRT_Operational_Car_Count.Physical_Fleet_Size_Owned_Idle_Empty_No_Movement_Platform_Cnt_15_Days As Physical_Fleet_Size_Owned_Idle_Empty_No_Movement_Platform_Count_15_Days ,   VMRT_Operational_Car_Count.Physical_Fleet_Size_Owned_Idle_Empty_No_Movement_Car_Cnt_15_Days As   Physical_Fleet_Size_Owned_Idle_Empty_No_Movement_Car_Count_15_Days    FROM VMRT_Operational_Car_Count_Hist VMRT_Operational_Car_Count"
    },
    {
      "id": "VRepair_Entity_Dim",
      "name": "VRepair_Entity_Dim",
      "type": "VIEW",
      "sql": "CREATE VIEW [DDSV].[VRepair_Entity_Dim]  as    SELECT concat(convert (varchar(10),Repr_Enty_Dimn_Id),'_',convert(varchar(5),Repr_Enty_Ver)) as Repr_Enty_Dimn_Id,       concat(convert (varchar(10),Repr_Enty_Org_Dimn_Id),'_',convert (varchar(5),Repr_Enty_Org_Ver)) as Org_Enty_Dimn_Id      ,CAST(SPLC_Dimn_Id AS VARCHAR) AS SPLC_Dimn_Id        ,org.[Pty_Id]         ,cast(Repr_Enty_Org_Abrv as varchar(25)) as Curr_Abrv     ,[Repr_Enty_org_Nm]        ,Repr_shp_Typ as Repr_Shop_Typ        ,[Repr_Fac_Grp]        ,cast(Ownr_Org_Nm as varchar(50)) as Repr_Fac_Ownr         ,[Repr_Enty_Typ]        ,[SPLC_Nr]        ,cast(SPLC_Nm as varchar(100)) as [Locn_Nm]        ,[FMO_Zone]        ,cast(Ownr_Org_Abrv as char(4)) as [Ownr_Mrk_Cd]        ,cast(St_Prov as varchar(55)) as [St_Prov_Regn]     ,cast(City as varchar(55)) as [City]        ,cast([Ownr_Typ_Desc] as varchar(255)) as [Ownr_Typ_Desc]     ,Serv_Yard_Cap        ,[Crtd_Dt]        ,cast([Crtd_Id] as char(8)) as [Crtd_Id]        ,[Lst_Upd_Dt]        ,cast([Lst_Upd_Id] as char(8)) as [Lst_Upd_Id]        ,cast([Src_Sys_Nm] as varchar(25)) as [Src_Sys_Nm]     ,[Eff_From]     ,[Eff_To]     ,[Shop_Cap]     --,[Repr_Enty_Dimn_Id] AS [Dim_ID]    FROM ddsmrt.dbo.VMRT_Repair_Entity_Dimension as Rep    LEFT JOIN(SELECT Org_Dimn_ID, Org_Ver, Pty_id from DDSMRT.DBO.Organization_Dim) as Org    on rep.Repr_Enty_Org_Dimn_Id = org.Org_dimn_id and Rep.Repr_Enty_Org_Ver = Org.Org_Ver"
    },
    {
      "id": "VMRT_Maximo_Car_Count_Hist",
      "name": "VMRT_Maximo_Car_Count_Hist",
      "type": "VIEW",
      "sql": "CREATE view [dbo].[VMRT_Maximo_Car_Count_Hist] as  SELECT       max_car_cnt.car_dimn_id    ,max_car_cnt.car_ver    ,max_car_cnt.Dt_Dimn_Id as Snapshot_Dt_Dimn_Id    , max_car_cnt.[138] as Maximo_Fleet_Size_Car_Cnt    , max_tpe_cnt.[138] as Maximo_Fleet_Size_TPE_Cnt    , max_ut_cnt.[138] as Maximo_Fleet_Size_Unit_Cnt    , max_pltfm_cnt.[138] as Maximo_Fleet_Size_Platform_Cnt      FROM     (select * from  ddsmrt.dbo.vw_car_count_fact_History  (NOLOCK)   where row_typ_id=519 ) ta   PIVOT   (            sum(car_cnt)       FOR Car_cnt_Catg_Typ_id IN ([138])   )   AS max_car_cnt  join    (select * from  ddsmrt.dbo.vw_car_count_fact_History    where row_typ_id=519 ) ta  PIVOT   (            sum(tpe_cnt)       FOR Car_cnt_Catg_Typ_id IN ([138])  )   AS max_tpe_cnt  on max_car_cnt.Car_Count_Fact_Id = max_tpe_cnt.Car_Count_Fact_Id  join    (select * from  ddsmrt.dbo.vw_car_count_fact_History    where row_typ_id=519 ) ta  PIVOT   (            sum(Ut_cnt)       FOR Car_cnt_Catg_Typ_id IN ([138])  )   AS max_ut_cnt  on max_car_cnt.Car_Count_Fact_Id = max_ut_cnt.Car_Count_Fact_Id  join    (select * from  ddsmrt.dbo.vw_car_count_fact_History    where row_typ_id=519 ) ta  PIVOT   (            sum(Pltfm_cnt)       FOR Car_cnt_Catg_Typ_id IN ([138])  )   AS max_pltfm_cnt  on max_car_cnt.Car_Count_Fact_Id = max_pltfm_cnt.Car_Count_Fact_Id"
    },
    {
      "id": "VRepair_Event_Cost_Fact",
      "name": "VRepair_Event_Cost_Fact",
      "type": "VIEW",
      "sql": "CREATE VIEW [DDSV].[VRepair_Event_Cost_Fact] AS   SELECT CAST([Rpr_Evnt_Cst_Fct_Id] AS int) AS [Repr_Evnt_Cst_Fct_Id]        ,concat(convert(varchar(10),Car_Dimn_Id),'_',convert(varchar(5), Car_Ver)) as [Car_Dimn_Id]     ,concat(convert(varchar(10),Car_Dimn_Id),'_',convert(varchar(5), Car_Ver)) as TTX_Equipment_Dimn_Id        ,concat(convert(varchar(10),Mnt_Typ_Dimn_Id),'_',convert(varchar(5),Mnt_Typ_Ver)) as [Repr_Cd_Dimn_Id]     ,CAST(Rpr_Dt_Dimn_Id AS int) AS [Repr_Dt_Dimn_Id]        ,CAST(TTX_Acct_Dt_Dimn_Id AS int) AS [Acct_Dt_Dimn_Id]        ,CAST([Cond_Cd_Dimn_Id] as int) as Cnd_Cd_Dimn_Id        ,CAST([Repr_Evnt_Typ_Cd_Dimn_Id] as int) as [Repr_Typ_Dimn_Id]     ,concat(convert(varchar(10),[Area_Of_Car_Dimn_Id]),'_',convert(varchar(5),[Area_Of_Car_Ver])) as [Area_Of_Car_Dimn_Id]        ,concat(convert(varchar(10),Rpr.Repr_Enty_Org_Dimn_Id),'_',convert(varchar(5), Rpr.Repr_Enty_Org_Ver)) as [Org_Enty_Dimn_Id]        ,concat(convert(varchar(10),[Invc_Enty_Org_Dimn_Id]),'_',convert(varchar(5), [Invc_Enty_Org_Ver])) as [Inv_Enty_Dimn_Id]        ,concat(convert(varchar(10),Rf.[Repr_Enty_Dimn_Id]),'_',convert(varchar(5), Rf.[Repr_Enty_Ver])) as [Repr_Enty_Dimn_Id]        ,cast (Resp_Cd_Dimn_Id as int) as [Repr_Resp_Dimn_Id]        ,cast (Why_Md_Cd_Dimn_Id as int) as [Repr_Rsn_Dimn_Id]        ,cast ([Car_Loc_Dimn_Id] as int) as [Car_Loc_Dimn_Id]        ,cast ([Car_Nr] as decimal(11,0)) as Car_Nr        ,[Car_Init]        ,[Repr_Cd]        ,[Repr_Dt]        ,TTX_Acct_Dt as [Acct_Dt]        ,cast ([Cnd_Cd] as varchar(2)) as Cond_Cd        ,cast (Repr_Evnt_Typ_Cd as varchar(20)) as [Repr_Fac_Typ]        ,Apl_Job_Cd as [Job_Cd]        ,Apl_Qlfr_Cd as [Qlfr_Cd]        ,cast (Invc_Enty_Id as char(4)) as [Invc_Abrv]        ,cast (Rf.Repr_Enty_Org_Abrv as char(4)) as [Repr_Abrv]        ,[Resp_Cd]        ,[Why_Md_Cd]        ,cast (Loc_On_Car_Cd as varchar(10)) as [Loc_On_Car]        ,cast (Car_Cls as varchar(6)) as [Car_Cls_Cd]        ,[Repr_Cls_Cd]        ,[Labr_Cost]        ,[Labr_Hrs]        ,[Matl_Cost]        ,[Cmpnt_Qty]        ,Acct_Typ as [Mnt_Or_Cap_Ind]        ,[Labr_Rt]        ,[Inv_Nr]        ,[Inv_Ln_Nr]        ,[Ref_Nr]        ,Repr_Cnv_Flg as [Repr_Cnv_Fl]        ,cast (Rf.Src_Sys_Nm as varchar(50)) as [Src_Sys_Nm]        ,[Invc_Typ]        ,[Repr_Desc]     ,[Wrk_Ord_Nr]     ,[Work_Type_Dimn_Id]        ,cast (Rf.[Crtd_Id] as char(8)) as Crtd_Id        ,Rf.[Crtd_Dt]        ,Rf.[Lst_Upd_Dt]        ,cast (Rf.[Lst_Upd_Id] as char(8)) as Lst_Upd_Id    FROM ddsmrt.[dbo].[vw_Repair_Event_Cost_Fact]  (NOLOCK)  rf    LEFT JOIN DDSMRT.DBO.Repair_Entity_Dim  (NOLOCK)  as Rpr    on Rf.Repr_Enty_Dimn_Id = Rpr.Repr_Enty_Dimn_Id     and Rf.Repr_Enty_Ver = Rpr.Repr_Enty_Ver"
    },
    {
      "id": "TTX_Marked_Fleet_Counts_Hist",
      "name": "TTX_Marked_Fleet_Counts_Hist",
      "type": "VIEW",
      "sql": "CREATE VIEW [SV].[TTX_Marked_Fleet_Counts_Hist]   AS  SELECT     VMRT_Maximo_Car_Count.Car_Dimn_Id As Car_Dimn_Id,  VMRT_Maximo_Car_Count.Car_Ver As Car_Ver,  VMRT_Maximo_Car_Count.Snapshot_Dt_Dimn_Id As Snapshot_Date_Dimn_Id,  VMRT_Maximo_Car_Count.Maximo_Fleet_Size_Car_Cnt As Maximo_Fleet_Size_Car_Count ,  VMRT_Maximo_Car_Count.Maximo_Fleet_Size_TPE_Cnt As Maximo_Fleet_Size_TPE_Count,  VMRT_Maximo_Car_Count.Maximo_Fleet_Size_Unit_Cnt As Maximo_Fleet_Size_Unit_Count,  VMRT_Maximo_Car_Count.Maximo_Fleet_Size_Platform_Cnt As Maximo_Fleet_Size_Platform_Count     FROM VMRT_Maximo_Car_Count_Hist VMRT_Maximo_Car_Count"
    },
    {
      "id": "VRepair_Reason_Dim",
      "name": "VRepair_Reason_Dim",
      "type": "VIEW",
      "sql": "create view [DDSV].[VRepair_Reason_Dim] as  SELECT  cast([Why_Md_Cd_Dimn_Id] as int) as Repr_Rsn_Dimn_Id        ,cast([Repr_Rsn_Cd] as char(2)) as [Repr_Rsn_Cd]        ,cast([Repr_Rsn_Cd_Desc] as varchar(256)) as [Repr_Rsn_Desc]        ,[Crtd_Dt]        ,cast([Crtd_Id] as char(8)) as [Crtd_Id]        ,[Lst_Upd_Dt]        ,cast([Lst_Upd_Id] as char(8)) as [Lst_Upd_Id]    FROM [ddsmrt].[dbo].[VMRT_Why_Made_Code_Dimension]"
    },
    {
      "id": "VMRT_DQ_Car_Count_Fact_new_Hist",
      "name": "VMRT_DQ_Car_Count_Fact_new_Hist",
      "type": "VIEW",
      "sql": "CREATE VIEW [dbo].[VMRT_DQ_Car_Count_Fact_new_Hist]  AS  SELECT        Car_Count_Fact.Car_Init, Car_Count_Fact.Car_Nr, dbo.ETL_Error_Check_Lookup.Err_Desc, dbo.ETL_Run.Run_Dt, Car_Count_Fact.Dq_Flg,                            dbo.ETL_Run.SSIS_Package_Nm  FROM            dbo.ETL_Error_Check_Lookup INNER JOIN                           dbo.ETL_Error_Detail ON dbo.ETL_Error_Check_Lookup.Err_Chk_Id = dbo.ETL_Error_Detail.Err_Chk_Id INNER JOIN                           dbo.ETL_Run ON dbo.ETL_Error_Detail.Run_Id = dbo.ETL_Run.Run_Id INNER JOIN                           dbo.vw_car_count_fact_History Car_Count_Fact ON dbo.ETL_Error_Detail.DDS_PK = Car_Count_Fact.Car_Count_Fact_Id  WHERE        (Car_Count_Fact.Dq_Flg = '1') AND (dbo.ETL_Run.SSIS_Package_Nm = 'SSIS_Car_Cnt_Fact_Ufd_Cnts') OR                           (dbo.ETL_Run.SSIS_Package_Nm = 'SSIS_Car_Count_Fact_Rev_Acc_Accr') OR                           (dbo.ETL_Run.SSIS_Package_Nm = 'SSIS_Car_Count_Fact_Rev_Acc_Est') OR                           (dbo.ETL_Run.SSIS_Package_Nm = 'SSIS_Car_Count_Fact_Rev_Acc_Act')"
    },
    {
      "id": "VRepair_Responsibility_Dim",
      "name": "VRepair_Responsibility_Dim",
      "type": "VIEW",
      "sql": "create view [DDSV].[VRepair_Responsibility_Dim] as  SELECT  cast([Resp_Cd_Dimn_Id] as int) as Repr_Resp_Dimn_Id        ,cast([Resp_Cd] as char(1)) as [Repr_Resp_Cd]        ,cast([Resp_Cd_Desc] as varchar(256)) as [Repr_Resp_Cd_Desc]        ,[Crtd_Dt]        ,cast([Crtd_Id] as char(8)) as [Crtd_Id]        ,[Lst_Upd_Dt]        ,cast([Lst_Upd_Id] as char(8)) as [Lst_Upd_Id]    FROM [ddsmrt].[dbo].[VMRT_Responsibility_Code_Dimension]"
    },
    {
      "id": "VMRT_Revenue_Accounting_Accrual_Car_Count_Hist",
      "name": "VMRT_Revenue_Accounting_Accrual_Car_Count_Hist",
      "type": "VIEW",
      "sql": "CREATE view [dbo].[VMRT_Revenue_Accounting_Accrual_Car_Count_Hist] as      With Tunpivot as (  SELECT    car_dimn_id  ,car_ver  ,Dt_Dimn_Id   ,Attr_Id_1   ,Attr_Ver_1   ,Attr_Id_2   ,Attr_Ver_2   ,Liable_Org_Dimn_Id  ,Liable_Org_Ver  ,Responsible_Org_Dimn_Id  ,Responsible_Org_Ver  ,concat(CntName, Car_Cnt_Catg_Typ_Id) as PCol  ,CntValue      FROM     (select car_dimn_id,car_ver,Dt_Dimn_Id,Attr_Id_1,Attr_Ver_1,Attr_Id_2,Attr_Ver_2     , mem1.Org_Dimn_Id as Responsible_Org_Dimn_Id , mem1.org_Ver as Responsible_Org_Ver     , mem2.Org_Dimn_Id as Liable_Org_Dimn_Id, mem2.org_Ver as  Liable_Org_Ver           ,Car_cnt_Catg_Typ_id,Car_Cnt,TPE_Cnt, Ut_Cnt, Pltfm_Cnt     from  ddsmrt.dbo.vw_car_count_fact_History (NOLOCK) cnt    left join ddsmrt.dbo.Organization_Membership_dim (NOLOCK) mem1 on (Cnt.Attr_Id_1 = mem1.[Org_Mbrshp_Dimn_Id] and cnt.Attr_Ver_1 = mem1.[Org_Mbrshp_Ver])    left join ddsmrt.dbo.Organization_Membership_dim (NOLOCK) mem2 on (Cnt.Attr_Id_2 = mem2.[Org_Mbrshp_Dimn_Id] and cnt.Attr_Ver_2 = mem2.[Org_Mbrshp_Ver])    where cnt.row_typ_id=516 ) ta --Rev Acct Accrual     UNPIVOT   (CntValue FOR CntName IN (Car_Cnt, TPE_Cnt, Ut_Cnt, Pltfm_Cnt)) AS pvt    )  select      rev_car_cnt.car_dimn_id    ,rev_car_cnt.car_ver    ,rev_car_cnt.Dt_Dimn_Id as Service_Month_Start_Dt_Dimn_Id    ,rev_car_cnt.Attr_Id_1 as Responsible_Road_Org_Mbrshp_Dimn_Id     ,rev_car_cnt.Attr_Ver_1 as Responsible_Road_Org_Mbrshp_Ver    ,rev_car_cnt.Attr_Id_2 as Liable_Road_Org_Mbrshp_Dimn_Id    ,rev_car_cnt.Attr_Ver_2 as Liable_Road_Org_Mbrshp_Ver     ,rev_car_cnt.Liable_Org_Dimn_Id    ,rev_car_cnt.Liable_Org_Ver    ,rev_car_cnt.Responsible_Org_Dimn_Id    ,rev_car_cnt.Responsible_Org_Ver     --car cnt    , (isnull(rev_car_cnt.[Car_Cnt145],0) + isnull(rev_car_cnt.[Car_Cnt146],0))   As In_Shop_Car_Cnt          , isnull(rev_car_cnt.[Car_Cnt128],0)            As Enroute_Car_Cnt           , isnull(rev_car_cnt.[Car_Cnt129],0)            As In_Bad_Order_Storage_Car_Cnt    , isnull(rev_car_cnt.[Car_Cnt130],0)            as In_FMO_Car_Cnt    , (isnull(rev_car_cnt.[Car_Cnt133],0) + isnull(rev_car_cnt.[Car_Cnt129],0))   as In_Paid_Storage_Car_Cnt    , (isnull(rev_car_cnt.[Car_Cnt130],0) + isnull(rev_car_cnt.[Car_Cnt145],0) + isnull(rev_car_cnt.[Car_Cnt146],0)) as In_Repair_Entity_Car_Cnt    , isnull(rev_car_cnt.[Car_Cnt145],0)            as In_TTX_Shop_Car_Cnt    , isnull(rev_car_cnt.[Car_Cnt146],0)            as In_IRF_Car_Cnt    , isnull(rev_car_cnt.[Car_Cnt133],0)            as In_Selective_Storage_Car_Cnt    , isnull(rev_car_cnt.[Car_Cnt134],0)            as On_Offline_Relief_Car_Cnt    , isnull(rev_car_cnt.[Car_Cnt135],0)            as On_Online_Relief_Car_Cnt    , (isnull(rev_car_cnt.[Car_Cnt134],0) + isnull(rev_car_cnt.[Car_Cnt135],0))   as On_Railroad_Relief_Car_Cnt    , (isnull(rev_car_cnt.[Car_Cnt138],0)-isnull(rev_car_cnt.[Car_Cnt130],0)-isnull(rev_car_cnt.[Car_Cnt145],0)-isnull(rev_car_cnt.[Car_Cnt146],0)             -isnull(rev_car_cnt.[Car_Cnt134],0)-isnull(rev_car_cnt.[Car_Cnt135],0)             -isnull(rev_car_cnt.[Car_Cnt133],0)-isnull(rev_car_cnt.[Car_Cnt129],0)             -isnull(rev_car_cnt.[Car_Cnt128],0))     as Fleet_In_Service_Car_Cnt    , isnull(rev_car_cnt.[Car_Cnt138],0)            as Fleet_Size_Car_Cnt     --tpe cnt    , (isnull(rev_car_cnt.[TPE_Cnt145],0) + isnull(rev_car_cnt.[TPE_Cnt146],0))   As In_Shop_TPE_Cnt          , isnull(rev_car_cnt.[TPE_Cnt128],0)            As Enroute_TPE_Cnt          , isnull(rev_car_cnt.[TPE_Cnt129],0)            As In_Bad_Order_Storage_TPE_Cnt    , isnull(rev_car_cnt.[TPE_Cnt130],0)            as In_FMO_TPE_Cnt    , (isnull(rev_car_cnt.[TPE_Cnt133],0) + isnull(rev_car_cnt.[TPE_Cnt129],0))   as In_Paid_Storage_TPE_Cnt    , (isnull(rev_car_cnt.[TPE_Cnt130],0) + isnull(rev_car_cnt.[TPE_Cnt145],0) + isnull(rev_car_cnt.[TPE_Cnt146],0)) as In_Repair_Entity_TPE_Cnt    , isnull(rev_car_cnt.[TPE_Cnt145],0)            as In_TTX_Shop_TPE_Cnt    , isnull(rev_car_cnt.[TPE_Cnt146],0)            as In_IRF_TPE_Cnt    , isnull(rev_car_cnt.[TPE_Cnt133],0)            as In_Selective_Storage_TPE_Cnt    , isnull(rev_car_cnt.[TPE_Cnt134],0)            as On_Offline_Relief_TPE_Cnt    , isnull(rev_car_cnt.[TPE_Cnt135],0)            as On_Online_Relief_TPE_Cnt    , (isnull(rev_car_cnt.[TPE_Cnt134],0) + isnull(rev_car_cnt.[TPE_Cnt135],0))   as On_Railroad_Relief_TPE_Cnt    , (isnull(rev_car_cnt.[TPE_Cnt138],0)-isnull(rev_car_cnt.[TPE_Cnt130],0)-isnull(rev_car_cnt.[TPE_Cnt145],0)-isnull(rev_car_cnt.[TPE_Cnt146],0)             -isnull(rev_car_cnt.[TPE_Cnt134],0)-isnull(rev_car_cnt.[TPE_Cnt135],0)             -isnull(rev_car_cnt.[TPE_Cnt133],0)-isnull(rev_car_cnt.[TPE_Cnt129],0)             -isnull(rev_car_cnt.[TPE_Cnt128],0))     as Fleet_In_Service_TPE_Cnt    , isnull(rev_car_cnt.[TPE_Cnt138],0)            as Fleet_Size_TPE_Cnt     --Ut cnt    , (isnull(rev_car_cnt.[Ut_Cnt145],0) + isnull(rev_car_cnt.[Ut_Cnt146],0))      As In_Shop_Unit_Cnt          , isnull(rev_car_cnt.[Ut_Cnt128],0)                As Enroute_Unit_Cnt          , isnull(rev_car_cnt.[Ut_Cnt129],0)                As In_Bad_Order_Storage_Unit_Cnt    , isnull(rev_car_cnt.[Ut_Cnt130],0)                as In_FMO_Unit_Cnt    , (isnull(rev_car_cnt.[Ut_Cnt133],0) + isnull(rev_car_cnt.[Ut_Cnt129],0))      as In_Paid_Storage_Unit_Cnt    , (isnull(rev_car_cnt.[Ut_Cnt130],0) + isnull(rev_car_cnt.[Ut_Cnt145],0) + isnull(rev_car_cnt.[Ut_Cnt146],0)) as In_Repair_Entity_Unit_Cnt    , isnull(rev_car_cnt.[Ut_Cnt145],0)                as In_TTX_Shop_Unit_Cnt    , isnull(rev_car_cnt.[Ut_Cnt146],0)                as In_IRF_Unit_Cnt    , isnull(rev_car_cnt.[Ut_Cnt133],0)                as In_Selective_Storage_Unit_Cnt    , isnull(rev_car_cnt.[Ut_Cnt134],0)                as On_Offline_Relief_Unit_Cnt    , isnull(rev_car_cnt.[Ut_Cnt135],0)                as On_Online_Relief_Unit_Cnt    , (isnull(rev_car_cnt.[Ut_Cnt134],0) + isnull(rev_car_cnt.[Ut_Cnt135],0))      as On_Railroad_Relief_Unit_Cnt    , (isnull(rev_car_cnt.[Ut_Cnt138],0)-isnull(rev_car_cnt.[Ut_Cnt130],0)-isnull(rev_car_cnt.[Ut_Cnt145],0)-isnull(rev_car_cnt.[Ut_Cnt146],0)             -isnull(rev_car_cnt.[Ut_Cnt134],0)-isnull(rev_car_cnt.[Ut_Cnt135],0)             -isnull(rev_car_cnt.[Ut_Cnt133],0)-isnull(rev_car_cnt.[Ut_Cnt129],0)             -isnull(rev_car_cnt.[Ut_Cnt128],0))        as Fleet_In_Service_Unit_Cnt    , isnull(rev_car_cnt.[Ut_Cnt138],0)                as Fleet_Size_Unit_Cnt         --Platform cnt    , (isnull(rev_car_cnt.[Pltfm_Cnt145],0) + isnull(rev_car_cnt.[Pltfm_Cnt146],0))      As In_Shop_Platform_Cnt          , isnull(rev_car_cnt.[Pltfm_Cnt128],0)                As Enroute_Platform_Cnt          , isnull(rev_car_cnt.[Pltfm_Cnt129],0)                As In_Bad_Order_Storage_Platform_Cnt    , isnull(rev_car_cnt.[Pltfm_Cnt130],0)                as In_FMO_Platform_Cnt    , (isnull(rev_car_cnt.[Pltfm_Cnt133],0) + isnull(rev_car_cnt.[Pltfm_Cnt129],0))      as In_Paid_Storage_Platform_Cnt    , (isnull(rev_car_cnt.[Pltfm_Cnt130],0) + isnull(rev_car_cnt.[Pltfm_Cnt145],0) + isnull(rev_car_cnt.[Pltfm_Cnt146],0)) as In_Repair_Entity_Platform_Cnt    , isnull(rev_car_cnt.[Pltfm_Cnt145],0)                as In_TTX_Shop_Platform_Cnt    , isnull(rev_car_cnt.[Pltfm_Cnt146],0)                as In_IRF_Platform_Cnt    , isnull(rev_car_cnt.[Pltfm_Cnt133],0)                as In_Selective_Storage_Platform_Cnt    , isnull(rev_car_cnt.[Pltfm_Cnt134],0)                as On_Offline_Relief_Platform_Cnt    , isnull(rev_car_cnt.[Pltfm_Cnt135],0)                as On_Online_Relief_Platform_Cnt    , (isnull(rev_car_cnt.[Pltfm_Cnt134],0) + isnull(rev_car_cnt.[Pltfm_Cnt135],0))      as On_Railroad_Relief_Platform_Cnt    , (isnull(rev_car_cnt.[Pltfm_Cnt138],0)-isnull(rev_car_cnt.[Pltfm_Cnt130],0)-isnull(rev_car_cnt.[Pltfm_Cnt145],0)-isnull(rev_car_cnt.[Pltfm_Cnt146],0)             -isnull(rev_car_cnt.[Pltfm_Cnt134],0)-isnull(rev_car_cnt.[Pltfm_Cnt135],0)             -isnull(rev_car_cnt.[Pltfm_Cnt133],0)-isnull(rev_car_cnt.[Pltfm_Cnt129],0)             -isnull(rev_car_cnt.[Pltfm_Cnt128],0))        as Fleet_In_Service_Platform_Cnt    , isnull(rev_car_cnt.[Pltfm_Cnt138],0)                as Fleet_Size_Platform_Cnt      from Tunpivot    PIVOT   (            sum(CntValue)       FOR Pcol IN ( [Car_Cnt128], [Car_Cnt129],[Car_Cnt130],[Car_Cnt133],[Car_Cnt134],[Car_Cnt135],[Car_Cnt136],[Car_Cnt137],[Car_Cnt138],[Car_Cnt145],[Car_Cnt146]        , [TPE_Cnt128], [TPE_Cnt129],[TPE_Cnt130],[TPE_Cnt133],[TPE_Cnt134],[TPE_Cnt135],[TPE_Cnt136],[TPE_Cnt137],[TPE_Cnt138],[TPE_Cnt145],[TPE_Cnt146]        , [Ut_Cnt128], [Ut_Cnt129],[Ut_Cnt130],[Ut_Cnt133],[Ut_Cnt134],[Ut_Cnt135],[Ut_Cnt136],[Ut_Cnt137],[Ut_Cnt138],[Ut_Cnt145],[Ut_Cnt146]        , [Pltfm_Cnt128], [Pltfm_Cnt129],[Pltfm_Cnt130],[Pltfm_Cnt133],[Pltfm_Cnt134],[Pltfm_Cnt135],[Pltfm_Cnt136],[Pltfm_Cnt137],[Pltfm_Cnt138],[Pltfm_Cnt145],[Pltfm_Cnt146]          )     )   AS rev_car_cnt"
    },
    {
      "id": "VRepair_Type_Dim",
      "name": "VRepair_Type_Dim",
      "type": "VIEW",
      "sql": "create view [DDSV].[VRepair_Type_Dim] as  SELECT cast([Repr_Evnt_Typ_Cd_Dimn_Id] as int) as Repr_Typ_Dimn_Id        ,cast([Repr_Evnt_Typ_Cd] as varchar(20)) as [Repr_Typ_Nm]        ,cast([Repr_Evnt_Typ_Cd_Desc] as varchar(255)) as [Repr_Typ_Desc]        ,[Crtd_Dt]        ,cast([Crtd_Id] as char(8)) as [Crtd_Id]        ,[Lst_Upd_Dt]        ,cast([Lst_Upd_Id] as char(8)) as [Lst_Upd_Id]    FROM [ddsmrt].[dbo].[VMRT_Repair_Event_Type_Dimension]"
    },
    {
      "id": "VMRT_Revenue_Accounting_Actual_Car_Count_Hist",
      "name": "VMRT_Revenue_Accounting_Actual_Car_Count_Hist",
      "type": "VIEW",
      "sql": "CREATE view [dbo].[VMRT_Revenue_Accounting_Actual_Car_Count_Hist] as      With Tunpivot as (  SELECT    car_dimn_id  ,car_ver  ,Dt_Dimn_Id   ,Attr_Id_1   ,Attr_Ver_1   ,Attr_Id_2   ,Attr_Ver_2   ,Liable_Org_Dimn_Id  ,Liable_Org_Ver  ,Responsible_Org_Dimn_Id  ,Responsible_Org_Ver  ,concat(CntName, Car_Cnt_Catg_Typ_Id) as PCol  ,CntValue      FROM     (select car_dimn_id,car_ver,Dt_Dimn_Id,Attr_Id_1,Attr_Ver_1,Attr_Id_2,Attr_Ver_2     , mem1.Org_Dimn_Id as Responsible_Org_Dimn_Id , mem1.org_Ver as Responsible_Org_Ver     , mem2.Org_Dimn_Id as Liable_Org_Dimn_Id, mem2.org_Ver as Liable_Org_Ver            ,Car_cnt_Catg_Typ_id,Car_Cnt,TPE_Cnt, Ut_Cnt, Pltfm_Cnt     from  ddsmrt.dbo.vw_car_count_fact_History (NOLOCK) cnt    left join ddsmrt.dbo.Organization_Membership_dim (NOLOCK) mem1 on (Cnt.Attr_Id_1 = mem1.[Org_Mbrshp_Dimn_Id] and cnt.Attr_Ver_1 = mem1.[Org_Mbrshp_Ver])    left join ddsmrt.dbo.Organization_Membership_dim (NOLOCK) mem2 on (Cnt.Attr_Id_2 = mem2.[Org_Mbrshp_Dimn_Id] and cnt.Attr_Ver_2 = mem2.[Org_Mbrshp_Ver])      where row_typ_id=517 ) ta --Rev Acct Actual    UNPIVOT   (CntValue FOR CntName IN (Car_Cnt, TPE_Cnt, Ut_Cnt, Pltfm_Cnt)) AS pvt    )  select      rev_car_cnt.car_dimn_id    ,rev_car_cnt.car_ver    ,rev_car_cnt.Dt_Dimn_Id as Service_Month_Start_Dt_Dimn_Id    ,rev_car_cnt.Attr_Id_1 as Responsible_Road_Org_Mbrshp_Dimn_Id    ,rev_car_cnt.Attr_Ver_1 as Responsible_Road_Org_Mbrshp_Ver    ,rev_car_cnt.Attr_Id_2 as Liable_Road_Org_Mbrshp_Dimn_Id     ,rev_car_cnt.Attr_Ver_2 as Liable_Road_Org_Mbrshp_Ver     ,rev_car_cnt.Liable_Org_Dimn_Id    ,rev_car_cnt.Liable_Org_Ver    ,rev_car_cnt.Responsible_Org_Dimn_Id    ,rev_car_cnt.Responsible_Org_Ver     --car cnt    , (isnull(rev_car_cnt.[Car_Cnt145],0) + isnull(rev_car_cnt.[Car_Cnt146],0))   As In_Shop_Car_Cnt          , isnull(rev_car_cnt.[Car_Cnt128],0)            As Enroute_Car_Cnt           , isnull(rev_car_cnt.[Car_Cnt129],0)            As In_Bad_Order_Storage_Car_Cnt    , isnull(rev_car_cnt.[Car_Cnt130],0)            as In_FMO_Car_Cnt    , (isnull(rev_car_cnt.[Car_Cnt133],0) + isnull(rev_car_cnt.[Car_Cnt129],0))   as In_Paid_Storage_Car_Cnt    , (isnull(rev_car_cnt.[Car_Cnt130],0) + isnull(rev_car_cnt.[Car_Cnt145],0) + isnull(rev_car_cnt.[Car_Cnt146],0)) as In_Repair_Entity_Car_Cnt    , isnull(rev_car_cnt.[Car_Cnt145],0)            as In_TTX_Shop_Car_Cnt    , isnull(rev_car_cnt.[Car_Cnt146],0)            as In_IRF_Car_Cnt    , isnull(rev_car_cnt.[Car_Cnt133],0)            as In_Selective_Storage_Car_Cnt    , isnull(rev_car_cnt.[Car_Cnt134],0)            as On_Offline_Relief_Car_Cnt    , isnull(rev_car_cnt.[Car_Cnt135],0)            as On_Online_Relief_Car_Cnt    , (isnull(rev_car_cnt.[Car_Cnt134],0) + isnull(rev_car_cnt.[Car_Cnt135],0))   as On_Railroad_Relief_Car_Cnt    , (isnull(rev_car_cnt.[Car_Cnt138],0)-isnull(rev_car_cnt.[Car_Cnt130],0)-isnull(rev_car_cnt.[Car_Cnt145],0)-isnull(rev_car_cnt.[Car_Cnt146],0)             -isnull(rev_car_cnt.[Car_Cnt134],0)-isnull(rev_car_cnt.[Car_Cnt135],0)             -isnull(rev_car_cnt.[Car_Cnt133],0)-isnull(rev_car_cnt.[Car_Cnt129],0)             -isnull(rev_car_cnt.[Car_Cnt128],0))     as Fleet_In_Service_Car_Cnt    , isnull(rev_car_cnt.[Car_Cnt138],0)            as Fleet_Size_Car_Cnt     --tpe cnt    , (isnull(rev_car_cnt.[TPE_Cnt145],0) + isnull(rev_car_cnt.[TPE_Cnt146],0))   As In_Shop_TPE_Cnt          , isnull(rev_car_cnt.[TPE_Cnt128],0)            As Enroute_TPE_Cnt          , isnull(rev_car_cnt.[TPE_Cnt129],0)            As In_Bad_Order_Storage_TPE_Cnt    , isnull(rev_car_cnt.[TPE_Cnt130],0)            as In_FMO_TPE_Cnt    , (isnull(rev_car_cnt.[TPE_Cnt133],0) + isnull(rev_car_cnt.[TPE_Cnt129],0))   as In_Paid_Storage_TPE_Cnt    , (isnull(rev_car_cnt.[TPE_Cnt130],0) + isnull(rev_car_cnt.[TPE_Cnt145],0) + isnull(rev_car_cnt.[TPE_Cnt146],0)) as In_Repair_Entity_TPE_Cnt    , isnull(rev_car_cnt.[TPE_Cnt145],0)            as In_TTX_Shop_TPE_Cnt    , isnull(rev_car_cnt.[TPE_Cnt146],0)            as In_IRF_TPE_Cnt    , isnull(rev_car_cnt.[TPE_Cnt133],0)            as In_Selective_Storage_TPE_Cnt    , isnull(rev_car_cnt.[TPE_Cnt134],0)            as On_Offline_Relief_TPE_Cnt    , isnull(rev_car_cnt.[TPE_Cnt135],0)            as On_Online_Relief_TPE_Cnt    , (isnull(rev_car_cnt.[TPE_Cnt134],0) + isnull(rev_car_cnt.[TPE_Cnt135],0))   as On_Railroad_Relief_TPE_Cnt    , (isnull(rev_car_cnt.[TPE_Cnt138],0)-isnull(rev_car_cnt.[TPE_Cnt130],0)-isnull(rev_car_cnt.[TPE_Cnt145],0)-isnull(rev_car_cnt.[TPE_Cnt146],0)             -isnull(rev_car_cnt.[TPE_Cnt134],0)-isnull(rev_car_cnt.[TPE_Cnt135],0)             -isnull(rev_car_cnt.[TPE_Cnt133],0)-isnull(rev_car_cnt.[TPE_Cnt129],0)             -isnull(rev_car_cnt.[TPE_Cnt128],0))     as Fleet_In_Service_TPE_Cnt    , isnull(rev_car_cnt.[TPE_Cnt138],0)            as Fleet_Size_TPE_Cnt     --Ut cnt    , (isnull(rev_car_cnt.[Ut_Cnt145],0) + isnull(rev_car_cnt.[Ut_Cnt146],0))      As In_Shop_Unit_Cnt          , isnull(rev_car_cnt.[Ut_Cnt128],0)                As Enroute_Unit_Cnt          , isnull(rev_car_cnt.[Ut_Cnt129],0)                As In_Bad_Order_Storage_Unit_Cnt    , isnull(rev_car_cnt.[Ut_Cnt130],0)                as In_FMO_Unit_Cnt    , (isnull(rev_car_cnt.[Ut_Cnt133],0) + isnull(rev_car_cnt.[Ut_Cnt129],0))      as In_Paid_Storage_Unit_Cnt    , (isnull(rev_car_cnt.[Ut_Cnt130],0) + isnull(rev_car_cnt.[Ut_Cnt145],0) + isnull(rev_car_cnt.[Ut_Cnt146],0)) as In_Repair_Entity_Unit_Cnt    , isnull(rev_car_cnt.[Ut_Cnt145],0)                as In_TTX_Shop_Unit_Cnt    , isnull(rev_car_cnt.[Ut_Cnt146],0)                as In_IRF_Unit_Cnt    , isnull(rev_car_cnt.[Ut_Cnt133],0)                as In_Selective_Storage_Unit_Cnt    , isnull(rev_car_cnt.[Ut_Cnt134],0)                as On_Offline_Relief_Unit_Cnt    , isnull(rev_car_cnt.[Ut_Cnt135],0)                as On_Online_Relief_Unit_Cnt    , (isnull(rev_car_cnt.[Ut_Cnt134],0) + isnull(rev_car_cnt.[Ut_Cnt135],0))      as On_Railroad_Relief_Unit_Cnt    , (isnull(rev_car_cnt.[Ut_Cnt138],0)-isnull(rev_car_cnt.[Ut_Cnt130],0)-isnull(rev_car_cnt.[Ut_Cnt145],0)-isnull(rev_car_cnt.[Ut_Cnt146],0)             -isnull(rev_car_cnt.[Ut_Cnt134],0)-isnull(rev_car_cnt.[Ut_Cnt135],0)             -isnull(rev_car_cnt.[Ut_Cnt133],0)-isnull(rev_car_cnt.[Ut_Cnt129],0)             -isnull(rev_car_cnt.[Ut_Cnt128],0))        as Fleet_In_Service_Unit_Cnt    , isnull(rev_car_cnt.[Ut_Cnt138],0)                as Fleet_Size_Unit_Cnt         --Platform cnt    , (isnull(rev_car_cnt.[Pltfm_Cnt145],0) + isnull(rev_car_cnt.[Pltfm_Cnt146],0))      As In_Shop_Platform_Cnt          , isnull(rev_car_cnt.[Pltfm_Cnt128],0)                As Enroute_Platform_Cnt          , isnull(rev_car_cnt.[Pltfm_Cnt129],0)                As In_Bad_Order_Storage_Platform_Cnt    , isnull(rev_car_cnt.[Pltfm_Cnt130],0)                as In_FMO_Platform_Cnt    , (isnull(rev_car_cnt.[Pltfm_Cnt133],0) + isnull(rev_car_cnt.[Pltfm_Cnt129],0))      as In_Paid_Storage_Platform_Cnt    , (isnull(rev_car_cnt.[Pltfm_Cnt130],0) + isnull(rev_car_cnt.[Pltfm_Cnt145],0) + isnull(rev_car_cnt.[Pltfm_Cnt146],0)) as In_Repair_Entity_Platform_Cnt    , isnull(rev_car_cnt.[Pltfm_Cnt145],0)                as In_TTX_Shop_Platform_Cnt    , isnull(rev_car_cnt.[Pltfm_Cnt146],0)                as In_IRF_Platform_Cnt    , isnull(rev_car_cnt.[Pltfm_Cnt133],0)                as In_Selective_Storage_Platform_Cnt    , isnull(rev_car_cnt.[Pltfm_Cnt134],0)                as On_Offline_Relief_Platform_Cnt    , isnull(rev_car_cnt.[Pltfm_Cnt135],0)                as On_Online_Relief_Platform_Cnt    , (isnull(rev_car_cnt.[Pltfm_Cnt134],0) + isnull(rev_car_cnt.[Pltfm_Cnt135],0))      as On_Railroad_Relief_Platform_Cnt    , (isnull(rev_car_cnt.[Pltfm_Cnt138],0)-isnull(rev_car_cnt.[Pltfm_Cnt130],0)-isnull(rev_car_cnt.[Pltfm_Cnt145],0)-isnull(rev_car_cnt.[Pltfm_Cnt146],0)             -isnull(rev_car_cnt.[Pltfm_Cnt134],0)-isnull(rev_car_cnt.[Pltfm_Cnt135],0)             -isnull(rev_car_cnt.[Pltfm_Cnt133],0)-isnull(rev_car_cnt.[Pltfm_Cnt129],0)             -isnull(rev_car_cnt.[Pltfm_Cnt128],0))        as Fleet_In_Service_Platform_Cnt    , isnull(rev_car_cnt.[Pltfm_Cnt138],0)                as Fleet_Size_Platform_Cnt      from Tunpivot    PIVOT   (            sum(CntValue)       FOR Pcol IN ( [Car_Cnt128], [Car_Cnt129],[Car_Cnt130],[Car_Cnt133],[Car_Cnt134],[Car_Cnt135],[Car_Cnt136],[Car_Cnt137],[Car_Cnt138],[Car_Cnt145],[Car_Cnt146]        , [TPE_Cnt128], [TPE_Cnt129],[TPE_Cnt130],[TPE_Cnt133],[TPE_Cnt134],[TPE_Cnt135],[TPE_Cnt136],[TPE_Cnt137],[TPE_Cnt138],[TPE_Cnt145],[TPE_Cnt146]        , [Ut_Cnt128], [Ut_Cnt129],[Ut_Cnt130],[Ut_Cnt133],[Ut_Cnt134],[Ut_Cnt135],[Ut_Cnt136],[Ut_Cnt137],[Ut_Cnt138],[Ut_Cnt145],[Ut_Cnt146]        , [Pltfm_Cnt128], [Pltfm_Cnt129],[Pltfm_Cnt130],[Pltfm_Cnt133],[Pltfm_Cnt134],[Pltfm_Cnt135],[Pltfm_Cnt136],[Pltfm_Cnt137],[Pltfm_Cnt138],[Pltfm_Cnt145],[Pltfm_Cnt146]          )     )   AS rev_car_cnt"
    },
    {
      "id": "VStandard_Commodity_Dim",
      "name": "VStandard_Commodity_Dim",
      "type": "VIEW",
      "sql": "CREATE view [DDSV].[VStandard_Commodity_Dim]   AS  SELECT       cast([STCC_Dimn_Id] as int) as [STCC_Dimn_Id]         ,[STCC] as Stcc_Cd        ,convert(varchar(15), [STCC_Desc]) as [STCC_Desc]        ,[STCC_2_Digt] as Maj_Stcc_Grp        ,convert(varchar(50), [STCC_2_Digt_Desc]) as Maj_Stcc_Grp_Desc        ,[STCC_5_Digt] as Mnr_Stcc_Grp        ,convert(varchar(50), [STCC_5_Digt_Desc]) as Mnr_Stcc_Grp_Desc     ,[Crtd_Id]        ,[Crtd_Dt]        ,[Lst_Upd_Id]        ,[Lst_Upd_Dt]     ,[TTX_High_Desc]     ,[TTX_Low_Desc]    FROM [ddsmrt].[dbo].[Standard_Commodity_Dim] (NOLOCK)"
    },
    {
      "id": "VMRT_Revenue_Accounting_Estimate_Car_Count_Hist",
      "name": "VMRT_Revenue_Accounting_Estimate_Car_Count_Hist",
      "type": "VIEW",
      "sql": "CREATE view [dbo].[VMRT_Revenue_Accounting_Estimate_Car_Count_Hist] as      With Tunpivot as (  SELECT    car_dimn_id  ,car_ver  ,Dt_Dimn_Id   ,Attr_Id_1   ,Attr_Ver_1   ,Attr_Id_2   ,Attr_Ver_2   ,Liable_Org_Dimn_Id  ,Liable_Org_Ver  ,Responsible_Org_Dimn_Id  ,Responsible_Org_Ver  ,concat(CntName, Car_Cnt_Catg_Typ_Id) as PCol  ,CntValue  ,Crtd_Dt    FROM     (select car_dimn_id,car_ver,Dt_Dimn_Id,Attr_Id_1,Attr_Ver_1,Attr_Id_2,Attr_Ver_2     , mem1.Org_Dimn_Id as Responsible_Org_Dimn_Id , mem1.org_Ver as Responsible_Org_Ver      , mem2.Org_Dimn_Id as Liable_Org_Dimn_Id, mem2.org_Ver as Liable_Org_Ver           ,Car_cnt_Catg_Typ_id,Car_Cnt,TPE_Cnt, Ut_Cnt, Pltfm_Cnt, cnt.Crtd_Dt    from  ddsmrt.dbo.vw_car_count_fact_History (NOLOCK)  cnt    left join ddsmrt.dbo.Organization_Membership_dim (NOLOCK) mem1 on (Cnt.Attr_Id_1 = mem1.[Org_Mbrshp_Dimn_Id] and cnt.Attr_Ver_1 = mem1.[Org_Mbrshp_Ver])    left join ddsmrt.dbo.Organization_Membership_dim (NOLOCK) mem2 on (Cnt.Attr_Id_2 = mem2.[Org_Mbrshp_Dimn_Id] and cnt.Attr_Ver_2 = mem2.[Org_Mbrshp_Ver])      where row_typ_id=515 ) ta --Rev Acct Estimates     UNPIVOT   (CntValue FOR CntName IN (Car_Cnt, TPE_Cnt, Ut_Cnt, Pltfm_Cnt)) AS pvt    )  select      rev_car_cnt.car_dimn_id    ,rev_car_cnt.car_ver    ,rev_car_cnt.Dt_Dimn_Id as Snapshot_Dt_Dimn_Id    ,rev_car_cnt.Attr_Id_1 as Responsible_Road_Org_Mbrshp_Dimn_Id    ,rev_car_cnt.Attr_Ver_1 as Responsible_Road_Org_Mbrshp_Ver    ,rev_car_cnt.Attr_Id_2 as Liable_Road_Org_Mbrshp_Dimn_Id     ,rev_car_cnt.Attr_Ver_2 as Liable_Road_Org_Mbrshp_Ver     ,rev_car_cnt.Liable_Org_Dimn_Id    ,rev_car_cnt.Liable_Org_Ver    ,rev_car_cnt.Responsible_Org_Dimn_Id    ,rev_car_cnt.Responsible_Org_Ver     --car cnt    , (isnull(rev_car_cnt.[Car_Cnt145],0) + isnull(rev_car_cnt.[Car_Cnt146],0))   As In_Shop_Car_Cnt          , isnull(rev_car_cnt.[Car_Cnt128],0)            As Enroute_Car_Cnt           , isnull(rev_car_cnt.[Car_Cnt129],0)            As In_Bad_Order_Storage_Car_Cnt    , isnull(rev_car_cnt.[Car_Cnt130],0)            as In_FMO_Car_Cnt    , (isnull(rev_car_cnt.[Car_Cnt133],0) + isnull(rev_car_cnt.[Car_Cnt129],0))   as In_Paid_Storage_Car_Cnt    , (isnull(rev_car_cnt.[Car_Cnt130],0) + isnull(rev_car_cnt.[Car_Cnt145],0) + isnull(rev_car_cnt.[Car_Cnt146],0)) as In_Repair_Entity_Car_Cnt    , isnull(rev_car_cnt.[Car_Cnt145],0)            as In_TTX_Shop_Car_Cnt    , isnull(rev_car_cnt.[Car_Cnt146],0)            as In_IRF_Car_Cnt    , isnull(rev_car_cnt.[Car_Cnt133],0)            as In_Selective_Storage_Car_Cnt    , isnull(rev_car_cnt.[Car_Cnt134],0)            as On_Offline_Relief_Car_Cnt    , isnull(rev_car_cnt.[Car_Cnt135],0)            as On_Online_Relief_Car_Cnt    , (isnull(rev_car_cnt.[Car_Cnt134],0) + isnull(rev_car_cnt.[Car_Cnt135],0))   as On_Railroad_Relief_Car_Cnt    , (isnull(rev_car_cnt.[Car_Cnt138],0)-isnull(rev_car_cnt.[Car_Cnt130],0)-isnull(rev_car_cnt.[Car_Cnt145],0)-isnull(rev_car_cnt.[Car_Cnt146],0)             -isnull(rev_car_cnt.[Car_Cnt134],0)-isnull(rev_car_cnt.[Car_Cnt135],0)             -isnull(rev_car_cnt.[Car_Cnt133],0)-isnull(rev_car_cnt.[Car_Cnt129],0)             -isnull(rev_car_cnt.[Car_Cnt128],0))     as Fleet_In_Service_Car_Cnt    , isnull(rev_car_cnt.[Car_Cnt138],0)            as Fleet_Size_Car_Cnt     --tpe cnt    , (isnull(rev_car_cnt.[TPE_Cnt145],0) + isnull(rev_car_cnt.[TPE_Cnt146],0))   As In_Shop_TPE_Cnt          , isnull(rev_car_cnt.[TPE_Cnt128],0)            As Enroute_TPE_Cnt          , isnull(rev_car_cnt.[TPE_Cnt129],0)            As In_Bad_Order_Storage_TPE_Cnt    , isnull(rev_car_cnt.[TPE_Cnt130],0)            as In_FMO_TPE_Cnt    , (isnull(rev_car_cnt.[TPE_Cnt133],0) + isnull(rev_car_cnt.[TPE_Cnt129],0))   as In_Paid_Storage_TPE_Cnt    , (isnull(rev_car_cnt.[TPE_Cnt130],0) + isnull(rev_car_cnt.[TPE_Cnt145],0) + isnull(rev_car_cnt.[TPE_Cnt146],0)) as In_Repair_Entity_TPE_Cnt    , isnull(rev_car_cnt.[TPE_Cnt145],0)            as In_TTX_Shop_TPE_Cnt    , isnull(rev_car_cnt.[TPE_Cnt146],0)            as In_IRF_TPE_Cnt    , isnull(rev_car_cnt.[TPE_Cnt133],0)            as In_Selective_Storage_TPE_Cnt    , isnull(rev_car_cnt.[TPE_Cnt134],0)            as On_Offline_Relief_TPE_Cnt    , isnull(rev_car_cnt.[TPE_Cnt135],0)            as On_Online_Relief_TPE_Cnt    , (isnull(rev_car_cnt.[TPE_Cnt134],0) + isnull(rev_car_cnt.[TPE_Cnt135],0))   as On_Railroad_Relief_TPE_Cnt    , (isnull(rev_car_cnt.[TPE_Cnt138],0)-isnull(rev_car_cnt.[TPE_Cnt130],0)-isnull(rev_car_cnt.[TPE_Cnt145],0)-isnull(rev_car_cnt.[TPE_Cnt146],0)             -isnull(rev_car_cnt.[TPE_Cnt134],0)-isnull(rev_car_cnt.[TPE_Cnt135],0)             -isnull(rev_car_cnt.[TPE_Cnt133],0)-isnull(rev_car_cnt.[TPE_Cnt129],0)             -isnull(rev_car_cnt.[TPE_Cnt128],0))     as Fleet_In_Service_TPE_Cnt    , isnull(rev_car_cnt.[TPE_Cnt138],0)            as Fleet_Size_TPE_Cnt     --Ut cnt    , (isnull(rev_car_cnt.[Ut_Cnt145],0) + isnull(rev_car_cnt.[Ut_Cnt146],0))      As In_Shop_Unit_Cnt          , isnull(rev_car_cnt.[Ut_Cnt128],0)                As Enroute_Unit_Cnt          , isnull(rev_car_cnt.[Ut_Cnt129],0)                As In_Bad_Order_Storage_Unit_Cnt    , isnull(rev_car_cnt.[Ut_Cnt130],0)                as In_FMO_Unit_Cnt    , (isnull(rev_car_cnt.[Ut_Cnt133],0) + isnull(rev_car_cnt.[Ut_Cnt129],0))      as In_Paid_Storage_Unit_Cnt    , (isnull(rev_car_cnt.[Ut_Cnt130],0) + isnull(rev_car_cnt.[Ut_Cnt145],0) + isnull(rev_car_cnt.[Ut_Cnt146],0)) as In_Repair_Entity_Unit_Cnt    , isnull(rev_car_cnt.[Ut_Cnt145],0)                as In_TTX_Shop_Unit_Cnt    , isnull(rev_car_cnt.[Ut_Cnt146],0)                as In_IRF_Unit_Cnt    , isnull(rev_car_cnt.[Ut_Cnt133],0)                as In_Selective_Storage_Unit_Cnt    , isnull(rev_car_cnt.[Ut_Cnt134],0)                as On_Offline_Relief_Unit_Cnt    , isnull(rev_car_cnt.[Ut_Cnt135],0)                as On_Online_Relief_Unit_Cnt    , (isnull(rev_car_cnt.[Ut_Cnt134],0) + isnull(rev_car_cnt.[Ut_Cnt135],0))      as On_Railroad_Relief_Unit_Cnt    , (isnull(rev_car_cnt.[Ut_Cnt138],0)-isnull(rev_car_cnt.[Ut_Cnt130],0)-isnull(rev_car_cnt.[Ut_Cnt145],0)-isnull(rev_car_cnt.[Ut_Cnt146],0)             -isnull(rev_car_cnt.[Ut_Cnt134],0)-isnull(rev_car_cnt.[Ut_Cnt135],0)             -isnull(rev_car_cnt.[Ut_Cnt133],0)-isnull(rev_car_cnt.[Ut_Cnt129],0)             -isnull(rev_car_cnt.[Ut_Cnt128],0))        as Fleet_In_Service_Unit_Cnt    , isnull(rev_car_cnt.[Ut_Cnt138],0)                as Fleet_Size_Unit_Cnt         --Platform cnt    , (isnull(rev_car_cnt.[Pltfm_Cnt145],0) + isnull(rev_car_cnt.[Pltfm_Cnt146],0))      As In_Shop_Platform_Cnt          , isnull(rev_car_cnt.[Pltfm_Cnt128],0)                As Enroute_Platform_Cnt          , isnull(rev_car_cnt.[Pltfm_Cnt129],0)                As In_Bad_Order_Storage_Platform_Cnt    , isnull(rev_car_cnt.[Pltfm_Cnt130],0)                as In_FMO_Platform_Cnt    , (isnull(rev_car_cnt.[Pltfm_Cnt133],0) + isnull(rev_car_cnt.[Pltfm_Cnt129],0))      as In_Paid_Storage_Platform_Cnt    , (isnull(rev_car_cnt.[Pltfm_Cnt130],0) + isnull(rev_car_cnt.[Pltfm_Cnt145],0) + isnull(rev_car_cnt.[Pltfm_Cnt146],0)) as In_Repair_Entity_Platform_Cnt    , isnull(rev_car_cnt.[Pltfm_Cnt145],0)                as In_TTX_Shop_Platform_Cnt    , isnull(rev_car_cnt.[Pltfm_Cnt146],0)                as In_IRF_Platform_Cnt    , isnull(rev_car_cnt.[Pltfm_Cnt133],0)                as In_Selective_Storage_Platform_Cnt    , isnull(rev_car_cnt.[Pltfm_Cnt134],0)                as On_Offline_Relief_Platform_Cnt    , isnull(rev_car_cnt.[Pltfm_Cnt135],0)                as On_Online_Relief_Platform_Cnt    , (isnull(rev_car_cnt.[Pltfm_Cnt134],0) + isnull(rev_car_cnt.[Pltfm_Cnt135],0))      as On_Railroad_Relief_Platform_Cnt    , (isnull(rev_car_cnt.[Pltfm_Cnt138],0)-isnull(rev_car_cnt.[Pltfm_Cnt130],0)-isnull(rev_car_cnt.[Pltfm_Cnt145],0)-isnull(rev_car_cnt.[Pltfm_Cnt146],0)             -isnull(rev_car_cnt.[Pltfm_Cnt134],0)-isnull(rev_car_cnt.[Pltfm_Cnt135],0)             -isnull(rev_car_cnt.[Pltfm_Cnt133],0)-isnull(rev_car_cnt.[Pltfm_Cnt129],0)             -isnull(rev_car_cnt.[Pltfm_Cnt128],0))        as Fleet_In_Service_Platform_Cnt    , isnull(rev_car_cnt.[Pltfm_Cnt138],0)                as Fleet_Size_Platform_Cnt    , Crtd_Dt      from Tunpivot    PIVOT   (            sum(CntValue)       FOR Pcol IN ( [Car_Cnt128], [Car_Cnt129],[Car_Cnt130],[Car_Cnt133],[Car_Cnt134],[Car_Cnt135],[Car_Cnt136],[Car_Cnt137],[Car_Cnt138],[Car_Cnt145],[Car_Cnt146]        , [TPE_Cnt128], [TPE_Cnt129],[TPE_Cnt130],[TPE_Cnt133],[TPE_Cnt134],[TPE_Cnt135],[TPE_Cnt136],[TPE_Cnt137],[TPE_Cnt138],[TPE_Cnt145],[TPE_Cnt146]        , [Ut_Cnt128], [Ut_Cnt129],[Ut_Cnt130],[Ut_Cnt133],[Ut_Cnt134],[Ut_Cnt135],[Ut_Cnt136],[Ut_Cnt137],[Ut_Cnt138],[Ut_Cnt145],[Ut_Cnt146]        , [Pltfm_Cnt128], [Pltfm_Cnt129],[Pltfm_Cnt130],[Pltfm_Cnt133],[Pltfm_Cnt134],[Pltfm_Cnt135],[Pltfm_Cnt136],[Pltfm_Cnt137],[Pltfm_Cnt138],[Pltfm_Cnt145],[Pltfm_Cnt146]          )     )   AS rev_car_cnt"
    },
    {
      "id": "Vsup_Dt_Dimn",
      "name": "Vsup_Dt_Dimn",
      "type": "VIEW",
      "sql": "CREATE VIEW [DDSV].[Vsup_Dt_Dimn]  AS  SELECT cast(dt.Dt_Dimn_Id as int) as Dt_Dimn_Id  ,cast(dt.Dt as smalldatetime) as Dt_Tm  ,cast(case when mthdate_nr =1 then replace(dt_nm, ' 1 ', ' 01 ')      when mthdate_nr =2 then replace(dt_nm, ' 2 ', ' 02 ')      when mthdate_nr =3 then replace(dt_nm, ' 3 ', ' 03 ')     when mthdate_nr =4 then replace(dt_nm, ' 4 ', ' 04 ')     when mthdate_nr =5 then replace(dt_nm, ' 5 ', ' 05 ')     when mthdate_nr =6 then replace(dt_nm, ' 6 ', ' 06 ')     when mthdate_nr =7 then replace(dt_nm, ' 7 ', ' 07 ')     when mthdate_nr =8 then replace(dt_nm, ' 8 ', ' 08 ')     when mthdate_nr =9 then replace(dt_nm, ' 9 ', ' 09 ')   else dt_nm end as varchar(50)) as dt_nm  ,dt.Wkday_Nr as Day_Nr  ,dt.Wkday_Nm as Day_Nm  ,dt.Wk_Nr   ,dt.Mth_Nr   ,dt.Mth_Nm   ,dt.Qtr_Nr   ,dt.Qtr_Nm   ,dt.Yr   ,concat('Calendar ', convert(varchar(4),Yr)) as Yr_Nm  ,Crtd_Dt  ,crtd_id  ,Lst_Upd_Dt  ,Lst_Upd_Id   FROM ddsmrt.dbo.Date_Dim (NOLOCK) dt   where Dt_Dimn_Id <> -1   and dt <'2050-01-01'"
    },
    {
      "id": "Vfin_Flet_Perf_Car_Milg_Car_Cnt_Fact_Hist",
      "name": "Vfin_Flet_Perf_Car_Milg_Car_Cnt_Fact_Hist",
      "type": "VIEW",
      "sql": "CREATE view [DDSV].[Vfin_Flet_Perf_Car_Milg_Car_Cnt_Fact_Hist] as  SELECT           case when op_car_cnt.Attr_Id_1 is null then '-1_-1'        else concat(convert(varchar(10),op_car_cnt.Attr_Id_1),'_',convert(varchar(5), op_car_cnt.Attr_Ver_1))         end as Lst_Part_Rd_Dimn_Id                              ,case when op_car_cnt.Attr_Id_3 is null then '-1_-1'              else concat(convert(varchar(10),op_car_cnt.Attr_Id_3),'_',convert(varchar(5), op_car_cnt.Attr_Ver_3))                end as Rpt_Rd_Dimn_Id                  --, case when op_car_cnt.Org_Abrv IN ('BNSF', 'CN', 'CPRS', 'CSXT', 'FXE', 'KCS', 'KCSM','NS', 'ST', 'UP') then cast(Org_Dimn_Id as int)              --  else -1              --  end as Mbr_Rd_Dimn_Id              --, case when org.Org_Abrv IN ('BNSF', 'CN', 'CPRS', 'CSXT', 'FXE', 'KCS', 'KCSM','NS', 'ST', 'UP') then Org_Ver              --  else -1              --  end as Mbr_Rd_Ver                ,cast(op_car_cnt.Dt_Dimn_Id as int) as Dt_Dimn_Id                  ,case when car.Entr_Hierchy_Id is null then '-1_-1'              else concat(convert(varchar(10),car.Entr_Hierchy_Id),'_',convert(varchar(5), car.Entr_Hierchy_Ver))                end as Stat_Cd_Dimn_Id                ,case when op_car_cnt.Attr_Id_2 is null then '-1_-1'              else concat(convert(varchar(10),op_car_cnt.Attr_Id_2),'_',convert(varchar(5), op_car_cnt.Attr_Ver_2))                end as Curr_Part_Rd_Dimn_Id                            ,case when Car_cnt_Catg_Typ_id = 149 and convert(char(1),op_car_cnt.Attr_Val_Char_4) = 'L' then 1 else 0 end as Load_Cnt              ,case when Car_cnt_Catg_Typ_id = 149 and convert(char(1),op_car_cnt.Attr_Val_Char_4) = 'E' then 1 else 0 end as Emp_Cnt              ,case when Car_cnt_Catg_Typ_id = 149 and convert(char(1),op_car_cnt.Attr_Val_Char_4) = 'U' then 1 else 0 end as LE_Unknown_Cnt              ,case when Car_cnt_Catg_Typ_id = 149 then 1 else 0 end as LE_Totl_Cnt                ,cast(car.Pltfm_Fctr as numeric(18,1)) as [Pltfm_Per_Car_Cnt]        --    ,cast(car.Pltfm_Fctr as numeric(18,1)) as [Car_Pltfm_Cnt_Fctr]              ,cast(car.TPE_Fctr as numeric(18,1)) as [TPE_Per_Car_Cnt]              --,cast(car.TPE_Fctr as numeric(18,1)) as [TPE_Fctr]                                        ,case when car.Business_Line = 'Intermodal' then ISNULL(tpe_fctr, 1.0) else 1.0 end as tpe_fctr                                      ,case when car.Business_Line = 'Intermodal' then ISNULL(TPE_Fctr * 2, 1.0)  else 1.0 end as Car_Pltfm_Cnt_Fctr            --car cnt            , cast(case Car_cnt_Catg_Typ_id when 128 then op_car_cnt.car_cnt else 0 end as int) As Cars_Enrt_Cnt               -- Enroute_Car_Cnt               , cast(case Car_cnt_Catg_Typ_id when 131 then op_car_cnt.car_cnt else 0 end as int) as Cars_Pd_Stor_Cnt         --In_Paid_Storage_Car_Cnt              , cast(case Car_cnt_Catg_Typ_id when 136 then op_car_cnt.car_cnt else 0 end as int) as Cars_Stor_Cnt                  -- In_Repair_Entity_Car_Cnt              , cast(case Car_cnt_Catg_Typ_id when 132 then op_car_cnt.car_cnt else 0 end as int) as Cars_In_Shop_Cnt         -- On_Railroad_Relief_Car_Cnt              , cast(case when Car_cnt_Catg_Typ_id = 149 and convert(char(1),op_car_cnt.Attr_Val_Char_5) in ('Y','N') then op_car_cnt.car_cnt else 0 end as int) as Cars_Onln_Cnt         --Total_Car_Cnt                  , op_car_cnt.Crtd_Dt  as Crtd_Dt              , op_car_cnt.Crtd_Id  as Crtd_Id              , op_car_cnt.Lst_Upd_Dt  as Lst_Upd_Dt              , op_car_cnt.Lst_Upd_Id  as Lst_Upd_Id                                FROM          (select * from  ddsmrt.dbo.vw_car_count_fact_History  (NOLOCK)        where row_typ_id=518 and dt_dimn_id >= 20100101        ) op_car_cnt -- Operational    --left join [dbo].[VMRT_Organization_Dimension] org on (op_car_cnt.Attr_Id_1 = org.org_dimn_id and op_car_cnt.Attr_Ver_1 = org.org_ver)    left join (select car_dimn_id,car_ver,tpe_Fctr,Pltfm_Fctr,Entr_Hierchy_Id,Entr_Hierchy_Ver, Business_Line                from ddsmrt.dbo.VMRT_Car_Dimension_correct) car on (op_car_cnt.Car_Dimn_Id = car.Car_dimn_id and op_car_cnt.Car_Ver = car.car_ver)"
    },
    {
      "id": "Vsup_Mth_Dimn",
      "name": "Vsup_Mth_Dimn",
      "type": "VIEW",
      "sql": "CREATE view [DDSV].[Vsup_Mth_Dimn] as  select distinct   cast(dt_dimn_id/100 as int) as Mth_Dimn_Id  ,cast(DATEFROMPARTS(YEAR(dt),MONTH(dt),1) as date) as Mth_Beg_Dt  ,cast(Mth_End_dt as date) as Mth_End_Dt  ,cast(Qtr_Beg_dt as  date) as Qtr_Beg_Dt  ,cast(Qtr_End_Dt as  date) as Qtr_End_Dt  ,convert(varchar(3), Mth_Abrv)  as Mth_Abrv  ,'Y' as Mth_End_Ind  ,Mth_Nm as Mth_Nm  ,Mth_Nr as Mth_Num  ,cast(Num_Day_Mth as smallint) as Num_Dy_Mth  ,cast(Qtr_Nr as smallint)  as Qtr_Num  ,concat(convert(char(4),Yr), ' Q', convert(char(1),Qtr_nr)) as Yr_Qtr  ,cast(Yr as int) as Year  ,cast((case [Leap_Yr_Ind] when 'Y' then 366 else 365 end) as smallint) as Num_Dy_Yr  ,Leap_Yr_Ind  ,case when Mth_Nr in (3,6,9,12) then 'Y' else 'N' end as Qtr_End_Ind  ,substring(convert(varchar(8),dt_dimn_id),1,6) as Yr_mth  ,convert(varchar(25), concat('Calendar ', convert(varchar(4),Yr))) as Yr_Nm  ,convert(varchar(25), Qtr_Nm) as Qtr_Nm  ,cast(case when mthdate_nr =1 then replace(dt_nm, ' 1 ', ' 1  ')      when mthdate_nr =2 then replace(dt_nm, ' 2 ', ' 2  ')      when mthdate_nr =3 then replace(dt_nm, ' 3 ', ' 3  ')     when mthdate_nr =4 then replace(dt_nm, ' 4 ', ' 4  ')     when mthdate_nr =5 then replace(dt_nm, ' 5 ', ' 5  ')     when mthdate_nr =6 then replace(dt_nm, ' 6 ', ' 6  ')     when mthdate_nr =7 then replace(dt_nm, ' 7 ', ' 7  ')     when mthdate_nr =8 then replace(dt_nm, ' 8 ', ' 8  ')     when mthdate_nr =9 then replace(dt_nm, ' 9 ', ' 9  ')   else dt_nm         end as varchar(50)) as Dt_Nm  ,Crtd_Id as [Create_Id]  ,Crtd_Dt as [Create_Dt]  ,Lst_Upd_Dt   ,Lst_Upd_Id    from ddsmrt.dbo.Date_Dim (NOLOCK) dt  where Mthdate_nr=Mth_Nr and dt<'2051-01-01 00:00:00'"
    },
    {
      "id": "Vfin_Flet_Perf_Rev_Act_Car_Cnt_Fact_Hist",
      "name": "Vfin_Flet_Perf_Rev_Act_Car_Cnt_Fact_Hist",
      "type": "VIEW",
      "sql": "CREATE VIEW [DDSV].[Vfin_Flet_Perf_Rev_Act_Car_Cnt_Fact_Hist]  AS      WITH    CntCTE                AS ( SELECT   CAST(SUBSTRING(CONVERT(VARCHAR(8), car_cnt.Dt_Dimn_Id),                                             1, 6) AS INT) AS Mth_Dimn_Id ,                              CASE WHEN car_cnt.Attr_Id_1 IS NULL THEN '-1_-1'                                   ELSE CONCAT(CONVERT(VARCHAR(10), car_cnt.Attr_Id_1),                                               '_',                                               CONVERT(VARCHAR(5), car_cnt.Attr_Ver_1))                              END AS Rd_Mbrshp_Dimn_Id ,                              CASE WHEN car.Entr_Hierchy_Id IS NULL THEN '-1_-1'                                   ELSE CONCAT(CONVERT(VARCHAR(10), car.Entr_Hierchy_Id),                                               '_',                                               CONVERT(VARCHAR(5), car.Entr_Hierchy_Ver))                              END AS Stat_Cd_Dimn_Id ,                              Dt_Dimn_Id ,                              Attr_Id_1 ,                              Attr_Ver_1 ,                              Entr_Hierchy_Id ,                              Entr_Hierchy_Ver ,                              CAST(SUM(CASE Car_Cnt_Catg_Typ_Id                                         WHEN 128 THEN car_cnt.Car_Cnt                                         ELSE 0                                       END) AS NUMERIC(38, 10)) AS Cars_Enrt_Cnt                 --  Enroute_Car_Cnt                              ,                              CAST(SUM(CASE Car_Cnt_Catg_Typ_Id                                         WHEN 130 THEN car_cnt.Car_Cnt                                         ELSE 0                                       END) AS NUMERIC(38, 10)) AS Cars_FMO_Mnt_Cnt              --  In_FMO_Car_Cnt                              ,                              CAST(SUM(CASE Car_Cnt_Catg_Typ_Id                                         WHEN 138 THEN car_cnt.Car_Cnt                                         ELSE 0                                       END) AS NUMERIC(38, 10)) AS Cars_Onln_Cnt     -- Fleet Size                              ,                              CAST(SUM(CASE Car_Cnt_Catg_Typ_Id                                         WHEN 135 THEN car_cnt.Car_Cnt                                         ELSE 0                                       END) AS NUMERIC(38, 10)) AS Cars_On_Relf_Cnt    --  On Online Relief                              ,                              CAST(SUM(CASE Car_Cnt_Catg_Typ_Id                                         WHEN 134 THEN car_cnt.Car_Cnt                                         ELSE 0                                       END) AS NUMERIC(38, 10)) AS Cars_On_Off_Ln_Relf_Cnt  --  On Offline Relief                              ,                              CAST(SUM(( CASE Car_Cnt_Catg_Typ_Id                                           WHEN 146 THEN car_cnt.Car_Cnt                                           ELSE 0                                         END )                                       + ( CASE Car_Cnt_Catg_Typ_Id                                             WHEN 145 THEN car_cnt.Car_Cnt                                             ELSE 0                                           END )) AS NUMERIC(38, 10)) AS Cars_In_Shop_Cnt  --  Cars_In_Shop_Cnt                              ,                              CAST(SUM(CASE Car_Cnt_Catg_Typ_Id                                         WHEN 129 THEN car_cnt.Car_Cnt                                         ELSE 0                                       END) AS NUMERIC(38, 10)) AS Cars_Bad_Ordr_Stor_Cnt  --  In_Bad_Order_Storage_Car_Cnt                              ,                              CAST(SUM(CASE Car_Cnt_Catg_Typ_Id                                         WHEN 133 THEN car_cnt.Car_Cnt                                         ELSE 0                                       END) AS NUMERIC(38, 10)) AS Cars_Stor_Cnt    --  In_Selective_Storage_Car_Cnt                              ,                              CAST(SUM(CASE Car_Cnt_Catg_Typ_Id                                         WHEN 138 THEN car_cnt.TPE_Cnt                                         ELSE 0                                       END) AS NUMERIC(38, 10))                              - SUM(( CASE Car_Cnt_Catg_Typ_Id                                        WHEN 128 THEN car_cnt.TPE_Cnt                                        ELSE 0                                      END ) + ( CASE Car_Cnt_Catg_Typ_Id                                                  WHEN 129 THEN car_cnt.TPE_Cnt                                                  ELSE 0                                                END )                                    + ( CASE Car_Cnt_Catg_Typ_Id                                          WHEN 130 THEN car_cnt.TPE_Cnt                                          ELSE 0                                        END )                                    + ( CASE Car_Cnt_Catg_Typ_Id                                          WHEN 145 THEN car_cnt.TPE_Cnt                                          ELSE 0                                        END )                                    + ( CASE Car_Cnt_Catg_Typ_Id                                          WHEN 146 THEN car_cnt.TPE_Cnt                                          ELSE 0                                        END )                                    + ( CASE Car_Cnt_Catg_Typ_Id                                          WHEN 133 THEN car_cnt.TPE_Cnt                                          ELSE 0                                        END )                                    + ( CASE Car_Cnt_Catg_Typ_Id                                          WHEN 134 THEN car_cnt.TPE_Cnt                                          ELSE 0                                        END )                                    + ( CASE Car_Cnt_Catg_Typ_Id                                          WHEN 135 THEN car_cnt.TPE_Cnt                                          ELSE 0                                        END )) AS In_Srvc_TPE_Cnt ,                              SUM(CASE Car_Cnt_Catg_Typ_Id                                    WHEN 138 THEN car_cnt.TPE_Cnt                                    ELSE 0                                  END) AS Totl_TPE_Cnt     --  Totl_TPE_Cnt                              ,                              SUM(( CASE Car_Cnt_Catg_Typ_Id                                      WHEN 128 THEN car_cnt.TPE_Cnt                                      ELSE 0                                    END ) + ( CASE Car_Cnt_Catg_Typ_Id                                                WHEN 129 THEN car_cnt.TPE_Cnt                                                ELSE 0                                              END )                                  + ( CASE Car_Cnt_Catg_Typ_Id                                        WHEN 130 THEN car_cnt.TPE_Cnt                                        ELSE 0                                      END ) + ( CASE Car_Cnt_Catg_Typ_Id                                                  WHEN 145 THEN car_cnt.TPE_Cnt                                                  ELSE 0                                                END )                                  + ( CASE Car_Cnt_Catg_Typ_Id                                        WHEN 146 THEN car_cnt.TPE_Cnt                                        ELSE 0                                      END ) + ( CASE Car_Cnt_Catg_Typ_Id                                                  WHEN 133 THEN car_cnt.TPE_Cnt                                                  ELSE 0                                                END )                                  + ( CASE Car_Cnt_Catg_Typ_Id                                        WHEN 134 THEN car_cnt.TPE_Cnt                                        ELSE 0                                      END ) + ( CASE Car_Cnt_Catg_Typ_Id                                                  WHEN 135 THEN car_cnt.TPE_Cnt                                                  ELSE 0                                                END )) AS Out_Of_Srvc_TPE_Cnt ,                              MAX(car_cnt.Crtd_Dt) AS Crtd_Dt ,                              MAX(car_cnt.Crtd_Id) AS Crtd_Id ,                              MAX(car_cnt.Lst_Upd_Dt) AS Lst_Upd_Dt ,                              MAX(car_cnt.Lst_Upd_Id) AS Lst_Upd_Id                     FROM     ( SELECT    Dt_Dimn_Id ,                                          Attr_Id_1 ,                                          Attr_Ver_1 ,                                          Car_Cnt ,                                          TPE_Cnt ,                                          Car_Cnt_Catg_Typ_Id ,                                          Row_Typ_Id ,                                          Car_Dimn_Id ,                                          Car_Ver ,                                          Crtd_Dt ,                                          Crtd_Id ,                                          Lst_Upd_Dt ,                                          Lst_Upd_Id                                FROM      DDSMRT.dbo.vw_car_count_fact_History (NOLOCK)                                WHERE     Row_Typ_Id = 517                              ) car_cnt -- Rev Actuals                              LEFT JOIN ( SELECT  Car_Dimn_Id ,                                                  Car_Ver ,                                                  Entr_Hierchy_Id ,                                                  Entr_Hierchy_Ver                                          FROM    DDSMRT.dbo.VMRT_Car_Dimension_Correct                                        ) car ON ( car_cnt.Car_Dimn_Id = car.Car_Dimn_Id                                                   AND car_cnt.Car_Ver = car.Car_Ver                                                 )                     GROUP BY Dt_Dimn_Id ,                              Attr_Id_1 ,                              Attr_Ver_1 ,                              Row_Typ_Id ,                              Entr_Hierchy_Id ,                              Entr_Hierchy_Ver                   )      SELECT  cnt.Mth_Dimn_Id ,              cnt.Rd_Mbrshp_Dimn_Id ,              cnt.Stat_Cd_Dimn_Id ,              cnt.Cars_Enrt_Cnt ,              cnt.Cars_FMO_Mnt_Cnt ,              cnt.Cars_Onln_Cnt ,              cnt.Cars_On_Relf_Cnt ,              cnt.Cars_On_Off_Ln_Relf_Cnt ,              cnt.Cars_In_Shop_Cnt ,              cnt.Cars_Bad_Ordr_Stor_Cnt ,              cnt.Cars_Stor_Cnt ,              mil.Cars_Zero_Rt_Cnt ,              cnt.In_Srvc_TPE_Cnt ,              cnt.Totl_TPE_Cnt ,              cnt.Out_Of_Srvc_TPE_Cnt ,              cnt.Crtd_Dt ,              cnt.Crtd_Id ,              cnt.Lst_Upd_Dt ,              cnt.Lst_Upd_Id ,              mil.[Zero_Rt_Out_Of_Srvc_TPE_Cnt] ,              mil.TPE_Mils ,              mil.TPE_Car_Hire ,              mil.TPE_Milg_Rev ,              mil.TPE_Whl_Schg_Milg_Rev      FROM    CntCTE cnt              LEFT JOIN ( SELECT  Mth_Beg_Dt_Dimn_Id ,                                  Hierchy_Id ,                                  Hierchy_Ver ,                                  Org_Mbrshp_Dimn_Id ,                                  Org_Mbrshp_Ver ,                                                sum(TPE_Mils         ) as TPE_Mils       ,                                  sum(TPE_Car_Hire        ) as TPE_Car_Hire      ,                                  sum(TPE_Milg_Rev        ) as TPE_Milg_Rev      ,                                  sum(TPE_Whl_Schg_Milg_Rev      ) as TPE_Whl_Schg_Milg_Rev    ,                                  sum([Zero_Rt_Out_Of_Srvc_TPE_Cnt]  ) as [Zero_Rt_Out_Of_Srvc_TPE_Cnt]  ,                                  sum([Cars_Zero_Rt_Cnt]      ) as [Cars_Zero_Rt_Cnt]                          FROM    DDSMRT.dbo.Tfin_Flet_Perf_Rev_Act_Car_Cnt_Fact (NOLOCK)        group by         Mth_Beg_Dt_Dimn_Id ,                                  Hierchy_Id ,                                  Hierchy_Ver ,                                  Org_Mbrshp_Dimn_Id ,                                  Org_Mbrshp_Ver                         ) mil ON ( mil.Mth_Beg_Dt_Dimn_Id = cnt.Dt_Dimn_Id                                   AND mil.Hierchy_Id = cnt.Entr_Hierchy_Id                                   AND mil.Hierchy_Ver = cnt.Entr_Hierchy_Ver                                   AND mil.Org_Mbrshp_Dimn_Id = cnt.Attr_Id_1                                   AND mil.Org_Mbrshp_Ver = cnt.Attr_Ver_1                                 )"
    },
    {
      "id": "VTrips_Fact",
      "name": "VTrips_Fact",
      "type": "VIEW",
      "sql": "CREATE VIEW [DDSV].[VTrips_Fact]  AS      SELECT  CAST(Trip_Begin_Dt_Dimn_Id AS INT) AS Trip_Beg_Dt_Dimn_Id ,              CAST(Trip_End_Dt_Dimn_Id AS INT) AS Trip_End_Dt_Dimn_Id ,              CAST(Trip_Orig_SPLC_Dimn_Id AS INT) AS Orig_Geo_Dimn_Id ,              CAST(Trip_Dest_SPLC_Dimn_Id AS INT) AS Dest_Geo_Dimn_Id ,              CONCAT(CONVERT(VARCHAR(10), Trip_Orig_Lst_Parti_Road_Org_Dimn_Id),                     '_', CONVERT(VARCHAR(5), Trip_Orig_Lst_Parti_Road_Org_Ver)) AS Orig_Last_Part_Rd_Dimn_Id ,              CONCAT(CONVERT(VARCHAR(10), Trip_Dest_Lst_Parti_Road_Org_Dimn_Id),                     '_', CONVERT(VARCHAR(5), Trip_Dest_Lst_Parti_Road_Org_Ver)) AS Dest_Last_Part_Rd_Dimn_Id ,              CONCAT(CONVERT(VARCHAR(10), Trip_Dest_Resp_Road_Org_Dimn_Id), '_',                     CONVERT(VARCHAR(5), Trip_Dest_Resp_Road_Org_Ver)) AS Dest_Resp_Rd_Dimn_Id ,              CAST(STCC_Dimn_Id AS INT) AS Stcc_Dimn_Id ,              CONCAT(CONVERT(VARCHAR(10), B.Car_Dimn_Id), '_',                     CONVERT(VARCHAR(5), B.Car_Ver)) AS Car_Dimn_Id ,              CONCAT(CONVERT(VARCHAR(10), Trip_Orig_Org_Dimn_Id), '_',                     CONVERT(VARCHAR(5), Trip_Orig_Org_Ver)) AS Orig_Dist_Enty_Dimn_Id ,              CONCAT(CONVERT(VARCHAR(10), Trip_Dest_Org_Dimn_Id), '_',                     CONVERT(VARCHAR(5), Trip_Dest_Org_Ver)) AS Dest_Dist_Enty_Dimn_Id ,              Trip AS Trips ,              Railcar AS Railcar ,              B.Car_Nr ,              B.Car_Init ,              Origin_Loc AS Origin_Loc ,              Dest_Loc AS Dest_Loc ,              Trip_Begin_Dt AS Trip_Begin_Dt ,              Trip_End_Dt AS Trip_End_Dt ,              Trip_Orig_Lst_Parti_Road AS Origin_Last_Part_RR ,              Trip_Dest_Lst_Parti_Road AS Dest_Last_Part_RR ,              Trip_Dest_Resp_Road AS Dest_Resp_RR ,              STCC AS STCC_Cd ,              Origin_Enty AS Origin_Entity ,              Dest_Enty AS Dest_Entity ,              1 AS Car_Cnt ,              ( CASE ( Trip_Typ )                  WHEN 'E' THEN 1                  ELSE 0                END ) AS Dy_Emp_Cnt ,              ( CASE ( Trip_Typ )                  WHEN 'L' THEN 1                  ELSE 0                END ) AS Dy_Ld_Cnt ,              Trip_Seg_Typ ,              Crtd_Dt AS Crtd_Dt ,              Crtd_Id AS Crtd_Id ,              Lst_Upd_Dt AS Lst_Upd_Dt ,              Lst_Upd_Id AS Lst_Upd_Id      FROM    ( ( SELECT  Trip_Fact_Id ,                          Car_Dimn_Id ,                          Car_Ver ,                          Trip_Begin_Dt_Dimn_Id ,                          Trip_End_Dt_Dimn_Id ,                          Trip_Orig_SPLC_Dimn_Id ,                          Trip_Dest_SPLC_Dimn_Id ,                          Trip_Orig_Lst_Parti_Road_Org_Dimn_Id ,                          Trip_Orig_Lst_Parti_Road_Org_Ver ,                          Trip_Dest_Lst_Parti_Road_Org_Dimn_Id ,                          Trip_Dest_Lst_Parti_Road_Org_Ver ,                          Trip_Dest_Resp_Road_Org_Dimn_Id ,                          Trip_Dest_Resp_Road_Org_Ver ,                          Trip_Orig_Org_Dimn_Id ,                          Trip_Orig_Org_Ver ,                          Trip_Dest_Org_Dimn_Id ,                          Trip_Dest_Org_Ver ,                          STCC_Dimn_Id ,                          Trip ,                          Railcar ,                          Origin_Loc ,                          Dest_Loc ,                          Trip_Begin_Dt ,                          Trip_End_Dt ,                          Trip_Orig_Lst_Parti_Road ,                          Trip_Dest_Lst_Parti_Road ,                          Trip_Dest_Resp_Road ,                          STCC ,                          Origin_Enty ,                          Dest_Enty ,                          Trip_Typ ,                          Crtd_Dt ,                          Crtd_Id ,                          Lst_Upd_Dt ,                          Lst_Upd_Id                  FROM    [DDSMRT].[dbo].[VMRT_Trip_Fact] (NOLOCK)                ) A                LEFT JOIN ( SELECT    Car_Nr ,                                      Car_Init ,                                      Car_Dimn_Id ,                                      Car_Ver           /** IR527842 Fix **/                            FROM      [DDSMRT].[dbo].[Car_Dim_Correct] (NOLOCK)                          ) B ON A.Car_Dimn_Id = B.Car_Dimn_Id                                 AND A.Car_Ver = B.Car_Ver                LEFT JOIN ( SELECT    Trip_Seg_Typ ,                                      Trip_Fact_Id                            FROM      [DDSMRT].[dbo].[vw_Trip_Segment_Fact_All] (NOLOCK)                          ) C ON A.Trip_Fact_Id = C.Trip_Fact_Id              )  where Trip_Begin_Dt > = '2010-01-01 00:00:00'"
    },
    {
      "id": "Vfin_Flet_Perf_Rev_Est_Car_Cnt_Fact_Hist",
      "name": "Vfin_Flet_Perf_Rev_Est_Car_Cnt_Fact_Hist",
      "type": "VIEW",
      "sql": "CREATE VIEW [DDSV].[Vfin_Flet_Perf_Rev_Est_Car_Cnt_Fact_Hist]  AS      WITH    CntCTE                AS ( SELECT   CAST(SUBSTRING(CONVERT(VARCHAR(8), car_cnt.Dt_Dimn_Id),                                             1, 6) AS INT) AS Mth_Dimn_Id ,                              CASE WHEN car_cnt.Attr_Id_1 IS NULL THEN '-1_-1'                                   ELSE CONCAT(CONVERT(VARCHAR(10), car_cnt.Attr_Id_1),                                               '_',                                               CONVERT(VARCHAR(5), car_cnt.Attr_Ver_1))                              END AS Rd_Mbrshp_Dimn_Id ,                              CASE WHEN car.Entr_Hierchy_Id IS NULL THEN '-1_-1'                                   ELSE CONCAT(CONVERT(VARCHAR(10), car.Entr_Hierchy_Id),                                               '_',                                               CONVERT(VARCHAR(5), car.Entr_Hierchy_Ver))                              END AS Stat_Cd_Dimn_Id ,                              Dt_Dimn_Id ,                              Attr_Id_1 ,                              Attr_Ver_1 ,                              Entr_Hierchy_Id ,                              Entr_Hierchy_Ver ,                              CAST(SUM(CASE Car_Cnt_Catg_Typ_Id                                         WHEN 128 THEN car_cnt.Car_Cnt                                         ELSE 0                                       END) AS NUMERIC(24, 10)) AS Cars_Enrt_Cnt                 --  Enroute_Car_Cnt                              ,                              CAST(SUM(CASE Car_Cnt_Catg_Typ_Id                                         WHEN 130 THEN car_cnt.Car_Cnt                                         ELSE 0                                       END) AS NUMERIC(24, 10)) AS Cars_FMO_Mnt_Cnt              --  In_FMO_Car_Cnt                              ,                              CAST(SUM(CASE Car_Cnt_Catg_Typ_Id                                         WHEN 138 THEN car_cnt.Car_Cnt                                         ELSE 0                                       END) AS NUMERIC(24, 10)) AS Cars_Onln_Cnt     -- Fleet Size                              ,                              CAST(SUM(CASE Car_Cnt_Catg_Typ_Id                                         WHEN 135 THEN car_cnt.Car_Cnt                                         ELSE 0                                       END) AS NUMERIC(24, 10)) AS Cars_On_Relf_Cnt    --  On Online Relief                              ,                              CAST(SUM(CASE Car_Cnt_Catg_Typ_Id                                         WHEN 134 THEN car_cnt.Car_Cnt                                         ELSE 0                                       END) AS NUMERIC(24, 10)) AS Cars_On_Off_Ln_Relf_Cnt  --  On Offline Relief                              ,                              CAST(SUM(( CASE Car_Cnt_Catg_Typ_Id                                           WHEN 146 THEN car_cnt.Car_Cnt                                           ELSE 0                                         END )                                       + ( CASE Car_Cnt_Catg_Typ_Id                                             WHEN 145 THEN car_cnt.Car_Cnt                                             ELSE 0                                           END )) AS NUMERIC(24, 10)) AS Cars_In_Shop_Cnt  --  Cars_In_Shop_Cnt                              ,                              CAST(SUM(CASE Car_Cnt_Catg_Typ_Id                                         WHEN 129 THEN car_cnt.Car_Cnt                                         ELSE 0                                       END) AS NUMERIC(24, 10)) AS Cars_Bad_Ordr_Stor_Cnt  --  In_Bad_Order_Storage_Car_Cnt                              ,                              CAST(SUM(CASE Car_Cnt_Catg_Typ_Id                                         WHEN 133 THEN car_cnt.Car_Cnt                                         ELSE 0                                       END) AS NUMERIC(24, 10)) AS Cars_Stor_Cnt    --  In_Selective_Storage_Car_Cnt                              ,                              CAST(SUM(CASE Car_Cnt_Catg_Typ_Id                                         WHEN 138 THEN car_cnt.TPE_Cnt                                         ELSE 0                                       END) AS NUMERIC(24, 10))                              - CAST(SUM(( CASE Car_Cnt_Catg_Typ_Id                                             WHEN 128 THEN car_cnt.TPE_Cnt                                             ELSE 0                                           END )                                         + ( CASE Car_Cnt_Catg_Typ_Id                                               WHEN 129 THEN car_cnt.TPE_Cnt                                               ELSE 0                                             END )                                         + ( CASE Car_Cnt_Catg_Typ_Id                                               WHEN 130 THEN car_cnt.TPE_Cnt                                               ELSE 0                                             END )                                         + ( CASE Car_Cnt_Catg_Typ_Id                                               WHEN 145 THEN car_cnt.TPE_Cnt                                               ELSE 0                                             END )                                         + ( CASE Car_Cnt_Catg_Typ_Id                                               WHEN 146 THEN car_cnt.TPE_Cnt                                               ELSE 0                                             END )                                         + ( CASE Car_Cnt_Catg_Typ_Id                                               WHEN 133 THEN car_cnt.TPE_Cnt                                               ELSE 0                                             END )                                         + ( CASE Car_Cnt_Catg_Typ_Id                                               WHEN 134 THEN car_cnt.TPE_Cnt                                               ELSE 0                                             END )                                         + ( CASE Car_Cnt_Catg_Typ_Id                                               WHEN 135 THEN car_cnt.TPE_Cnt                                               ELSE 0                                             END )) AS NUMERIC(24, 10)) AS In_Srvc_TPE_Cnt ,                              CAST(SUM(( CASE Car_Cnt_Catg_Typ_Id                                           WHEN 128 THEN car_cnt.TPE_Cnt                                           ELSE 0                                         END )                                       + ( CASE Car_Cnt_Catg_Typ_Id                                             WHEN 129 THEN car_cnt.TPE_Cnt                                             ELSE 0                                           END )                                       + ( CASE Car_Cnt_Catg_Typ_Id                                             WHEN 130 THEN car_cnt.TPE_Cnt                                             ELSE 0                                           END )                                       + ( CASE Car_Cnt_Catg_Typ_Id                                             WHEN 145 THEN car_cnt.TPE_Cnt                                             ELSE 0                                           END )                                       + ( CASE Car_Cnt_Catg_Typ_Id                                             WHEN 146 THEN car_cnt.TPE_Cnt                                             ELSE 0                                           END )                                       + ( CASE Car_Cnt_Catg_Typ_Id                                             WHEN 133 THEN car_cnt.TPE_Cnt                                             ELSE 0                                           END )                                       + ( CASE Car_Cnt_Catg_Typ_Id                                             WHEN 134 THEN car_cnt.TPE_Cnt                                             ELSE 0                                           END )                                       + ( CASE Car_Cnt_Catg_Typ_Id                                             WHEN 135 THEN car_cnt.TPE_Cnt                                             ELSE 0                                           END )) AS NUMERIC(24, 10)) AS Out_Of_Srvc_TPE_Cnt ,                              MAX(car_cnt.Crtd_Dt) AS Crtd_Dt ,                              MAX(car_cnt.Crtd_Id) AS Crtd_Id ,                              MAX(car_cnt.Lst_Upd_Dt) AS Lst_Upd_Dt ,                              MAX(car_cnt.Lst_Upd_Id) AS Lst_Upd_Id                     FROM     ( SELECT    Dt_Dimn_Id ,                                          Attr_Id_1 ,                                          Attr_Ver_1 ,                                          Car_Cnt ,                                          TPE_Cnt ,                                          Car_Cnt_Catg_Typ_Id ,                                          Row_Typ_Id ,                                          Car_Dimn_Id ,                                          Car_Ver ,                                          Crtd_Dt ,                                          Crtd_Id ,                                          Lst_Upd_Dt ,                                          Lst_Upd_Id                                FROM      DDSMRT.dbo.vw_car_count_fact_History (NOLOCK)                                WHERE     Row_Typ_Id = 516                              ) car_cnt -- Rev Accrual                               LEFT JOIN ( SELECT  Car_Dimn_Id ,                                                  Car_Ver ,                                                  Entr_Hierchy_Id ,                                                  Entr_Hierchy_Ver                                          FROM    DDSMRT.dbo.VMRT_Car_Dimension_Correct                                        ) car ON ( car_cnt.Car_Dimn_Id = car.Car_Dimn_Id                                                   AND car_cnt.Car_Ver = car.Car_Ver                                                 )                     GROUP BY Dt_Dimn_Id ,                              Attr_Id_1 ,                              Attr_Ver_1 ,                              Row_Typ_Id ,                              Entr_Hierchy_Id ,                              Entr_Hierchy_Ver                   )      SELECT  cnt.Mth_Dimn_Id ,              cnt.Rd_Mbrshp_Dimn_Id ,              cnt.Stat_Cd_Dimn_Id ,              cnt.Cars_Enrt_Cnt ,              cnt.Cars_FMO_Mnt_Cnt ,              cnt.Cars_Onln_Cnt ,              cnt.Cars_On_Relf_Cnt ,              cnt.Cars_On_Off_Ln_Relf_Cnt ,              cnt.Cars_In_Shop_Cnt ,              cnt.Cars_Bad_Ordr_Stor_Cnt ,              cnt.Cars_Stor_Cnt ,              mil.Cars_Zero_Rt_Cnt ,              cnt.In_Srvc_TPE_Cnt ,              cnt.Out_Of_Srvc_TPE_Cnt ,              cnt.Crtd_Dt ,              cnt.Crtd_Id ,              cnt.Lst_Upd_Dt ,              cnt.Lst_Upd_Id ,              mil.Totl_Hrs ,              mil.Mile_Rt ,              mil.Avg_Mils_Dy ,              mil.TPE_Car_Rt_Per_Dy ,              mil.TPE_Mils ,              mil.TPE_Mile_Rt ,              mil.TPE_Whl_Schg_Mile_Rt ,              mil.TPE_Totl_Rt_Per_Dy ,              mil.Est_TPE_Car_Hire ,              mil.TPE_Milg_Rev ,              mil.TPE_Whl_Schg_Milg_Rev      FROM    CntCTE cnt              LEFT JOIN ( SELECT  Mth_Beg_Dt_Dimn_Id ,                                  Hierchy_Id ,                                  Hierchy_Ver ,                                  Org_Mbrshp_Dimn_Id ,                                  Org_Mbrshp_Ver ,                                  Totl_Hrs ,                                  Mile_Rt ,                                  Avg_Mils_Dy ,                                  TPE_Car_Rt_Per_Dy ,                                  TPE_Mils ,                                  TPE_Mile_Rt ,                                  [TPE_Whl_Schg_Mile_Rt] ,                                  [TPE_Totl_Rt_Per_Dy] ,                                  [Est_TPE_Car_Hire] ,                                  TPE_Milg_Rev ,                                  TPE_Whl_Schg_Milg_Rev ,                                  [Cars_Zero_Rt_Cnt]                          FROM    DDSMRT.dbo.Tfin_Flet_Perf_Rev_Est_Car_Cnt_Fact (NOLOCK)                        ) mil ON ( mil.Mth_Beg_Dt_Dimn_Id = cnt.Dt_Dimn_Id                                   AND mil.Hierchy_Id = cnt.Entr_Hierchy_Id                                   AND mil.Hierchy_Ver = cnt.Entr_Hierchy_Ver                                   AND mil.Org_Mbrshp_Dimn_Id = cnt.Attr_Id_1                                   AND mil.Org_Mbrshp_Ver = cnt.Attr_Ver_1                                 )"
    },
    {
      "id": "VTTX_Equipment_Dim",
      "name": "VTTX_Equipment_Dim",
      "type": "VIEW",
      "sql": "CREATE view [DDSV].[VTTX_Equipment_Dim] as  select       concat(convert(varchar(10),car.car_dimn_id),'_',convert(varchar(5), car.car_Ver)) as TTX_Equipment_Dimn_Id     --,hier1.[Bus_Ln_Desc] as [Bus_Ln_Shrt_Desc]          ,case when hier3.stat_cd in (998, 999) then hier3.[Bus_Ln_Shrt_Desc]    else isnull(hier3.[Bus_Ln_Shrt_Desc] , Hier2.Business_line_description) end  AS [Bus_Ln_Shrt_Desc]          --,hier1.Eq_Typ_Desc  as [Eq_Typ_Shrt_Desc]         ,case when hier3.stat_cd in (998, 999) then hier3.[Eq_Typ_Shrt_Desc]      else isnull(hier3.[Eq_Typ_Shrt_Desc], hier2.Equipment_Type_Description) end AS [Eq_Typ_Shrt_Desc]         ,hier3.Eq_Featr_Shrt_Desc        ,hier1.[Eq_Char]  as [Eq_Char_Desc]        ,hier1.[TTX_Eq_Cd_Desc] as [TTX_Eq_Desc]        ,hier1.[TTX_Eq_Cd] as [TTX_Eq_Cd]     ,NULL as Rpt_Dt     ,car.Eff_From as [Eq_Eff_Strt_Dt]     ,car.eff_to as [Eq_Eff_End_Dt]     ,case when car.Eff_To is null then 1 else 0 end as [Act_Sts]     , car.[Car_Nr]        ,car.[Car_Init]       ,car.Crtd_Dt     ,car.Crtd_Id     ,car.Lst_Upd_Dt     ,car.Lst_Upd_Id      /** IR527842 Fix **/    from ddsmrt.dbo.car_dim_correct  (NOLOCK)  car  --left join ddsmrt.[dbo].[VMRT_Car_Hierarchy_Equipment] hier1  --on car.eq_Hierchy_Id = hier1.Hierchy_Id and car.eq_Hierchy_ver = hier1.hierchy_ver  --left join ddsmrt.dbo.VMRT_Car_Hierarchy_Enterprise hier3  --on car.entr_Hierchy_Id = hier3.Hierchy_Id and car.entr_Hierchy_ver = hier3.hierchy_ver      left join [dbo].[VMRT_Car_Hierarchy_Equipment] hier1  on (car.eq_Hierchy_Id = hier1.Hierchy_Id and car.eq_Hierchy_ver = hier1.hierchy_ver)  left join [dbo].[VMRT_Car_Hierarchy_Fleet] hier2  on (car.Fleet_Hierchy_Id = hier2.Hierchy_Id and car.fleet_Hierchy_ver = hier2.hierchy_ver)  left join [dbo].[VMRT_Car_Hierarchy_Enterprise] hier3  on (car.Entr_Hierchy_Id = hier3.Hierchy_Id and car.Entr_Hierchy_ver = hier3.hierchy_ver)"
    },
    {
      "id": "VCar_Dim",
      "name": "VCar_Dim",
      "type": "VIEW",
      "sql": "CREATE view [DDSV].[VCar_Dim]  as  select concat(convert(varchar(10),car.Car_Dimn_Id),'_',convert(varchar(5), car.Car_Ver)) as Car_Dimn_Id    --cast(car.Car_Dimn_Id as int) as Car_Dimn_Id    --,car.Car_Ver    ,coalesce(car.[Car_Status_Maximo], car.[Car_Status_UFD]) as Car_Stat_Ind    ,cast(car.[Car_Nr] as decimal(11,0)) as Car_Nr        ,car.[Car_Init]     ,car.Car_Cls as Car_Cls_Cd     ,hier3.Stat_Cd as Fin_Stat_Cd     ,NULL as Eq_Typ_Stat_Cd     ,car.[Eff_From] as Car_Eff_Strt_Dt        ,car.[Eff_To] as Car_Eff_End_Dt     ,hier3.Stat_Cd as Stat_Cd     ,hier3.Stat_Cd_Eff_Strt_Dt as Stat_Cd_Dt     ,car.TTX_Eff_Dt     ,       CASE WHEN isnull(convert(varchar(50),hier3.bus_Ln_Shrt_Desc), convert(varchar(50), hier2.[Business_Line_Description])) = 'Intermodal' AND car.TTX_Mngd_Car_Ind = 0       THEN             CASE WHEN SUBSTRING(cchar.Eq_Typ_Cd, 1, 2) IN ('S1', 'S2', 'S3', 'S4', 'S5') THEN '40'' Wells'               WHEN SUBSTRING(cchar.Eq_Typ_Cd, 1, 2) IN ('S6', 'S7') THEN '53'' Wells' END       ELSE replace(hier3.Eq_Featr_Shrt_Desc,\"ft\",\"'\")  END AS Eq_Featr_Shrt_Desc     , CASE WHEN isnull(convert(varchar(50),hier3.bus_Ln_Shrt_Desc), convert(varchar(50), hier2.[Business_Line_Description])) = 'Intermodal' AND car.TTX_Mngd_Car_Ind  = 0       THEN          CASE WHEN SUBSTRING(cchar.Eq_Typ_Cd, 1, 1) IN ('P', 'Q') THEN 'Conventional'            WHEN SUBSTRING(cchar.Eq_Typ_Cd, 1, 2) IN ('S1', 'S2', 'S3', 'S4', 'S5', 'S6', 'S7') THEN 'Doublestack' END       ELSE isnull(hier3.[Eq_Typ_Shrt_Desc], hier2.Equipment_Type_Description) END AS Eq_Typ_Shrt_Desc       ,isnull(convert(varchar(50),hier3.bus_Ln_Shrt_Desc), convert(varchar(50), hier2.[Business_Line_Description])) as bus_Ln_Shrt_Desc     ,      CASE WHEN isnull(convert(varchar(50),hier3.bus_Ln_Shrt_Desc), convert(varchar(50), hier2.[Business_Line_Description])) = 'Intermodal' AND car.TTX_Mngd_Car_Ind = 0      THEN            CASE WHEN SUBSTRING(cchar.Eq_Typ_Cd, 1, 1) IN ('P', 'Q') THEN 'Conventional'              WHEN SUBSTRING(cchar.Eq_Typ_Cd, 1, 2) IN ('S1', 'S2', 'S3', 'S4', 'S5') THEN 'DTTX 40-48ft'              WHEN SUBSTRING(cchar.Eq_Typ_Cd, 1, 2) IN ('S6', 'S7') THEN 'DTTX 53-56ft'                          END     WHEN isnull(convert(varchar(50),hier3.bus_Ln_Shrt_Desc), convert(varchar(50), hier2.[Business_Line_Description])) = 'Intermodal'        AND (coalesce(car.[Car_Status_Maximo], car.[Car_Status_UFD]) = 'PRE-REGISTERED' or coalesce(car.[Car_Status_Maximo], car.[Car_Status_UFD]) IS NULL)     THEN NULL     ELSE convert(varchar(40),hier2.Fleet_Segment_Description) END       as Flet_Seg_Desc       ,car.Ownr_Mrk as Ownr_Mrk_Cd     ,cchar.[Intmdit_Connt_Styl] as Is_Art_Ind     ,car.Pool_Cd     ,car.TTX_Mngd_Car_Ind as TTX_Mng_Ind     ,cast(cchar.TPE_Fctr as numeric(2,1)) as TPE_Fctr     ,ISNULL(cast(cchar.[Pltfm_Fctr] as decimal(15,1)),1.0) as Pltfm_Fctr       ,cast(cchar.Trk_Axl_Cnt as decimal(15,1)) as Trk_Fctr     ,CONVERT(VARCHAR(14), car.Car_Init + REPLICATE('0',10 - LEN(CONVERT(VARCHAR(10), car.Car_Nr)))                  + CONVERT(VARCHAR(10), car.Car_Nr)) AS EDW_Car_Id         ,cast(cchar.Axl_Cnt as int) as Axl_Cnt     ,cast(cchar.Ut_Cnt  as int) as Ut_Cnt     ,convert(char(4),cchar.Eq_Typ_Cd) as Eq_Cd     ,convert(char(8), car.Crtd_Id) as Crtd_Id     ,car.Crtd_Dt     ,car.Lst_Upd_Dt     ,convert(char(8), car.Lst_Upd_Id) as Lst_Upd_Id      from dbo.[2022_09_Car_Dim] car (NOLOCK)  Left join (select * from [Car_Characteristic_Dim] (NOLOCK) where eff_to is null and car_dimn_id <> -1) cchar  on (car.Car_Dimn_Id = cchar.car_dimn_id )  left join [dbo].[VMRT_Car_Hierarchy_Fleet] (NOLOCK) hier2  on (car.Fleet_Hierchy_Id = hier2.Hierchy_Id and car.fleet_Hierchy_ver = hier2.hierchy_ver)  left join [dbo].[VMRT_Car_Hierarchy_Enterprise] (NOLOCK) hier3  on (car.Entr_Hierchy_Id = hier3.Hierchy_Id and car.Entr_Hierchy_ver = hier3.hierchy_ver)"
    },
    {
      "id": "Revenue_Accounting_Actual_Car_Count_Hist",
      "name": "Revenue_Accounting_Actual_Car_Count_Hist",
      "type": "VIEW",
      "sql": "CREATE view [SV].[Revenue_Accounting_Actual_Car_Count_Hist] as    --Actual  select   Car_Dimn_Id  ,Car_Ver    ,Dt_Dimn_Id as Service_Month_Start_Dt_Dimn_Id  ,Car_Cnt_Catg_Typ_Id  ,Responsible_Road_Org_Mbrshp_Dimn_Id  ,Responsible_Road_Org_Mbrshp_Ver  ,liable_rd_mbrshp_dimn_id  ,liable_rd_mbrshp_ver  ,Liable_org_dimn_id  ,Liable_Org_Ver     ,(Cast([Car_Dimn_Id] AS VARCHAR) + '|' + Cast([Car_Ver] AS VARCHAR)) AS Car_ID     ,(Cast(liable_rd_mbrshp_dimn_id AS VARCHAr) + '|' + Cast(liable_rd_mbrshp_ver AS VARCHAR)) AS Liable_Road_ID     ,(Cast([Responsible_Road_Org_Mbrshp_Dimn_Id] AS VARCHAR) + '|' + Cast([Responsible_Road_Org_Mbrshp_Ver] AS VARCHAR)) AS Resp_Road_ID     ,(Cast([Liable_Org_Dimn_Id] AS VARCHAr) + '|' + Cast([Liable_Org_Ver] AS VARCHAR)) AS Liable_Dimn_ID     ,(Cast([Responsible_Org_Dimn_Id] AS VARCHAR) + '|' + Cast([Responsible_Org_Ver] AS VARCHAR)) AS Resp_Dimn_ID    ,Car_Cnt  ,TPE_Cnt  ,Ut_Cnt  ,Pltfm_Cnt    from (  select    f.car_dimn_id  ,f.car_ver  ,f.Dt_Dimn_Id  ,f.car_Cnt_Catg_Typ_id  ,f.Attr_Id_1  as Responsible_Road_Org_Mbrshp_Dimn_Id  ,f.Attr_Ver_1 as Responsible_Road_Org_Mbrshp_Ver  ,f.Attr_Id_2  as liable_rd_mbrshp_dimn_id  ,f.Attr_Ver_2 as liable_rd_mbrshp_ver  ,isnull(mem.Org_Dimn_Id,-1) as Liable_org_dimn_id  ,isnull(mem.org_ver    ,-1) as Liable_Org_Ver  ,isnull(mem2.Org_Dimn_Id,-1) as [Responsible_Org_Dimn_Id]  ,isnull(mem2.org_ver ,-1) as [Responsible_Org_Ver]  ,isnull(f.Car_Cnt ,0) as Car_Cnt  ,isnull(f.TPE_Cnt ,0) as TPE_Cnt  ,isnull(f.Ut_Cnt ,0) as Ut_Cnt  ,isnull(f.Pltfm_Cnt ,0) as Pltfm_Cnt    from (SELECT car_dimn_id     ,car_ver     ,Dt_Dimn_Id     ,car_Cnt_Catg_Typ_id     ,1 as grp_nr     ,Attr_Id_1     ,Attr_Ver_1     ,Attr_Id_2     ,Attr_Ver_2     ,Row_Typ_Id     ,sum(Car_Cnt   ) as Car_Cnt     ,sum(TPE_Cnt   ) as TPE_Cnt     ,sum(Ut_Cnt    ) as Ut_Cnt     ,sum(Pltfm_Cnt ) as Pltfm_Cnt     FROM ddsmrt.dbo.vw_car_count_fact_History (NOLOCK)     WHERE Row_Typ_Id = 517 and car_Cnt_Catg_Typ_id <> 138 and Dt_Dimn_Id >=20100101      Group by car_dimn_id,car_ver,Dt_Dimn_Id,car_Cnt_Catg_Typ_id,Attr_Id_1,Attr_Ver_1,Attr_Id_2,Attr_Ver_2,Row_Typ_Id     UNION      select * from (     select       car_dimn_id     ,car_ver     ,Dt_Dimn_Id     ,137 as car_Cnt_Catg_Typ_id     ,grp_nr     ,Attr_Id_1     ,Attr_Ver_1     ,Attr_Id_2     ,Attr_Ver_2     ,Row_Typ_Id     ,isnull(Car_Cnt-lag(Car_Cnt) over (partition by dt_dimn_id, car_dimn_id, car_ver, Attr_Id_2,Attr_Ver_2, Attr_Id_1,Attr_Ver_1 order by grp_nr), Car_Cnt) as Car_Cnt     ,isnull(TPE_Cnt-lag(TPE_Cnt) over (partition by dt_dimn_id, car_dimn_id, car_ver, Attr_Id_2,Attr_Ver_2, Attr_Id_1,Attr_Ver_1 order by grp_nr), TPE_Cnt) as TPE_Cnt     ,isnull(Ut_Cnt-lag(Ut_Cnt) over (partition by dt_dimn_id, car_dimn_id, car_ver, Attr_Id_2,Attr_Ver_2, Attr_Id_1,Attr_Ver_1 order by grp_nr), Ut_Cnt) as Ut_Cnt     ,isnull(Pltfm_Cnt-lag(Pltfm_Cnt) over (partition by dt_dimn_id, car_dimn_id, car_ver, Attr_Id_2,Attr_Ver_2, Attr_Id_1,Attr_Ver_1 order by grp_nr), Pltfm_Cnt) as Pltfm_Cnt     from (     SELECT car_dimn_id     ,car_ver     ,Dt_Dimn_Id     ,case when car_Cnt_Catg_Typ_id = 138 then 2 else 1 end as grp_nr     ,Attr_Id_1     ,Attr_Ver_1     ,Attr_Id_2     ,Attr_Ver_2     ,Row_Typ_Id     ,sum(Car_Cnt   ) as Car_Cnt     ,sum(TPE_Cnt   ) as TPE_Cnt     ,sum(Ut_Cnt    ) as Ut_Cnt     ,sum(Pltfm_Cnt ) as Pltfm_Cnt     FROM ddsmrt.dbo.vw_car_count_fact_History (NOLOCK)     WHERE Row_Typ_Id = 517 and Dt_Dimn_Id  >=20100101      Group by car_dimn_id,car_ver,Dt_Dimn_Id,Attr_Id_1,Attr_Ver_1,Attr_Id_2,Attr_Ver_2,Row_Typ_Id, case when car_Cnt_Catg_Typ_id = 138 then 2 else 1 end     ) FISs     ) FIS    WHERE grp_nr = 2     )  f    left join ddsmrt.dbo.VMRT_Organization_Membership_Dimension mem on (f.Attr_Id_2 = mem.Org_Mbrshp_Dimn_Id and f.Attr_Ver_2 = mem.Org_Mbrshp_Ver)  left join ddsmrt.dbo.VMRT_Organization_Membership_Dimension mem2 on (f.Attr_Id_1 = mem2.Org_Mbrshp_Dimn_Id and f.Attr_Ver_1 = mem2.Org_Mbrshp_Ver)    ) f2"
    },
    {
      "id": "AAR_Velocity",
      "name": "AAR_Velocity",
      "type": "VIEW",
      "sql": "CREATE VIEW [sv].[AAR_Velocity]    AS    SELECT     AAR_Velocity_Fact.AAR_Velocity_Fact_Id,  AAR_Velocity_Fact.Road_Org_Dimn_Id,  AAR_Velocity_Fact.Road_Org_Ver,  AAR_Velocity_Fact.Week_Ending_Dt_Dimn_Id,  AAR_Velocity_Fact.Indx_Lds_Per_Car AS AAR_Loads_Per_Car,   AAR_Velocity_Fact.Indx_Dwell_Time AS AAR_Terminal_Dwell_Time,  AAR_Velocity_Fact.Indx_Inmd_Train_Speed AS AAR_Intermodal_Train_Speed,  AAR_Velocity_Fact.Indx_Train_Speed AS Train_Speed,  AAR_Velocity_Fact.Road_Abbrv,  AAR_Velocity_Fact.Indx_Totl AS AAR_Performance_Index     FROM AAR_Velocity_Fact"
    },
    {
      "id": "VMRT_DQ_Car_Characteristic_Dim_new",
      "name": "VMRT_DQ_Car_Characteristic_Dim_new",
      "type": "VIEW",
      "sql": "CREATE VIEW [dbo].[VMRT_DQ_Car_Characteristic_Dim_new]  AS  SELECT        dbo.Car_Characteristic_Dim.Car_Init, dbo.Car_Characteristic_Dim.Car_Nr, dbo.ETL_Error_Check_Lookup.Err_Desc, dbo.ETL_Run.SSIS_Package_Nm,                            dbo.ETL_Run.Run_Dt  FROM            dbo.ETL_Error_Check_Lookup INNER JOIN                           dbo.ETL_Error_Detail ON dbo.ETL_Error_Check_Lookup.Err_Chk_Id = dbo.ETL_Error_Detail.Err_Chk_Id INNER JOIN                           dbo.ETL_Run ON dbo.ETL_Error_Detail.Run_Id = dbo.ETL_Run.Run_Id INNER JOIN                           dbo.Car_Characteristic_Dim ON dbo.ETL_Error_Detail.DDS_PK = dbo.Car_Characteristic_Dim.Car_Char_Dimn_Id  WHERE        (dbo.Car_Characteristic_Dim.Dq_Flg = 1) AND (dbo.ETL_Run.SSIS_Package_Nm = 'SSIS_Car_Char_Dim')"
    },
    {
      "id": "usp_D_House_Keeping_Car_Count_Fact",
      "name": "usp_D_House_Keeping_Car_Count_Fact",
      "type": "SQL_STORED_PROCEDURE",
      "sql": "CREATE PROC [dbo].[usp_D_House_Keeping_Car_Count_Fact] (@month INT = 6)  AS  BEGIN     IF(MONTH(GETDATE()) IN (3,6,9,12))   BEGIN    DECLARE @date INT = CONVERT(VARCHAR(10), DATEADD(MONTH,- @month,GETDATE()), 112)    DECLARE @PARTITION INT      SELECT @PARTITION = $PARTITION.pf_Car_Count_Fact_Function(@date)       ALTER TABLE [dbo].[Car_Count_Fact] SWITCH PARTITION (@PARTITION) TO [dbo].[Car_Count_Fact_History] PARTITION (@PARTITION)   END  END"
    },
    {
      "id": "Accounting_Code_Category",
      "name": "Accounting_Code_Category",
      "type": "VIEW",
      "sql": "CREATE VIEW [sv].[Accounting_Code_Category]  (  Acct_Cd_Catg_Dimn_Id,  Accounting_Cost_Category,  Accounting_Cost_Code)  AS  SELECT   Accounting_Code_Category_Dim.Acct_Cd_Catg_Dimn_Id,  isnull(Accounting_Code_Category_Dim.Acct_Cost_Cd_Catg , 'Unknown') as Acct_Cost_Cd_Catg,  isnull(Accounting_Code_Category_Dim.Acct_Cost_Cd   , 'Unknown') as Acct_Cost_Cd  FROM Accounting_Code_Category_Dim"
    },
    {
      "id": "VMRT_DQ_Car_Count_Fact_new",
      "name": "VMRT_DQ_Car_Count_Fact_new",
      "type": "VIEW",
      "sql": "CREATE VIEW [dbo].[VMRT_DQ_Car_Count_Fact_new]  AS  SELECT        Car_Count_Fact.Car_Init, Car_Count_Fact.Car_Nr, dbo.ETL_Error_Check_Lookup.Err_Desc, dbo.ETL_Run.Run_Dt, Car_Count_Fact.Dq_Flg,                            dbo.ETL_Run.SSIS_Package_Nm  FROM            dbo.ETL_Error_Check_Lookup INNER JOIN                           dbo.ETL_Error_Detail ON dbo.ETL_Error_Check_Lookup.Err_Chk_Id = dbo.ETL_Error_Detail.Err_Chk_Id INNER JOIN                           dbo.ETL_Run ON dbo.ETL_Error_Detail.Run_Id = dbo.ETL_Run.Run_Id INNER JOIN                           dbo.vw_car_count_fact Car_Count_Fact ON dbo.ETL_Error_Detail.DDS_PK = Car_Count_Fact.Car_Count_Fact_Id  WHERE        (Car_Count_Fact.Dq_Flg = '1') AND (dbo.ETL_Run.SSIS_Package_Nm = 'SSIS_Car_Cnt_Fact_Ufd_Cnts') OR                           (dbo.ETL_Run.SSIS_Package_Nm = 'SSIS_Car_Count_Fact_Rev_Acc_Accr') OR                           (dbo.ETL_Run.SSIS_Package_Nm = 'SSIS_Car_Count_Fact_Rev_Acc_Est') OR                           (dbo.ETL_Run.SSIS_Package_Nm = 'SSIS_Car_Count_Fact_Rev_Acc_Act')"
    },
    {
      "id": "Accounting_Cost",
      "name": "Accounting_Cost",
      "type": "VIEW",
      "sql": "CREATE VIEW [sv].[Accounting_Cost]  (Acct_Cost_Fact_Id,  Acct_Cd_Catg_Dimn_Id,  TTX_Acct_Dt_Dimn_Id,  Accounting_Cost_Code,  Posting_Period,  Accounting_Cost)  AS  SELECT   Accounting_Cost_Fact.Acct_Cost_Fact_Id,  Accounting_Cost_Fact.Acct_Cd_Catg_Dimn_Id,  Accounting_Cost_Fact.TTX_Acct_Dt_Dimn_Id,  Accounting_Cost_Fact.Acct_Cost_Cd,  Accounting_Cost_Fact.TTX_Acct_Dt,  Accounting_Cost_Fact.Acct_Cost   FROM Accounting_Cost_Fact"
    },
    {
      "id": "vw_UFD_Milg_Fact_All",
      "name": "vw_UFD_Milg_Fact_All",
      "type": "VIEW",
      "sql": "CREATE VIEW [dbo].[vw_UFD_Milg_Fact_All] AS  select    [UFD_Milg_Fact_Id] ,    [Car_Dimn_Id] ,   [Car_Ver] ,   [Resp_Rd_Org_Dimn_Id] ,   [Resp_Rd_Org_Ver] ,   [Poss_Rd_Org_Dimn_Id] ,   [Poss_Rd_Org_Ver] ,   [Svc_Mth_Dimn_Id] ,   [Car_Init] ,   [Car_Nbr] ,   [Resp_Rd_Abrv] ,   [Poss_Rd_Abrv] ,   [Svc_Mth] ,   [Load_Mile_UFD] ,   [Load_Mile_Corrd] as Load_Mile,   [Load_Unit_Mile_Corrd] as Load_Unit_Mile,   [Load_TPE_Mile_Corrd] as Load_TPE_Mile,   [Load_Pltfm_Mile_Corrd] as Load_Pltfm_Mile,   [Emp_Mile_UFD] ,   [Emp_Mile_Corrd] as Emp_Mile,   [Emp_Unit_Mile_Corrd] as Emp_Unit_Mile,   [Emp_TPE_Mile_Corrd] as Emp_TPE_Mile,   [Emp_Pltfm_Mile_Corrd] as Emp_Pltfm_Mile ,   [Tot_Mile_UFD] ,   [Tot_Mile_Corrd] as Tot_Mile ,   [Tot_Unit_Mile_Corrd] as Tot_Unit_Mile,   [Tot_TPE_Mile_Corrd] as Tot_TPE_Mile,   [Tot_Pltfm_Mile_Corrd] as Tot_Pltfm_Mile,   [Load_Trip_Seg_Mile_In_Mth_Corrd] as Load_Trip_Seg_Mile_In_Mth,   [Load_Trip_Seg_Mile_Strt_In_Mth_Corrd] as Load_Trip_Seg_Mile_Strt_In_Mth ,   [Load_Trip_Seg_Mile_End_In_Mth_Corrd] as Load_Trip_Seg_Mile_End_In_Mth,   [Emp_Trip_Seg_Mile_In_Mth_Corrd] as Emp_Trip_Seg_Mile_In_Mth,   [Emp_Trip_Seg_Mile_Strt_In_Mth_Corrd] as Emp_Trip_Seg_Mile_Strt_In_Mth,   [Emp_Trip_Seg_Mile_End_In_Mth_Corrd] as Emp_Trip_Seg_Mile_End_In_Mth,   [Tot_Trip_Seg_Mile_In_Mth_Corrd] as Tot_Trip_Seg_Mile_In_Mth,   [Tot_Trip_Seg_Mile_Strt_In_Mth_Corrd] as Tot_Trip_Seg_Mile_Strt_In_Mth,   [Tot_Trip_Seg_Mile_End_In_Mth_Corrd] as Tot_Trip_Seg_Mile_End_In_Mth,   [Crtd_Id] ,   [Crtd_Dt] ,   [Lst_Upd_Id] ,   [Lst_Upd_Dt] ,   [Src_Sys_Nm] ,   [Dq_Flg]    FROM [dbo].[UFD_Milg_Fact]    UNION ALL     select    [UFD_Milg_Fact_Id] ,    [Car_Dimn_Id] ,   [Car_Ver] ,   [Resp_Rd_Org_Dimn_Id] ,   [Resp_Rd_Org_Ver] ,   [Poss_Rd_Org_Dimn_Id] ,   [Poss_Rd_Org_Ver] ,   [Svc_Mth_Dimn_Id] ,   [Car_Init] ,   [Car_Nbr] ,   [Resp_Rd_Abrv] ,   [Poss_Rd_Abrv] ,   [Svc_Mth] ,   [Load_Mile_UFD] ,   [Load_Mile_Corrd] ,   [Load_Unit_Mile_Corrd] ,   [Load_TPE_Mile_Corrd] ,   [Load_Pltfm_Mile_Corrd] ,   [Emp_Mile_UFD] ,   [Emp_Mile_Corrd] ,   [Emp_Unit_Mile_Corrd] ,   [Emp_TPE_Mile_Corrd] ,   [Emp_Pltfm_Mile_Corrd] ,   [Tot_Mile_UFD] ,   [Tot_Mile_Corrd] ,   [Tot_Unit_Mile_Corrd] ,   [Tot_TPE_Mile_Corrd] ,   [Tot_Pltfm_Mile_Corrd] ,   [Load_Trip_Seg_Mile_In_Mth_Corrd] ,   [Load_Trip_Seg_Mile_Strt_In_Mth_Corrd] ,   [Load_Trip_Seg_Mile_End_In_Mth_Corrd] ,   [Emp_Trip_Seg_Mile_In_Mth_Corrd] ,   [Emp_Trip_Seg_Mile_Strt_In_Mth_Corrd] ,   [Emp_Trip_Seg_Mile_End_In_Mth_Corrd] ,   [Tot_Trip_Seg_Mile_In_Mth_Corrd] ,   [Tot_Trip_Seg_Mile_Strt_In_Mth_Corrd] ,   [Tot_Trip_Seg_Mile_End_In_Mth_Corrd] ,   [Crtd_Id] ,   [Crtd_Dt] ,   [Lst_Upd_Id] ,   [Lst_Upd_Dt] ,   [Src_Sys_Nm] ,   [Dq_Flg]  FROM [dbo].[UFD_Milg_Fact_History]"
    },
    {
      "id": "VMRT_DQ_Car_Dim",
      "name": "VMRT_DQ_Car_Dim",
      "type": "VIEW",
      "sql": "CREATE VIEW [dbo].[VMRT_DQ_Car_Dim]  AS  SELECT        TOP (100) PERCENT dbo.[2022_09_Car_Dim].Car_Init, dbo.[2022_09_Car_Dim].Car_Nr,   dbo.[2022_09_Car_Dim].Ownr_Mrk, dbo.[2022_09_Car_Dim].TTX_Mngd_Car_Ind, dbo.ETL_Error_Check_Lookup.Err_Desc,                            dbo.ETL_Run.Run_Dt  FROM            dbo.ETL_Error_Check_Lookup INNER JOIN                           dbo.ETL_Error_Detail          ON dbo.ETL_Error_Check_Lookup.Err_Chk_Id = dbo.ETL_Error_Detail.Err_Chk_Id INNER JOIN                           dbo.[2022_09_Car_Dim]          ON dbo.ETL_Error_Detail.DDS_PK = dbo.[2022_09_Car_Dim].Car_Dimn_Id          AND dbo.ETL_Error_Detail.DDS_Ver = dbo.[2022_09_Car_Dim].Car_Ver INNER JOIN                           dbo.ETL_Run ON dbo.ETL_Error_Detail.Run_Id = dbo.ETL_Run.Run_Id  WHERE        (dbo.[2022_09_Car_Dim].Dq_Flg = 1) AND   (dbo.ETL_Error_Check_Lookup.Tbl_Nm = '2022_09_Car_Dim') AND   (dbo.ETL_Run.Run_Dt > CONVERT(DATETIME, '2015-06-15 00:00:00', 102))  ORDER BY dbo.ETL_Run.Run_Dt"
    },
    {
      "id": "Area_of_Car",
      "name": "Area_of_Car",
      "type": "VIEW",
      "sql": "CREATE VIEW [SV].[Area_of_Car]  (    Area_Of_Car_Dimn_Id,  Area_Of_Car_Ver,  Applied_Job_Code,  Qualifier_Code,  Applied_Job_Code_Description,  Qualifier_Code_Description,  Area_of_Car_Level_1,  Area_of_Car_Level_2,  Area_of_Car_Level_3,  Area_of_Car_Level_4,  Wheel_Size,  Wheel_Class,  Wheel_Condition,  Condition_Based_Maint_Flag,  Condition_Based_Maint_Type,  Miscellaneous_Flag,  Miscellaneous_Type)  AS    SELECT   Area_Of_Car_Dim.Area_Of_Car_Dimn_Id,  Area_Of_Car_Dim.Area_Of_Car_Ver,  Area_Of_Car_Dim.Apl_Job_Cd,  Area_Of_Car_Dim.Apl_Qlfr_Cd,  a.Apl_Job_Cd_Desc,  a.Apl_Qlfr_Cd_Desc,  a.Area_Of_Car_Lvl_1,  a.Area_Of_Car_Lvl_2,  a.Area_Of_Car_Lvl_3,  a.Area_Of_Car_Lvl_4,  a.Whl_Sz,  a.Whl_Cls,  a.Whl_Cond,  a.Cond_Based_Mnt_Flg,  a.Cond_Based_Mnt_Typ,  a.Miscellaneous_Flag,  a.Miscellaneous_Type     FROM DDSMRT.dbo.Area_Of_Car_Dim as Area_Of_Car_Dim   JOIN (SELECT a.* FROM DDSMRT.dbo.Area_Of_Car_Dim a     JOIN (SELECT Area_Of_Car_Dimn_Id,MAX(Area_Of_Car_Ver) Area_Of_Car_Ver FROM DDSMRT.dbo.Area_Of_Car_Dim GROUP BY Area_Of_Car_Dimn_Id)b ON a.Area_Of_Car_Dimn_Id = b.Area_Of_Car_Dimn_Id AND a.Area_Of_Car_Ver = b.Area_Of_Car_Ver   ) a on a.Area_Of_Car_Dimn_Id = Area_Of_Car_Dim.Area_Of_Car_Dimn_Id"
    },
    {
      "id": "VMRT_DQ_Cycle_Fact_new",
      "name": "VMRT_DQ_Cycle_Fact_new",
      "type": "VIEW",
      "sql": "CREATE VIEW [dbo].[VMRT_DQ_Cycle_Fact_new]  AS  SELECT DISTINCT         TOP (100) PERCENT dbo.ETL_Error_Check_Lookup.Err_Desc, dbo.[2022_09_Car_Dim].Car_Init,     dbo.[2022_09_Car_Dim].Car_Nr, dbo.ETL_Run.Run_Dt,           dbo.ETL_Run.SSIS_Package_Nm  FROM     dbo.ETL_Error_Check_Lookup INNER JOIN                           dbo.ETL_Error_Detail          ON dbo.ETL_Error_Check_Lookup.Err_Chk_Id = dbo.ETL_Error_Detail.Err_Chk_Id INNER JOIN                           dbo.ETL_Run ON dbo.ETL_Error_Detail.Run_Id = dbo.ETL_Run.Run_Id INNER JOIN                           dbo.[2022_09_Car_Dim] INNER JOIN                           dbo.vw_Cycle_Fact_All Cycle_Fact          ON dbo.[2022_09_Car_Dim].Car_Dimn_Id = Cycle_Fact.Car_Dimn_Id         ON dbo.ETL_Error_Detail.DDS_PK = Cycle_Fact.Cycle_Fact_Id  WHERE        (Cycle_Fact.Dq_Flg = 1) AND (dbo.ETL_Run.SSIS_Package_Nm = 'SSIS_Cycle_Fact')  ORDER BY dbo.[2022_09_Car_Dim].Car_Nr"
    },
    {
      "id": "VMRT_DQ_Repair_Event_Cost_Fact",
      "name": "VMRT_DQ_Repair_Event_Cost_Fact",
      "type": "VIEW",
      "sql": "CREATE VIEW [dbo].[VMRT_DQ_Repair_Event_Cost_Fact]  AS  SELECT        Repair_Event_Cost_Fact.Car_Init, Repair_Event_Cost_Fact.Car_Nr, Repair_Event_Cost_Fact.Repr_Enty_Org_Abrv,                            Repair_Event_Cost_Fact.SPLC_Nr, Repair_Event_Cost_Fact.Loc_On_Car_Cd, Repair_Event_Cost_Fact.Why_Md_Cd,                            Repair_Event_Cost_Fact.Cnd_Cd, Repair_Event_Cost_Fact.Repr_Cd, Repair_Event_Cost_Fact.Repr_Cls_Cd, Repair_Event_Cost_Fact.Apl_Job_Cd,                            Repair_Event_Cost_Fact.Apl_Qlfr_Cd, Repair_Event_Cost_Fact.Invc_Enty_Id, dbo.ETL_Error_Check_Lookup.Err_Desc, dbo.ETL_Run.Run_Dt,                            Repair_Event_Cost_Fact.Dq_Flg, dbo.ETL_Error_Check_Lookup.Tbl_Nm  FROM            dbo.ETL_Error_Check_Lookup INNER JOIN                           dbo.ETL_Error_Detail ON dbo.ETL_Error_Check_Lookup.Err_Chk_Id = dbo.ETL_Error_Detail.Err_Chk_Id INNER JOIN                           dbo.ETL_Run ON dbo.ETL_Error_Detail.Run_Id = dbo.ETL_Run.Run_Id INNER JOIN                           dbo.vw_Repair_Event_Cost_Fact Repair_Event_Cost_Fact ON dbo.ETL_Error_Detail.DDS_Ver = Repair_Event_Cost_Fact.Car_Ver AND                            dbo.ETL_Error_Detail.DDS_PK = Repair_Event_Cost_Fact.Car_Dimn_Id  WHERE        (Repair_Event_Cost_Fact.Dq_Flg = 1) AND (dbo.ETL_Error_Check_Lookup.Tbl_Nm = 'Repair_Entity_Dim') OR                           (dbo.ETL_Error_Check_Lookup.Tbl_Nm = 'Organization_Dim')"
    },
    {
      "id": "Condition_Code",
      "name": "Condition_Code",
      "type": "VIEW",
      "sql": "CREATE VIEW [sv].[Condition_Code](Cond_Cd_Dimn_Id,Condition_Code,Condition_Code_Description)  AS  SELECT VMRT_Condition_Code_Dimension.Cond_Cd_Dimn_Id,VMRT_Condition_Code_Dimension.Cnd_Cd,VMRT_Condition_Code_Dimension.Cnd_Cd_Desc   FROM DDSMRT.dbo.VMRT_Condition_Code_Dimension"
    },
    {
      "id": "VContainer_Fact",
      "name": "VContainer_Fact",
      "type": "VIEW",
      "sql": "CREATE VIEW [DDSV].[VContainer_Fact]  AS   SELECT   CAST(fact.[Container_Fact_ID] AS int) AS Container_Fact_ID,   CAST([Dt_Dimn_Id] AS int) AS Dt_Dimn_Id,   concat(convert(varchar(10),Rpt_Rd_Dimn_Id),'_',convert(varchar(5), Rpt_Rd_Ver)) as [Rpt_Rd_Dimn_Id],   concat(convert(varchar(10),Car_Dimn_Id),'_',convert(varchar(5), Car_Ver)) as [Car_Dimn_Id] ,   CAST([Stcc_Dimn_Id] AS int) AS Stcc_Dimn_Id,   CAST([Geo_Dimn_Id] AS int) AS Geo_Dimn_Id,   [Orig_Evnt_Dt] ,   [Rpt_Rd] ,   [Evnt_Loc_Splc] ,   [Car_Nr] ,   [Car_Init] ,   [Commodity_Cd] ,   [Cntr_Trl_Nr] ,   [Cntr_Trl_Pfx] ,   [Cntr_Trl_Wgt] ,   [Cntr_Trl_Wgt_Qlfy] ,   [Cntr_Trl_Eq_Typ] ,   [Cntr_Trl_Len] ,   [Cntr_Trl_Hgt] ,   [Cntr_Trl_Wdt] ,   [Cntr_Pos] ,   [Evnt_Typ] ,   [Recv_Dt] ,   [Train_Id] ,   [Inside_Pltfm_Len] ,   [Ownr_Mrk] ,   [Lese_Mrk] ,   [Ld_Lmt] ,   [Active_Sts] ,   [Crtd_Dt] ,   [Crtd_Id] ,   [Lst_Upd_Dt] ,   [Lst_Upd_Id] ,   [Cntr_Char_Dimn_Id],   [Cntr_Trl_Dimn_Id],   [Cntr_Wgt_Dimn_Id],   Event_End_Dt,   case when rownum=1 then Event_End_Dt else  PreviousEventEndDate end as PreviousEventEndDate,   case when rownum=1 then Getdate() else [Orig_Evnt_Dt] end as [Orig_Evnt_Date]   FROM ddsmrt.dbo.Container_fact FACT   LEFT JOIN   (Select container_fact_id,case when Evnt_Typ in ('AL','RM') then lag (Event_End_Dt) over (partition by cntr_trl_nr, cntr_trl_pfx   order by dt_dimn_id) end as PreviousEventEndDate, ROW_NUMBER() over (partition by cntr_trl_nr, cntr_trl_pfx order by dt_dimn_id desc) as rownum  from ddsmrt.dbo.Container_fact   where Evnt_Typ in ('AL','RM')) Con  on  Fact.container_fact_id=Con.Container_fact_id"
    },
    {
      "id": "Distribution_Entity",
      "name": "Distribution_Entity",
      "type": "VIEW",
      "sql": "CREATE VIEW [SV].[Distribution_Entity]    AS    SELECT      Org_Abrv,   Org_Nm,   Dist_Enty_Dimn_Id,    Dist_Enty_Ver,    Org_Dimn_Id,   Org_Ver,   Dist_Enty,   Apl_To_Trip_Ind   SCT_Ent_Ind,   TTX_Aprv_Ind,   Ld_Typ,   Act_Sts_Ind,   Eff_From,   Eff_to,   Src_Sys_Nm ,    Type,   lkp.DESCRIPTION       FROM [dbo].[VMRT_Distribution_Entity_Dimension] de   left join  (SELECT CODE,         DESCRIPTION  FROM HDSSUP..CODE  WHERE TYPE = 'distribution_entity_type' ) lkp on  de.Type=lkp.CODE"
    },
    {
      "id": "VMRT_Dashboard_Operating_Cost",
      "name": "VMRT_Dashboard_Operating_Cost",
      "type": "VIEW",
      "sql": "create view [dbo].[VMRT_Dashboard_Operating_Cost] as  select   op_dt  ,op_bus_Ln  ,op_Eq_typ  ,op_Eq_Featr  ,[Unscheduled_AAR]  ,[scheduled_AAR]  ,[Unscheduled_FMO]  ,[scheduled_FMO]  ,[Unscheduled_SHOP]  ,[scheduled_SHOP]  ,[scheduled_Unknown]  ,[Unscheduled_Unknown]  ,[Unknown_FMO]  ,[Unknown_AAR]  ,[Unknown_SHOP]  ,[Unknown_Unknown]  ,[ALL_AAR]  ,[ALL_FMO]  ,[ALL_SHOP]  ,[ALL_Unknown]  ,[Unscheduled_ALL]  ,[Scheduled_ALL]  ,[Unknown_ALL]  ,[ALL_ALL]  ,Dt  ,Bus_Ln  ,Eq_Typ  ,Eq_Featr  ,Fleet_Size_Car  ,Fleet_In_Service_Car  ,Fleet_Size_TPE  ,Fleet_In_Service_TPE  ,Fleet_Size_Ut  ,Fleet_In_Service_Ut  ,Fleet_Size_Pltfm  ,Fleet_In_Service_Pltfm     from  (SELECT                  Dt as op_dt, op_bus_Ln, op_Eq_typ, op_Eq_Featr                , [Unscheduled_AAR], [scheduled_AAR],[Unscheduled_FMO], [scheduled_FMO],[Unscheduled_SHOP]                , [scheduled_SHOP] , [scheduled_Unknown],[Unscheduled_Unknown],[Unknown_FMO],[Unknown_AAR], [Unknown_SHOP],[Unknown_Unknown]                 , (ISNULL([Unscheduled_AAR], 0) + ISNULL([scheduled_AAR], 0) + ISNULL([Unknown_AAR], 0)) as [ALL_AAR]                , (ISNULL([Unscheduled_FMO],0) + ISNULL([scheduled_FMO],0) + ISNULL([Unknown_FMO], 0)) as [ALL_FMO]                , (ISNULL([Unscheduled_SHOP],0)+ISNULL([scheduled_SHOP],0) +ISNULL([Unknown_SHOP],0)) as [ALL_SHOP]                , ([Unknown_Unknown]) as [ALL_Unknown]                , (ISNULL([Unscheduled_AAR],0)+ISNULL([Unscheduled_FMO],0)+ISNULL([Unscheduled_SHOP],0)+ISNULL([Unscheduled_Unknown],0)) as [Unscheduled_ALL]                , (ISNULL([scheduled_AAR],0)+ISNULL([scheduled_FMO],0)+ISNULL([scheduled_SHOP],0)+ISNULL([scheduled_Unknown],0)) as [Scheduled_ALL]                , (ISNULL([Unknown_FMO],0)+ISNULL([Unknown_AAR],0)+ISNULL([Unknown_SHOP],0)+ISNULL([Unknown_Unknown],0)) as [Unknown_ALL]                , (ISNULL([Unscheduled_AAR],0)+ ISNULL([scheduled_AAR],0)+ISNULL([Unscheduled_FMO],0)+ ISNULL([scheduled_FMO],0)+ISNULL([Unscheduled_SHOP],0)                   + ISNULL([scheduled_SHOP],0) + ISNULL([Unknown_FMO],0) + ISNULL([Unknown_AAR],0) + ISNULL([Unknown_Unknown],0) +  ISNULL([Unknown_SHOP],0)                   + ISNULL([scheduled_Unknown],0)+ ISNULL([Unscheduled_Unknown],0)) as [ALL_ALL]                                                                             FROM (                  select Dt, bus_Ln as op_bus_ln, Eq_typ as op_eq_typ, Eq_Featr as op_eq_featr, concat(isnull(Mnt_typ,'Unknown'),'_',isnull(Repr_Enty_Typ,'Unknown')) as P_col , Op_Cost                 from ddsmrt.dbo.Dashboard_Operating_Cost                where (src <> ('SEI') or src is null) and (Acct_Typ = 'M' or Acct_Typ is null)       and dt <= (select Max(dt) from ddsmrt.dbo.Dashboard_Operating_Cost where src = 'AAR')    -- closed month logic      ) p    PIVOT (           sum(Op_Cost) FOR P_col IN ( [Unscheduled_AAR], [scheduled_AAR],[Unscheduled_FMO], [scheduled_FMO],[Unscheduled_SHOP]                                                    , [scheduled_SHOP] , [Unknown_FMO],  [Unknown_AAR], [Unknown_Unknown],  [Unknown_SHOP] ,[scheduled_Unknown],[Unscheduled_Unknown])    ) pvt) a left join      (select     Dt,       Bus_Ln,       Eq_Typ,       Eq_Featr,       sum(ISNULL(Fleet_Size_Car,0)) as Fleet_Size_Car,       sum(ISNULL(Fleet_Size_Car,0))-(sum(ISNULL(Enroute_Car,0)) + sum(ISNULL(In_TTX_Shop_Car,0)) + sum(ISNULL(In_FMO_Car,0)) +  sum(ISNULL(In_Bad_Order_Storage_Car,0)) +  sum(ISNULL(In_Selective_Storage_Car,0)) +  sum(ISNULL(On_Online_Relief_Car,0)) +  sum(ISNULL(In_IRF_Car,0)) +  sum(ISNULL(On_Offline_Relief_Car,0))) as Fleet_In_Service_Car,         sum(ISNULL(Fleet_Size_TPE,0)) as Fleet_Size_TPE,       sum(ISNULL(Fleet_Size_TPE,0))-(sum(ISNULL(Enroute_TPE,0)) + sum(ISNULL(In_TTX_Shop_TPE,0)) + sum(ISNULL(In_FMO_TPE,0)) +  sum(ISNULL(In_Bad_Order_Storage_TPE,0)) +  sum(ISNULL(In_Selective_Storage_TPE,0)) +  sum(ISNULL(On_Online_Relief_TPE,0)) +  sum(ISNULL(In_IRF_TPE,0)) +  sum(ISNULL(On_Offline_Relief_TPE,0))) as Fleet_In_Service_TPE,         sum(ISNULL(Fleet_Size_Ut,0)) as Fleet_Size_Ut,       sum(ISNULL(Fleet_Size_Ut,0))-(sum(ISNULL(Enroute_Ut,0)) + sum(ISNULL(In_TTX_Shop_Ut,0)) + sum(ISNULL(In_FMO_Ut,0)) +  sum(ISNULL(In_Bad_Order_Storage_Ut,0)) +  sum(ISNULL(In_Selective_Storage_Ut,0)) +  sum(ISNULL(On_Online_Relief_Ut,0)) +  sum(ISNULL(In_IRF_Ut,0)) +  sum(ISNULL(On_Offline_Relief_Ut,0))) as Fleet_In_Service_Ut,         sum(ISNULL(Fleet_Size_Pltfm,0)) as Fleet_Size_Pltfm,       sum(ISNULL(Fleet_Size_Pltfm,0))-(sum(ISNULL(Enroute_Pltfm,0)) + sum(ISNULL(In_TTX_Shop_Pltfm,0)) + sum(ISNULL(In_FMO_Pltfm,0)) +  sum(ISNULL(In_Bad_Order_Storage_Pltfm,0)) +  sum(ISNULL(In_Selective_Storage_Pltfm,0)) +  sum(ISNULL(On_Online_Relief_Pltfm,0)) +  sum(ISNULL(In_IRF_Pltfm,0)) +  sum(ISNULL(On_Offline_Relief_Pltfm,0))) as Fleet_In_Service_Pltfm     from  (    SELECT  Dt     ,Bus_Ln     ,Eq_Typ     ,Eq_Featr            , case when car_cnt_typ= 'Fleet Size' then SUM([Car_Cnt]) end as Fleet_Size_Car     , case when car_cnt_typ= 'Enroute' then SUM([Car_Cnt]) end as Enroute_Car     , case when car_cnt_typ= 'In TTX Shop' then SUM([Car_Cnt]) end as In_TTX_Shop_Car     , case when car_cnt_typ= 'In FMO' then SUM([Car_Cnt]) end as In_FMO_Car     , case when car_cnt_typ= 'In Bad Order Storage' then SUM([Car_Cnt]) end as In_Bad_Order_Storage_Car     , case when car_cnt_typ= 'In Selective Storage' then SUM([Car_Cnt]) end as In_Selective_Storage_Car     , case when car_cnt_typ= 'On Online Relief' then SUM([Car_Cnt]) end as On_Online_Relief_Car     , case when car_cnt_typ= 'In IRF' then SUM([Car_Cnt]) end as In_IRF_Car     , case when car_cnt_typ= 'On Offline Relief' then SUM([Car_Cnt]) end as On_Offline_Relief_Car       , case when car_cnt_typ= 'Fleet Size' then SUM([TPE_Cnt]) end as Fleet_Size_TPE     , case when car_cnt_typ= 'Enroute' then SUM([TPE_Cnt]) end as Enroute_TPE     , case when car_cnt_typ= 'In TTX Shop' then SUM([TPE_Cnt]) end as In_TTX_Shop_TPE     , case when car_cnt_typ= 'In FMO' then SUM([TPE_Cnt]) end as In_FMO_TPE     , case when car_cnt_typ= 'In Bad Order Storage' then SUM([TPE_Cnt]) end as In_Bad_Order_Storage_TPE     , case when car_cnt_typ= 'In Selective Storage' then SUM([TPE_Cnt]) end as In_Selective_Storage_TPE     , case when car_cnt_typ= 'On Online Relief' then SUM([TPE_Cnt]) end as On_Online_Relief_TPE     , case when car_cnt_typ= 'In IRF' then SUM([TPE_Cnt]) end as In_IRF_TPE     , case when car_cnt_typ= 'On Offline Relief' then SUM([TPE_Cnt]) end as On_Offline_Relief_TPE       , case when car_cnt_typ= 'Fleet Size' then SUM([Ut_Cnt]) end as Fleet_Size_Ut     , case when car_cnt_typ= 'Enroute' then SUM([Ut_Cnt]) end as Enroute_Ut     , case when car_cnt_typ= 'In TTX Shop' then SUM([Ut_Cnt]) end as In_TTX_Shop_Ut     , case when car_cnt_typ= 'In FMO' then SUM([Ut_Cnt]) end as In_FMO_Ut     , case when car_cnt_typ= 'In Bad Order Storage' then SUM([Ut_Cnt]) end as In_Bad_Order_Storage_Ut     , case when car_cnt_typ= 'In Selective Storage' then SUM([Ut_Cnt]) end as In_Selective_Storage_Ut     , case when car_cnt_typ= 'On Online Relief' then SUM([Ut_Cnt]) end as On_Online_Relief_Ut     , case when car_cnt_typ= 'In IRF' then SUM([Ut_Cnt]) end as In_IRF_Ut     , case when car_cnt_typ= 'On Offline Relief' then SUM([Ut_Cnt]) end as On_Offline_Relief_Ut       , case when car_cnt_typ= 'Fleet Size' then SUM([Pltfm_Cnt]) end as Fleet_Size_Pltfm     , case when car_cnt_typ= 'Enroute' then SUM([Pltfm_Cnt]) end as Enroute_Pltfm     , case when car_cnt_typ= 'In TTX Shop' then SUM([Pltfm_Cnt]) end as In_TTX_Shop_Pltfm     , case when car_cnt_typ= 'In FMO' then SUM([Pltfm_Cnt]) end as In_FMO_Pltfm     , case when car_cnt_typ= 'In Bad Order Storage' then SUM([Pltfm_Cnt]) end as In_Bad_Order_Storage_Pltfm     , case when car_cnt_typ= 'In Selective Storage' then SUM([Pltfm_Cnt]) end as In_Selective_Storage_Pltfm     , case when car_cnt_typ= 'On Online Relief' then SUM([Pltfm_Cnt]) end as On_Online_Relief_Pltfm     , case when car_cnt_typ= 'In IRF' then SUM([Pltfm_Cnt]) end as In_IRF_Pltfm     , case when car_cnt_typ= 'On Offline Relief' then SUM([Pltfm_Cnt]) end as On_Offline_Relief_Pltfm      FROM [DDSMRT].[dbo].[Dashboard_Fleet_In_Service]  group by Dt, Car_Cnt_Typ, Bus_Ln, Eq_Typ, Eq_Featr    ) a    group by Dt, Bus_Ln, Eq_Typ, Eq_Featr ) b    on a.op_bus_ln = b.bus_ln and a.op_dt=b.dt and a.op_Eq_Featr = b.Eq_Featr and a.op_Eq_Typ = b.Eq_Typ"
    },
    {
      "id": "VMRT_Car_Hierarchy_Enterprise",
      "name": "VMRT_Car_Hierarchy_Enterprise",
      "type": "VIEW",
      "sql": "CREATE VIEW [dbo].[VMRT_Car_Hierarchy_Enterprise]  WITH SCHEMABINDING  as  SELECT    [Hierchy_Id]   ,[Hierchy_Ver]  ,convert(varchar(25),[Lvl1_Desc]) as bus_Ln_Shrt_Desc  ,cast(Lvl1_Nm as int) as Bus_Ln_Id  ,convert(varchar(50),[Lvl2_Desc]) as [Eq_Typ_Shrt_Desc]  ,cast(Lvl2_Nm as int) as Eq_Typ_Id  ,convert(varchar(50),[Lvl3_Desc]) as [Eq_Featr_Shrt_Desc]  ,cast(Lvl3_Nm as int) as Eq_Featr_Id  ,cast([Lvl4_Nm] as int) as [Stat_Cd]  ,cast([Attr1_Val_Num] as decimal(5,2)) as [Car_Hrly_Rt]  ,cast([Attr2_Val_Num] as decimal(5,2)) as [Est_Car_Hrly_Rate]  ,cast([Attr3_Val_Num] as decimal(18,1)) as [Daily_Miles]  ,cast([Attr4_Val_Num] as decimal(5,3)) as [Milg_Rt]  ,convert(datetime, [Attr5_Val_Char] ) as [Stat_Cd_Eff_Strt_Dt]  ,convert(datetime, [Attr6_Val_Char] ) as [Stat_Cd_Eff_End_Dt]  ,convert(varchar(20), attr7_val_Char ) as [Car_Rpt_Mrk]    ,CASE        WHEN cast([Lvl4_Nm] as int)  BETWEEN 1 AND 99 THEN 'Intermodal Cars'                      WHEN cast([Lvl4_Nm] as int)  BETWEEN 100 AND 299 THEN 'General Use Cars'                      WHEN cast([Lvl4_Nm] as int)  BETWEEN 300 AND 399 THEN 'Intermodal Cars'                      WHEN cast([Lvl4_Nm] as int)  BETWEEN 400 AND 499 THEN 'Rack Cars'                      WHEN cast([Lvl4_Nm] as int)  BETWEEN 500 AND 599 THEN 'General Use Cars'                      WHEN cast([Lvl4_Nm] as int)  > 599 THEN 'Not Available'                 END as [Fleet_Type]  ,[Attr8_Val_Char] as [Rack_Type]  ,[Attr9_Val_Num] as TPE_Fctr  ,[Attr8_Val_Num] as Milg_Rt_Whl_Schg  ,[Attr7_Val_Num] as Ut_Cnt  ,eff_from  , eff_to  , crtd_id  ,crtd_dt  ,lst_upd_id  ,lst_upd_dt   FROM dbo.[Hierarchy_Dim] (NOLOCK)    WHERE [Hierchy_Typ_Id]=101"
    },
    {
      "id": "sp_BlitzIndex",
      "name": "sp_BlitzIndex",
      "type": "SQL_STORED_PROCEDURE",
      "sql": "CREATE PROCEDURE [dbo].[sp_BlitzIndex]   @DatabaseName NVARCHAR(128) = null, /*Defaults to current DB if not specified*/   @Mode tinyint=0, /*0=diagnose, 1=Summarize, 2=Index Usage Detail, 3=Missing Index Detail*/   @SchemaName NVARCHAR(128) = NULL, /*Requires table_name as well.*/   @TableName NVARCHAR(128) = NULL,  /*Requires schema_name as well.*/    /*Note:@Mode doesn't matter if you're specifying schema_name and @TableName.*/   @Filter tinyint = 0 /* 0=no filter (default). 1=No low-usage warnings for objects with 0 reads. 2=Only warn for objects >= 500MB */    /*Note:@Filter doesn't do anything unless @Mode=0*/  /*  sp_BlitzIndex(TM) v2.02 - Jan 30, 2014    (C) 2014, Brent Ozar Unlimited(TM).   See http://BrentOzar.com/go/eula for the End User Licensing Agreement.    For help and how-to info, visit http://www.BrentOzar.com/BlitzIndex    How to use:  -- Diagnose:    EXEC dbo.sp_BlitzIndex @DatabaseName='AdventureWorks';  -- Return detail for a specific table:    EXEC dbo.sp_BlitzIndex @DatabaseName='AdventureWorks', @SchemaName='Person', @TableName='Person';    Known limitations of this version:   - Does not include FULLTEXT indexes. (A possibility in the future, let us know if you're interested.)   - Index create statements are just to give you a rough idea of the syntax. It includes filters and fillfactor.   --  Example 1: index creates use ONLINE=? instead of ONLINE=ON / ONLINE=OFF. This is because it's important for the user to understand if it's going to be offline and not just run a script.   --  Example 2: they do not include all the options the index may have been created with (padding, compression filegroup/partition scheme etc.)   --  (The compression and filegroup index create syntax isn't trivial because it's set at the partition level and isn't trivial to code. Two people have voted for wanting it so far.)   - Doesn't advise you about data modeling for clustered indexes and primary keys (primarily looks for signs of insanity.)   - Found something? Let us know at help@brentozar.com.     Thanks for using sp_BlitzIndex(TM)!   Sincerely,   The Humans of Brent Ozar Unlimited(TM)    CHANGE LOG (last five versions):   Jan 30, 2014 (v2.02)    Standardized calling parameters with sp_AskBrent(TM) and sp_BlitzIndex(TM). (@DatabaseName instead of @database_name, etc)    Added check_id 80 and 81-- what appear to be the most frequently used indexes (workaholics)    Added index_operational_stats info to table level output -- recent scans vs lookups    Broke index_usage_stats output into two categories, scans and lookups (also in table level output)    Changed db name, table name, index name to 128 length    Fixed findings_group column length in #BlitzIndexResults (fixed issues for users w/ longer db names)    Fixed issue where identities nearing end of range were only detected if the check was run with a specific db context     Fixed extra tab in @SchemaName= that made pasting into Excel awkward/wrong    Added abnormal psychology check for clustered columnstore indexes (and general support for detecting them)    Standardized underscores in create TSQL for missing indexes    Better error message when running in table mode and the table isn't found.    Added current timestamp to the header based on user request. (Didn't add startup time-- sorry! Too many things reset usage info, don't want to mislead anyone.)    Added fillfactor to index create statements.    Changed all index create statements to ONLINE=?, SORT_IN_TEMPDB=?. The user should decide at index create time what's right for them.   May 26, 2013 (v2.01)    Added check_id 28: Non-unqiue clustered indexes. (This should have been checked in for an earlier version, it slipped by).   May 14, 2013 (v2.0) - Added data types and max length to all columns (keys, includes, secret columns)    Set sp_blitz to default to current DB if database_name is not specified when called    Added @Filter:       0=no filter (default)     1=Don't throw low-usage warnings for objects with 0 reads (helpful for dev/non-production environments)     2=Only report on objects >= 250MB (helps focus on larger indexes). Still runs a few database-wide checks as well.    Added list of all columns and types in table for runs using: @DatabaseName, @SchemaName, @TableName    Added count of total number of indexes a column is part of.    Added check_id 25: Addicted to nullable columns. (All or all but one column is nullable.)    Added check_id 66 and 67 to flag tables/indexes created within 1 week or modified within 48 hours.    Added check_id 26: Wide tables (35+ cols or > 2000 non-LOB bytes).    Added check_id 27: Addicted to strings. Looks for tables with 4 or more columns, of which all or all but one are string or LOB types.    Added check_id 68: Identity columns within 30% of the end of range (tinyint, smallint, int) AND     Negative identity seeds or identity increments <> 1    Added check_id 69: Column collation does not match database collation    Added check_id 70: Replicated columns. This identifies which columns are in at least one replication publication.    Added check_id 71: Cascading updates or cascading deletes.    Split check_id 40 into two checks: fillfactor on nonclustered indexes < 80%, fillfactor on clustered indexes < 90%    Added check_id 33: Potential filtered indexes based on column names.    Fixed bug where you couldn't see detailed view for indexed views.      (Ex: EXEC dbo.sp_BlitzIndex @DatabaseName='AdventureWorks', @SchemaName='Production', @TableName='vProductAndDescription';)    Added four index usage columns to table detail output: last_user_seek, last_user_scan, last_user_lookup, last_user_update    Modified check_id 24. This now looks for wide clustered indexes (> 3 columns OR > 16 bytes).     Previously just simplistically looked for multiple column CX.    Removed extra spacing (non-breaking) in more_info column.    Fixed bug where create t-sql didn't include filter (for filtered indexes)    Fixed formatting bug where \"magic number\" in table detail view didn't have commas    Neatened up column names in result sets.   April 8, 2013 (v1.5) - Fixed breaking bug for partitioned tables with > 10(ish) partitions    Added schema_name to suggested create statement for PKs    Handled \"magic_benefit_number\" values for missing indexes >= 922,337,203,685,477    Added count of NC indexes to Index Hoarder: Multi-column clustered index finding    Added link to EULA    Simplified aggressive index checks (blocking). Multiple checks confused people more than it helped.     Left only \"Total lock wait time > 5 minutes (row + page)\".    Added CheckId 25 for non-unique clustered indexes.     The \"Create TSQL\" column now shows a commented out drop command for disabled non-clustered indexes    Updated query which joins to sys.dm_operational_stats DMV when running against 2012 for performance reasons   December 20, 2012 (v1.4) - Fixed bugs for instances using a case-sensitive collation    Added support to identify compressed indexes    Added basic support for columnstore, XML, and spatial indexes    Added \"Abnormal Psychology\" diagnosis to alert you to special index types in a database    Removed hypothetical indexes and disabled indexes from \"multiple personality disorders\"    Fixed bug where hypothetical indexes weren't showing up in \"self-loathing indexes\"    Fixed bug where the partitioning key column was displayed in the key of aligned nonclustered indexes on partitioned tables    Added set options to the script so procedure is created with required settings for its use of computed columns    */  AS     SET NOCOUNT ON;  SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;      DECLARE @DatabaseID INT;  DECLARE @ObjectID INT;  DECLARE @dsql NVARCHAR(MAX);  DECLARE @params NVARCHAR(MAX);  DECLARE @msg NVARCHAR(4000);  DECLARE @ErrorSeverity INT;  DECLARE @ErrorState INT;  DECLARE @Rowcount BIGINT;  DECLARE @SQLServerProductVersion NVARCHAR(128);  DECLARE @SQLServerEdition INT;  DECLARE @FilterMB INT;  DECLARE @collation NVARCHAR(256);      SELECT @SQLServerProductVersion = CAST(SERVERPROPERTY('ProductVersion') AS NVARCHAR(128));  SELECT @SQLServerEdition =CAST(SERVERPROPERTY('EngineEdition') AS INT); /* We default to online index creates where EngineEdition=3*/  SET @FilterMB=250;    IF @DatabaseName is null    SET @DatabaseName=DB_NAME();    SELECT @DatabaseID = database_id  FROM sys.databases  WHERE [name] = @DatabaseName   AND user_access_desc='MULTI_USER'   AND state_desc = 'ONLINE';    ----------------------------------------  --STEP 1: OBSERVE THE PATIENT  --This step puts index information into temp tables.  ----------------------------------------  BEGIN TRY   BEGIN      --Validate SQL Server Verson      IF (SELECT LEFT(@SQLServerProductVersion,       CHARINDEX('.',@SQLServerProductVersion,0)-1       )) <= 8    BEGIN     SET @msg=N'sp_BlitzIndex is only supported on SQL Server 2005 and higher. The version of this instance is: ' + @SQLServerProductVersion;     RAISERROR(@msg,16,1);    END      --Short circuit here if database name does not exist.    IF @DatabaseName IS NULL OR @DatabaseID IS NULL    BEGIN     SET @msg='Database does not exist or is not online/multi-user: cannot proceed.'     RAISERROR(@msg,16,1);    END          --Validate parameters.    IF (@Mode NOT IN (0,1,2,3))    BEGIN     SET @msg=N'Invalid @Mode parameter. 0=diagnose, 1=summarize, 2=index detail, 3=missing index detail';     RAISERROR(@msg,16,1);    END      IF (@Mode <> 0 AND @TableName IS NOT NULL)    BEGIN     SET @msg=N'Setting the @Mode doesn''t change behavior if you supply @TableName. Use default @Mode=0 to see table detail.';     RAISERROR(@msg,16,1);    END      IF ((@Mode <> 0 OR @TableName IS NOT NULL) and @Filter <> 0)    BEGIN     SET @msg=N'@Filter only appies when @Mode=0 and @TableName is not specified. Please try again.';     RAISERROR(@msg,16,1);    END      IF (@SchemaName IS NOT NULL AND @TableName IS NULL)     BEGIN     SET @msg='We can''t run against a whole schema! Specify a @TableName, or leave both NULL for diagnosis.'     RAISERROR(@msg,16,1);    END        IF  (@TableName IS NOT NULL AND @SchemaName IS NULL)    BEGIN     SET @SchemaName=N'dbo'     SET @msg='@SchemaName wasn''t specified-- assuming schema=dbo.'     RAISERROR(@msg,1,1) WITH NOWAIT;    END      --If a table is specified, grab the object id.    --Short circuit if it doesn't exist.    IF @TableName IS NOT NULL    BEGIN     SET @dsql = N'       SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;       SELECT @ObjectID= OBJECT_ID       FROM ' + QUOTENAME(@DatabaseName) + N'.sys.objects AS so       JOIN ' + QUOTENAME(@DatabaseName) + N'.sys.schemas AS sc on         so.schema_id=sc.schema_id       where so.type in (''U'', ''V'')       and so.name=' + QUOTENAME(@TableName,'''')+ N'       and sc.name=' + QUOTENAME(@SchemaName,'''')+ N'       /*Has a row in sys.indexes. This lets us get indexed views.*/       and exists (        SELECT si.name        FROM ' + QUOTENAME(@DatabaseName) + '.sys.indexes AS si         WHERE so.object_id=si.object_id)       OPTION (RECOMPILE);';       SET @params='@ObjectID INT OUTPUT'           IF @dsql IS NULL       RAISERROR('@dsql is null',16,1);       EXEC sp_executesql @dsql, @params, @ObjectID=@ObjectID OUTPUT;          IF @ObjectID IS NULL       BEGIN        SET @msg=N'Oh, this is awkward. I can''t find the table or indexed view you''re looking for in that database.' + CHAR(10) +         N'Please check your parameters.'        RAISERROR(@msg,1,1);        RETURN;       END    END      RAISERROR(N'Starting run. sp_BlitzIndex(TM) v2.02 - Jan 30, 2014', 0,1) WITH NOWAIT;      IF OBJECT_ID('tempdb..#IndexSanity') IS NOT NULL      DROP TABLE #IndexSanity;      IF OBJECT_ID('tempdb..#IndexPartitionSanity') IS NOT NULL      DROP TABLE #IndexPartitionSanity;      IF OBJECT_ID('tempdb..#IndexSanitySize') IS NOT NULL      DROP TABLE #IndexSanitySize;      IF OBJECT_ID('tempdb..#IndexColumns') IS NOT NULL      DROP TABLE #IndexColumns;      IF OBJECT_ID('tempdb..#MissingIndexes') IS NOT NULL      DROP TABLE #MissingIndexes;      IF OBJECT_ID('tempdb..#ForeignKeys') IS NOT NULL      DROP TABLE #ForeignKeys;      IF OBJECT_ID('tempdb..#BlitzIndexResults') IS NOT NULL      DROP TABLE #BlitzIndexResults;        IF OBJECT_ID('tempdb..#IndexCreateTsql') IS NOT NULL      DROP TABLE #IndexCreateTsql;      RAISERROR (N'Create temp tables.',0,1) WITH NOWAIT;    CREATE TABLE #BlitzIndexResults     (       blitz_result_id INT IDENTITY PRIMARY KEY,       check_id INT NOT NULL,       index_sanity_id INT NULL,       findings_group VARCHAR(4000) NOT NULL,       finding VARCHAR(200) NOT NULL,       URL VARCHAR(200) NOT NULL,       details NVARCHAR(4000) NOT NULL,       index_definition NVARCHAR(MAX) NOT NULL,       secret_columns NVARCHAR(MAX) NULL,       index_usage_summary NVARCHAR(MAX) NULL,       index_size_summary NVARCHAR(MAX) NULL,       create_tsql NVARCHAR(MAX) NULL,       more_info NVARCHAR(MAX)NULL     );      CREATE TABLE #IndexSanity     (       [index_sanity_id] INT IDENTITY PRIMARY KEY,       [database_id] SMALLINT NOT NULL ,       [object_id] INT NOT NULL ,       [index_id] INT NOT NULL ,       [index_type] TINYINT NOT NULL,       [database_name] NVARCHAR(128) NOT NULL ,       [schema_name] NVARCHAR(128) NOT NULL ,       [object_name] NVARCHAR(128) NOT NULL ,       index_name NVARCHAR(128) NULL ,       key_column_names NVARCHAR(MAX) NULL ,       key_column_names_with_sort_order NVARCHAR(MAX) NULL ,       key_column_names_with_sort_order_no_types NVARCHAR(MAX) NULL ,       count_key_columns INT NULL ,       include_column_names NVARCHAR(MAX) NULL ,       include_column_names_no_types NVARCHAR(MAX) NULL ,       count_included_columns INT NULL ,       partition_key_column_name NVARCHAR(MAX) NULL,       filter_definition NVARCHAR(MAX) NOT NULL ,       is_indexed_view BIT NOT NULL ,       is_unique BIT NOT NULL ,       is_primary_key BIT NOT NULL ,       is_XML BIT NOT NULL,       is_spatial BIT NOT NULL,       is_NC_columnstore BIT NOT NULL,       is_CX_columnstore BIT NOT NULL,       is_disabled BIT NOT NULL ,       is_hypothetical BIT NOT NULL ,       is_padded BIT NOT NULL ,       fill_factor SMALLINT NOT NULL ,       user_seeks BIGINT NOT NULL ,       user_scans BIGINT NOT NULL ,       user_lookups BIGINT NOT  NULL ,       user_updates BIGINT NULL ,       last_user_seek DATETIME NULL ,       last_user_scan DATETIME NULL ,       last_user_lookup DATETIME NULL ,       last_user_update DATETIME NULL ,       is_referenced_by_foreign_key BIT DEFAULT(0),       secret_columns NVARCHAR(MAX) NULL,       count_secret_columns INT NULL,       create_date DATETIME NOT NULL,       modify_date DATETIME NOT NULL     );       CREATE TABLE #IndexPartitionSanity     (       [index_partition_sanity_id] INT IDENTITY PRIMARY KEY ,       [index_sanity_id] INT NULL ,       [object_id] INT NOT NULL ,       [index_id] INT NOT NULL ,       [partition_number] INT NOT NULL ,       row_count BIGINT NOT NULL ,       reserved_MB NUMERIC(29,2) NOT NULL ,       reserved_LOB_MB NUMERIC(29,2) NOT NULL ,       reserved_row_overflow_MB NUMERIC(29,2) NOT NULL ,       leaf_insert_count BIGINT NULL ,       leaf_delete_count BIGINT NULL ,       leaf_update_count BIGINT NULL ,       range_scan_count BIGINT NULL ,       singleton_lookup_count BIGINT NULL ,        forwarded_fetch_count BIGINT NULL ,       lob_fetch_in_pages BIGINT NULL ,       lob_fetch_in_bytes BIGINT NULL ,       row_overflow_fetch_in_pages BIGINT NULL ,       row_overflow_fetch_in_bytes BIGINT NULL ,       row_lock_count BIGINT NULL ,       row_lock_wait_count BIGINT NULL ,       row_lock_wait_in_ms BIGINT NULL ,       page_lock_count BIGINT NULL ,       page_lock_wait_count BIGINT NULL ,       page_lock_wait_in_ms BIGINT NULL ,       index_lock_promotion_attempt_count BIGINT NULL ,       index_lock_promotion_count BIGINT NULL,         data_compression_desc VARCHAR(60) NULL     );      CREATE TABLE #IndexSanitySize     (       [index_sanity_size_id] INT IDENTITY NOT NULL ,       [index_sanity_id] INT NOT NULL ,       partition_count INT NOT NULL ,       total_rows BIGINT NOT NULL ,       total_reserved_MB NUMERIC(29,2) NOT NULL ,       total_reserved_LOB_MB NUMERIC(29,2) NOT NULL ,       total_reserved_row_overflow_MB NUMERIC(29,2) NOT NULL ,       total_leaf_delete_count BIGINT NULL,       total_leaf_update_count BIGINT NULL,       total_range_scan_count BIGINT NULL,       total_singleton_lookup_count BIGINT NULL,       total_forwarded_fetch_count BIGINT NULL,       total_row_lock_count BIGINT NULL ,       total_row_lock_wait_count BIGINT NULL ,       total_row_lock_wait_in_ms BIGINT NULL ,       avg_row_lock_wait_in_ms BIGINT NULL ,       total_page_lock_count BIGINT NULL ,       total_page_lock_wait_count BIGINT NULL ,       total_page_lock_wait_in_ms BIGINT NULL ,       avg_page_lock_wait_in_ms BIGINT NULL ,        total_index_lock_promotion_attempt_count BIGINT NULL ,       total_index_lock_promotion_count BIGINT NULL ,       data_compression_desc VARCHAR(8000) NULL     );      CREATE TABLE #IndexColumns     (       [object_id] INT NOT NULL ,       [index_id] INT NOT NULL ,       [key_ordinal] INT NULL ,       is_included_column BIT NULL ,       is_descending_key BIT NULL ,       [partition_ordinal] INT NULL ,       column_name NVARCHAR(256) NOT NULL ,       system_type_name NVARCHAR(256) NOT NULL,       max_length SMALLINT NOT NULL,       [precision] TINYINT NOT NULL,       [scale] TINYINT NOT NULL,       collation_name NVARCHAR(256) NULL,       is_nullable bit NULL,       is_identity bit NULL,       is_computed bit NULL,       is_replicated bit NULL,       is_sparse bit NULL,       is_filestream bit NULL,       seed_value BIGINT NULL,       increment_value INT NULL ,       last_value BIGINT NULL,       is_not_for_replication BIT NULL     );      CREATE TABLE #MissingIndexes     ([object_id] INT NOT NULL,     [database_name] NVARCHAR(128) NOT NULL ,     [schema_name] NVARCHAR(128) NOT NULL ,     [table_name] NVARCHAR(128),     [statement] NVARCHAR(512) NOT NULL,     magic_benefit_number AS (( user_seeks + user_scans ) * avg_total_user_cost * avg_user_impact),     avg_total_user_cost NUMERIC(29,1) NOT NULL,     avg_user_impact NUMERIC(29,1) NOT NULL,     user_seeks BIGINT NOT NULL,     user_scans BIGINT NOT NULL,     unique_compiles BIGINT NULL,     equality_columns NVARCHAR(4000),      inequality_columns NVARCHAR(4000),     included_columns NVARCHAR(4000)     );      CREATE TABLE #ForeignKeys (     foreign_key_name NVARCHAR(256),     parent_object_id INT,     parent_object_name NVARCHAR(256),     referenced_object_id INT,     referenced_object_name NVARCHAR(256),     is_disabled BIT,     is_not_trusted BIT,     is_not_for_replication BIT,     parent_fk_columns NVARCHAR(MAX),     referenced_fk_columns NVARCHAR(MAX),     update_referential_action_desc NVARCHAR(16),     delete_referential_action_desc NVARCHAR(60)    )        CREATE TABLE #IndexCreateTsql (     index_sanity_id INT NOT NULL,     create_tsql NVARCHAR(MAX) NOT NULL    )      --set @collation    SELECT @collation=collation_name    FROM sys.databases    where database_id=@DatabaseID;      --insert columns for clustered indexes and heaps    --collect info on identity columns for this one    SET @dsql = N'SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;      SELECT        si.object_id,        si.index_id,        sc.key_ordinal,        sc.is_included_column,        sc.is_descending_key,       sc.partition_ordinal,       c.name as column_name,        st.name as system_type_name,       c.max_length,       c.[precision],       c.[scale],       c.collation_name,       c.is_nullable,       c.is_identity,       c.is_computed,       c.is_replicated,       ' + case when @SQLServerProductVersion not like '9%' THEN N'c.is_sparse' else N'NULL as is_sparse' END + N',       ' + case when @SQLServerProductVersion not like '9%' THEN N'c.is_filestream' else N'NULL as is_filestream' END + N',       CAST(ic.seed_value AS BIGINT),       CAST(ic.increment_value AS INT),       CAST(ic.last_value AS BIGINT),       ic.is_not_for_replication      FROM ' + QUOTENAME(@DatabaseName) + N'.sys.indexes si      JOIN ' + QUOTENAME(@DatabaseName) + N'.sys.columns c ON       si.object_id=c.object_id      LEFT JOIN ' + QUOTENAME(@DatabaseName) + N'.sys.index_columns sc ON        sc.object_id = si.object_id       and sc.index_id=si.index_id       AND sc.column_id=c.column_id      LEFT JOIN ' + QUOTENAME(@DatabaseName) + N'.sys.identity_columns ic ON       c.object_id=ic.object_id and       c.column_id=ic.column_id      JOIN ' + QUOTENAME(@DatabaseName) + N'.sys.types st ON        c.system_type_id=st.system_type_id       AND c.user_type_id=st.user_type_id      WHERE si.index_id in (0,1) '        + CASE WHEN @ObjectID IS NOT NULL         THEN N' AND si.object_id=' + CAST(@ObjectID AS NVARCHAR(30))        ELSE N'' END       + N';';      IF @dsql IS NULL      RAISERROR('@dsql is null',16,1);      RAISERROR (N'Inserting data into #IndexColumns for clustered indexes and heaps',0,1) WITH NOWAIT;    INSERT #IndexColumns ( object_id, index_id, key_ordinal, is_included_column, is_descending_key, partition_ordinal,     column_name, system_type_name, max_length, precision, scale, collation_name, is_nullable, is_identity, is_computed,     is_replicated, is_sparse, is_filestream, seed_value, increment_value, last_value, is_not_for_replication )      EXEC sp_executesql @dsql;      --insert columns for nonclustered indexes    --this uses a full join to sys.index_columns    --We don't collect info on identity columns here. They may be in NC indexes, but we just analyze identities in the base table.    SET @dsql = N'SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;      SELECT        si.object_id,        si.index_id,        sc.key_ordinal,        sc.is_included_column,        sc.is_descending_key,       sc.partition_ordinal,       c.name as column_name,        st.name as system_type_name,       c.max_length,       c.[precision],       c.[scale],       c.collation_name,       c.is_nullable,       c.is_identity,       c.is_computed,       c.is_replicated,       ' + case when @SQLServerProductVersion not like '9%' THEN N'c.is_sparse' else N'NULL AS is_sparse' END + N',       ' + case when @SQLServerProductVersion not like '9%' THEN N'c.is_filestream' else N'NULL AS is_filestream' END + N'          FROM ' + QUOTENAME(@DatabaseName) + N'.sys.indexes AS si      JOIN ' + QUOTENAME(@DatabaseName) + N'.sys.columns AS c ON       si.object_id=c.object_id      JOIN ' + QUOTENAME(@DatabaseName) + N'.sys.index_columns AS sc ON        sc.object_id = si.object_id       and sc.index_id=si.index_id       AND sc.column_id=c.column_id      JOIN ' + QUOTENAME(@DatabaseName) + N'.sys.types AS st ON        c.system_type_id=st.system_type_id       AND c.user_type_id=st.user_type_id      WHERE si.index_id not in (0,1) '        + CASE WHEN @ObjectID IS NOT NULL         THEN N' AND si.object_id=' + CAST(@ObjectID AS NVARCHAR(30))        ELSE N'' END       + N';';      IF @dsql IS NULL      RAISERROR('@dsql is null',16,1);      RAISERROR (N'Inserting data into #IndexColumns for nonclustered indexes',0,1) WITH NOWAIT;    INSERT #IndexColumns ( object_id, index_id, key_ordinal, is_included_column, is_descending_key, partition_ordinal,     column_name, system_type_name, max_length, precision, scale, collation_name, is_nullable, is_identity, is_computed,     is_replicated, is_sparse, is_filestream )      EXEC sp_executesql @dsql;           SET @dsql = N'SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;      SELECT ' + CAST(@DatabaseID AS NVARCHAR(10)) + ' AS database_id,         so.object_id,         si.index_id,         si.type,        ' + QUOTENAME(@DatabaseName, '''') + ' AS database_name,         sc.NAME AS [schema_name],        so.name AS [object_name],         si.name AS [index_name],        CASE WHEN so.[type] = CAST(''V'' AS CHAR(2)) THEN 1 ELSE 0 END,         si.is_unique,         si.is_primary_key,         CASE when si.type = 3 THEN 1 ELSE 0 END AS is_XML,        CASE when si.type = 4 THEN 1 ELSE 0 END AS is_spatial,        CASE when si.type = 6 THEN 1 ELSE 0 END AS is_NC_columnstore,        CASE when si.type = 5 then 1 else 0 end as is_CX_columnstore,        si.is_disabled,        si.is_hypothetical,         si.is_padded,         si.fill_factor,'        + case when @SQLServerProductVersion not like '9%' THEN '        CASE WHEN si.filter_definition IS NOT NULL THEN si.filter_definition          ELSE ''''        END AS filter_definition' ELSE ''''' AS filter_definition' END + '        , ISNULL(us.user_seeks, 0), ISNULL(us.user_scans, 0),        ISNULL(us.user_lookups, 0), ISNULL(us.user_updates, 0), us.last_user_seek, us.last_user_scan,        us.last_user_lookup, us.last_user_update,        so.create_date, so.modify_date      FROM ' + QUOTENAME(@DatabaseName) + '.sys.indexes AS si WITH (NOLOCK)        JOIN ' + QUOTENAME(@DatabaseName) + '.sys.objects AS so WITH (NOLOCK) ON si.object_id = so.object_id                AND so.is_ms_shipped = 0 /*Exclude objects shipped by Microsoft*/                AND so.type <> ''TF'' /*Exclude table valued functions*/        JOIN ' + QUOTENAME(@DatabaseName) + '.sys.schemas sc ON so.schema_id = sc.schema_id        LEFT JOIN sys.dm_db_index_usage_stats AS us WITH (NOLOCK) ON si.[object_id] = us.[object_id]                      AND si.index_id = us.index_id                      AND us.database_id = '+ CAST(@DatabaseID AS NVARCHAR(10)) + '      WHERE si.[type] IN ( 0, 1, 2, 3, 4, 5, 6 )       /* Heaps, clustered, nonclustered, XML, spatial, Cluster Columnstore, NC Columnstore */ ' +      CASE WHEN @TableName IS NOT NULL THEN ' and so.name=' + QUOTENAME(@TableName,'''') + ' ' ELSE '' END +     'OPTION ( RECOMPILE );    ';    IF @dsql IS NULL      RAISERROR('@dsql is null',16,1);      RAISERROR (N'Inserting data into #IndexSanity',0,1) WITH NOWAIT;    INSERT #IndexSanity ( [database_id], [object_id], [index_id], [index_type], [database_name], [schema_name], [object_name],          index_name, is_indexed_view, is_unique, is_primary_key, is_XML, is_spatial, is_NC_columnstore, is_CX_columnstore,          is_disabled, is_hypothetical, is_padded, fill_factor, filter_definition, user_seeks, user_scans,           user_lookups, user_updates, last_user_seek, last_user_scan, last_user_lookup, last_user_update,          create_date, modify_date )      EXEC sp_executesql @dsql;      RAISERROR (N'Updating #IndexSanity.key_column_names',0,1) WITH NOWAIT;    UPDATE #IndexSanity    SET  key_column_names = D1.key_column_names    FROM #IndexSanity si      CROSS APPLY ( SELECT RTRIM(STUFF( (SELECT N', ' + c.column_name            + N' {' + system_type_name + N' ' + CAST(max_length AS NVARCHAR(50)) +  N'}'            AS col_definition           FROM #IndexColumns c           WHERE c.object_id = si.object_id             AND c.index_id = si.index_id             AND c.is_included_column = 0 /*Just Keys*/             AND c.key_ordinal > 0 /*Ignore non-key columns, such as partitioning keys*/           ORDER BY c.object_id, c.index_id, c.key_ordinal          FOR   XML PATH('') ,TYPE).value('.', 'varchar(max)'), 1, 1, ''))            ) D1 ( key_column_names )      RAISERROR (N'Updating #IndexSanity.partition_key_column_name',0,1) WITH NOWAIT;    UPDATE #IndexSanity    SET  partition_key_column_name = D1.partition_key_column_name    FROM #IndexSanity si      CROSS APPLY ( SELECT RTRIM(STUFF( (SELECT N', ' + c.column_name AS col_definition           FROM #IndexColumns c           WHERE c.object_id = si.object_id             AND c.index_id = si.index_id             AND c.partition_ordinal <> 0 /*Just Partitioned Keys*/           ORDER BY c.object_id, c.index_id, c.key_ordinal          FOR   XML PATH('') , TYPE).value('.', 'varchar(max)'), 1, 1,''))) D1             ( partition_key_column_name )      RAISERROR (N'Updating #IndexSanity.key_column_names_with_sort_order',0,1) WITH NOWAIT;    UPDATE #IndexSanity    SET  key_column_names_with_sort_order = D2.key_column_names_with_sort_order    FROM #IndexSanity si      CROSS APPLY ( SELECT RTRIM(STUFF( (SELECT N', ' + c.column_name + CASE c.is_descending_key           WHEN 1 THEN N' DESC'           ELSE N''          + N' {' + system_type_name + N' ' + CAST(max_length AS NVARCHAR(50)) +  N'}'          END AS col_definition         FROM #IndexColumns c         WHERE c.object_id = si.object_id           AND c.index_id = si.index_id           AND c.is_included_column = 0 /*Just Keys*/           AND c.key_ordinal > 0 /*Ignore non-key columns, such as partitioning keys*/         ORDER BY c.object_id, c.index_id, c.key_ordinal        FOR   XML PATH('') , TYPE).value('.', 'varchar(max)'), 1, 1, ''))       ) D2 ( key_column_names_with_sort_order )      RAISERROR (N'Updating #IndexSanity.key_column_names_with_sort_order_no_types (for create tsql)',0,1) WITH NOWAIT;    UPDATE #IndexSanity    SET  key_column_names_with_sort_order_no_types = D2.key_column_names_with_sort_order_no_types    FROM #IndexSanity si      CROSS APPLY ( SELECT RTRIM(STUFF( (SELECT N', ' + QUOTENAME(c.column_name) + CASE c.is_descending_key           WHEN 1 THEN N' [DESC]'           ELSE N''          END AS col_definition         FROM #IndexColumns c         WHERE c.object_id = si.object_id           AND c.index_id = si.index_id           AND c.is_included_column = 0 /*Just Keys*/           AND c.key_ordinal > 0 /*Ignore non-key columns, such as partitioning keys*/         ORDER BY c.object_id, c.index_id, c.key_ordinal        FOR   XML PATH('') , TYPE).value('.', 'varchar(max)'), 1, 1, ''))       ) D2 ( key_column_names_with_sort_order_no_types )      RAISERROR (N'Updating #IndexSanity.include_column_names',0,1) WITH NOWAIT;    UPDATE #IndexSanity    SET  include_column_names = D3.include_column_names    FROM #IndexSanity si      CROSS APPLY ( SELECT RTRIM(STUFF( (SELECT N', ' + c.column_name          + N' {' + system_type_name + N' ' + CAST(max_length AS NVARCHAR(50)) +  N'}'          FROM #IndexColumns c          WHERE c.object_id = si.object_id            AND c.index_id = si.index_id            AND c.is_included_column = 1 /*Just includes*/          ORDER BY c.column_name /*Order doesn't matter in includes,             this is here to make rows easy to compare.*/         FOR   XML PATH('') ,  TYPE).value('.', 'varchar(max)'), 1, 1, ''))        ) D3 ( include_column_names );      RAISERROR (N'Updating #IndexSanity.include_column_names_no_types (for create tsql)',0,1) WITH NOWAIT;    UPDATE #IndexSanity    SET  include_column_names_no_types = D3.include_column_names_no_types    FROM #IndexSanity si      CROSS APPLY ( SELECT RTRIM(STUFF( (SELECT N', ' + QUOTENAME(c.column_name)          FROM #IndexColumns c          WHERE c.object_id = si.object_id            AND c.index_id = si.index_id            AND c.is_included_column = 1 /*Just includes*/          ORDER BY c.column_name /*Order doesn't matter in includes,             this is here to make rows easy to compare.*/         FOR   XML PATH('') ,  TYPE).value('.', 'varchar(max)'), 1, 1, ''))        ) D3 ( include_column_names_no_types );      RAISERROR (N'Updating #IndexSanity.count_key_columns and count_include_columns',0,1) WITH NOWAIT;    UPDATE #IndexSanity    SET  count_included_columns = D4.count_included_columns,      count_key_columns = D4.count_key_columns    FROM #IndexSanity si      CROSS APPLY ( SELECT SUM(CASE WHEN is_included_column = 'true' THEN 1               ELSE 0             END) AS count_included_columns,            SUM(CASE WHEN is_included_column = 'false' AND c.key_ordinal > 0 THEN 1               ELSE 0             END) AS count_key_columns           FROM  #IndexColumns c           WHERE  c.object_id = si.object_id            AND c.index_id = si.index_id             ) AS D4 ( count_included_columns, count_key_columns );      IF (SELECT LEFT(@SQLServerProductVersion,       CHARINDEX('.',@SQLServerProductVersion,0)-1       )) <> 11 --Anything other than 2012    BEGIN       RAISERROR (N'Using non-2012 syntax to query sys.dm_db_index_operational_stats',0,1) WITH NOWAIT;       --NOTE: we're joining to sys.dm_db_index_operational_stats differently than you might think (not using a cross apply)     --This is because of quirks prior to SQL Server 2012 and in 2014 with this DMV.     SET @dsql = N'SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;        SELECT ps.object_id,           ps.index_id,           ps.partition_number,           ps.row_count,          ps.reserved_page_count * 8. / 1024. AS reserved_MB,          ps.lob_reserved_page_count * 8. / 1024. AS reserved_LOB_MB,          ps.row_overflow_reserved_page_count * 8. / 1024. AS reserved_row_overflow_MB,          os.leaf_insert_count,           os.leaf_delete_co"
    },
    {
      "id": "Geography",
      "name": "Geography",
      "type": "VIEW",
      "sql": "CREATE View [sv].[Geography]    As    (    SELECT      ('ORG' + CAST(Organization_Dim.Org_Dimn_Id AS VARCHAR))  AS Geo_Id,  Organization_Dim.Geo_Dimn_Id , Organization_Dim.SPLC_Dimn_Id , Organization_Dim.Org_Dimn_Id, SPLC_Dim.SPLC, SPLC_Dim.SPLC_Nm AS SPLC_Name,    Case WHEN SPLC_Dim.SPLC_Long IS NULL THEN Geography_Dim.Geo_Long    WHEN SPLC_Dim.SPLC_Long = -1 THEN Geography_Dim.Geo_Long  END AS Longitude ,    Case WHEN SPLC_Dim.SPLC_Lat IS NULL THEN Geography_Dim.Geo_Lat   WHEN SPLC_Dim.SPLC_Lat = -1 THEN Geography_Dim.Geo_Lat   END AS Latitude,     SPLC_Dim.SPLC_Status, Geography_Dim.City  , Geography_Dim.County    , isnull(Geography_Dim.Regn, 'Unknown') AS Regn_UFD   , isnull(Geography_Dim.Regn_Desc, 'Unknown') AS Regn_UFD_Desc,     isnull(CASE WHEN ((Geography_Dim.Row_Typ_Id = 512 AND Geography_Dim.Src_Sys_Nm = 'IANA') OR (Geography_Dim.Row_typ_id <>512 and Geography_Dim.Src_Sys_Nm <> 'IANA'))  THEN Geography_Dim.Regn_Ext ELSE NULL END, 'Unknown') AS Regn_IANA,  isnull(CASE WHEN ((Geography_Dim.Row_Typ_Id = 512 AND Geography_Dim.Src_Sys_Nm = 'IANA') OR (Geography_Dim.Row_typ_id <>512 and Geography_Dim.Src_Sys_Nm <> 'IANA'))  THEN Geography_Dim.Regn_Ext_Desc ELSE NULL END, 'Unknown') AS Regn_IANA_Desc,    isnull(CASE WHEN Geography_Dim.Row_Typ_Id = 512 AND Geography_Dim.Src_Sys_Nm =  'AAR' THEN Geography_Dim.Regn_Ext ELSE NULL END,'Unknown') AS Regn_AAR,    Geography_Dim.Metro_Area,   isnull(Geography_Dim.St_Prov, 'Unknown') AS [State],   isnull(Geography_Dim.St_Prov_Desc, 'Unknown') AS [State_Desc],     isnull(Geography_Dim.cntry, 'Unknown') as country   , isnull(Geography_Dim.Cntry_Desc, 'Unknown') as Country_Desc    FROM dbo.Organization_Dim (NOLOCK) LEFT OUTER JOIN dbo.SPLC_Dim (NOLOCK) ON dbo.Organization_Dim.SPLC_Dimn_Id = dbo.SPLC_Dim.SPLC_Dimn_Id    LEFT OUTER JOIN dbo.Geography_Dim (NOLOCK) ON dbo.Organization_Dim.Geo_Dimn_Id = dbo.Geography_Dim.Geo_Dimn_Id    WHERE Organization_Dim.Eff_To  IS NULL    )    UNION    (SELECT    ('GEO'+ CAST(Geography_Dim.Geo_Dimn_Id AS VARCHAR)) AS Geo_Id,  Geo_Dimn_Id,NULL,NULL, NULL, NULL, Geo_Long AS Longitude, Geo_Lat AS Latitude, NULL, City, County,   isnull(Regn, 'Unknown') AS Regn_UFD,   isnull(Geography_Dim.Regn_Desc, 'Unknown') AS Regn_UFD_Desc,     isnull(CASE WHEN ((Row_Typ_Id = 512 AND  Src_Sys_Nm = 'IANA') OR (Row_typ_id <>512 and Src_Sys_Nm <> 'IANA')) THEN Regn_Ext ELSE NULL END,  'Unknown') AS Regn_IANA,  isnull(CASE WHEN ((Geography_Dim.Row_Typ_Id = 512 AND Geography_Dim.Src_Sys_Nm = 'IANA') OR (Geography_Dim.Row_typ_id <>512 and Geography_Dim.Src_Sys_Nm <> 'IANA'))  THEN Geography_Dim.Regn_Ext_Desc ELSE NULL END, 'Unknown') AS Regn_IANA_Desc,    isnull(CASE WHEN Row_Typ_Id = 512 AND  Src_Sys_Nm =  'AAR' THEN Regn_Ext ELSE NULL END,'Unknown') AS Regn_AAR,    Metro_Area,   isnull(St_Prov, 'Unknown') AS [State],   isnull(Geography_Dim.St_Prov_Desc, 'Unknown') AS [State_Desc],  isnull(cntry, 'Unknown') as Country,  isnull(Geography_Dim.Cntry_Desc, 'Unknown') as Country_Desc        FROM  Geography_Dim (NOLOCK)    )    UNION    (    SELECT    ('SPLC' + CAST(splc.SPLC_Dimn_Id AS VARCHAR)) AS Geo_Id,   splc.Geo_Dimn_ID,    splc.SPLC_Dimn_Id,   NULL,    SPLC, SPLC_Nm,       Case WHEN splc.SPLC_Long IS NULL THEN geo.Geo_Long ELSE splc.SPLC_Long END AS Longitude ,   Case WHEN splc.SPLC_Lat IS NULL THEN geo.Geo_Lat ELSE splc.SPLC_Lat END AS Latitude,      SPLC_Status,    geo.City,    geo.County,    isnull(geo.Regn, 'Unknown') AS Regn_UFD,    isnull(geo.Regn_Desc, 'Unknown') AS Regn_UFD_Desc,      isnull(CASE WHEN ((geo.Row_Typ_Id = 512 AND  geo.Src_Sys_Nm = 'IANA') OR (geo.Row_typ_id <>512 and geo.Src_Sys_Nm <> 'IANA'))  THEN geo.Regn_Ext ELSE NULL END, 'Unknown') AS Regn_IANA,   isnull(CASE WHEN ((geo.Row_Typ_Id = 512 AND geo.Src_Sys_Nm = 'IANA') OR (geo.Row_typ_id <>512 and geo.Src_Sys_Nm <> 'IANA'))  THEN geo.Regn_Ext_Desc ELSE NULL END, 'Unknown') AS Regn_IANA_Desc,     isnull(CASE WHEN geo.Row_Typ_Id = 512 AND  geo.Src_Sys_Nm =  'AAR' THEN geo.Regn_Ext ELSE NULL END,'Unknown') AS Regn_AAR,   geo.Metro_Area,    isnull(geo.st_prov, 'Unknown') AS [State],    isnull(geo.St_Prov_Desc, 'Unknown') AS [State_Desc],   isnull(geo.cntry, 'Unknown') AS Country,   isnull(geo.Cntry_Desc, 'Unknown') as Country_Desc    FROM SPLC_Dim (NOLOCK) splc  LEFT JOIN Geography_Dim (NOLOCK) geo ON Geo.Geo_Dimn_ID =  splc.Geo_Dimn_Id    )"
    },
    {
      "id": "Invoicing_Entity",
      "name": "Invoicing_Entity",
      "type": "VIEW",
      "sql": "CREATE VIEW [sv].[Invoicing_Entity]  (  Invc_Enty_Org_Dimn_Id,  Invc_Enty_Org_Ver,  Invoicing_Entity_Id,  Invoicing_Entity_Name  )  AS  SELECT  VMRT_Invoicing_Entity_Dimension.Invc_Enty_Org_Dimn_Id,  VMRT_Invoicing_Entity_Dimension.Invc_Enty_Org_Ver,  VMRT_Invoicing_Entity_Dimension.Invc_Enty_Org_Abrv,  VMRT_Invoicing_Entity_Dimension.Invc_Enty_Org_Nm   FROM VMRT_Invoicing_Entity_Dimension"
    },
    {
      "id": "Loading_AAR",
      "name": "Loading_AAR",
      "type": "VIEW",
      "sql": "CREATE VIEW [sv].[Loading_AAR]  AS  SELECT       [Week_Start_Date_Dimn_Id]        ,[STCC_Dimn_Id]        ,[Road_Org_Dimn_Id]        ,[Road_Org_Ver]        ,[Loaded_Trip_Starts_Cnt]        ,[Loads_Interchanged_Cnt]        ,[Total_Volume_Handled]        ,[Trip_Origin_Region_Geo_Dimn_Id]        ,[Last_Updated_Date]        ,[Created_Date]  FROM     dbo.VMRT_Loading_AAR"
    },
    {
      "id": "VMRT_Car_Dimension_Correct_Hist",
      "name": "VMRT_Car_Dimension_Correct_Hist",
      "type": "VIEW",
      "sql": "CREATE VIEW [dbo].[VMRT_Car_Dimension_Correct_Hist]     WITH schemabinding     AS       SELECT car.[car_nr],              car.[car_init],              car.[car_status_ufd],              car.[ttx_eff_dt],              car.[car_ownrshp_ind],              car.[pool_cd],              car.[ttx_mngd_car_ind],              car.car_eff_from,              car.car_eff_to,              car.[car_dimn_id],              car.[car_ver],              car.car_src_sys_nm,              car.[ownr_mrk],              car.[eq_hierchy_id],              car.[eq_hierchy_ver],              car.[fleet_hierchy_ver],              car.[entr_hierchy_ver],              car.[fleet_hierchy_id],              car.[entr_hierchy_id],              car.[car_cls],              car.[railcar],              car.[car_lineage_grp_id],              car.[assetnum],              car.[fin_car_id],              car.[car_status_maximo],              [umler_blt_dt],              [eq_bldr],              [bldr_lot_cd],              [blt_from_use_ast],              [brk_cd],              [car_cost_est_act],              [lese_cd],              [ldgr_val],              [lst_shp_dt],              [milg_upd_dt],              [orig_car_ownr],              [orig_cost],              [reblt_dt],              [scnd_hand_dt],              [scnd_lese],              [seller_orig_cost],              [setl_val],              [split_or_cmbnd_invl_ind],              [wghg_pty],              [milg_sinc_lst_cls_a_rpr_dt],              [milg_sinc_lst_cls_b_rpr_dt],              [milg_sinc_lst_cls_i_rpr_dt],              [lst_cls_a_rpr_dt],              [lst_cls_b_rpr_dt],              [lst_cls_i_rpr_dt],              [num_dy_car_can],              [num_dy_car_mex],              [can_mex_dy_lst_updt_dt],              [blng_extd_srvc_ind],              [rub_rail_upd],              [cert_dt],              [cert_cd],              [car_grd],              [car_grd_dt],              [osid_usa_ind],              [insd_len],              [osid_len],              car.car_char_eff_from,              car.car_char_eff_to              --    ,ISNULL(ISNULL(car.[Pltfm_Fctr], 2*Ut_Cnt),1.0) as [Pltfm_Fctr]              ,              Isnull(car.[pltfm_fctr], 1.0) AS [Pltfm_Fctr],              car.[trk_axl_cnt],              car.[axl_cnt],              Isnull(car.[tpe_fctr], 1)     AS [TPE_Fctr],              car.[ut_cnt],              [eq_typ_cd],              [intmdit_connt_styl],              [s_str_bldr_cd],              [s_str_modl],              [s_str_blt_dt],              [rt_ind],              [s_str_addn_betr_val],              [orig_rk_cost],              [act_rk_dim_ind],              [s_str_deck_bc_setg],              [s_str_deck_ab_setg],              [s_str_chock_typ],              [s_str_end_door_m941_90_qlfy],              [s_str_dooredg_prot_cd],              [enclsd_s_str_top_deck_setg],              [s_str_lese],              [auto_rk_ctgy],              [s_str_ownr],              [s_str_crnt_cost],              [s_str_enclsr_cd],              [s_str_end_door_dsgn],              [s_str_deck_lvl_cd],              [s_str_tare_wgt],              [is_s_str_intg_wth_car],              [car_char_dimn_id],              [car_char_ver],              [elem_desc],              [elem_id],              [elem_lbl],              [elem_shrt_desc],              car.[ttx_blt_dt],              hier1.ttx_eq_cd,              hier1.[eq_char],              hier1.ttx_eq_cd_desc              ---- container car logic              ,              CASE                WHEN ( CASE                         WHEN hier3.stat_cd IN ( 998, 999 ) THEN                         hier3.[bus_ln_shrt_desc]                         ELSE Isnull(hier3.[bus_ln_shrt_desc],                              Hier2.business_line_description)                       END ) = 'Intermodal'                     AND [ttx_mngd_car_ind] = 0 THEN                  CASE                    WHEN Substring([eq_typ_cd], 1, 1) IN ( 'P', 'Q' ) THEN                    'Conventional'                    WHEN Substring([eq_typ_cd], 1, 2) IN                         ( 'S1', 'S2', 'S3', 'S4', 'S5' ) THEN                    'DTTX 40-48ft'                    WHEN Substring([eq_typ_cd], 1, 2) IN ( 'S6', 'S7' ) THEN                    'DTTX 53-56ft'                    ELSE hier2.[fleet_segment_description]                  END                WHEN ( CASE                         WHEN hier3.stat_cd IN ( 998, 999 ) THEN                         hier3.[bus_ln_shrt_desc]                         ELSE Isnull(hier3.[bus_ln_shrt_desc],                              Hier2.business_line_description)                       END ) = 'Intermodal'                     AND ( COALESCE(car.[car_status_maximo], car.[car_status_ufd]) =                           'PRE-REGISTERED'                            OR COALESCE(car.[car_status_maximo],                               car.[car_status_ufd])                               IS NULL                         ) THEN NULL                ELSE hier2.[fleet_segment_description]              END                           AS [Fleet_Segment_Description],              Isnull(CASE                       WHEN ( CASE                                WHEN hier3.stat_cd IN ( 998, 999 ) THEN                                hier3.[bus_ln_shrt_desc]                                ELSE Isnull(hier3.[bus_ln_shrt_desc],                                     Hier2.business_line_description)                              END ) = 'Intermodal'                            AND [ttx_mngd_car_ind] = 0 THEN                         CASE                           WHEN Substring([eq_typ_cd], 1, 1) IN ( 'P', 'Q' ) THEN                           'Conventional'                           WHEN Substring([eq_typ_cd], 1, 2) IN (                                'S1', 'S2', 'S3', 'S4',                                'S5', 'S6', 'S7' ) THEN                           'Doublestack'                         END                       ELSE ( CASE                                WHEN hier3.stat_cd IN ( 998, 999 ) THEN                                hier3.[eq_typ_shrt_desc]                                ELSE Isnull(hier3.[eq_typ_shrt_desc],                                     hier2.equipment_type_description)                              END )                     END, 'Unknown')        AS Equipment_Type_Description,              hier3.[stat_cd]               AS Stat_Code,              Isnull(CASE                       WHEN ( CASE                                WHEN hier3.stat_cd IN ( 998, 999 ) THEN                                hier3.[bus_ln_shrt_desc]                                ELSE Isnull(hier3.[bus_ln_shrt_desc],                                     Hier2.business_line_description)                              END ) = 'Intermodal'                            AND [ttx_mngd_car_ind] = 0 THEN                         CASE                           WHEN Substring([eq_typ_cd], 1, 2) IN                                ( 'S1', 'S2', 'S3', 'S4', 'S5' ) THEN                           '40 ft Wells'                           WHEN Substring([eq_typ_cd], 1, 2) IN ( 'S6', 'S7' ) THEN                           '53 ft Wells'                           ELSE hier3.[eq_featr_shrt_desc]                         END                       ELSE hier3.[eq_featr_shrt_desc]                     END, 'Unknown')        AS [Equipment_Feature],              hier3.[car_hrly_rt]           AS Car_Hourly_Rate,              hier3.[est_car_hrly_rate]     AS Estimated_Car_Hourly_Rate,              hier3.[daily_miles]           AS Daily_Miles,              hier3.[milg_rt]               AS Milg_Rate,              hier3.[fleet_type],              hier3.[rack_type],              Isnull(CASE                       WHEN ( CASE                                WHEN hier3.stat_cd IN ( 998, 999 ) THEN                                hier3.[bus_ln_shrt_desc]                                ELSE Isnull(hier3.[bus_ln_shrt_desc],                                     Hier2.business_line_description)                              END ) = 'Intermodal'                            AND [ttx_mngd_car_ind] = 0 THEN                         CASE                           WHEN Substring([eq_typ_cd], 1, 1) IN ( 'P', 'Q' ) THEN                           'Conventional'                           WHEN Substring([eq_typ_cd], 1, 2) IN (                                'S1', 'S2', 'S3', 'S4',                                'S5', 'S6', 'S7' ) THEN                           'Doublestack'                         END                       ELSE ( CASE                                WHEN hier3.stat_cd IN ( 998, 999 ) THEN                                hier3.[eq_typ_shrt_desc]                                ELSE Isnull(hier3.[eq_typ_shrt_desc],                                     hier2.equipment_type_description)                              END )                     END, 'Unknown')        AS Equipment_Type,              Isnull(CASE                       WHEN hier3.stat_cd IN ( 998, 999 ) THEN                       hier3.[bus_ln_shrt_desc]                       ELSE Isnull(hier3.[bus_ln_shrt_desc],                            Hier2.business_line_description)                     END, 'Unknown')        AS Business_Line ,         Car_Health_Rating         --car_health_score      FROM   (SELECT [car_nr],                      [car_init],                      [car_status_ufd],                      [ttx_eff_dt],                      [car_ownrshp_ind],                      [pool_cd],                      [ttx_mngd_car_ind],                      car_eff_from,                      car_eff_to,                      [car_dimn_id],                      [car_ver],                      car_src_sys_nm,                      [ownr_mrk],                      [eq_hierchy_id],                      [eq_hierchy_ver],                      [fleet_hierchy_ver],                      [entr_hierchy_ver],                      [fleet_hierchy_id],                      [entr_hierchy_id],                      [car_cls],                      [railcar],                      [car_lineage_grp_id],                      [assetnum],                      [fin_car_id],                      [car_status_maximo],                      [umler_blt_dt],                      [eq_bldr],                      [bldr_lot_cd],                      [blt_from_use_ast],                      [brk_cd],                      [car_cost_est_act],                      [lese_cd],                      [ldgr_val],                      [lst_shp_dt],                      [milg_upd_dt],                      [orig_car_ownr],                      [orig_cost],                      [reblt_dt],                      [scnd_hand_dt],                      [scnd_lese],                      [seller_orig_cost],                      [setl_val],                      [split_or_cmbnd_invl_ind],                      [wghg_pty],                      [milg_sinc_lst_cls_a_rpr_dt],                      [milg_sinc_lst_cls_b_rpr_dt],                      [milg_sinc_lst_cls_i_rpr_dt],                      [lst_cls_a_rpr_dt],                      [lst_cls_b_rpr_dt],                      [lst_cls_i_rpr_dt],                      [num_dy_car_can],                      [num_dy_car_mex],                      [can_mex_dy_lst_updt_dt],                      [blng_extd_srvc_ind],                      [rub_rail_upd],                      [cert_dt],                      [cert_cd],                      [car_grd],                      [car_grd_dt],                      [osid_usa_ind],                      [insd_len],                      [osid_len],                      car_char_eff_from,                      car_char_eff_to,                      [pltfm_fctr],                      [trk_axl_cnt],                      [axl_cnt],                      [tpe_fctr],                      [ut_cnt],                      [eq_typ_cd],                      [intmdit_connt_styl],                      [s_str_bldr_cd],                      [s_str_modl],                      [s_str_blt_dt],                      [rt_ind],                      [s_str_addn_betr_val],                      [orig_rk_cost],                      [act_rk_dim_ind],                      [s_str_deck_bc_setg],                      [s_str_deck_ab_setg],                      [s_str_chock_typ],                      [s_str_end_door_m941_90_qlfy],                      [s_str_dooredg_prot_cd],                      [enclsd_s_str_top_deck_setg],                      [s_str_lese],                      [auto_rk_ctgy],                      [s_str_ownr],                      [s_str_crnt_cost],                      [s_str_enclsr_cd],                      [s_str_end_door_dsgn],                    [s_str_deck_lvl_cd],                      [s_str_tare_wgt],                      [is_s_str_intg_wth_car],                      [car_char_dimn_id],                      [car_char_ver],                      [elem_desc],                      [elem_id],                      [elem_lbl],                      [elem_shrt_desc],                      [ttx_blt_dt],         Car_Health_Rating         --car_health_score              FROM   (SELECT car1.[car_nr],                              car1.[car_init],                              car1.[car_status_ufd],                              car1.[ttx_eff_dt],                              car1.[car_ownrshp_ind],                              car1.[pool_cd],                              car1.[ttx_mngd_car_ind],                              car1.[eff_from]   AS Car_Eff_From,                              car1.[eff_to]     AS Car_Eff_To,                              car1.[car_dimn_id],                              car1.[car_ver],                              car1.[src_sys_nm] AS Car_Src_Sys_Nm,                              car1.[ownr_mrk],                              car1.[eq_hierchy_id],                              car1.[eq_hierchy_ver],                              car1.[fleet_hierchy_ver],                              car1.[entr_hierchy_ver],                              car1.[fleet_hierchy_id],                              car1.[entr_hierchy_id],                              car1.[car_cls],                              car1.[railcar],                              car1.[car_lineage_grp_id],                              car1.[assetnum],                              car1.[fin_car_id],                              car1.[car_status_maximo],                              cchar.[umler_blt_dt],                              cchar.[eq_bldr],                              cchar.[bldr_lot_cd],                              cchar.[blt_from_use_ast],                              cchar.[brk_cd],                              cchar.[car_cost_est_act],                              cchar.[lese_cd],                              cchar.[ldgr_val],                              cchar.[lst_shp_dt],                              cchar.[milg_upd_dt],                              cchar.[orig_car_ownr],                              cchar.[orig_cost],                              cchar.[reblt_dt],                              cchar.[scnd_hand_dt],                              cchar.[scnd_lese],                              cchar.[seller_orig_cost],                              cchar.[setl_val],                              cchar.[split_or_cmbnd_invl_ind],                              cchar.[wghg_pty],                              cchar.[milg_sinc_lst_cls_a_rpr_dt],                              cchar.[milg_sinc_lst_cls_b_rpr_dt],                              cchar.[milg_sinc_lst_cls_i_rpr_dt],                              cchar.[lst_cls_a_rpr_dt],                              cchar.[lst_cls_b_rpr_dt],                              cchar.[lst_cls_i_rpr_dt],                              cchar.[num_dy_car_can],                              cchar.[num_dy_car_mex],                              cchar.[can_mex_dy_lst_updt_dt],                              cchar.[blng_extd_srvc_ind],                              cchar.[rub_rail_upd],                              cchar.[cert_dt],                              cchar.[cert_cd],                              cchar.[car_grd],                              cchar.[car_grd_dt],                              cchar.[osid_usa_ind],                              cchar.[insd_len],                              cchar.[osid_len],                              cchar.[eff_from]  AS Car_Char_Eff_From,                              cchar.[eff_to]    AS Car_Char_Eff_To,                              cchar.[pltfm_fctr],                              cchar.[trk_axl_cnt],                              cchar.[axl_cnt],                              cchar.[tpe_fctr],                              cchar.[ut_cnt],                              cchar.[eq_typ_cd],                              cchar.[intmdit_connt_styl],                              cchar.[s_str_bldr_cd],                              cchar.[s_str_modl],                        cchar.[s_str_blt_dt],                              cchar.[rt_ind],                              cchar.[s_str_addn_betr_val],                              cchar.[orig_rk_cost],                              cchar.[act_rk_dim_ind],                              cchar.[s_str_deck_bc_setg],                              cchar.[s_str_deck_ab_setg],                              cchar.[s_str_chock_typ],                              cchar.[s_str_end_door_m941_90_qlfy],                              cchar.[s_str_dooredg_prot_cd],                              cchar.[enclsd_s_str_top_deck_setg],                              cchar.[s_str_lese],                              cchar.[auto_rk_ctgy],                              cchar.[s_str_ownr],                              cchar.[s_str_crnt_cost],                              cchar.[s_str_enclsr_cd],                              cchar.[s_str_end_door_dsgn],                              cchar.[s_str_deck_lvl_cd],                              cchar.[s_str_tare_wgt],                              cchar.[is_s_str_intg_wth_car],                              cchar.[car_char_dimn_id],                              cchar.[car_char_ver],                              cchar.[elem_desc],                              cchar.[elem_id],                              cchar.[elem_lbl],                              cchar.[elem_shrt_desc],                              cchar.[ttx_blt_dt],         car1.Car_Health_Rating         --car1.car_health_score                      FROM   dbo.Car_Dim_Correct (nolock) car1                              LEFT JOIN (SELECT car_dimn_id,                                                car_ver,                                                [umler_blt_dt],                                                [eq_bldr],                                                [bldr_lot_cd],                                                [blt_from_use_ast],                                                [brk_cd],                                                [car_cost_est_act],                                                [lese_cd],                                                [ldgr_val],                                                [lst_shp_dt],                                                [milg_upd_dt],                                                [orig_car_ownr],                                                [orig_cost],                                                [reblt_dt],                                                [scnd_hand_dt],                                                [scnd_lese],                                                [seller_orig_cost],                                                [setl_val],                                                [split_or_cmbnd_invl_ind],                                                [wghg_pty],                                                [milg_sinc_lst_cls_a_rpr_dt],                                                [milg_sinc_lst_cls_b_rpr_dt],                                                [milg_sinc_lst_cls_i_rpr_dt],                                                [lst_cls_a_rpr_dt],                                                [lst_cls_b_rpr_dt],                                                [lst_cls_i_rpr_dt],                                                [num_dy_car_can],                                                [num_dy_car_mex],                                                [can_mex_dy_lst_updt_dt],                                                [blng_extd_srvc_ind],                                                [rub_rail_upd],                                                [cert_dt],                                                [cert_cd],                                                [car_grd],                                                [car_grd_dt],                                                [osid_usa_ind],                                                [insd_len],                                                [osid_len],                                                [eff_from],                                                [eff_to],          [pltfm_fctr],                                                [trk_axl_cnt],                                                [axl_cnt],                                                [tpe_fctr],                                                [ut_cnt],                                                [eq_typ_cd],                                                [intmdit_connt_styl],                                                [s_str_bldr_cd],                                                [s_str_modl],                                                [s_str_blt_dt],                                                [rt_ind],                                                [s_str_addn_betr_val],                                                [orig_rk_cost],                                                [act_rk_dim_ind],                                                [s_str_deck_bc_setg],                                                [s_str_deck_ab_setg],                                                [s_str_chock_typ],                                                [s_str_end_door_m941_90_qlfy],                                                [s_str_dooredg_prot_cd],                                                [enclsd_s_str_top_deck_setg],                                                [s_str_lese],                                                [auto_rk_ctgy],                                                [s_str_ownr],                                                [s_str_crnt_cost],                                                [s_str_enclsr_cd],                                                [s_str_end_door_dsgn],                                                [s_str_deck_lvl_cd],                                                [s_str_tare_wgt],                                                [is_s_str_intg_wth_car],                                                [car_char_dimn_id],                                                [car_char_ver],                                                [elem_desc],                                                [elem_id],                                                [elem_lbl],                                                [elem_shrt_desc],                                                [ttx_blt_dt]                                         FROM   dbo.car_characteristic_dim (nolock)                                         ) cchar           --Retrieve complete date from Car_Characterstic_Dim                                  ON ( car1.car_dimn_id = cchar.car_dimn_id and           car1.car_ver = cchar.car_ver)) ta)              car              LEFT JOIN [dbo].[vmrt_car_hierarchy_equipment] hier1                     ON ( car.eq_hierchy_id = hier1.hierchy_id                          AND car.eq_hierchy_ver = hier1.hierchy_ver )              LEFT JOIN [dbo].[vmrt_car_hierarchy_fleet] hier2                     ON ( car.fleet_hierchy_id = hier2.hierchy_id                          AND car.fleet_hierchy_ver = hier2.hierchy_ver )              LEFT JOIN [dbo].[vmrt_car_hierarchy_enterprise] hier3                     ON ( car.entr_hierchy_id = hier3.hierchy_id                          AND car.entr_hierchy_ver = hier3.hierchy_ver )"
    },
    {
      "id": "Loading_TTXContainer",
      "name": "Loading_TTXContainer",
      "type": "VIEW",
      "sql": "CREATE VIEW [sv].[Loading_TTXContainer]    AS    SELECT     VMRT_Loading_TTXContainer.Container_Fact_ID,  VMRT_Loading_TTXContainer.Car_Dimn_Id,  VMRT_Loading_TTXContainer.Car_Ver,  VMRT_Loading_TTXContainer.Rpt_Rd_Ver AS Road_Org_Ver,  VMRT_Loading_TTXContainer.Rpt_Rd_Dimn_Id AS Road_Org_Dimn_Id,  VMRT_Loading_TTXContainer.Dt_Dimn_Id,  VMRT_Loading_TTXContainer.Geo_Dimn_Id,  VMRT_Loading_TTXContainer.STCC_Dimn_Id,  VMRT_Loading_TTXContainer.Cntr_Trl_Len AS [Container_Trailer_Size],  VMRT_Loading_TTXContainer.Cntr_Trl_Eq_Typ AS Container_Trailer_Equipment_Type   FROM VMRT_Loading_TTXContainer"
    },
    {
      "id": "Loading_TTXLoaded_Trip_Starts",
      "name": "Loading_TTXLoaded_Trip_Starts",
      "type": "VIEW",
      "sql": "CREATE VIEW [SV].[Loading_TTXLoaded_Trip_Starts]  AS  SELECT [Car_Dimn_Id]        ,[Car_Ver]        ,[STCC_Dimn_Id]        ,[Trip_Begin_Dt_Dimn_Id]        ,[Trip_End_Dt_Dimn_Id]        ,[Trip_Orig_Parti_Shpr_Org_Dimn_Id]        ,[Trip_Orig_Parti_Shpr_Org_Ver]        ,[Trip_Dest_Parti_Shpr_Org_Dimn_Id]        ,[Trip_Dest_Parti_Shpr_Org_Ver]        ,[Trip_Orig_Poss_Road_Org_Dimn_Id]        ,[Trip_Orig_Poss_Road_Org_Ver]        ,[Trip_Dest_Poss_Road_Org_Dimn_Id]        ,[Trip_Dest_Poss_Road_Org_Ver]        ,[Trip_Orig_Lst_Parti_Road_Org_Dimn_Id]        ,[Trip_Orig_Lst_Parti_Road_Org_Ver]        ,[Trip_Dest_Lst_Parti_Road_Org_Dimn_Id]        ,[Trip_Dest_Lst_Parti_Road_Org_Ver]        ,[Trip_Orig_Resp_Road_Org_Dimn_Id]        ,[Trip_Orig_Resp_Road_Org_Ver]        ,[Trip_Dest_Resp_Road_Org_Dimn_Id]        ,[Trip_Dest_Resp_Road_Org_Ver]        ,[Trip_Orig_SPLC_Dimn_Id]        ,[Trip_Dest_SPLC_Dimn_Id]        ,[Trip_Orig_Loc_Org_Dimn_Id]        ,[Trip_Orig_Loc_Org_Ver]        ,[Trip_Dest_Loc_Org_Dimn_Id]        ,[Trip_Dest_Loc_Org_Ver]        ,COALESCE([Ld_Trip_Strts_Cnt], 0) AS [Ld_Trip_Starts_Count]    FROM [DDSMRT].[dbo].[VMRT_TTX_Loaded_Trip_Starts]"
    },
    {
      "id": "Location_on_Car",
      "name": "Location_on_Car",
      "type": "VIEW",
      "sql": "CREATE VIEW [sv].[Location_on_Car]  (  Loc_On_Car_Dimn_Id,  Location_on_Car,  Truck_Location,  Axle_Location)  AS  SELECT     Car_Location_Dim.Car_Loc_Dimn_Id,  Car_Location_Dim.On_Car_Loc_Cd,  Car_Location_Dim.Trk_Loc_Cd,  Car_Location_Dim.Axl_Loc_Cd   FROM Car_Location_Dim (NOLOCK)"
    },
    {
      "id": "Maintenance_Type",
      "name": "Maintenance_Type",
      "type": "VIEW",
      "sql": "CREATE VIEW [sv].[Maintenance_Type]  (  Mnt_Typ_Dimn_Id,  Mnt_Typ_Ver,  Repair_Code_Full,  Repair_Code,  Repair_Class,  Maintenance_Type_Level_1,  Maintenance_Type_Level_2,  Maintenance_Type_Level_3,  Repair_Code_Full_Description,  Repair_Class_Description,  Program_Description    )  AS  SELECT Maintenance_Type_Dim.Mnt_Typ_Dimn_Id,  Maintenance_Type_Dim.Mnt_Typ_Ver,  Maintenance_Type_Dim.Repr_Cd_Full,  Maintenance_Type_Dim.Repr_Cd,  Maintenance_Type_Dim.Repr_Cls_Cd,  isnull(Maintenance_Type_Dim.Mnt_Typ_Lvl_1, 'Unknown') as Mnt_Typ_Lvl_1,  isnull(Maintenance_Type_Dim.Mnt_Typ_Lvl_2, 'Unknown') as Mnt_Typ_Lvl_2,  isnull(Maintenance_Type_Dim.Mnt_Typ_Lvl_3, 'Unknown') as Mnt_Typ_Lvl_3,  Maintenance_Type_Dim.Repr_Cd_Full_Desc,  Maintenance_Type_Dim.Repr_Cls_Desc,  Maintenance_Type_Dim.Pgm_Desc  FROM Maintenance_Type_Dim (NOLOCK)"
    },
    {
      "id": "Availability_Metric",
      "name": "Availability_Metric",
      "type": "VIEW",
      "sql": "CREATE VIEW [SV].[Availability_Metric]  AS  SELECT (CAST(x.car_dimn_id AS VARCHAR) + '|' + CAST(x.car_ver AS VARCHAR)) AS Car_Id,         x.RailCar,         x.Last_Participating_RR,         (CAST(x.[Last_Participating_Org_Dimn_Id] AS VARCHAR) + '|' + CAST(x.[Last_Participating_Org_Ver] AS VARCHAR)) AS [Last_Participating_Org_Id],         x.Possessor_RR,         (CAST(x.[Possessor_RR_Org_DImn_Id] AS VARCHAR) + '|' + CAST(x.[Possessor_RR_Org_Ver] AS VARCHAR)) AS [Possessor_RR_Org_Id],         x.Dt_Dimn_Id AS [Snapshot_Dt_Dimn_Id],         x.Unit_Count AS [Unit_Count],      x.Car_Count AS [Fleet_Size],         x.NR_RR_Relief AS [On_RR_Relief],         x.BO_on_RRproperty AS [BO_in_RR_Possession],         x.NR_Paid_stor AS [Total_in_Paid_Storage],         x.BO_inPaidStor AS [BO_in_Paid_Storage],      x.Mechanical_Defect_inPaidstorageCars AS [Mechanical_Defect_in_Paid_Storage],         x.Non_BO_inPaidStor AS [Current/Future_Mods_in_Paid_Storage],         x.Scrap_inPaidStor AS [Scrap_Candidates_in_Paid_Storage],         x.PaidStor_Arrival AS [Paid_Storage_Arrivals],         x.NR_Shop AS [Cars_in_SCT_Shop],      x.[NR_Shop_Serving Yard] AS [Cars_in_SCT_Shop_Serving_Yard],      [Cars_in_non_SCT_Shop],      x.NR_Shop + [Cars_in_non_SCT_Shop] AS [Total_in_Shop],         x.NR_Shop + [Cars_in_non_SCT_Shop] + x.[NR_Shop_Serving Yard] AS [Total_in_Shop_and_Serving_Yard],            x.BO_atShop as [BO_at_SCT_Shop_cars],      [BO_at_non_SCT_Shop_Car],      x.BO_atShop + [BO_at_non_SCT_Shop_Car] AS [BO_at_Shop],      [Cars_At_Scrap],         x.UMLER_Mech_Restrict_no_Shop_PdSt AS [UMLER_Mech_Restriction_in_RR_Possession_not_BO],         x.On_Active_Directive AS [On_Active_Directive_Adjusted],      --Added columns to get location and distribution entity information       x.Current_Entity as [Current_Distribution_Entity],      (CAST(x.[Dist_Enty_Dimn_Id] AS VARCHAR) + '|' + CAST(x.[Dist_Enty_Ver] AS VARCHAR)) AS [Current_Distribution_Entity_Id],      x.Cur_Loc as [Current_Location],      ('SPLC' + CAST(x.SPLC_Dimn_Id AS VARCHAR)) AS [Current_Location_Id],      Car_Hire_Status_Dimn_Id,      Car_Hire_Status,      ISNULL(Total_In_RIP,0) Total_In_RIP,      x.BO_at_RIP AS [BO_at_RIP]      FROM  (      SELECT RMH.car_dimn_id,             RMH.car_ver,             RMH.RailCar,             RMH.Last_Participating_RR,             RMH.Possessor_RR,             RMH.Snpsht_Dt,       RMH.CarsInRIP Total_In_RIP,       CASE WHEN RMH.CarsInRIP = 1                       AND (RMH.Bad_Order_Sts = 'Y') THEN 1 ELSE 0 END BO_at_RIP,             tt.Dt_Dimn_Id,             ISNULL(Part_rd.Org_Dimn_Id, -1) Last_Participating_Org_Dimn_Id,             ISNULL(Part_rd.Org_Ver, -1) AS Last_Participating_Org_Ver,             ISNULL(Poss_rd.Org_Dimn_Id, -1) AS Possessor_RR_Org_DImn_Id,             ISNULL(Poss_rd.Org_Ver, -1) AS Possessor_RR_Org_Ver,             (car.ut_cnt) AS [Unit_Count],       (1) AS [Car_Count],             ((CASE                   WHEN                   (                       (RMH.NR_Code IN ( '00', '01', '02', '05', '06', '08' ))                   ) THEN                       1                   ELSE                       0               END              )             ) AS NR_Paid_stor,             ((CASE                   WHEN                   (                       (RMH.Bad_Order_Sts = 'Y')                       AND (RMH.NR_Code NOT IN ( '00', '01', '02', '05', '06', '08', '04', '09', '10', '11', '13', '16',                                                 '52'                                               )                           )                   ) THEN                       1                   ELSE                       0               END              )             ) AS [BO_on_RRproperty],             ((CASE                   WHEN                   (                       (Transport_Code IN ( 'X', 'S', 'Y' ))                       AND (RMH.NR_Code NOT IN ( '00', '01', '02', '05', '06', '08', '04', '09', '10', '11', '13', '16',                                                 '52'                                               )                           )                       AND (RMH.Bad_Order_Sts = 'N')                   ) THEN                       1                   ELSE                       0               END              )             ) AS [UMLER_Mech_Restrict_no_Shop_PdSt],             ((CASE                   WHEN                   (                       (TRIM(ACTIVE_STATUS) IN ( 'A' ))                       AND (RMH.Bad_Order_Sts <> 'Y')        AND rmh.DIRECTIVE_TYPE  IN ('I','J','M')                   ) THEN                       1                   ELSE                       0               END              )             ) AS [On_Active_Directive],             ((CASE                   WHEN                   (                       (RMH.NR_Code = '00')                   ) THEN                       1                   ELSE                       0               END              )             ) AS 'Scrap_inPaidStor',             (((((CASE                      WHEN (RMH.Distributable_Status IN ( 'Y', 'N' )) THEN                          1                      ELSE                          0                  END                 ) - (CASE                          WHEN                          (                              (RMH.NR_Code IN ( '22', '26', '28' ))                              AND (RMH.Car_Hire_Status = 'N')                              AND (RMH.Last_Participating_RR <> 'TTX')                          ) THEN                              1                          ELSE                              0                      END                     )                ) - (CASE                         WHEN                         (                             (RMH.NR_Code IN ( '00', '01', '02', '05', '06', '08' ))                             AND (RMH.Car_Hire_Status = 'N')                         ) THEN                             1                         ELSE                             0                     END                    )               ) - (CASE                        WHEN (RMH.NR_Code IN ( '04', '09', '10', '11', '13', '16', '52' )) THEN                            1                        ELSE                            0                    END                   )              )             ) AS NR_Rev_Svc_new,             ((CASE                   WHEN                   (                       (RMH.NR_Code IN ( '22', '26', '28' ))                       AND (RMH.Car_Hire_Status = 'N')                       AND (RMH.Last_Participating_RR <> 'TTX')                   ) THEN                       1                   ELSE                       0               END              )             ) AS [NR_RR_Relief],             ((CASE                   WHEN                   (                       (RMH.NR_Code = '06')                   ) THEN                       1                   ELSE                       0               END              )             ) AS 'BO_inPaidStor',            ((CASE                   WHEN                   (                       (RMH.NR_Code = '05')                   ) THEN                       1                   ELSE                       0               END              )             ) AS 'Mechanical_Defect_inPaidstorageCars',                 ((CASE                   WHEN                   (                       (RMH.NR_Code IN ( '01', '02' ))                   ) THEN                       1                   ELSE                       0               END              )             ) AS [Non_BO_inPaidStor],             ((CASE                   WHEN                   (                       (RMH.NR_Code = '08')                   ) THEN                       1                   ELSE                       0               END              )             ) AS [PaidStor_Arrival],             ((CASE                   WHEN (RMH.NR_Code IN ( '04', '10', '11', '13', '16','12','17' ) or (RMH.NR_Code='94' and DE.Type='SHOP')) THEN                       1                   ELSE                       0               END              )             ) AS [NR_Shop],       ((CASE                   WHEN (RMH.NR_Code IN ( '09', '07')) THEN                       1                   ELSE                       0               END              )             ) AS [NR_Shop_Serving Yard],       ((CASE                   WHEN (RMH.NR_Code NOT IN ( '04', '09', '10', '11', '13', '16','07','12','17','94' )) AND DE.Type='SHOP' THEN                       1                   ELSE                       0               END              )             ) AS [Cars_in_non_SCT_Shop],             ((CASE                   WHEN                   (                       (RMH.NR_Code IN ( '04', '09', '10', '11', '13', '16','07','12','17' ))                       AND (RMH.Bad_Order_Sts = 'Y')                   ) THEN                       1                   ELSE                       0               END              )             ) AS [BO_atShop],        ((CASE                   WHEN                   (                       (RMH.NR_Code NOT IN ( '04', '09', '10', '11', '13', '16','07','12','17' ))                       AND (RMH.Bad_Order_Sts = 'Y') and DE.Type='SHOP'                   ) THEN                       1                   ELSE                       0               END              )             ) AS [BO_at_non_SCT_Shop_Car],       ((CASE                   WHEN DE.Type='SCRAP' THEN 1                   ELSE 0               END              )             ) AS [Cars_At_Scrap],             ((CASE                   WHEN                   (                       (RMH.Distributable_Status = 'Y')                       AND (car.Fleet_Segment_Description <> '')                   ) THEN                       1                   ELSE                       0               END              )             ) AS [Dist_Status_cnt],             ((CASE                   WHEN (RMH.Distributable_Status IN ( 'Y', 'N' )) THEN                       1                   ELSE                       0               END              )             ) AS [Dist_Status_Tot]          ,ISNULL(de.Dist_Enty_Dimn_Id,-1)  Dist_Enty_Dimn_Id, ISNULL(de.Dist_Enty_Ver,-1) Dist_Enty_Ver, RMH.Current_Entity       ,RMH.Cur_Loc ,ISNULL(SPLC.SPLC_Dimn_Id,-1) SPLC_Dimn_Id,  ISNULL(CHS.Car_Hire_Status_Dimn_Id,-1) Car_Hire_Status_Dimn_Id,  Car_Hire_Status          FROM DDSMRT..Railcar_Movement_History RMH          INNER JOIN DDSMRT..VMRT_Car_Dimension_Correct car              ON car.car_dimn_id = RMH.car_dimn_id                 AND car.car_ver = RMH.car_ver          --Join with sv.Distribution_Entity        LEFT OUTER JOIN(Select Dist_Enty_Dimn_Id, Dist_Enty_Ver,Dist_Enty, case when Dist_Enty_Ver=1 then '1900-01-10' else  Eff_From end as eff_From,                 COALESCE(eff_to, '9999-01-01 00:00:00.000') AS eff_to,Type from  SV.Distribution_Entity ) de        on RMH.Current_Entity=de.Dist_Enty and ( Snpsht_Dt  between Eff_From and Eff_to)          --Join with SPLC_Dim        LEFT JOIN DDSMRT.dbo.SPLC_Dim (NOLOCK) SPLC on (RMH.[Cur_Loc] = SPLC.Location)          --Join with sv.Car_Hire_Status    LEFT JOIN SV.CAR_Hire_Status CHS on rmh.Car_Hire_Status=CHS.Car_Hire_Status_Value                LEFT OUTER JOIN DDSMRT.SV.Time tt              ON CAST(RMH.Snpsht_Dt AS DATE) = tt.DT          LEFT JOIN          (              SELECT Org_Abrv,                     Org_Dimn_Id,                     Org_Ver,                     CASE                         WHEN Org_Ver = 1 THEN                             '1900-01-01'                         ELSE                             eff_From                     END AS eff_from,                     COALESCE(eff_to, '9999-01-01 00:00:00.000') AS eff_to              FROM DDSMRT.dbo.VMRT_Organization_Dimension WITH (NOLOCK)              WHERE Org_Abrv IS NOT NULL          ) Part_rd              ON Part_rd.Org_Abrv = RMH.Last_Participating_RR                 AND (Snpsht_Dt                 BETWEEN Part_rd.eff_from AND Part_rd.eff_to                     )          LEFT JOIN          (              SELECT Org_Abrv,                     Org_Dimn_Id,                     Org_Ver,                     CASE                         WHEN Org_Ver = 1 THEN                             '1900-01-01'                         ELSE                             eff_From                     END AS eff_from,                     COALESCE(eff_to, '9999-01-01 00:00:00.000') AS eff_to              FROM DDSMRT.dbo.VMRT_Organization_Dimension WITH (NOLOCK)              WHERE Org_Abrv IS NOT NULL          ) Poss_rd              ON Poss_rd.Org_Abrv = RMH.Possessor_RR                 AND (Snpsht_Dt                 BETWEEN Poss_rd.eff_from AND Poss_rd.eff_to                     )      WHERE 1 = 1              AND CAST (RMH.Snpsht_Dt AS DATE) >= '2020-01-01'             AND DATENAME(WEEKDAY, RMH.Snpsht_Dt) = 'Friday'  ) x;"
    },
    {
      "id": "Operational_Car_Count",
      "name": "Operational_Car_Count",
      "type": "VIEW",
      "sql": "CREATE VIEW [SV].[Operational_Car_Count]   AS  SELECT     VMRT_Operational_Car_Count.Car_Dimn_Id As Car_Dimn_Id,  VMRT_Operational_Car_Count.Car_Ver As Car_Ver,  VMRT_Operational_Car_Count.Snapshot_Dt_Dimn_Id  As Snapshot_Dt_Dimn_Id,  VMRT_Operational_Car_Count.Reporting_Road_Org_Dimn_Id As Reporting_Road_Org_Dimn_Id,  VMRT_Operational_Car_Count.Reporting_Road_Org_Ver As Reporting_Road_Org_Ver,  VMRT_Operational_Car_Count.Last_Participating_Road_Org_Dimn_Id As Last_Participating_Road_Org_Dimn_Id,  VMRT_Operational_Car_Count.Last_Participating_Road_Org_Ver As Last_Participating_Road_Org_Ver,  VMRT_Operational_Car_Count.Current_Participating_Road_Org_Dimn_Id As Current_Participating_Road_Org_Dimn_Id,  VMRT_Operational_Car_Count.Current_Participating_Road_Org_Ver  As Current_Participating_Road_Org_Ver,  VMRT_Operational_Car_Count.Enroute_Car_Cnt As Enroute_Car_Count,  VMRT_Operational_Car_Count.Enroute_TPE_Cnt As Enroute_TPE_Count,  VMRT_Operational_Car_Count.Enroute_Unit_Cnt As Enroute_Unit_Count,  VMRT_Operational_Car_Count.Enroute_Platform_Cnt As Enroute_Platform_Count,  VMRT_Operational_Car_Count.In_Paid_Storage_Car_Cnt As In_Paid_Storage_Car_Count,  VMRT_Operational_Car_Count.In_Paid_Storage_TPE_Cnt As In_Paid_Storage_TPE_Count,  VMRT_Operational_Car_Count.In_Paid_Storage_Unit_Cnt As In_Paid_Storage_Unit_Count,  VMRT_Operational_Car_Count.In_Paid_Storage_Platform_Cnt As In_Paid_Storage_Platform_Count,  VMRT_Operational_Car_Count.In_Repair_Entity_Car_Cnt As In_Repair_Entity_Car_Count,  VMRT_Operational_Car_Count.In_Repair_Entity_TPE_Cnt As In_Repair_Entity_TPE_Count,  VMRT_Operational_Car_Count.In_Repair_Entity_Unit_Cnt As In_Repair_Entity_Unit_Count,  VMRT_Operational_Car_Count.In_Repair_Entity_Platform_Cnt As In_Repair_Entity_Platform_Count,  VMRT_Operational_Car_Count.On_Railroad_Relief_Car_Cnt As On_Railroad_Relief_Car_Count,  VMRT_Operational_Car_Count.On_Railroad_Relief_TPE_Cnt As On_Railroad_Relief_TPE_Count,  VMRT_Operational_Car_Count.On_Railroad_Relief_Unit_Cnt As On_Railroad_Relief_Unit_Count,  VMRT_Operational_Car_Count.On_Railroad_Relief_Platform_Cnt As On_Railroad_Relief_Platform_Count,  VMRT_Operational_Car_Count.Fleet_In_Service_Car_Cnt As Fleet_In_Service_Car_Count,  VMRT_Operational_Car_Count.Fleet_In_Service_TPE_Cnt As Fleet_In_Service_TPE_Count,  VMRT_Operational_Car_Count.Fleet_In_Service_Unit_Cnt As Fleet_In_Service_Unit_Count,  VMRT_Operational_Car_Count.Fleet_In_Service_Platform_Cnt As Fleet_In_Service_Pltfm_Count,  VMRT_Operational_Car_Count.Distributable_Fleet_Size_Car_Cnt As Distributable_Fleet_Size_Car_Count,  VMRT_Operational_Car_Count.Distributable_Fleet_Size_Platform_Cnt As Distributable_Fleet_Size_Platform_Count,  VMRT_Operational_Car_Count.Distributable_Fleet_Size_TPE_Cnt As Distributable_Fleet_Size_TPE_Count,  VMRT_Operational_Car_Count.Distributable_Fleet_Size_Unit_Cnt As Distributable_Fleet_Size_Unit_Count,  VMRT_Operational_Car_Count.Physical_Fleet_Size_Car_Cnt As Physical_Fleet_Size_Car_Count,  VMRT_Operational_Car_Count.Physical_Fleet_Size_Platform_Cnt As Physical_Fleet_Size_Platform_Count ,  VMRT_Operational_Car_Count.Physical_Fleet_Size_TPE_Cnt As Physical_Fleet_Size_TPE_Count,  VMRT_Operational_Car_Count.Physical_Fleet_Size_Unit_Cnt As Physical_Fleet_Size_Unit_Count  ,  VMRT_Operational_Car_Count.Pooled_Fleet_Size_Car_Cnt As Pooled_Fleet_Size_Car_Count,   VMRT_Operational_Car_Count.Pooled_Fleet_Size_Platform_Cnt As Pooled_Fleet_Size_Platform_Count,  VMRT_Operational_Car_Count.Pooled_Fleet_Size_TPE_Cnt As Pooled_Fleet_Size_TPE_Count,  VMRT_Operational_Car_Count.Pooled_Fleet_Size_Unit_Cnt As Pooled_Fleet_Size_Unit_Count,  VMRT_Operational_Car_Count.Enroute_Owned_Idle_Empty_Car_Cnt_15_Days As Enroute_Owned_Idle_Empty_Car_Count_15_Days,  VMRT_Operational_Car_Count.Physical_Fleet_Size_Owned_Idle_Empty_Car_Cnt_15_Days As   Physical_Fleet_Size_Owned_Idle_Empty_Car_Count_15_Days,  VMRT_Operational_Car_Count.Pooled_Fleet_Size_Owned_Idle_Empty_Car_Cnt_15_Days As Pooled_Fleet_Size_Owned_Idle_Empty_Car_Count_15_Days,  VMRT_Operational_Car_Count.Distributable_Fleet_Size_Owned_Idle_Empty_Car_Cnt_15_Days As Distributable_Fleet_Size_Owned_Idle_Empty_Car_Count_15_Days ,  VMRT_Operational_Car_Count.Enroute_Owned_Idle_Empty_Platform_Cnt_15_Days As Enroute_Owned_Idle_Empty_Platform_Count_15_Days,  VMRT_Operational_Car_Count.Physical_Fleet_Size_Owned_Idle_Empty_Platform_Cnt_15_Days As Physical_Fleet_Size_Owned_Idle_Empty_Platform_Count_15_Days ,  VMRT_Operational_Car_Count.Pooled_Fleet_Size_Owned_Idle_Empty_Platform_Cnt_15_Days As Pooled_Fleet_Size_Owned_Idle_Empty_Platform_Count_15_Days ,  VMRT_Operational_Car_Count.Distributable_Fleet_Size_Owned_Idle_Empty_Platform_Cnt_15_Days As  Distributable_Fleet_Size_Owned_Idle_Empty_Platform_Count_15_Days,  (CASE WHEN [Ld_Empt_Ind] IS NULL THEN 'U' ELSE [Ld_Empt_Ind] END) AS [LE_Status]  ,VMRT_Operational_Car_Count.Offered_for_Relief_Fleet_Size_Car_cnt  ,VMRT_Operational_Car_Count.Offered_for_Relief_Fleet_Size_TPE_cnt  ,VMRT_Operational_Car_Count.Offered_for_Relief_Fleet_Size_Unit_cnt  ,VMRT_Operational_Car_Count.Offered_for_Relief_Fleet_Size_Pltfm_cnt  ,Case when datediff(hour, Liability_Event_Dt , Crtd_Dt) >= 72 and  datediff(hour, Liability_Event_Dt , Crtd_Dt) < 96      then Offered_for_Relief_Fleet_Size_Car_cnt else null end as [Hours since offered 72-96 Car Count]  ,Case when datediff(hour, Liability_Event_Dt , Crtd_Dt) >= 96 and  datediff(hour, Liability_Event_Dt , Crtd_Dt) < 120      then Offered_for_Relief_Fleet_Size_Car_cnt Else Null End as   [Hours since offered 96+ Car Count]        ,Liability_Event_Dt     ,VMRT_Operational_Car_Count.Active_Circulation_Car_Cnt,   VMRT_Operational_Car_Count.Active_Circulation_Truck_Cnt,   VMRT_Operational_Car_Count.Active_Circulation_Unit_Cnt   ,VMRT_Operational_Car_Count.Physical_Fleet_Size_Owned_Idle_Empty_No_Movement_Platform_Cnt_15_Days As Physical_Fleet_Size_Owned_Idle_Empty_No_Movement_Platform_Count_15_Days ,   VMRT_Operational_Car_Count.Physical_Fleet_Size_Owned_Idle_Empty_No_Movement_Car_Cnt_15_Days As   Physical_Fleet_Size_Owned_Idle_Empty_No_Movement_Car_Count_15_Days   FROM dbo.VMRT_Operational_Car_Count"
    },
    {
      "id": "Railroad_Details",
      "name": "Railroad_Details",
      "type": "VIEW",
      "sql": "CREATE view [SV].[Railroad_Details] as       select  Distinct     (CAST(org.[Org_Dimn_Id] AS VARCHAR) + '|' + CAST(org.[Org_Ver] AS VARCHAR)) AS [Org_Id],   org.[Org_Dimn_Id],  org.[Org_Ver],  org.Org_Abrv AS [Railroad Abbreviation],  org.Org_Nm AS [Railroad Name],    Case  Road_Ownrshp_Ind   when 1 then org.Org_Abrv   ELSE  (CASE WHEN org.Org_Abrv ='NS' THEN org.Org_Abrv ELSE  'Other' END)  end as 'Railroad Abbreviation Group'        from ddsmrt.dbo.Organization_Dim (NOLOCK) org  left join [organization_Type_Lookup]  (NOLOCK) typ on (org.Org_Dimn_Id = typ.Org_Dimn_Id and org.Org_Ver = typ.org_ver)  left join (select Org_Dimn_Id, org_ver, Road_Ownrshp_Ind from ddsmrt.dbo.Organization_Membership_Dim  (NOLOCK) where eff_to is null) memb      on (org.Org_Dimn_Id = memb.Org_Dimn_Id )      --(and org.Org_Ver = memb.org_ver)    where (org_Typ_id=105 and Row_Typ_Id=501) or (org.Org_Dimn_Id = -1 and typ.Org_Dimn_Id = -1) or org.Org_Abrv = 'UNKN'  UNION ALL  SELECT '99999|1',99999,1,'NRPC','NRPC','NRPC'"
    },
    {
      "id": "VMRT_Revenue_Hierarchy",
      "name": "VMRT_Revenue_Hierarchy",
      "type": "VIEW",
      "sql": "CREATE VIEW [dbo].[VMRT_Revenue_Hierarchy]  AS  SELECT [Hierchy_Id]   ,[Hierchy_Ver]   ,convert(varchar(25),[Lvl1_Desc])  as Is_In_Service_Desc   ,convert(char(1),[Lvl1_Nm]) as Is_In_Service   ,convert(varchar(50),[Lvl2_Desc]) as Car_Hire_Group   ,convert(varchar(50),[Lvl3_Desc]) as Car_Hire_Subgroup   ,convert(varchar(50),[Attr4_Val_Char]) as Revenue_Service_Code_Short_Desc   ,convert(varchar(4), [Lvl4_Desc]) as Revenue_Service_Code    ,eff_from, eff_to   ,Crtd_Dt,Crtd_Id   ,Lst_Upd_Dt,Lst_Upd_Id  FROM dbo.[Hierarchy_Dim] (NOLOCK)  WHERE [Hierchy_Typ_Id]=154"
    },
    {
      "id": "Railroad_Membership",
      "name": "Railroad_Membership",
      "type": "VIEW",
      "sql": "create view [sv].[Railroad_Membership] as     select      (Cast([Org_Mbrshp_Dimn_Id] AS VARCHAR) + '|' + Cast ([Org_Mbrshp_Ver] AS VARCHAR)) AS [Org_Id],    FORMAT(TTX_Mbrshp_Strt_Dt,'MM/dd/yyyy') AS [Membership Effective Start Date],   FORMAT(TTX_Mbrshp_End_Dt,'MM/dd/yyyy') AS [Membership Effective End Date],   Org_Abrv AS [Railroad Abbreviation],   Org_Nm AS [Railroad Name],   case  Road_Ownrshp_Ind     when 1 then Org_Abrv     else 'Other'   end as 'Railroad Abbreviation Group',    (CASE WHEN Road_Ownrshp_Ind = 1 THEN 'Yes' ELSE 'No' END) AS [Railroad Ownership Indicator],    (CASE WHEN [Signatory_Road_Ind] = 1 THEN 'Yes' ELSE 'No' END) AS [Signatory Road Indicator],   Case Road_Hun_Pct_Stmt_Part_Ind    WHEN 1 THEN 'Yes'    WHEN 0 THEN  'No'   END AS [Railroad Hundred Percent Statement Indicator]         from ddsmrt.dbo.Organization_Membership_Dim (NOLOCK) memb  left join ddsmrt.dbo.Organization_Dim (NOLOCK) org on ( memb.Org_Dimn_Id=org.Org_Dimn_Id and memb.Org_Ver = org.Org_Ver )  left join ddsmrt.dbo.[organization_Type_Lookup] (NOLOCK) typ on (org.Org_Dimn_Id = typ.Org_Dimn_Id and org.Org_Ver = typ.org_ver)    where  (   org_Typ_id=105 and Row_Typ_Id=501 )  or memb.Org_Dimn_Id = -1"
    },
    {
      "id": "Railroad_Reporting_Miles",
      "name": "Railroad_Reporting_Miles",
      "type": "VIEW",
      "sql": "CREATE VIEW [sv].[Railroad_Reporting_Miles]    AS  SELECT     Hierchy_Id ,  Hierchy_Ver ,     Svc_Mth_Dt_Dimn_Id,  Rpt_Mth_Dt_Dimn_Id,    Rptng_Miles.[Org_Mbrshp_Dimn_Id],  Rptng_Miles.[Org_Mbrshp_Ver],  road.Org_Dimn_Id AS Reporting_Railroad_Dimn_Id,  road.Org_ver AS Reporting_Railroad_Ver,  Inct_Typ AS Inct_Type,  Car_Hrs AS Car_Hours,  Car_Hire_Rev AS Car_Hire_Rev,  Load_Mile,  Emp_Mile,  Milg_Rev,  Ernd_Mlg_Amt AS Earned_Milage_Amount,  Inct_Amt AS Inct_Amount,  TPE_Car_Hrs AS TPE_Car_Hours,  TPE_Load_Mile,  TPE_Emp_Mile,  Pnlty_Amt AS Pnlty_Amount    FROM dbo.Tfin_Flet_Perf_Car_Milg_Rev_Fact (NOLOCK) Rptng_Miles     LEFT JOIN VMRT_Railroad_Dimension road ON road.Org_Mbrshp_Dimn_Id = Rptng_Miles.[Org_Mbrshp_Dimn_Id] AND road.Org_Mbrshp_Ver = Rptng_Miles.[Org_Mbrshp_Ver]"
    },
    {
      "id": "VMRT_Vendor_Dimension",
      "name": "VMRT_Vendor_Dimension",
      "type": "VIEW",
      "sql": "CREATE VIEW [dbo].[VMRT_Vendor_Dimension]  AS  SELECT Organization_Dim.Org_Dimn_Id as Vndr_Dimn_Id     ,Organization_Dim.Org_Ver as Vndr_Ver     ,Organization_Dim.Org_Abrv as Vndr_Mfgr_Cd     ,Organization_Dim.Org_Nm as Vndr_Nm     ,Organization_Dim.eff_From     ,Organization_Dim.eff_to     FROM ddsmrt.dbo.Organization_Dim (NOLOCK)       where Organization_Dim.Row_Typ_Id=520"
    },
    {
      "id": "Repair_Entity",
      "name": "Repair_Entity",
      "type": "VIEW",
      "sql": "CREATE VIEW [SV].[Repair_Entity]    AS  SELECT VMRT_Repair_Entity_Dimension.Repr_Enty_Dimn_Id as Repr_Enty_Dimn_Id,  VMRT_Repair_Entity_Dimension.Repr_Enty_Ver as Repr_Enty_Ver,  VMRT_Repair_Entity_Dimension.St_Prov as State,  VMRT_Repair_Entity_Dimension.City as City,  VMRT_Repair_Entity_Dimension.FMO_Zone as FMO_Zone,  VMRT_Repair_Entity_Dimension.Repr_Enty_Org_Abrv  as Repair_Entity_ID,   VMRT_Repair_Entity_Dimension.Repr_Enty_Org_Nm  as Repair_Entity_Name,   VMRT_Repair_Entity_Dimension.Ownr_Org_Abrv   as Repair_Entity_Owner_ID,   VMRT_Repair_Entity_Dimension.Ownr_Org_Nm   as Repair_Entity_Owner_Name,   isnull(VMRT_Repair_Entity_Dimension.Repr_Enty_Typ, 'Unknown') as Repair_Entity_Type_Level_1,  isnull(VMRT_Repair_Entity_Dimension.Ownr_Typ_Desc, 'Unknown') as Repair_Entity_Type_Level_2,  VMRT_Repair_Entity_Dimension.Repr_Shp_Typ as Repair_Shop_Type,  VMRT_Repair_Entity_Dimension.SPLC_Nr as SPLC_Number,  VMRT_Repair_Entity_Dimension.SPLC_Dimn_Id as SPLC_Dimn_Id,  VMRT_Repair_Entity_Dimension.Repr_Enty_Org_Dimn_Id as Repr_Enty_Org_Dimn_Id,  VMRT_Repair_Entity_Dimension.Repr_Enty_Org_Ver as Repr_Enty_Org_Ver,  VMRT_Repair_Entity_Dimension.Prnt_Org_Dimn_Id as Prnt_Org_Dimn_Id   FROM VMRT_Repair_Entity_Dimension"
    },
    {
      "id": "Vendor",
      "name": "Vendor",
      "type": "VIEW",
      "sql": "CREATE VIEW [SV].[Vendor]    AS    SELECT   [Vndr_Dimn_Id]  ,[Vndr_Ver]  ,[Vndr_Mfgr_Cd]  ,[Vndr_Nm]  ,[eff_From]  ,[eff_to]      FROM [dbo].[VMRT_Vendor_Dimension]"
    },
    {
      "id": "Repair_Event_Type",
      "name": "Repair_Event_Type",
      "type": "VIEW",
      "sql": "CREATE VIEW [sv].[Repair_Event_Type](Repr_Evnt_Typ_Cd_Dimn_Id,Repair_Event_Type_ID,Repair_Event_Type_Description)  AS  SELECT VMRT_Repair_Event_Type_Dimension.Repr_Evnt_Typ_Cd_Dimn_Id,VMRT_Repair_Event_Type_Dimension.Repr_Evnt_Typ_Cd,VMRT_Repair_Event_Type_Dimension.Repr_Evnt_Typ_Cd_Desc   FROM DDSMRT.dbo.VMRT_Repair_Event_Type_Dimension"
    },
    {
      "id": "Responsibility_Code",
      "name": "Responsibility_Code",
      "type": "VIEW",
      "sql": "CREATE VIEW [sv].[Responsibility_Code](Resp_Cd_Dimn_Id,Responsibility_Code,Responsibility_Code_Description)  AS  SELECT VMRT_Responsibility_Code_Dimension.Resp_Cd_Dimn_Id,VMRT_Responsibility_Code_Dimension.Resp_Cd,VMRT_Responsibility_Code_Dimension.Resp_Cd_Desc   FROM DDSMRT.dbo.VMRT_Responsibility_Code_Dimension"
    },
    {
      "id": "Shipper",
      "name": "Shipper",
      "type": "VIEW",
      "sql": "CREATE VIEW [sv].[Shipper](Org_Dimn_Id,Org_Ver,Shipper_Abbreviation,Shipper_Name,Eff_From,Eff_To)  AS  SELECT VMRT_Shipper_Dimension.Org_Dimn_Id,VMRT_Shipper_Dimension.Org_Ver,VMRT_Shipper_Dimension.Shipper_Abbreviation,VMRT_Shipper_Dimension.Shipper_Name,VMRT_Shipper_Dimension.Eff_From,    VMRT_Shipper_Dimension.Eff_To   FROM [dbo].[VMRT_Shipper_Dimension]"
    },
    {
      "id": "Sponsoring_Railroad",
      "name": "Sponsoring_Railroad",
      "type": "VIEW",
      "sql": "CREATE VIEW [sv].[Sponsoring_Railroad]  (  Spon_Road_Org_Ver,  Spon_Road_Org_Dimn_Id,  Sponsoring_Railroad_Id,  Sponsoring_Railroad_Name  )  AS  SELECT  VMRT_Sponsoring_Railroad_Dimension.Spon_Road_Org_Ver,  VMRT_Sponsoring_Railroad_Dimension.Spon_Road_Org_Dimn_Id,  VMRT_Sponsoring_Railroad_Dimension.Spon_Road_Org_Abrv,  VMRT_Sponsoring_Railroad_Dimension.Spon_Road_Org_Nm    FROM VMRT_Sponsoring_Railroad_Dimension"
    },
    {
      "id": "Standard_Commodity",
      "name": "Standard_Commodity",
      "type": "VIEW",
      "sql": "CREATE VIEW [SV].[Standard_Commodity]  AS  SELECT    Standard_Commodity_Dim.STCC_Dimn_Id AS STCC_Dimn_Id ,   Standard_Commodity_Dim.STCC_3_Digt AS [3_Digit_STCC],   Standard_Commodity_Dim.STCC AS STCC,   Standard_Commodity_Dim.STCC_Desc AS STCC_Description,   case when STCC is null then Standard_Commodity_Dim.STCC_2_Digt_Desc    else isnull(Standard_Commodity_Dim.STCC_2_Digt_Desc,'All Others') END AS Major_Description,   Standard_Commodity_Dim.STCC_4_Digt AS [4_Digit_STCC],   case when STCC is null then Standard_Commodity_Dim.STCC_5_Digt_Desc    else isnull(Standard_Commodity_Dim.STCC_5_Digt_Desc,'All Others') END AS Minor_Description,   Standard_Commodity_Dim.Cmdy_Grd AS Commodity_Grade,   isnull(Standard_Commodity_Dim.CS54_Grp_Nm,'Unknown') AS CS54_Group_Name,   Standard_Commodity_Dim.NABP_Allw AS NABP_Allowed,   Standard_Commodity_Dim.CS54_Grp_Cd AS CS54_Group_Code,   Standard_Commodity_Dim.TTX_High_Desc,       Standard_Commodity_Dim.TTX_Low_Desc   FROM Standard_Commodity_Dim  WHERE Row_Typ_Id=503 OR Row_Typ_Id =504 or STCC_Dimn_Id =-1"
    },
    {
      "id": "Time",
      "name": "Time",
      "type": "VIEW",
      "sql": "CREATE VIEW [sv].[Time]   AS  SELECT     dbo.Date_Dim.Dt_Dimn_Id AS Dt_Dimn_Id,  dbo.Date_Dim.Dt AS DT,  dbo.Date_Dim.Wkday_Nr AS [Day],  dbo.Date_Dim.Wkday_Nm AS Day_Of_Week,  dbo.Date_Dim.Wk_Nr AS Week_Number,  dbo.Date_Dim.Mth_Abrv AS Month_Name,  dbo.Date_Dim.Mth_Nr AS Month_Number,  dbo.Date_Dim.Qtr_Nr AS Quarter_Number,  dbo.Date_Dim.Qtr_Nm AS Quarter_Name,  dbo.Date_Dim.Yr AS [Year],  dbo.Date_Dim.Dt_Nm AS Day_Name,  dbo.Date_Dim.[Num_Day_Mth]        FROM dbo.Date_Dim (NOLOCK) where dbo.Date_Dim.Dt_Dimn_Id <> '-1'"
    },
    {
      "id": "TTX_Marked_Fleet_Counts",
      "name": "TTX_Marked_Fleet_Counts",
      "type": "VIEW",
      "sql": "CREATE VIEW [SV].[TTX_Marked_Fleet_Counts]   AS  SELECT     VMRT_Maximo_Car_Count.Car_Dimn_Id As Car_Dimn_Id,  VMRT_Maximo_Car_Count.Car_Ver As Car_Ver,  VMRT_Maximo_Car_Count.Snapshot_Dt_Dimn_Id As Snapshot_Date_Dimn_Id,  VMRT_Maximo_Car_Count.Maximo_Fleet_Size_Car_Cnt As Maximo_Fleet_Size_Car_Count ,  VMRT_Maximo_Car_Count.Maximo_Fleet_Size_TPE_Cnt As Maximo_Fleet_Size_TPE_Count,  VMRT_Maximo_Car_Count.Maximo_Fleet_Size_Unit_Cnt As Maximo_Fleet_Size_Unit_Count,  VMRT_Maximo_Car_Count.Maximo_Fleet_Size_Platform_Cnt As Maximo_Fleet_Size_Platform_Count     FROM VMRT_Maximo_Car_Count"
    },
    {
      "id": "TTX_Velocity",
      "name": "TTX_Velocity",
      "type": "VIEW",
      "sql": "CREATE VIEW [SV].[TTX_Velocity]  AS  SELECT   VMRT_TTX_Velocity.Cycle_Fact_Id,  VMRT_TTX_Velocity.Cycle_Seg_Fact_Id,  VMRT_TTX_Velocity.Cycle_Seg_Road_Seg_Fact_Id,  VMRT_TTX_Velocity.Car_Dimn_Id,  VMRT_TTX_Velocity.Car_Ver,  VMRT_TTX_Velocity.Cycle_Seg_Road_Seg_Poss_Road_Org_Dimn_Id AS Cycle_Seg_Poss_Road_Org_Dimn_Id,  VMRT_TTX_Velocity.Cycle_Seg_Road_Seg_Poss_Road_Org_Ver AS Cycle_Seg_Poss_Road_Org_Ver,  VMRT_TTX_Velocity.Cycle_Seg_Road_Seg_Resp_Road_Org_Dimn_Id AS Cycle_Seg_Resp_Road_Org_Dimn_Id,  VMRT_TTX_Velocity.Cycle_Seg_Road_Seg_Resp_Road_Org_Ver AS Cycle_Seg_Resp_Road_Org_Ver,  VMRT_TTX_Velocity.Cycle_Seg_Road_Seg_Lst_Parti_Road_Org_Dimn_Id AS Cycle_Seg_Lst_Parti_Road_Org_Dimn_Id,  VMRT_TTX_Velocity.Cycle_Seg_Road_Seg_Lst_Parti_Road_Org_Ver AS Cycle_Seg_Lst_Parti_Road_Org_Ver,  VMRT_TTX_Velocity.Cycle_Seg_Road_Seg_Begin_Loc_SPLC_Dimn_Id AS Cycle_Seg_Road_Seg_Beg_Loc_SPLC_Dimn_Id,  VMRT_TTX_Velocity.Cycle_Seg_Road_Seg_End_Loc_SPLC_Dimn_Id AS Cycle_Seg_Road_Seg_End_Loc_SPLC_Dimn_Id,  VMRT_TTX_Velocity.Orig_Lst_Parti_road_Org_Dimn_Id,  VMRT_TTX_Velocity.Orig_Lst_Parti_road_Org_Ver,  VMRT_TTX_Velocity.Orig_Resp_road_Org_Dimn_Id,  VMRT_TTX_Velocity.Orig_Resp_road_Org_Ver,  VMRT_TTX_Velocity.Orig_Poss_road_Org_Dimn_Id,  VMRT_TTX_Velocity.Orig_Poss_road_Org_Ver,  VMRT_TTX_Velocity.Origin_Empt_SPLC_Dimn_Id,  VMRT_TTX_Velocity.Dest_Empt_SPLC_Dimn_Id,  VMRT_TTX_Velocity.Origin_Ld_SPLC_Dimn_Id,  VMRT_TTX_Velocity.Dest_Ld_SPLC_Dimn_Id,  VMRT_TTX_Velocity.Empt_Ld_Ind,  VMRT_TTX_Velocity.Cycle_Seg_Typ,  VMRT_TTX_Velocity.Calc_Milg,  VMRT_TTX_Velocity.Calc_Dura,  VMRT_TTX_Velocity.Cycle_Shpr_Org_Dimn_Id,  VMRT_TTX_Velocity.Cycle_Shpr_Org_Ver,  VMRT_TTX_Velocity.Cycle_Begin_Dt_Dimn_Id,  VMRT_TTX_Velocity.Origin_Ld_Org_Dimn_Id,  VMRT_TTX_Velocity.Origin_Ld_Org_Ver,  VMRT_TTX_Velocity.Dest_Ld_Org_Dimn_Id,  VMRT_TTX_Velocity.Dest_Ld_Org_Ver,  VMRT_TTX_Velocity.Origin_Empt_Org_Dimn_Id,  VMRT_TTX_Velocity.Origin_Empt_Org_Ver,  VMRT_TTX_Velocity.Dest_Empt_Org_Dimn_Id,  VMRT_TTX_Velocity.Dest_Empt_Org_Ver,  VMRT_TTX_Velocity.Cycle_End_Dt_Dimn_Id,  VMRT_TTX_Velocity.Cycle_Typ,  VMRT_TTX_Velocity.Invalid_Rsn,  VMRT_TTX_Velocity.Crtd_Dt,  VMRT_TTX_Velocity.Lst_Upd_Dt   FROM dbo.VMRT_TTX_Velocity   where Cycle_Typ = 'SH'"
    }
  ],
  "links": [
    {
      "source": "Why_Made",
      "target": "VMRT_Why_Made_Code_Dimension",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "Vfin_Supplement_Car_Hire_Penalty_Fact",
      "target": "VMRT_Organization_Dimension",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "TTX_Velocity",
      "target": "VMRT_TTX_Velocity",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "Responsibility_Code",
      "target": "VMRT_Responsibility_Code_Dimension",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "Shipper",
      "target": "VMRT_Shipper_Dimension",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "Sponsoring_Railroad",
      "target": "VMRT_Sponsoring_Railroad_Dimension",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "TTX_Marked_Fleet_Counts",
      "target": "VMRT_Maximo_Car_Count",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "Railroad_Reporting_Miles",
      "target": "VMRT_Railroad_Dimension",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "Repair_Entity",
      "target": "VMRT_Repair_Entity_Dimension",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "Vendor",
      "target": "VMRT_Vendor_Dimension",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "Repair_Event_Type",
      "target": "VMRT_Repair_Event_Type_Dimension",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "Availability_Metric",
      "target": "Distribution_Entity",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "Availability_Metric",
      "target": "Time",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "Availability_Metric",
      "target": "VMRT_Organization_Dimension",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "Operational_Car_Count",
      "target": "VMRT_Operational_Car_Count",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "Loading_TTXContainer",
      "target": "VMRT_Loading_TTXContainer",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "Loading_TTXLoaded_Trip_Starts",
      "target": "VMRT_TTX_Loaded_Trip_Starts",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "Availability_Metric",
      "target": "Car_Hire_Status",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "Invoicing_Entity",
      "target": "VMRT_Invoicing_Entity_Dimension",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "Loading_AAR",
      "target": "VMRT_Loading_AAR",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_DQ_Repair_Event_Cost_Fact",
      "target": "vw_Repair_Event_Cost_Fact",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "Condition_Code",
      "target": "VMRT_Condition_Code_Dimension",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "Distribution_Entity",
      "target": "VMRT_Distribution_Entity_Dimension",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_DQ_Cycle_Fact_new",
      "target": "vw_Cycle_Fact_All",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_DQ_Car_Count_Fact_new",
      "target": "vw_Car_Count_Fact",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VCar_Dim",
      "target": "VMRT_Car_Hierarchy_Enterprise",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VCar_Dim",
      "target": "VMRT_Car_Hierarchy_Fleet",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "Revenue_Accounting_Actual_Car_Count_Hist",
      "target": "VMRT_Organization_Membership_Dimension",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "Revenue_Accounting_Actual_Car_Count_Hist",
      "target": "vw_Car_Count_Fact_History",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VTTX_Equipment_Dim",
      "target": "VMRT_Car_Hierarchy_Enterprise",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VTTX_Equipment_Dim",
      "target": "VMRT_Car_Hierarchy_Equipment",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VTTX_Equipment_Dim",
      "target": "VMRT_Car_Hierarchy_Fleet",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VTrips_Fact",
      "target": "VMRT_Trip_Fact",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VTrips_Fact",
      "target": "vw_Trip_Segment_Fact_All",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "Vfin_Flet_Perf_Rev_Est_Car_Cnt_Fact_Hist",
      "target": "VMRT_Car_Dimension_Correct",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "Vfin_Flet_Perf_Rev_Est_Car_Cnt_Fact_Hist",
      "target": "vw_Car_Count_Fact_History",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "Vfin_Flet_Perf_Car_Milg_Car_Cnt_Fact_Hist",
      "target": "VMRT_Car_Dimension_Correct",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "Vfin_Flet_Perf_Car_Milg_Car_Cnt_Fact_Hist",
      "target": "vw_Car_Count_Fact_History",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "Vfin_Flet_Perf_Rev_Act_Car_Cnt_Fact_Hist",
      "target": "VMRT_Car_Dimension_Correct",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "Vfin_Flet_Perf_Rev_Act_Car_Cnt_Fact_Hist",
      "target": "vw_Car_Count_Fact_History",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Revenue_Accounting_Actual_Car_Count_Hist",
      "target": "vw_Car_Count_Fact_History",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Revenue_Accounting_Estimate_Car_Count_Hist",
      "target": "vw_Car_Count_Fact_History",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_DQ_Car_Count_Fact_new_Hist",
      "target": "vw_Car_Count_Fact_History",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VRepair_Responsibility_Dim",
      "target": "VMRT_Responsibility_Code_Dimension",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Revenue_Accounting_Accrual_Car_Count_Hist",
      "target": "vw_Car_Count_Fact_History",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VRepair_Type_Dim",
      "target": "VMRT_Repair_Event_Type_Dimension",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VRepair_Event_Cost_Fact",
      "target": "vw_Repair_Event_Cost_Fact",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "TTX_Marked_Fleet_Counts_Hist",
      "target": "VMRT_Maximo_Car_Count_Hist",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VRepair_Reason_Dim",
      "target": "VMRT_Why_Made_Code_Dimension",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "Operational_Car_Count_Hist",
      "target": "VMRT_Operational_Car_Count_Hist",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VRepair_Entity_Dim",
      "target": "VMRT_Repair_Entity_Dimension",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Maximo_Car_Count_Hist",
      "target": "vw_Car_Count_Fact_History",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "Revenue_Accounting_Car_Count_Hist",
      "target": "vw_Car_Count_Fact_History",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VPool_Contribution_Fact_History",
      "target": "vw_Pool_Contribution_Fact_History",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VPool_Contribution_Fact",
      "target": "vw_Pool_Contribution_Fact_All",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "Revenue_Accounting_Car_Count_Hist",
      "target": "Revenue_Accounting_Accrual_Car_Count_Hist",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "Revenue_Accounting_Car_Count_Hist",
      "target": "Revenue_Accounting_Estimate_Car_Count_Hist",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "Revenue_Accounting_Accrual_Car_Count_Hist",
      "target": "VMRT_Organization_Membership_Dimension",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "Revenue_Accounting_Accrual_Car_Count_Hist",
      "target": "vw_Car_Count_Fact_History",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "Revenue_Accounting_Estimate_Car_Count_Hist",
      "target": "VMRT_Organization_Membership_Dimension",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "Revenue_Accounting_Estimate_Car_Count_Hist",
      "target": "vw_Car_Count_Fact_History",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "USP_I_Wheelset_Repair_Outlier",
      "target": "Geography",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VInvoicing_Entity_Dim",
      "target": "VMRT_Invoicing_Entity_Dimension",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "USP_I_Wheelset_Repair_Outlier",
      "target": "Area_of_Car",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "Vfin_Flet_Perf_Rev_Est_Car_Cnt_Fact",
      "target": "vw_Car_Count_Fact_All",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "Vfin_Flet_Perf_Rev_Act_Car_Cnt_Fact",
      "target": "vw_Car_Count_Fact_All",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "Loading_TTXLoaded_Trip_Starts_History",
      "target": "VMRT_TTX_Loaded_Trip_Starts_History",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "Vfin_Flet_Perf_Rev_Est_Car_Cnt_Fact",
      "target": "VMRT_Car_Dimension_Correct",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_TTX_Loaded_Trip_Starts_History",
      "target": "vw_Trip_Segment_Fact_All",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VTrips_Fact_History",
      "target": "VMRT_Trip_Fact_History",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VTrips_Fact_History",
      "target": "vw_Trip_Segment_Fact_All",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "Vfin_Flet_Perf_Rev_Act_Car_Cnt_Fact",
      "target": "VMRT_Car_Dimension_Correct",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Trip_Fact_History",
      "target": "vw_Trip_Fact_History",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Trip_Seg_Fact_History",
      "target": "vw_Trip_Segment_Fact_History",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_TTX_Loaded_Trip_Starts_History",
      "target": "vw_Trip_Fact_History",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "Vfin_Flet_Perf_Car_Milg_Car_Cnt_Fact",
      "target": "VMRT_Car_Dimension_Correct",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "Vfin_Flet_Perf_Car_Milg_Car_Cnt_Fact",
      "target": "vw_Car_Count_Fact_All",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VCycles_Fact",
      "target": "vw_Cycle_Fact_All",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VCycles_Fact",
      "target": "vw_Cycle_Seg_Fact_All",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VCycles_Fact",
      "target": "vw_Cycle_Seg_Road_Seg_Fact_All",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_UFD_Mileage",
      "target": "VMRT_Car_Dimension_Correct",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_UFD_Mileage",
      "target": "vw_UFD_Milg_Fact_All",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VCycles_Fact",
      "target": "VMRT_Organization_Dimension",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_UFD_Act_Car_Milg_Fact",
      "target": "VMRT_Actual_Mileage",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_UFD_Act_Car_Milg_Fact",
      "target": "VMRT_Car_Dimension_Correct",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_UFD_Act_Car_Milg_Fact",
      "target": "VMRT_Organization_Membership_Dimension",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_UFD_Act_Car_Milg_Fact",
      "target": "vw_UFD_Milg_Fact_All",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "Forecast_Planning",
      "target": "VMRT_Car_Dimension_Correct",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "Forecast_Planning",
      "target": "VMRT_Car_Hierarchy_Enterprise",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VCondition_Code_Dim",
      "target": "VMRT_Condition_Code_Dimension",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VCar_Characteristics_Dim",
      "target": "VMRT_Car_Hierarchy_Enterprise",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "Revenue_Accounting_Car_Count",
      "target": "Revenue_Accounting_Accrual_Car_Count",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "Revenue_Accounting_Car_Count",
      "target": "Revenue_Accounting_Estimate_Car_Count",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "Revenue_Accounting_Car_Count",
      "target": "vw_Car_Count_Fact",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "Revenue_Accounting_Estimate_Car_Count",
      "target": "VMRT_Organization_Membership_Dimension",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "Revenue_Accounting_Estimate_Car_Count",
      "target": "vw_Car_Count_Fact",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "Revenue_Accounting_Accrual_Car_Count",
      "target": "vw_Car_Count_Fact",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "Revenue_Accounting_Actual_Car_Count",
      "target": "VMRT_Organization_Membership_Dimension",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "Revenue_Accounting_Actual_Car_Count",
      "target": "vw_Car_Count_Fact",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "Vast_Stat_Cd_Dimn",
      "target": "VMRT_Car_Dimension_Correct",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "Repair_Event_Cost",
      "target": "vw_Repair_Event_Cost_Fact",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "Revenue_Accounting_Accrual_Car_Count",
      "target": "VMRT_Organization_Membership_Dimension",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "Car",
      "target": "VMRT_Car_Dimension",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Trip_Seg_Fact",
      "target": "vw_Trip_Segment_Fact",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_TTX_Loaded_Trip_Starts",
      "target": "vw_Trip_Fact",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_TTX_Loaded_Trip_Starts",
      "target": "vw_Trip_Segment_Fact_All",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Trip_Fact",
      "target": "vw_Trip_Fact_All",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "attrep_fn_NumericLsnToHexa",
      "target": "attrep_fn_LsnSegmentToHexa",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "Actual_Reported_Mileage",
      "target": "VMRT_Actual_Mileage",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Revenue_Accounting_Estimate_Car_Count",
      "target": "vw_Car_Count_Fact",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "Accrual_Reported_Mileage",
      "target": "VMRT_Accrual_Mileage",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VCar_Dim_Correct",
      "target": "VMRT_Car_Hierarchy_Enterprise",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VCar_Dim_Correct",
      "target": "VMRT_Car_Hierarchy_Fleet",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "vwAARWheelForecasting",
      "target": "VMRT_Car_Hierarchy_Eshift",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Revenue_Accounting_Actual_Car_Count",
      "target": "vw_Car_Count_Fact",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "Repair_Event_Cost_History",
      "target": "vw_Repair_Event_Cost_Fact_History",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Revenue_Accounting_Accrual_Car_Count",
      "target": "vw_Car_Count_Fact",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_DQ_Repair_Event_Cost_Fact_History",
      "target": "vw_Repair_Event_Cost_Fact_History",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VRepair_Event_Cost_Fact_History",
      "target": "vw_Repair_Event_Cost_Fact_History",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Maximo_Car_Count",
      "target": "vw_Car_Count_Fact",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Cycle_Seg_Fact",
      "target": "vw_Cycle_Seg_Fact_All",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Cycle_Seg_Road_Seg_Fact",
      "target": "vw_Cycle_Seg_Road_Seg_Fact_All",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_TTX_Velocity",
      "target": "VMRT_Cycle_Fact",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_TTX_Velocity",
      "target": "VMRT_Cycle_Seg_Fact",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_TTX_Velocity",
      "target": "VMRT_Cycle_Seg_Road_Seg_Fact",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Revenue_Accounting_Estimated_Car_Hire_Revenue_Pivot",
      "target": "VMRT_Car_Hierarchy_Enterprise",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Revenue_Accounting_Estimated_Car_Hire_Revenue_Pivot",
      "target": "VMRT_Organization_Dimension",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Revenue_Accounting_Estimated_Car_Hire_Revenue_Pivot",
      "target": "VMRT_Revenue_Hierarchy",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Cycle_Fact",
      "target": "vw_Cycle_Fact",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Revenue_Accounting_Estimated_Car_Hire_Revenue",
      "target": "VMRT_Revenue_Hierarchy",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Loading_TTXContainer",
      "target": "VMRT_Car_Dimension_Correct",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Revenue_Accounting_Estimated_Car_Hire_Revenue",
      "target": "VMRT_Car_Hierarchy_Enterprise",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Revenue_Accounting_Estimated_Car_Hire_Revenue",
      "target": "VMRT_Organization_Dimension",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Revenue_Accounting_Actual_Car_Hire_Revenue_Pivot",
      "target": "VMRT_Car_Hierarchy_Enterprise",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Revenue_Accounting_Actual_Car_Hire_Revenue_Pivot",
      "target": "VMRT_Organization_Dimension",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Revenue_Accounting_Actual_Car_Hire_Revenue_Pivot",
      "target": "VMRT_Revenue_Hierarchy",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Revenue_Accounting_Actual_Car_Hire_Revenue",
      "target": "VMRT_Car_Hierarchy_Enterprise",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Revenue_Accounting_Actual_Car_Hire_Revenue",
      "target": "VMRT_Organization_Dimension",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Revenue_Accounting_Actual_Car_Hire_Revenue",
      "target": "VMRT_Revenue_Hierarchy",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Revenue_Accounting_Accrual_Car_Hire_Revenue_Pivot",
      "target": "VMRT_Revenue_Hierarchy",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "Car_Correct",
      "target": "VMRT_Car_Dimension_Correct",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Revenue_Accounting_Accrual_Car_Hire_Revenue_Pivot",
      "target": "VMRT_Car_Hierarchy_Enterprise",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Revenue_Accounting_Accrual_Car_Hire_Revenue_Pivot",
      "target": "VMRT_Organization_Dimension",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Revenue_Accounting_Accrual_Car_Hire_Revenue",
      "target": "VMRT_Car_Hierarchy_Enterprise",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Revenue_Accounting_Accrual_Car_Hire_Revenue",
      "target": "VMRT_Organization_Dimension",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Revenue_Accounting_Accrual_Car_Hire_Revenue",
      "target": "VMRT_Revenue_Hierarchy",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VCycles_Fact_History",
      "target": "vw_Cycle_Seg_Fact_All",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VCycles_Fact_History",
      "target": "vw_Cycle_Seg_Road_Seg_Fact_All",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_TTX_Velocity_History",
      "target": "VMRT_Cycle_Seg_Road_Seg_Fact",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "TTX_Velocity_History",
      "target": "VMRT_TTX_Velocity_History",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VCycles_Fact_History",
      "target": "VMRT_Organization_Dimension",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VCycles_Fact_History",
      "target": "vw_Cycle_Fact_History",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Cycle_Fact_History",
      "target": "vw_Cycle_Fact_History",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "Badorder_Snapshot",
      "target": "Car_Correct",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_TTX_Velocity_History",
      "target": "VMRT_Cycle_Fact_History",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_TTX_Velocity_History",
      "target": "VMRT_Cycle_Seg_Fact",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "Car_Mileage_Fact",
      "target": "Car_Correct",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "vw_Car_Health_Snapshot",
      "target": "Time",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "vw_Car_Health_Snapshot",
      "target": "VMRT_Car_Dimension_Correct",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "Vfin_Supplement_Loaded_Penalty_Fact",
      "target": "VMRT_Organization_Dimension",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Car_Dimension",
      "target": "VMRT_Car_Hierarchy_Equipment",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Car_Dimension",
      "target": "VMRT_Car_Hierarchy_Equipment",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Car_Dimension",
      "target": "VMRT_Car_Hierarchy_Equipment",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Car_Dimension",
      "target": "VMRT_Car_Hierarchy_Equipment",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Car_Dimension",
      "target": "VMRT_Car_Hierarchy_Equipment",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Car_Dimension",
      "target": "VMRT_Car_Hierarchy_Equipment",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Car_Dimension",
      "target": "VMRT_Car_Hierarchy_Enterprise",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Car_Dimension",
      "target": "VMRT_Car_Hierarchy_Enterprise",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Car_Dimension",
      "target": "VMRT_Car_Hierarchy_Enterprise",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Car_Dimension",
      "target": "VMRT_Car_Hierarchy_Enterprise",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Car_Dimension",
      "target": "VMRT_Car_Hierarchy_Enterprise",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Car_Dimension",
      "target": "VMRT_Car_Hierarchy_Enterprise",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Car_Dimension",
      "target": "VMRT_Car_Hierarchy_Enterprise",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Car_Dimension",
      "target": "VMRT_Car_Hierarchy_Enterprise",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Car_Dimension",
      "target": "VMRT_Car_Hierarchy_Enterprise",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Car_Dimension",
      "target": "VMRT_Car_Hierarchy_Enterprise",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Car_Dimension",
      "target": "VMRT_Car_Hierarchy_Enterprise",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Car_Dimension",
      "target": "VMRT_Car_Hierarchy_Enterprise",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Car_Dimension",
      "target": "VMRT_Car_Hierarchy_Enterprise",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Car_Dimension",
      "target": "VMRT_Car_Hierarchy_Fleet",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Car_Dimension",
      "target": "VMRT_Car_Hierarchy_Fleet",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Car_Dimension",
      "target": "VMRT_Car_Hierarchy_Fleet",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Car_Dimension",
      "target": "VMRT_Car_Hierarchy_Fleet",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Car_Dimension",
      "target": "VMRT_Car_Hierarchy_Fleet",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Car_Dimension",
      "target": "VMRT_Car_Hierarchy_Fleet",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Car_Dimension_Hist",
      "target": "VMRT_Car_Hierarchy_Equipment",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Car_Dimension_Hist",
      "target": "VMRT_Car_Hierarchy_Equipment",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Car_Dimension_Hist",
      "target": "VMRT_Car_Hierarchy_Equipment",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Car_Dimension_Hist",
      "target": "VMRT_Car_Hierarchy_Equipment",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Car_Dimension_Hist",
      "target": "VMRT_Car_Hierarchy_Equipment",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Car_Dimension_Hist",
      "target": "VMRT_Car_Hierarchy_Equipment",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Car_Dimension_Hist",
      "target": "VMRT_Car_Hierarchy_Enterprise",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Car_Dimension_Hist",
      "target": "VMRT_Car_Hierarchy_Enterprise",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Car_Dimension_Hist",
      "target": "VMRT_Car_Hierarchy_Enterprise",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Car_Dimension_Hist",
      "target": "VMRT_Car_Hierarchy_Enterprise",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Car_Dimension_Hist",
      "target": "VMRT_Car_Hierarchy_Enterprise",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Car_Dimension_Hist",
      "target": "VMRT_Car_Hierarchy_Enterprise",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Car_Dimension_Hist",
      "target": "VMRT_Car_Hierarchy_Enterprise",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Car_Dimension_Hist",
      "target": "VMRT_Car_Hierarchy_Enterprise",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Car_Dimension_Hist",
      "target": "VMRT_Car_Hierarchy_Enterprise",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Car_Dimension_Hist",
      "target": "VMRT_Car_Hierarchy_Enterprise",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Car_Dimension_Hist",
      "target": "VMRT_Car_Hierarchy_Enterprise",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Car_Dimension_Hist",
      "target": "VMRT_Car_Hierarchy_Enterprise",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Car_Dimension_Hist",
      "target": "VMRT_Car_Hierarchy_Enterprise",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Car_Dimension_Hist",
      "target": "VMRT_Car_Hierarchy_Fleet",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Car_Dimension_Hist",
      "target": "VMRT_Car_Hierarchy_Fleet",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Car_Dimension_Hist",
      "target": "VMRT_Car_Hierarchy_Fleet",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Car_Dimension_Hist",
      "target": "VMRT_Car_Hierarchy_Fleet",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Car_Dimension_Hist",
      "target": "VMRT_Car_Hierarchy_Fleet",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Car_Dimension_Hist",
      "target": "VMRT_Car_Hierarchy_Fleet",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Car_Dimension_Correct",
      "target": "VMRT_Car_Hierarchy_Eshift",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Car_Dimension_Correct",
      "target": "VMRT_Car_Hierarchy_Eshift",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Car_Dimension_Correct",
      "target": "VMRT_Car_Hierarchy_Eshift",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Car_Dimension_Correct",
      "target": "VMRT_Car_Hierarchy_Eshift",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Car_Dimension_Correct",
      "target": "VMRT_Car_Hierarchy_Eshift",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Car_Dimension_Correct",
      "target": "VMRT_Car_Hierarchy_Eshift",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Car_Dimension_Correct",
      "target": "VMRT_Car_Hierarchy_Enterprise",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Car_Dimension_Correct",
      "target": "VMRT_Car_Hierarchy_Enterprise",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Car_Dimension_Correct",
      "target": "VMRT_Car_Hierarchy_Enterprise",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Car_Dimension_Correct",
      "target": "VMRT_Car_Hierarchy_Enterprise",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Car_Dimension_Correct",
      "target": "VMRT_Car_Hierarchy_Enterprise",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Car_Dimension_Correct",
      "target": "VMRT_Car_Hierarchy_Enterprise",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Car_Dimension_Correct",
      "target": "VMRT_Car_Hierarchy_Enterprise",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Car_Dimension_Correct",
      "target": "VMRT_Car_Hierarchy_Enterprise",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Car_Dimension_Correct",
      "target": "VMRT_Car_Hierarchy_Enterprise",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Car_Dimension_Correct",
      "target": "VMRT_Car_Hierarchy_Enterprise",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Car_Dimension_Correct",
      "target": "VMRT_Car_Hierarchy_Enterprise",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Car_Dimension_Correct",
      "target": "VMRT_Car_Hierarchy_Enterprise",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Car_Dimension_Correct",
      "target": "VMRT_Car_Hierarchy_Enterprise",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Car_Dimension_Correct",
      "target": "VMRT_Car_Hierarchy_Fleet",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Car_Dimension_Correct",
      "target": "VMRT_Car_Hierarchy_Fleet",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Car_Dimension_Correct",
      "target": "VMRT_Car_Hierarchy_Fleet",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Car_Dimension_Correct",
      "target": "VMRT_Car_Hierarchy_Equipment",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Car_Dimension_Correct",
      "target": "VMRT_Car_Hierarchy_Equipment",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Car_Dimension_Correct",
      "target": "VMRT_Car_Hierarchy_Equipment",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Car_Dimension_Correct",
      "target": "VMRT_Car_Hierarchy_Fleet",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Car_Dimension_Correct",
      "target": "VMRT_Car_Hierarchy_Fleet",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Car_Dimension_Correct",
      "target": "VMRT_Car_Hierarchy_Fleet",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Car_Dimension_Correct",
      "target": "VMRT_Car_Hierarchy_Eshift",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Car_Dimension_Correct",
      "target": "VMRT_Car_Hierarchy_Eshift",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Car_Dimension_Correct",
      "target": "VMRT_Car_Hierarchy_Eshift",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Car_Dimension_Correct",
      "target": "VMRT_Car_Hierarchy_Equipment",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Car_Dimension_Correct",
      "target": "VMRT_Car_Hierarchy_Equipment",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Car_Dimension_Correct",
      "target": "VMRT_Car_Hierarchy_Equipment",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Operational_Car_Count",
      "target": "VMRT_Car_Dimension_Correct",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Operational_Car_Count",
      "target": "VMRT_Car_Dimension_Correct",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Operational_Car_Count",
      "target": "VMRT_Car_Dimension_Correct",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Operational_Car_Count",
      "target": "VMRT_Car_Dimension_Correct",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Operational_Car_Count",
      "target": "VMRT_Car_Dimension_Correct",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Operational_Car_Count",
      "target": "VMRT_Car_Dimension_Correct",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Operational_Car_Count",
      "target": "vw_Car_Count_Fact",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Operational_Car_Count",
      "target": "vw_Car_Count_Fact",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Operational_Car_Count",
      "target": "vw_Car_Count_Fact",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Operational_Car_Count",
      "target": "vw_Car_Count_Fact",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Operational_Car_Count",
      "target": "vw_Car_Count_Fact",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Operational_Car_Count",
      "target": "vw_Car_Count_Fact",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Operational_Car_Count",
      "target": "vw_Car_Count_Fact",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Operational_Car_Count",
      "target": "vw_Car_Count_Fact",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Operational_Car_Count",
      "target": "vw_Car_Count_Fact",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Operational_Car_Count",
      "target": "vw_Car_Count_Fact",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Operational_Car_Count",
      "target": "vw_Car_Count_Fact",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Operational_Car_Count",
      "target": "vw_Car_Count_Fact",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Operational_Car_Count",
      "target": "vw_Car_Count_Fact",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Operational_Car_Count",
      "target": "vw_Car_Count_Fact",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Operational_Car_Count",
      "target": "vw_Car_Count_Fact",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Operational_Car_Count",
      "target": "vw_Car_Count_Fact",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Operational_Car_Count",
      "target": "vw_Car_Count_Fact",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Operational_Car_Count",
      "target": "vw_Car_Count_Fact",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Operational_Car_Count",
      "target": "vw_Car_Count_Fact",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Operational_Car_Count",
      "target": "vw_Car_Count_Fact",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Operational_Car_Count",
      "target": "VMRT_Car_Dimension_Correct",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Operational_Car_Count",
      "target": "VMRT_Car_Dimension_Correct",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Operational_Car_Count",
      "target": "vw_Car_Count_Fact",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Operational_Car_Count",
      "target": "vw_Car_Count_Fact",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Operational_Car_Count",
      "target": "vw_Car_Count_Fact",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Operational_Car_Count",
      "target": "vw_Car_Count_Fact",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Operational_Car_Count_Hist",
      "target": "VMRT_Car_Dimension_Correct",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Operational_Car_Count_Hist",
      "target": "VMRT_Car_Dimension_Correct",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Operational_Car_Count_Hist",
      "target": "VMRT_Car_Dimension_Correct",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Operational_Car_Count_Hist",
      "target": "VMRT_Car_Dimension_Correct",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Operational_Car_Count_Hist",
      "target": "VMRT_Car_Dimension_Correct",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Operational_Car_Count_Hist",
      "target": "VMRT_Car_Dimension_Correct",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Operational_Car_Count_Hist",
      "target": "vw_Car_Count_Fact_History",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Operational_Car_Count_Hist",
      "target": "vw_Car_Count_Fact_History",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Operational_Car_Count_Hist",
      "target": "vw_Car_Count_Fact_History",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Operational_Car_Count_Hist",
      "target": "vw_Car_Count_Fact_History",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Operational_Car_Count_Hist",
      "target": "vw_Car_Count_Fact_History",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Operational_Car_Count_Hist",
      "target": "vw_Car_Count_Fact_History",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Operational_Car_Count_Hist",
      "target": "vw_Car_Count_Fact_History",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Operational_Car_Count_Hist",
      "target": "vw_Car_Count_Fact_History",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Operational_Car_Count_Hist",
      "target": "vw_Car_Count_Fact_History",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Operational_Car_Count_Hist",
      "target": "vw_Car_Count_Fact_History",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Operational_Car_Count_Hist",
      "target": "vw_Car_Count_Fact_History",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Operational_Car_Count_Hist",
      "target": "vw_Car_Count_Fact_History",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Operational_Car_Count_Hist",
      "target": "vw_Car_Count_Fact_History",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Operational_Car_Count_Hist",
      "target": "vw_Car_Count_Fact_History",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Operational_Car_Count_Hist",
      "target": "vw_Car_Count_Fact_History",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Operational_Car_Count_Hist",
      "target": "vw_Car_Count_Fact_History",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Operational_Car_Count_Hist",
      "target": "vw_Car_Count_Fact_History",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Operational_Car_Count_Hist",
      "target": "vw_Car_Count_Fact_History",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Operational_Car_Count_Hist",
      "target": "vw_Car_Count_Fact_History",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Operational_Car_Count_Hist",
      "target": "vw_Car_Count_Fact_History",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Operational_Car_Count_Hist",
      "target": "VMRT_Car_Dimension_Correct",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Operational_Car_Count_Hist",
      "target": "VMRT_Car_Dimension_Correct",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Operational_Car_Count_Hist",
      "target": "vw_Car_Count_Fact_History",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Operational_Car_Count_Hist",
      "target": "vw_Car_Count_Fact_History",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Operational_Car_Count_Hist",
      "target": "vw_Car_Count_Fact_History",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Operational_Car_Count_Hist",
      "target": "vw_Car_Count_Fact_History",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Car_Dimension_Correct_Hist",
      "target": "VMRT_Car_Hierarchy_Equipment",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Car_Dimension_Correct_Hist",
      "target": "VMRT_Car_Hierarchy_Equipment",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Car_Dimension_Correct_Hist",
      "target": "VMRT_Car_Hierarchy_Equipment",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Car_Dimension_Correct_Hist",
      "target": "VMRT_Car_Hierarchy_Equipment",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Car_Dimension_Correct_Hist",
      "target": "VMRT_Car_Hierarchy_Equipment",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Car_Dimension_Correct_Hist",
      "target": "VMRT_Car_Hierarchy_Equipment",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Car_Dimension_Correct_Hist",
      "target": "VMRT_Car_Hierarchy_Enterprise",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Car_Dimension_Correct_Hist",
      "target": "VMRT_Car_Hierarchy_Enterprise",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Car_Dimension_Correct_Hist",
      "target": "VMRT_Car_Hierarchy_Enterprise",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Car_Dimension_Correct_Hist",
      "target": "VMRT_Car_Hierarchy_Enterprise",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Car_Dimension_Correct_Hist",
      "target": "VMRT_Car_Hierarchy_Enterprise",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Car_Dimension_Correct_Hist",
      "target": "VMRT_Car_Hierarchy_Enterprise",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Car_Dimension_Correct_Hist",
      "target": "VMRT_Car_Hierarchy_Enterprise",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Car_Dimension_Correct_Hist",
      "target": "VMRT_Car_Hierarchy_Enterprise",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Car_Dimension_Correct_Hist",
      "target": "VMRT_Car_Hierarchy_Enterprise",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Car_Dimension_Correct_Hist",
      "target": "VMRT_Car_Hierarchy_Enterprise",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Car_Dimension_Correct_Hist",
      "target": "VMRT_Car_Hierarchy_Enterprise",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Car_Dimension_Correct_Hist",
      "target": "VMRT_Car_Hierarchy_Enterprise",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Car_Dimension_Correct_Hist",
      "target": "VMRT_Car_Hierarchy_Enterprise",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Car_Dimension_Correct_Hist",
      "target": "VMRT_Car_Hierarchy_Fleet",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Car_Dimension_Correct_Hist",
      "target": "VMRT_Car_Hierarchy_Fleet",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Car_Dimension_Correct_Hist",
      "target": "VMRT_Car_Hierarchy_Fleet",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Car_Dimension_Correct_Hist",
      "target": "VMRT_Car_Hierarchy_Fleet",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Car_Dimension_Correct_Hist",
      "target": "VMRT_Car_Hierarchy_Fleet",
      "kind": "DEPENDS_ON"
    },
    {
      "source": "VMRT_Car_Dimension_Correct_Hist",
      "target": "VMRT_Car_Hierarchy_Fleet",
      "kind": "DEPENDS_ON"
    }
  ]
}  </script>

  <script>
// ---------- state ----------
let fullData = { nodes: [], links: [] };
let currentRoot = null;
let searchIndex = [];
let lastLoad = {
  data: null,
  mode: 'demo',
  view: 'neighborhood',
  radius: 4,
  startId: null
};

// ---------- graph ----------
const g = ForceGraph3D()(document.getElementById('canvas'))
  .backgroundColor('#0b0f14')
  .nodeAutoColorBy('type')
  .nodeLabel(n => n.name || n.id)
  .nodeVal(n => Math.max(2, Math.min(10, 2 + (n.degree || 0) * 0.4)))
  .nodeRelSize(6)
  .linkColor(() => '#888')
  .linkOpacity(0.6)
  .enableNodeDrag(false)
  .showNavInfo(false)
  .onNodeClick(node => {
    currentRoot = node.id;
    showDetails(node);
    renderNeighborhood(node.id, getRadius());
  });
g.d3Force('charge').strength(-180);

// ----- Camera and Controls -----
const camera = g.camera();
const controls = g.controls();
camera.far = 10000;
camera.updateProjectionMatrix();
controls.minDistance = 1;
controls.maxDistance = 10000;
controls.enableDamping = true;
controls.dampingFactor = 0.05;
controls.enablePan = true;
controls.minPolarAngle = 0;
controls.maxPolarAngle = Math.PI;

// ----- Node Render -----
const colorByType = t => ({ Table:'#4aa3ff', View:'#9b59b6', Proc:'#f1c40f' }[t] || '#9aa4af');
g.nodeThreeObject(n => {
  const s = Math.max(2, Math.min(10, 2 + (n.degree || 0) * 0.4));
  const geom = new THREE.SphereGeometry(s, 24, 24);
  const mat  = new THREE.MeshStandardMaterial({ color: colorByType(n.type), roughness: 0.6, metalness: 0.1 });
  return new THREE.Mesh(geom, mat);
});
g.nodeThreeObjectExtend(false);

// ----- Graph Forces -----
g.cooldownTicks(400).cooldownTime(16000).d3VelocityDecay(0.18);
g.d3Force('link')
  .distance(l => 70 + 3 * Math.sqrt((l.source.degree || 0) + (l.target.degree || 0)))
  .strength(0.25);
g.d3Force('charge').strength(-180);

// ----- Lighting -----
const scene = g.scene();
scene.add(new THREE.AmbientLight(0xffffff, 0.9));
const dir = new THREE.DirectionalLight(0xffffff, 0.7);
dir.position.set(80, 80, 80);
scene.add(dir);

// ----- Labels -----
let labelsOn = false;
const btnLabels = document.getElementById('btnLabels');
const labelFn = n => n.name || n.id;
const labelDivs = new Map();

function toggleLabels(on) {
  labelsOn = on;
  btnLabels.textContent = on ? 'Hide Object Names' : 'Show Object Names';
  labelDivs.forEach(el => el.remove());
  labelDivs.clear();

  if (on) {
    const container = g.renderer().domElement.parentElement;
    g.graphData().nodes.forEach(n => {
      const el = document.createElement('div');
      el.textContent = labelFn(n);
      Object.assign(el.style, {
        position: 'absolute',
        color: '#fff',
        background: 'rgba(20,20,20,0.8)',
        font: '12px sans-serif',
        padding: '2px 6px',
        borderRadius: '4px',
        pointerEvents: 'none',
        whiteSpace: 'nowrap',
        transform: 'translate(-50%,-50%)'
      });
      container.appendChild(el);
      labelDivs.set(n, el);
    });

    g.onRenderFrame(() => {
      const camera = g.camera();
      const renderer = g.renderer();
      const width = renderer.domElement.clientWidth;
      const height = renderer.domElement.clientHeight;
      const vector = new THREE.Vector3();
      g.graphData().nodes.forEach(n => {
        const el = labelDivs.get(n);
        if (!el) return;
        vector.copy(n.x ? {x:n.x,y:n.y,z:n.z} : {x:0,y:0,z:0});
        vector.project(camera);
        el.style.left = `${(vector.x * 0.5 + 0.5) * width}px`;
        el.style.top  = `${(-vector.y * 0.5 + 0.5) * height}px`;
        el.style.display = (vector.z < 1) ? 'block' : 'none';
      });
    });
  } else {
    g.onRenderFrame(() => {}); // No overlays
  }
}
btnLabels.addEventListener('click', () => toggleLabels(!labelsOn));

// ----- Sidebar Toggle -----
const handle = document.getElementById('toggleHandle');
const collapseKey = 'sidebar-collapsed';
function setHandleIcon() {
  handle.textContent = document.body.classList.contains('sidebar-collapsed') ? '▸' : '◂';
}
function fitGraph() { try { g.zoomToFit(400, 60); } catch(_) {} }
if (localStorage.getItem(collapseKey) === '1') document.body.classList.add('sidebar-collapsed');
setHandleIcon();
setTimeout(() => { window.dispatchEvent(new Event('resize')); fitGraph(); }, 80);

handle.addEventListener('click', () => {
  const willOpen = document.body.classList.contains('sidebar-collapsed');
  document.body.classList.toggle('sidebar-collapsed');
  localStorage.setItem(collapseKey, document.body.classList.contains('sidebar-collapsed') ? '1':'0');
  setHandleIcon();
  setTimeout(() => {
    window.dispatchEvent(new Event('resize'));
  }, 260);
});

// ----- File Loader -----
document.getElementById('file').addEventListener('change', async (e) => {
  const file = e.target.files[0];
  if (!file) return;
  try {
    const text = await file.text();
    const json = JSON.parse(text);
    loadGraph(json);
    lastLoad = { data: JSON.parse(JSON.stringify(fullData)), mode:'file', view:'full', radius:getRadius(), startId: fullData.nodes[0]?.id || null };
    afterLoad({ full:true });
    logSys(`Model loaded: ${fullData.nodes.length} nodes, ${fullData.links.length} links.`);
  } catch (err) {
    console.error(err);
    logSys('Invalid JSON file.');
  }
});

// ----- Demo Loader -----
function loadTTXDemo() {
  const tag = document.getElementById('ttx-demo');
  if (!tag){ logSys('Embedded demo not found.'); return; }
  const json = JSON.parse(tag.textContent);
  loadGraph(json);
  const full = true;
  lastLoad = {
    data: JSON.parse(JSON.stringify(fullData)),
    mode: 'demo',
    view: full ? 'full' : 'neighborhood',
    radius: getRadius(),
    startId: full ? null : (fullData.nodes[0]?.id || null)
  };
  afterLoad({ full });
  logSys(`TTX demo loaded: ${fullData.nodes.length} nodes, ${fullData.links.length} links.`);
}
document.getElementById('btnDemo').onclick = loadTTXDemo;

// ----- Search -----
const searchEl = document.getElementById('search');
const suggEl   = document.getElementById('sugg');
function applyFocusToNode(node){
  if (!node) return;
  currentRoot = node.id;
  showDetails(node);
  renderNeighborhood(node.id, getRadius());
  logSys(`Focused ${node.id}`);
}
function findBestMatch(q){
  const ql = q.toLowerCase();
  return fullData.nodes.find(n => String(n.id).toLowerCase() === ql || String(n.name||'').toLowerCase() === ql)
      || fullData.nodes.find(n => String(n.name||'').toLowerCase().includes(ql))
      || fullData.nodes.find(n => String(n.id).toLowerCase().includes(ql));
}
function updateSuggestions(q){
  const ql = q.toLowerCase().trim();
  if (!ql){ suggEl.classList.add('hidden'); suggEl.innerHTML=''; return; }
  const hits = searchIndex.filter(x => x.name.toLowerCase().includes(ql) || x.id.toLowerCase().includes(ql)).slice(0,12);
  if (!hits.length){ suggEl.classList.add('hidden'); suggEl.innerHTML=''; return; }
  suggEl.innerHTML = hits.map(h => (
    `<div class="item" data-id="${h.id}">
       <span>${h.name}</span><span class="type">${(h.label.split(' · ')[1]||'').trim()}</span>
     </div>`
  )).join('');
  suggEl.classList.remove('hidden');
  Array.from(suggEl.querySelectorAll('.item')).forEach(el => {
    el.onclick = () => {
      const id = el.getAttribute('data-id');
      const node = fullData.nodes.find(n => String(n.id) === id);
      searchEl.value = node?.name || node?.id || '';
      suggEl.classList.add('hidden');
      applyFocusToNode(node);
    };
  });
}
searchEl.addEventListener('input', () => {
  const q = searchEl.value;
  updateSuggestions(q);
  const exact = findBestMatch(q);
  if (exact && (String(exact.id).toLowerCase() === q.toLowerCase() || String(exact.name||'').toLowerCase() === q.toLowerCase())){
    applyFocusToNode(exact);
    suggEl.classList.add('hidden');
  }
});
document.addEventListener('click', (e) => {
  if (!suggEl.contains(e.target) && e.target !== searchEl) suggEl.classList.add('hidden');
});

// ----- Helpers -----
function getRadius() {
  const v = parseInt(document.getElementById('radius').value, 10);
  return Number.isNaN(v)?4:v;
}
function computeDegree(data){
  const deg = new Map();
  data.nodes.forEach(n => deg.set(n.id, 0));
  data.links.forEach(l => {
    const s = typeof l.source === 'object' ? l.source.id : l.source;
    const t = typeof l.target === 'object' ? l.target.id : l.target;
    deg.set(s, (deg.get(s)||0)+1);
    deg.set(t, (deg.get(t)||0)+1);
  });
  data.nodes.forEach(n => {
    n.degree = deg.get(n.id) || 0;
    n._r = Math.max(2, Math.min(10, 2 + (n.degree || 0) * 0.4));
  });
}
function buildIndex(data){
  const adj = new Map();
  data.nodes.forEach(n => adj.set(n.id, new Set()));
  data.links.forEach(l => {
    const s = typeof l.source === 'object' ? l.source.id : l.source;
    const t = typeof l.target === 'object' ? l.target.id : l.target;
    adj.get(s)?.add(t);
    adj.get(t)?.add(s);
  });
  return adj;
}
function bfsSubgraph(startId, radius, data){
  if (!startId) return data;
  const adj = buildIndex(data);
  const vis = new Set([startId]);
  const q = [[startId,0]];
  while(q.length){
    const [u,d] = q.shift();
    if (d === radius) continue;
    for (const v of (adj.get(u)||[])) if (!vis.has(v)){
      vis.add(v); q.push([v,d+1]);
    }
  }
  const nodes = data.nodes.filter(n => vis.has(n.id));
  const S = new Set(nodes.map(n => n.id));
  const links = data.links.filter(l => {
    const s = typeof l.source === 'object' ? l.source.id : l.source;
    const t = typeof l.target === 'object' ? l.target.id : l.target;
    return S.has(s) && S.has(t);
  });
  return { nodes, links };
}
function renderNeighborhood(rootId, radius, forceFull=false) {
  if (forceFull || !rootId) {
    computeDegree(fullData);
    g.graphData(fullData);
    toggleLabels(labelsOn);
    setTimeout(() => { try { g.zoomToFit(800, 80); } catch(_) {} }, 80);
    return;
  }
  if ((radius|0) === 0){
    const node = fullData.nodes.find(n => n.id === rootId);
    if (node){
      g.graphData({ nodes: [{...node, degree: 0}], links: [] });
      setTimeout(() => { try { g.zoomToFit(600, 60); } catch(_) {} }, 60);
    }
    return;
  }
  const sub = bfsSubgraph(rootId, radius, fullData);
  computeDegree(sub);
  g.graphData(sub);
  toggleLabels(labelsOn);
  setTimeout(() => { try { g.zoomToFit(600, 60); } catch(_) {} }, 60);
}
function shortestPath(src,dst,data){
  const adj = buildIndex(data);
  const q = [[src]];
  const seen = new Set([src]);
  while(q.length){
    const path = q.shift(), last = path[path.length-1];
    if (last === dst) return path;
    for (const v of (adj.get(last)||[])){
      if (!seen.has(v)){
        seen.add(v); q.push(path.concat(v));
      }
    }
  }
  return null;
}
function highlightPath(path){
  const set = new Set(path);
  const links = fullData.links.filter(l => {
    const s = typeof l.source === 'object' ? l.source.id : l.source;
    const t = typeof l.target === 'object' ? l.target.id : l.target;
    return set.has(s) && set.has(t);
  });
  const nodes = fullData.nodes.filter(n => set.has(n.id));
  g.graphData({nodes, links});
}

// ----- Details -----
function showDetails(n){
  const el = document.getElementById('details');
  const name = n.name || n.id;
  const type = n.type || 'Object';
  const deg  = n.degree ?? 0;
  const sql  = n.sql || 'No SQL available.';
  el.innerHTML = (
    `<div><strong>${escapeHtml(name)}</strong></div>
     <div class="muted">${escapeHtml(type)} · degree ${deg}</div>
     <div style="margin-top:8px" class="muted">SQL</div>
     <pre>${escapeHtml(sql)}</pre>
     <div style="margin-top:8px" class="muted">Properties</div>
     <pre>${escapeHtml(JSON.stringify({id:n.id,type:n.type,degree:n.degree}, null, 2))}</pre>`
  );
  document.getElementById('title').textContent = name;
}
function escapeHtml(s){
  return String(s).replace(/[&<>"]/g, c => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;'}[c]));
}

// ----- Data Plumbing -----
function normalizeLinks(json){
  json.links = (json.links || []).map(l => ({
    source: typeof l.source === 'object' ? l.source.id : l.source,
    target: typeof l.target === 'object' ? l.target.id : l.target,
    kind: l.kind || 'DEPENDS_ON'
  }));
  return json;
}
function normalizeType(t){
  if (!t) return 'Object';
  const s = String(t).toLowerCase().trim();
  if (s.includes('table') || s === 'user_table' || s === 'base_table' || s === 'system_table')
    return 'Table';
  if (s.includes('view') || s.startsWith('vw_'))
    return 'View';
  if (s.includes('procedure') || s.includes('proc') || s.includes('sp_') || s.includes('stored_proc'))
    return 'Proc';
  if (s.includes('function') || s.includes('fn_') || s.includes('udf') || s.includes('tvf'))
    return 'Function';
  if (s.includes('trigger'))
    return 'Trigger';
  if (s.includes('synonym'))
    return 'Synonym';
  if (s.includes('type') || s.includes('udt'))
    return 'Type';
  if (s.includes('constraint') || s.includes('foreign') || s.includes('primary') || s.includes('check'))
    return 'Constraint';
  return 'Object';
}
function sanitizeGraph(data){
  data.nodes.forEach(n => {
    n.type = normalizeType(n.type);
    n.id = String(n.id).trim();
    n.name = String(n.name || n.id).trim();
  });
  const seen = new Set();
  data.links = (data.links || []).map(l => ({
    source: String(typeof l.source === 'object' ? l.source.id : l.source).trim(),
    target: String(typeof l.target === 'object' ? l.target.id : l.target).trim(),
    kind: l.kind || 'DEPENDS_ON'
  }))
  .filter(l => l.source && l.target && l.source !== l.target)
  .filter(l => { const k = `${l.source}->${l.target}`; if (seen.has(k)) return false; seen.add(k); return true; });

  const nodeSet = new Set(data.nodes.map(n => n.id));
  for (const l of data.links){
    if (!nodeSet.has(l.source)) { data.nodes.push({ id:l.source, name:l.source, type:'Object' }); nodeSet.add(l.source); }
    if (!nodeSet.has(l.target)) { data.nodes.push({ id:l.target, name:l.target, type:'Object' }); nodeSet.add(l.target); }
  }
  return data;
}
function loadGraph(json){
  if (!json || !Array.isArray(json.nodes) || !Array.isArray(json.links)){
    logSys('Invalid model JSON structure.');
    return;
  }
  fullData = sanitizeGraph(normalizeLinks(json));
  computeDegree(fullData);
}
function afterLoad({ full=false } = {}){
  buildSearchIndex(fullData.nodes);
  const startId = fullData.nodes[0]?.id || null;
  currentRoot = startId;
  renderNeighborhood(full ? null : startId, getRadius(), full);
}
function buildSearchIndex(nodes){
  const seen = new Set();
  searchIndex = nodes.map(n => ({
    id: String(n.id),
    name: String(n.name || n.id),
    label: `${n.name || n.id}${n.type ? ' · ' + n.type : ''}`
  })).filter(x => {
    const k = x.name.toLowerCase();
    if (seen.has(k)) return false; seen.add(k); return true;
  });
}

// ----- Chat -----
document.getElementById('send').onclick = onAsk;
function onAsk(){
  const p = document.getElementById('prompt').value.trim();
  if (!p) return;
  addChat('you', p);
  handleLocalQuery(p);
  document.getElementById('prompt').value = '';
}
function handleLocalQuery(q){
  const [cmd, ...rest] = q.split(/\s+/);
  const arg = rest.join(' ');
  switch ((cmd||'').toLowerCase()){
    case 'help':
      addChat('assistant',
        "Commands:\n- focus <nodeId>\n- neighbors <nodeId> [radius]\n- shortest <src> <dst>\n- search <text>\n- radius <n>\n- types <Table|View|Proc>");
      break;
    case 'focus': {
      const id = rest[0];
      const node = fullData.nodes.find(n => n.id === id);
      if (!node){ addChat('assistant',`No node ${id}`); return; }
      applyFocusToNode(node);
    } break;
    case 'search': {
      const txt = arg.toLowerCase();
      const hits = fullData.nodes.filter(n => (n.name||n.id).toLowerCase().includes(txt)).slice(0,20);
      addChat('assistant', hits.length ? `Matches (${hits.length}): ${hits.map(h=>h.id).join(', ')}` : 'No matches');
    } break;
    case 'neighbors': {
      const id = rest[0];
      const r = parseInt(rest[1]||String(getRadius()),10);
      if (!id){ addChat('assistant','Usage: neighbors <nodeId> [radius]'); return; }
      const node = fullData.nodes.find(n => n.id === id);
      if (!node){ addChat('assistant',`No node ${id}`); return; }
      renderNeighborhood(id, Number.isNaN(r)?getRadius():r);
      const adj = buildIndex(fullData);
      const nb = Array.from(adj.get(id)||[]);
      addChat('assistant', `Neighbors of ${id} (1 hop): ${nb.join(', ') || '(none)'}`);
    } break;
    case 'shortest': {
      const [src,dst] = rest;
      if (!src||!dst){ addChat('assistant','Usage: shortest <src> <dst>'); return; }
      const path = shortestPath(src,dst,fullData);
      if (!path){ addChat('assistant',`No path from ${src} to ${dst}`); return; }
      highlightPath(path);
      addChat('assistant',`Shortest path (${path.length-1} hops): ${path.join(' -> ')}`);
    } break;
    case 'radius': {
      const n = parseInt(rest[0]||'4',10);
      document.getElementById('radius').value = String(n);
      onRadiusChange();
      addChat('assistant',`Radius set to ${n}`);
    } break;
    case 'types': {
      const want = new Set(rest.join('').split('|').map(s=>s.trim()));
      const hits = fullData.nodes.filter(n => want.has((n.type||'').toString()));
      addChat('assistant', hits.length ? `Types ${Array.from(want).join('|')}: ${hits.slice(0,20).map(h=>h.id).join(', ')}${hits.length>20?' …':''}` : 'No matches');
    } break;
    default:
      addChat('assistant','Unknown command. Type "help".');
  }
}
function addChat(role, content){
  const wrap = document.createElement('div');
  wrap.className='chat-msg';
  const r = document.createElement('div'); r.className='chat-role'; r.textContent=role;
  const b = document.createElement('div'); b.className='chat-bubble'; b.textContent=content;
  wrap.appendChild(r); wrap.appendChild(b);
  const log = document.getElementById('chatlog');
  log.appendChild(wrap); log.scrollTop = log.scrollHeight;

  // REMOVE every message after N ms
  setTimeout(() => wrap.remove(), 3000); // 3s, or your preferred duration

  return wrap;
}

// ----- Radius Change -----
function onRadiusChange(){
  if (!fullData.nodes.length) return;
  const root = currentRoot || fullData.nodes[0]?.id;
  if (!root){ renderNeighborhood(null, getRadius(), true); return; }
  renderNeighborhood(root, getRadius());
}
document.getElementById('radius').addEventListener('input', onRadiusChange);
document.getElementById('radius').addEventListener('change', onRadiusChange);

// ----- Search Index -----
function buildSearchIndex(nodes){
  const seen = new Set();
  searchIndex = nodes.map(n => ({
    id: String(n.id),
    name: String(n.name || n.id),
    label: `${n.name || n.id}${n.type ? ' · ' + n.type : ''}`
  })).filter(x => {
    const k = x.name.toLowerCase();
    if (seen.has(k)) return false; seen.add(k); return true;
  });
}

// ----- Reset -----
function resetVisual(){
  if (!lastLoad.data){ logSys('Nothing to reset. Load a model first.'); return; }
  fullData = JSON.parse(JSON.stringify(lastLoad.data));
  computeDegree(fullData);
  buildSearchIndex(fullData.nodes);
  document.getElementById('search').value = '';
  document.getElementById('radius').value = String(lastLoad.radius);
  currentRoot = (lastLoad.view === 'neighborhood') ? lastLoad.startId : null;
  const forceFull = (lastLoad.view === 'full');
  renderNeighborhood(currentRoot, lastLoad.radius, forceFull);
  document.getElementById('details').textContent = 'Reset to loaded view.';
  document.getElementById('title').textContent = 'Details';
  setTimeout(() => { try { g.zoomToFit(800, 80); } catch(_) {} }, 80);
}
document.getElementById('btnReset').addEventListener('click', resetVisual);

// Button: Toggle Labels
document.getElementById('btnLabels').addEventListener('click', () => {
  labelsOn = !labelsOn;
  toggleLabels(labelsOn);
});

// ---------- init ----------
(function init(){
  document.getElementById('radius').value = 4;
  g.graphData({ nodes: [], links: [] });
  loadTTXDemo();
})();
  </script>
</body>
</html>
